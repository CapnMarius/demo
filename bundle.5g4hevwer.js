!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=108)}([function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(62)),__export(__webpack_require__(63)),__export(__webpack_require__(46)),__export(__webpack_require__(127)),__export(__webpack_require__(128)),__export(__webpack_require__(129)),__export(__webpack_require__(130)),__export(__webpack_require__(64)),__export(__webpack_require__(131)),__export(__webpack_require__(65)),__export(__webpack_require__(132)),__export(__webpack_require__(133)),__export(__webpack_require__(135)),__export(__webpack_require__(136)),__export(__webpack_require__(137))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(0),util_3=__webpack_require__(0),util_4=__webpack_require__(0),util_5=__webpack_require__(0),util_6=__webpack_require__(0),storage_1=__webpack_require__(34),util_7=__webpack_require__(0);exports.LUIDGenerator=function(){var id=1;return function(){return id++}}(),exports.sha1=function(str){var utf8Bytes=util_5.stringToByteArray(str),sha1=new util_4.Sha1;sha1.update(utf8Bytes);var sha1Bytes=sha1.digest();return util_3.base64.encodeByteArray(sha1Bytes)};var buildLogMessage_=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];for(var message="",i=0;i<var_args.length;i++)Array.isArray(var_args[i])||var_args[i]&&"object"==typeof var_args[i]&&"number"==typeof var_args[i].length?message+=buildLogMessage_.apply(null,var_args[i]):"object"==typeof var_args[i]?message+=util_6.stringify(var_args[i]):message+=var_args[i],message+=" ";return message};exports.logger=null;var firstLog_=!0;exports.enableLogging=function(logger_,persistent){util_1.assert(!persistent||!0===logger_||!1===logger_,"Can't turn on custom loggers persistently."),!0===logger_?("undefined"!=typeof console&&("function"==typeof console.log?exports.logger=console.log.bind(console):"object"==typeof console.log&&(exports.logger=function(message){console.log(message)})),persistent&&storage_1.SessionStorage.set("logging_enabled",!0)):"function"==typeof logger_?exports.logger=logger_:(exports.logger=null,storage_1.SessionStorage.remove("logging_enabled"))},exports.log=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];if(!0===firstLog_&&(firstLog_=!1,null===exports.logger&&!0===storage_1.SessionStorage.get("logging_enabled")&&exports.enableLogging(!0)),exports.logger){var message=buildLogMessage_.apply(null,var_args);exports.logger(message)}},exports.logWrapper=function(prefix){return function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];exports.log.apply(void 0,[prefix].concat(var_args))}},exports.error=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];if("undefined"!=typeof console){var message="FIREBASE INTERNAL ERROR: "+buildLogMessage_.apply(void 0,var_args);void 0!==console.error?console.error(message):console.log(message)}},exports.fatal=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var message=buildLogMessage_.apply(void 0,var_args);throw new Error("FIREBASE FATAL ERROR: "+message)},exports.warn=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];if("undefined"!=typeof console){var message="FIREBASE WARNING: "+buildLogMessage_.apply(void 0,var_args);void 0!==console.warn?console.warn(message):console.log(message)}},exports.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&exports.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},exports.warnAboutUnsupportedMethod=function(methodName){exports.warn(methodName+" is unsupported and will likely change soon.  Please do not use.")},exports.isInvalidJSONNumber=function(data){return"number"==typeof data&&(data!=data||data==Number.POSITIVE_INFINITY||data==Number.NEGATIVE_INFINITY)},exports.executeWhenDOMReady=function(fn){if(util_7.isNodeSdk()||"complete"===document.readyState)fn();else{var called_1=!1,wrappedFn_1=function(){if(!document.body)return void setTimeout(wrappedFn_1,Math.floor(10));called_1||(called_1=!0,fn())};document.addEventListener?(document.addEventListener("DOMContentLoaded",wrappedFn_1,!1),window.addEventListener("load",wrappedFn_1,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&wrappedFn_1()}),window.attachEvent("onload",wrappedFn_1))}},exports.MIN_NAME="[MIN_NAME]",exports.MAX_NAME="[MAX_NAME]",exports.nameCompare=function(a,b){if(a===b)return 0;if(a===exports.MIN_NAME||b===exports.MAX_NAME)return-1;if(b===exports.MIN_NAME||a===exports.MAX_NAME)return 1;var aAsInt=exports.tryParseInt(a),bAsInt=exports.tryParseInt(b);return null!==aAsInt?null!==bAsInt?aAsInt-bAsInt==0?a.length-b.length:aAsInt-bAsInt:-1:null!==bAsInt?1:a<b?-1:1},exports.stringCompare=function(a,b){return a===b?0:a<b?-1:1},exports.requireKey=function(key,obj){if(obj&&key in obj)return obj[key];throw new Error("Missing required key ("+key+") in object: "+util_6.stringify(obj))},exports.ObjectToUniqueKey=function(obj){if("object"!=typeof obj||null===obj)return util_6.stringify(obj);var keys=[];for(var k in obj)keys.push(k);keys.sort();for(var key="{",i=0;i<keys.length;i++)0!==i&&(key+=","),key+=util_6.stringify(keys[i]),key+=":",key+=exports.ObjectToUniqueKey(obj[keys[i]]);return key+="}"},exports.splitStringBySize=function(str,segsize){var len=str.length;if(len<=segsize)return[str];for(var dataSegs=[],c=0;c<len;c+=segsize)c+segsize>len?dataSegs.push(str.substring(c,len)):dataSegs.push(str.substring(c,c+segsize));return dataSegs},exports.each=function(obj,fn){if(Array.isArray(obj))for(var i=0;i<obj.length;++i)fn(i,obj[i]);else util_2.forEach(obj,function(key,val){return fn(val,key)})},exports.bindCallback=function(callback,context){return context?callback.bind(context):callback},exports.doubleToIEEE754String=function(v){util_1.assert(!exports.isInvalidJSONNumber(v),"Invalid JSON number");var s,e,f,ln,i,bits,str;for(0===v?(e=0,f=0,s=1/v==-1/0?1:0):(s=v<0,v=Math.abs(v),v>=Math.pow(2,-1022)?(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),1023),e=ln+1023,f=Math.round(v*Math.pow(2,52-ln)-Math.pow(2,52))):(e=0,f=Math.round(v/Math.pow(2,-1074)))),bits=[],i=52;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=11;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);bits.push(s?1:0),bits.reverse(),str=bits.join("");var hexByteString="";for(i=0;i<64;i+=8){var hexByte=parseInt(str.substr(i,8),2).toString(16);1===hexByte.length&&(hexByte="0"+hexByte),hexByteString+=hexByte}return hexByteString.toLowerCase()},exports.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},exports.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},exports.errorForServerCode=function(code,query){var reason="Unknown Error";"too_big"===code?reason="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==code?reason="Client doesn't have permission to access the desired data.":"unavailable"==code&&(reason="The service is unavailable");var error=new Error(code+" at "+query.path.toString()+": "+reason);return error.code=code.toUpperCase(),error},exports.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),exports.tryParseInt=function(str){if(exports.INTEGER_REGEXP_.test(str)){var intVal=Number(str);if(intVal>=-2147483648&&intVal<=2147483647)return intVal}return null},exports.exceptionGuard=function(fn){try{fn()}catch(e){setTimeout(function(){var stack=e.stack||"";throw exports.warn("Exception was thrown by user callback.",stack),e},Math.floor(0))}},exports.callUserCallback=function(callback){for(var var_args=[],_i=1;_i<arguments.length;_i++)var_args[_i-1]=arguments[_i];"function"==typeof callback&&exports.exceptionGuard(function(){callback.apply(void 0,var_args)})},exports.beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},exports.exportPropGetter=function(object,name,fnGet){Object.defineProperty(object,name,{get:fnGet})},exports.setTimeoutNonBlocking=function(fn,time){var timeout=setTimeout(fn,time);return"object"==typeof timeout&&timeout.unref&&timeout.unref(),timeout}},function(module,exports,__webpack_require__){(function(setImmediate,global){!function(){"use strict";function Vnode(tag,key,attrs0,children,text,dom){return{tag:tag,key:key,attrs:attrs0,children:children,text:text,dom:dom,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}function isEmpty(object){for(var key in object)if(hasOwn.call(object,key))return!1;return!0}function compileSelector(selector){for(var match,tag="div",classes=[],attrs={};match=selectorParser.exec(selector);){var type=match[1],value=match[2];if(""===type&&""!==value)tag=value;else if("#"===type)attrs.id=value;else if("."===type)classes.push(value);else if("["===match[3][0]){var attrValue=match[6];attrValue&&(attrValue=attrValue.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===match[4]?classes.push(attrValue):attrs[match[4]]=""===attrValue?attrValue:attrValue||!0}}return classes.length>0&&(attrs.className=classes.join(" ")),selectorCache[selector]={tag:tag,attrs:attrs}}function execSelector(state,attrs,children){var childList,text,hasAttrs=!1,className=attrs.className||attrs.class;if(!isEmpty(state.attrs)&&!isEmpty(attrs)){var newAttrs={};for(var key in attrs)hasOwn.call(attrs,key)&&(newAttrs[key]=attrs[key]);attrs=newAttrs}for(var key in state.attrs)hasOwn.call(state.attrs,key)&&(attrs[key]=state.attrs[key]);void 0!==className&&(void 0!==attrs.class&&(attrs.class=void 0,attrs.className=className),null!=state.attrs.className&&(attrs.className=state.attrs.className+" "+className));for(var key in attrs)if(hasOwn.call(attrs,key)&&"key"!==key){hasAttrs=!0;break}return Array.isArray(children)&&1===children.length&&null!=children[0]&&"#"===children[0].tag?text=children[0].children:childList=children,Vnode(state.tag,attrs.key,hasAttrs?attrs:void 0,childList,text)}function hyperscript(selector){var children,attrs=arguments[1],start=2;if(null==selector||"string"!=typeof selector&&"function"!=typeof selector&&"function"!=typeof selector.view)throw Error("The selector must be either a string or a component.");if("string"==typeof selector)var cached=selectorCache[selector]||compileSelector(selector);if(null==attrs?attrs={}:("object"!=typeof attrs||null!=attrs.tag||Array.isArray(attrs))&&(attrs={},start=1),arguments.length===start+1)children=arguments[start],Array.isArray(children)||(children=[children]);else for(children=[];start<arguments.length;)children.push(arguments[start++]);var normalized=Vnode.normalizeChildren(children);return"string"==typeof selector?execSelector(cached,attrs,normalized):Vnode(selector,attrs.key,attrs,normalized)}function throttle(callback){var last=0,pending=null,timeout="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var now=Date.now();0===last||now-last>=16?(last=now,callback()):null===pending&&(pending=timeout(function(){pending=null,callback(),last=Date.now()},16-(now-last)))}}Vnode.normalize=function(node){return Array.isArray(node)?Vnode("[",void 0,void 0,Vnode.normalizeChildren(node),void 0,void 0):null!=node&&"object"!=typeof node?Vnode("#",void 0,void 0,!1===node?"":node,void 0,void 0):node},Vnode.normalizeChildren=function(children){for(var i=0;i<children.length;i++)children[i]=Vnode.normalize(children[i]);return children};var selectorParser=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,selectorCache={},hasOwn={}.hasOwnProperty;hyperscript.trust=function(html){return null==html&&(html=""),Vnode("<",void 0,void 0,html,void 0,void 0)},hyperscript.fragment=function(attrs1,children){return Vnode("[",attrs1.key,attrs1,Vnode.normalizeChildren(children),void 0,void 0)};var m=hyperscript,PromisePolyfill=function(executor){function handler(list,shouldAbsorb){return function execute(value){var then;try{if(!shouldAbsorb||null==value||"object"!=typeof value&&"function"!=typeof value||"function"!=typeof(then=value.then))callAsync(function(){shouldAbsorb||0!==list.length||console.error("Possible unhandled promise rejection:",value);for(var i=0;i<list.length;i++)list[i](value);resolvers.length=0,rejectors.length=0,instance.state=shouldAbsorb,instance.retry=function(){execute(value)}});else{if(value===self)throw new TypeError("Promise can't be resolved w/ itself");executeOnce(then.bind(value))}}catch(e){rejectCurrent(e)}}}function executeOnce(then){function run(fn){return function(value){runs++>0||fn(value)}}var runs=0,onerror=run(rejectCurrent);try{then(run(resolveCurrent),onerror)}catch(e){onerror(e)}}if(!(this instanceof PromisePolyfill))throw new Error("Promise must be called with `new`");if("function"!=typeof executor)throw new TypeError("executor must be a function");var self=this,resolvers=[],rejectors=[],resolveCurrent=handler(resolvers,!0),rejectCurrent=handler(rejectors,!1),instance=self._instance={resolvers:resolvers,rejectors:rejectors},callAsync="function"==typeof setImmediate?setImmediate:setTimeout;executeOnce(executor)};if(PromisePolyfill.prototype.then=function(onFulfilled,onRejection){function handle(callback,list,next,state){list.push(function(value){if("function"!=typeof callback)next(value);else try{resolveNext(callback(value))}catch(e){rejectNext&&rejectNext(e)}}),"function"==typeof instance.retry&&state===instance.state&&instance.retry()}var resolveNext,rejectNext,self=this,instance=self._instance,promise=new PromisePolyfill(function(resolve,reject){resolveNext=resolve,rejectNext=reject});return handle(onFulfilled,instance.resolvers,resolveNext,!0),handle(onRejection,instance.rejectors,rejectNext,!1),promise},PromisePolyfill.prototype.catch=function(onRejection){return this.then(null,onRejection)},PromisePolyfill.resolve=function(value){return value instanceof PromisePolyfill?value:new PromisePolyfill(function(resolve){resolve(value)})},PromisePolyfill.reject=function(value){return new PromisePolyfill(function(resolve,reject){reject(value)})},PromisePolyfill.all=function(list){return new PromisePolyfill(function(resolve,reject){var total=list.length,count=0,values=[];if(0===list.length)resolve([]);else for(var i=0;i<list.length;i++)!function(i){function consume(value){count++,values[i]=value,count===total&&resolve(values)}null==list[i]||"object"!=typeof list[i]&&"function"!=typeof list[i]||"function"!=typeof list[i].then?consume(list[i]):list[i].then(consume,reject)}(i)})},PromisePolyfill.race=function(list){return new PromisePolyfill(function(resolve,reject){for(var i=0;i<list.length;i++)list[i].then(resolve,reject)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=PromisePolyfill);var PromisePolyfill=window.Promise}else if(void 0!==global){void 0===global.Promise&&(global.Promise=PromisePolyfill);var PromisePolyfill=global.Promise}var buildQueryString=function(object){function destructure(key0,value){if(Array.isArray(value))for(var i=0;i<value.length;i++)destructure(key0+"["+i+"]",value[i]);else if("[object Object]"===Object.prototype.toString.call(value))for(var i in value)destructure(key0+"["+i+"]",value[i]);else args.push(encodeURIComponent(key0)+(null!=value&&""!==value?"="+encodeURIComponent(value):""))}if("[object Object]"!==Object.prototype.toString.call(object))return"";var args=[];for(var key0 in object)destructure(key0,object[key0]);return args.join("&")},FILE_PROTOCOL_REGEX=new RegExp("^file://","i"),requestService=function($window,Promise){function setCompletionCallback(callback){oncompletion=callback}function finalizer(){function complete(){0==--count&&"function"==typeof oncompletion&&oncompletion()}var count=0;return function finalize(promise0){var then0=promise0.then;return promise0.then=function(){count++;var next=then0.apply(promise0,arguments);return next.then(complete,function(e){if(complete(),0===count)throw e}),finalize(next)},promise0}}function normalize(args,extra){if("string"==typeof args){var url=args;args=extra||{},null==args.url&&(args.url=url)}return args}function request(args,extra){var finalize=finalizer();args=normalize(args,extra);var promise0=new Promise(function(resolve,reject){null==args.method&&(args.method="GET"),args.method=args.method.toUpperCase();var useBody="GET"!==args.method&&"TRACE"!==args.method&&("boolean"!=typeof args.useBody||args.useBody);"function"!=typeof args.serialize&&(args.serialize="undefined"!=typeof FormData&&args.data instanceof FormData?function(value){return value}:JSON.stringify),"function"!=typeof args.deserialize&&(args.deserialize=deserialize),"function"!=typeof args.extract&&(args.extract=extract),args.url=interpolate(args.url,args.data),useBody?args.data=args.serialize(args.data):args.url=assemble(args.url,args.data);var xhr=new $window.XMLHttpRequest,aborted=!1,_abort=xhr.abort;xhr.abort=function(){aborted=!0,_abort.call(xhr)},xhr.open(args.method,args.url,"boolean"!=typeof args.async||args.async,"string"==typeof args.user?args.user:void 0,"string"==typeof args.password?args.password:void 0),args.serialize!==JSON.stringify||!useBody||args.headers&&args.headers.hasOwnProperty("Content-Type")||xhr.setRequestHeader("Content-Type","application/json; charset=utf-8"),args.deserialize!==deserialize||args.headers&&args.headers.hasOwnProperty("Accept")||xhr.setRequestHeader("Accept","application/json, text/*"),args.withCredentials&&(xhr.withCredentials=args.withCredentials);for(var key in args.headers)({}).hasOwnProperty.call(args.headers,key)&&xhr.setRequestHeader(key,args.headers[key]);"function"==typeof args.config&&(xhr=args.config(xhr,args)||xhr),xhr.onreadystatechange=function(){if(!aborted&&4===xhr.readyState)try{var response=args.extract!==extract?args.extract(xhr,args):args.deserialize(args.extract(xhr,args));if(xhr.status>=200&&xhr.status<300||304===xhr.status||FILE_PROTOCOL_REGEX.test(args.url))resolve(cast(args.type,response));else{var error=new Error(xhr.responseText);for(var key in response)error[key]=response[key];reject(error)}}catch(e){reject(e)}},useBody&&null!=args.data?xhr.send(args.data):xhr.send()});return!0===args.background?promise0:finalize(promise0)}function jsonp(args,extra){var finalize=finalizer();args=normalize(args,extra);var promise0=new Promise(function(resolve,reject){var callbackName=args.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+callbackCount++,script=$window.document.createElement("script");$window[callbackName]=function(data){script.parentNode.removeChild(script),resolve(cast(args.type,data)),delete $window[callbackName]},script.onerror=function(){script.parentNode.removeChild(script),reject(new Error("JSONP request failed")),delete $window[callbackName]},null==args.data&&(args.data={}),args.url=interpolate(args.url,args.data),args.data[args.callbackKey||"callback"]=callbackName,script.src=assemble(args.url,args.data),$window.document.documentElement.appendChild(script)});return!0===args.background?promise0:finalize(promise0)}function interpolate(url,data){if(null==data)return url;for(var tokens=url.match(/:[^\/]+/gi)||[],i=0;i<tokens.length;i++){var key=tokens[i].slice(1);null!=data[key]&&(url=url.replace(tokens[i],data[key]))}return url}function assemble(url,data){var querystring=buildQueryString(data);if(""!==querystring){url+=(url.indexOf("?")<0?"?":"&")+querystring}return url}function deserialize(data){try{return""!==data?JSON.parse(data):null}catch(e){throw new Error(data)}}function extract(xhr){return xhr.responseText}function cast(type0,data){if("function"==typeof type0){if(!Array.isArray(data))return new type0(data);for(var i=0;i<data.length;i++)data[i]=new type0(data[i])}return data}var oncompletion,callbackCount=0;return{request:request,jsonp:jsonp,setCompletionCallback:setCompletionCallback}}(window,PromisePolyfill),coreRenderer=function($window){function setEventCallback(callback){return onevent=callback}function getNameSpace(vnode){return vnode.attrs&&vnode.attrs.xmlns||nameSpace[vnode.tag]}function createNodes(parent,vnodes,start,end,hooks,nextSibling,ns){for(var i=start;i<end;i++){var vnode=vnodes[i];null!=vnode&&createNode(parent,vnode,hooks,ns,nextSibling)}}function createNode(parent,vnode,hooks,ns,nextSibling){var tag=vnode.tag;if("string"!=typeof tag)return createComponent(parent,vnode,hooks,ns,nextSibling);switch(vnode.state={},null!=vnode.attrs&&initLifecycle(vnode.attrs,vnode,hooks),tag){case"#":return createText(parent,vnode,nextSibling);case"<":return createHTML(parent,vnode,nextSibling);case"[":return createFragment(parent,vnode,hooks,ns,nextSibling);default:return createElement(parent,vnode,hooks,ns,nextSibling)}}function createText(parent,vnode,nextSibling){return vnode.dom=$doc.createTextNode(vnode.children),insertNode(parent,vnode.dom,nextSibling),vnode.dom}function createHTML(parent,vnode,nextSibling){var match1=vnode.children.match(/^\s*?<(\w+)/im)||[],parent1={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[match1[1]]||"div",temp=$doc.createElement(parent1);temp.innerHTML=vnode.children,vnode.dom=temp.firstChild,vnode.domSize=temp.childNodes.length;for(var child,fragment=$doc.createDocumentFragment();child=temp.firstChild;)fragment.appendChild(child);return insertNode(parent,fragment,nextSibling),fragment}function createFragment(parent,vnode,hooks,ns,nextSibling){var fragment=$doc.createDocumentFragment();if(null!=vnode.children){var children=vnode.children;createNodes(fragment,children,0,children.length,hooks,null,ns)}return vnode.dom=fragment.firstChild,vnode.domSize=fragment.childNodes.length,insertNode(parent,fragment,nextSibling),fragment}function createElement(parent,vnode,hooks,ns,nextSibling){var tag=vnode.tag,attrs2=vnode.attrs,is=attrs2&&attrs2.is;ns=getNameSpace(vnode)||ns;var element=ns?is?$doc.createElementNS(ns,tag,{is:is}):$doc.createElementNS(ns,tag):is?$doc.createElement(tag,{is:is}):$doc.createElement(tag);if(vnode.dom=element,null!=attrs2&&setAttrs(vnode,attrs2,ns),insertNode(parent,element,nextSibling),null!=vnode.attrs&&null!=vnode.attrs.contenteditable)setContentEditable(vnode);else if(null!=vnode.text&&(""!==vnode.text?element.textContent=vnode.text:vnode.children=[Vnode("#",void 0,void 0,vnode.text,void 0,void 0)]),null!=vnode.children){var children=vnode.children;createNodes(element,children,0,children.length,hooks,null,ns),setLateAttrs(vnode)}return element}function initComponent(vnode,hooks){var sentinel;if("function"==typeof vnode.tag.view){if(vnode.state=Object.create(vnode.tag),sentinel=vnode.state.view,null!=sentinel.$$reentrantLock$$)return $emptyFragment;sentinel.$$reentrantLock$$=!0}else{if(vnode.state=void 0,sentinel=vnode.tag,null!=sentinel.$$reentrantLock$$)return $emptyFragment;sentinel.$$reentrantLock$$=!0,vnode.state=null!=vnode.tag.prototype&&"function"==typeof vnode.tag.prototype.view?new vnode.tag(vnode):vnode.tag(vnode)}if(vnode._state=vnode.state,null!=vnode.attrs&&initLifecycle(vnode.attrs,vnode,hooks),initLifecycle(vnode._state,vnode,hooks),vnode.instance=Vnode.normalize(vnode._state.view.call(vnode.state,vnode)),vnode.instance===vnode)throw Error("A view cannot return the vnode it received as argument");sentinel.$$reentrantLock$$=null}function createComponent(parent,vnode,hooks,ns,nextSibling){if(initComponent(vnode,hooks),null!=vnode.instance){var element=createNode(parent,vnode.instance,hooks,ns,nextSibling);return vnode.dom=vnode.instance.dom,vnode.domSize=null!=vnode.dom?vnode.instance.domSize:0,insertNode(parent,element,nextSibling),element}return vnode.domSize=0,$emptyFragment}function updateNodes(parent,old,vnodes,recycling,hooks,nextSibling,ns){if(old!==vnodes&&(null!=old||null!=vnodes))if(null==old)createNodes(parent,vnodes,0,vnodes.length,hooks,nextSibling,ns);else if(null==vnodes)removeNodes(old,0,old.length,vnodes);else{if(old.length===vnodes.length){for(var isUnkeyed=!1,i=0;i<vnodes.length;i++)if(null!=vnodes[i]&&null!=old[i]){isUnkeyed=null==vnodes[i].key&&null==old[i].key;break}if(isUnkeyed){for(var i=0;i<old.length;i++)old[i]!==vnodes[i]&&(null==old[i]&&null!=vnodes[i]?createNode(parent,vnodes[i],hooks,ns,getNextSibling(old,i+1,nextSibling)):null==vnodes[i]?removeNodes(old,i,i+1,vnodes):updateNode(parent,old[i],vnodes[i],hooks,getNextSibling(old,i+1,nextSibling),recycling,ns));return}}if(recycling=recycling||isRecyclable(old,vnodes)){var pool=old.pool;old=old.concat(old.pool)}for(var map,oldStart=0,start=0,oldEnd=old.length-1,end=vnodes.length-1;oldEnd>=oldStart&&end>=start;){var o=old[oldStart],v=vnodes[start];if(o!==v||recycling)if(null==o)oldStart++;else if(null==v)start++;else if(o.key===v.key){var shouldRecycle=null!=pool&&oldStart>=old.length-pool.length||null==pool&&recycling;oldStart++,start++,updateNode(parent,o,v,hooks,getNextSibling(old,oldStart,nextSibling),shouldRecycle,ns),recycling&&o.tag===v.tag&&insertNode(parent,toFragment(o),nextSibling)}else{var o=old[oldEnd];if(o!==v||recycling)if(null==o)oldEnd--;else if(null==v)start++;else{if(o.key!==v.key)break;var shouldRecycle=null!=pool&&oldEnd>=old.length-pool.length||null==pool&&recycling;updateNode(parent,o,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),shouldRecycle,ns),(recycling||start<end)&&insertNode(parent,toFragment(o),getNextSibling(old,oldStart,nextSibling)),oldEnd--,start++}else oldEnd--,start++}else oldStart++,start++}for(;oldEnd>=oldStart&&end>=start;){var o=old[oldEnd],v=vnodes[end];if(o!==v||recycling)if(null==o)oldEnd--;else if(null==v)end--;else if(o.key===v.key){var shouldRecycle=null!=pool&&oldEnd>=old.length-pool.length||null==pool&&recycling;updateNode(parent,o,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),shouldRecycle,ns),recycling&&o.tag===v.tag&&insertNode(parent,toFragment(o),nextSibling),null!=o.dom&&(nextSibling=o.dom),oldEnd--,end--}else{if(map||(map=getKeyMap(old,oldEnd)),null!=v){var oldIndex=map[v.key];if(null!=oldIndex){var movable=old[oldIndex],shouldRecycle=null!=pool&&oldIndex>=old.length-pool.length||null==pool&&recycling;updateNode(parent,movable,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),recycling,ns),insertNode(parent,toFragment(movable),nextSibling),old[oldIndex].skip=!0,null!=movable.dom&&(nextSibling=movable.dom)}else{var dom=createNode(parent,v,hooks,ns,nextSibling);nextSibling=dom}}end--}else oldEnd--,end--;if(end<start)break}createNodes(parent,vnodes,start,end+1,hooks,nextSibling,ns),removeNodes(old,oldStart,oldEnd+1,vnodes)}}function updateNode(parent,old,vnode,hooks,nextSibling,recycling,ns){var oldTag=old.tag;if(oldTag===vnode.tag){if(vnode.state=old.state,vnode._state=old._state,vnode.events=old.events,!recycling&&shouldNotUpdate(vnode,old))return;if("string"==typeof oldTag)switch(null!=vnode.attrs&&(recycling?(vnode.state={},initLifecycle(vnode.attrs,vnode,hooks)):updateLifecycle(vnode.attrs,vnode,hooks)),oldTag){case"#":updateText(old,vnode);break;case"<":updateHTML(parent,old,vnode,nextSibling);break;case"[":updateFragment(parent,old,vnode,recycling,hooks,nextSibling,ns);break;default:updateElement(old,vnode,recycling,hooks,ns)}else updateComponent(parent,old,vnode,hooks,nextSibling,recycling,ns)}else removeNode(old,null),createNode(parent,vnode,hooks,ns,nextSibling)}function updateText(old,vnode){old.children.toString()!==vnode.children.toString()&&(old.dom.nodeValue=vnode.children),vnode.dom=old.dom}function updateHTML(parent,old,vnode,nextSibling){old.children!==vnode.children?(toFragment(old),createHTML(parent,vnode,nextSibling)):(vnode.dom=old.dom,vnode.domSize=old.domSize)}function updateFragment(parent,old,vnode,recycling,hooks,nextSibling,ns){updateNodes(parent,old.children,vnode.children,recycling,hooks,nextSibling,ns);var domSize=0,children=vnode.children;if(vnode.dom=null,null!=children){for(var i=0;i<children.length;i++){var child=children[i];null!=child&&null!=child.dom&&(null==vnode.dom&&(vnode.dom=child.dom),domSize+=child.domSize||1)}1!==domSize&&(vnode.domSize=domSize)}}function updateElement(old,vnode,recycling,hooks,ns){var element=vnode.dom=old.dom;ns=getNameSpace(vnode)||ns,"textarea"===vnode.tag&&(null==vnode.attrs&&(vnode.attrs={}),null!=vnode.text&&(vnode.attrs.value=vnode.text,vnode.text=void 0)),updateAttrs(vnode,old.attrs,vnode.attrs,ns),null!=vnode.attrs&&null!=vnode.attrs.contenteditable?setContentEditable(vnode):null!=old.text&&null!=vnode.text&&""!==vnode.text?old.text.toString()!==vnode.text.toString()&&(old.dom.firstChild.nodeValue=vnode.text):(null!=old.text&&(old.children=[Vnode("#",void 0,void 0,old.text,void 0,old.dom.firstChild)]),null!=vnode.text&&(vnode.children=[Vnode("#",void 0,void 0,vnode.text,void 0,void 0)]),updateNodes(element,old.children,vnode.children,recycling,hooks,null,ns))}function updateComponent(parent,old,vnode,hooks,nextSibling,recycling,ns){if(recycling)initComponent(vnode,hooks);else{if(vnode.instance=Vnode.normalize(vnode._state.view.call(vnode.state,vnode)),vnode.instance===vnode)throw Error("A view cannot return the vnode it received as argument");null!=vnode.attrs&&updateLifecycle(vnode.attrs,vnode,hooks),updateLifecycle(vnode._state,vnode,hooks)}null!=vnode.instance?(null==old.instance?createNode(parent,vnode.instance,hooks,ns,nextSibling):updateNode(parent,old.instance,vnode.instance,hooks,nextSibling,recycling,ns),vnode.dom=vnode.instance.dom,vnode.domSize=vnode.instance.domSize):null!=old.instance?(removeNode(old.instance,null),vnode.dom=void 0,vnode.domSize=0):(vnode.dom=old.dom,vnode.domSize=old.domSize)}function isRecyclable(old,vnodes){if(null!=old.pool&&Math.abs(old.pool.length-vnodes.length)<=Math.abs(old.length-vnodes.length)){var oldChildrenLength=old[0]&&old[0].children&&old[0].children.length||0,poolChildrenLength=old.pool[0]&&old.pool[0].children&&old.pool[0].children.length||0,vnodesChildrenLength=vnodes[0]&&vnodes[0].children&&vnodes[0].children.length||0;if(Math.abs(poolChildrenLength-vnodesChildrenLength)<=Math.abs(oldChildrenLength-vnodesChildrenLength))return!0}return!1}function getKeyMap(vnodes,end){for(var map={},i=0,i=0;i<end;i++){var vnode=vnodes[i];if(null!=vnode){var key2=vnode.key;null!=key2&&(map[key2]=i)}}return map}function toFragment(vnode){var count0=vnode.domSize;if(null!=count0||null==vnode.dom){var fragment=$doc.createDocumentFragment();if(count0>0){for(var dom=vnode.dom;--count0;)fragment.appendChild(dom.nextSibling);fragment.insertBefore(dom,fragment.firstChild)}return fragment}return vnode.dom}function getNextSibling(vnodes,i,nextSibling){for(;i<vnodes.length;i++)if(null!=vnodes[i]&&null!=vnodes[i].dom)return vnodes[i].dom;return nextSibling}function insertNode(parent,dom,nextSibling){nextSibling&&nextSibling.parentNode?parent.insertBefore(dom,nextSibling):parent.appendChild(dom)}function setContentEditable(vnode){var children=vnode.children;if(null!=children&&1===children.length&&"<"===children[0].tag){var content=children[0].children;vnode.dom.innerHTML!==content&&(vnode.dom.innerHTML=content)}else if(null!=vnode.text||null!=children&&0!==children.length)throw new Error("Child node of a contenteditable must be trusted")}function removeNodes(vnodes,start,end,context){for(var i=start;i<end;i++){var vnode=vnodes[i];null!=vnode&&(vnode.skip?vnode.skip=!1:removeNode(vnode,context))}}function removeNode(vnode,context){function continuation(){if(++called===expected&&(onremove(vnode),vnode.dom)){var count0=vnode.domSize||1;if(count0>1)for(var dom=vnode.dom;--count0;)removeNodeFromDOM(dom.nextSibling);removeNodeFromDOM(vnode.dom),null==context||null!=vnode.domSize||hasIntegrationMethods(vnode.attrs)||"string"!=typeof vnode.tag||(context.pool?context.pool.push(vnode):context.pool=[vnode])}}var expected=1,called=0;if(vnode.attrs&&"function"==typeof vnode.attrs.onbeforeremove){var result=vnode.attrs.onbeforeremove.call(vnode.state,vnode);null!=result&&"function"==typeof result.then&&(expected++,result.then(continuation,continuation))}if("string"!=typeof vnode.tag&&"function"==typeof vnode._state.onbeforeremove){var result=vnode._state.onbeforeremove.call(vnode.state,vnode);null!=result&&"function"==typeof result.then&&(expected++,result.then(continuation,continuation))}continuation()}function removeNodeFromDOM(node){var parent=node.parentNode;null!=parent&&parent.removeChild(node)}function onremove(vnode){if(vnode.attrs&&"function"==typeof vnode.attrs.onremove&&vnode.attrs.onremove.call(vnode.state,vnode),"string"!=typeof vnode.tag)"function"==typeof vnode._state.onremove&&vnode._state.onremove.call(vnode.state,vnode),null!=vnode.instance&&onremove(vnode.instance);else{var children=vnode.children;if(Array.isArray(children))for(var i=0;i<children.length;i++){var child=children[i];null!=child&&onremove(child)}}}function setAttrs(vnode,attrs2,ns){for(var key2 in attrs2)setAttr(vnode,key2,null,attrs2[key2],ns)}function setAttr(vnode,key2,old,value,ns){var element=vnode.dom;if("key"!==key2&&"is"!==key2&&(old!==value||isFormAttribute(vnode,key2)||"object"==typeof value)&&void 0!==value&&!isLifecycleMethod(key2)){var nsLastIndex=key2.indexOf(":");if(nsLastIndex>-1&&"xlink"===key2.substr(0,nsLastIndex))element.setAttributeNS("http://www.w3.org/1999/xlink",key2.slice(nsLastIndex+1),value);else if("o"===key2[0]&&"n"===key2[1]&&"function"==typeof value)updateEvent(vnode,key2,value);else if("style"===key2)updateStyle(element,old,value);else if(key2 in element&&!isAttribute(key2)&&void 0===ns&&!isCustomElement(vnode)){if("value"===key2){var normalized0=""+value;if(("input"===vnode.tag||"textarea"===vnode.tag)&&vnode.dom.value===normalized0&&vnode.dom===$doc.activeElement)return;if("select"===vnode.tag)if(null===value){if(-1===vnode.dom.selectedIndex&&vnode.dom===$doc.activeElement)return}else if(null!==old&&vnode.dom.value===normalized0&&vnode.dom===$doc.activeElement)return;if("option"===vnode.tag&&null!=old&&vnode.dom.value===normalized0)return}if("input"===vnode.tag&&"type"===key2)return void element.setAttribute(key2,value);element[key2]=value}else"boolean"==typeof value?value?element.setAttribute(key2,""):element.removeAttribute(key2):element.setAttribute("className"===key2?"class":key2,value)}}function setLateAttrs(vnode){var attrs2=vnode.attrs;"select"===vnode.tag&&null!=attrs2&&("value"in attrs2&&setAttr(vnode,"value",null,attrs2.value,void 0),"selectedIndex"in attrs2&&setAttr(vnode,"selectedIndex",null,attrs2.selectedIndex,void 0))}function updateAttrs(vnode,old,attrs2,ns){if(null!=attrs2)for(var key2 in attrs2)setAttr(vnode,key2,old&&old[key2],attrs2[key2],ns);if(null!=old)for(var key2 in old)null!=attrs2&&key2 in attrs2||("className"===key2&&(key2="class"),"o"!==key2[0]||"n"!==key2[1]||isLifecycleMethod(key2)?"key"!==key2&&vnode.dom.removeAttribute(key2):updateEvent(vnode,key2,void 0))}function isFormAttribute(vnode,attr){return"value"===attr||"checked"===attr||"selectedIndex"===attr||"selected"===attr&&vnode.dom===$doc.activeElement}function isLifecycleMethod(attr){return"oninit"===attr||"oncreate"===attr||"onupdate"===attr||"onremove"===attr||"onbeforeremove"===attr||"onbeforeupdate"===attr}function isAttribute(attr){return"href"===attr||"list"===attr||"form"===attr||"width"===attr||"height"===attr}function isCustomElement(vnode){return vnode.attrs.is||vnode.tag.indexOf("-")>-1}function hasIntegrationMethods(source){return null!=source&&(source.oncreate||source.onupdate||source.onbeforeremove||source.onremove)}function updateStyle(element,old,style){if(old===style&&(element.style.cssText="",old=null),null==style)element.style.cssText="";else if("string"==typeof style)element.style.cssText=style;else{"string"==typeof old&&(element.style.cssText="");for(var key2 in style)element.style[key2]=style[key2];if(null!=old&&"string"!=typeof old)for(var key2 in old)key2 in style||(element.style[key2]="")}}function updateEvent(vnode,key2,value){var element=vnode.dom,callback="function"!=typeof onevent?value:function(e){var result=value.call(element,e);return onevent.call(element,e),result};if(key2 in element)element[key2]="function"==typeof value?callback:null;else{var eventName=key2.slice(2);if(void 0===vnode.events&&(vnode.events={}),vnode.events[key2]===callback)return;null!=vnode.events[key2]&&element.removeEventListener(eventName,vnode.events[key2],!1),"function"==typeof value&&(vnode.events[key2]=callback,element.addEventListener(eventName,vnode.events[key2],!1))}}function initLifecycle(source,vnode,hooks){"function"==typeof source.oninit&&source.oninit.call(vnode.state,vnode),"function"==typeof source.oncreate&&hooks.push(source.oncreate.bind(vnode.state,vnode))}function updateLifecycle(source,vnode,hooks){"function"==typeof source.onupdate&&hooks.push(source.onupdate.bind(vnode.state,vnode))}function shouldNotUpdate(vnode,old){var forceVnodeUpdate,forceComponentUpdate;return null!=vnode.attrs&&"function"==typeof vnode.attrs.onbeforeupdate&&(forceVnodeUpdate=vnode.attrs.onbeforeupdate.call(vnode.state,vnode,old)),"string"!=typeof vnode.tag&&"function"==typeof vnode._state.onbeforeupdate&&(forceComponentUpdate=vnode._state.onbeforeupdate.call(vnode.state,vnode,old)),!(void 0===forceVnodeUpdate&&void 0===forceComponentUpdate||forceVnodeUpdate||forceComponentUpdate)&&(vnode.dom=old.dom,vnode.domSize=old.domSize,vnode.instance=old.instance,!0)}function render(dom,vnodes){if(!dom)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var hooks=[],active=$doc.activeElement,namespace=dom.namespaceURI;null==dom.vnodes&&(dom.textContent=""),Array.isArray(vnodes)||(vnodes=[vnodes]),updateNodes(dom,dom.vnodes,Vnode.normalizeChildren(vnodes),!1,hooks,null,"http://www.w3.org/1999/xhtml"===namespace?void 0:namespace),dom.vnodes=vnodes,null!=active&&$doc.activeElement!==active&&active.focus();for(var i=0;i<hooks.length;i++)hooks[i]()}var onevent,$doc=$window.document,$emptyFragment=$doc.createDocumentFragment(),nameSpace={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};return{render:render,setEventCallback:setEventCallback}},redrawService=function($window){function subscribe(key1,callback){unsubscribe(key1),callbacks.push(key1,throttle(callback))}function unsubscribe(key1){var index=callbacks.indexOf(key1);index>-1&&callbacks.splice(index,2)}function redraw(){for(var i=1;i<callbacks.length;i+=2)callbacks[i]()}var renderService=coreRenderer($window);renderService.setEventCallback(function(e){!1===e.redraw?e.redraw=void 0:redraw()});var callbacks=[];return{subscribe:subscribe,unsubscribe:unsubscribe,redraw:redraw,render:renderService.render}}(window);requestService.setCompletionCallback(redrawService.redraw);m.mount=function(redrawService0){return function(root,component){if(null===component)return redrawService0.render(root,[]),void redrawService0.unsubscribe(root);if(null==component.view&&"function"!=typeof component)throw new Error("m.mount(element, component) expects a component, not a vnode");var run0=function(){redrawService0.render(root,Vnode(component))};redrawService0.subscribe(root,run0),redrawService0.redraw()}}(redrawService);var Promise=PromisePolyfill,parseQueryString=function(string){if(""===string||null==string)return{};"?"===string.charAt(0)&&(string=string.slice(1));for(var entries=string.split("&"),data0={},counters={},i=0;i<entries.length;i++){var entry=entries[i].split("="),key5=decodeURIComponent(entry[0]),value=2===entry.length?decodeURIComponent(entry[1]):"";"true"===value?value=!0:"false"===value&&(value=!1);var levels=key5.split(/\]\[?|\[/),cursor=data0;key5.indexOf("[")>-1&&levels.pop();for(var j=0;j<levels.length;j++){var level=levels[j],nextLevel=levels[j+1],isNumber=""==nextLevel||!isNaN(parseInt(nextLevel,10)),isValue=j===levels.length-1;if(""===level){var key5=levels.slice(0,j).join();null==counters[key5]&&(counters[key5]=0),level=counters[key5]++}null==cursor[level]&&(cursor[level]=isValue?value:isNumber?[]:{}),cursor=cursor[level]}}return data0},coreRouter=function($window){function normalize1(fragment0){var data=$window.location[fragment0].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===fragment0&&"/"!==data[0]&&(data="/"+data),data}function debounceAsync(callback0){return function(){null==asyncId&&(asyncId=callAsync0(function(){asyncId=null,callback0()}))}}function parsePath(path,queryData,hashData){var queryIndex=path.indexOf("?"),hashIndex=path.indexOf("#"),pathEnd=queryIndex>-1?queryIndex:hashIndex>-1?hashIndex:path.length;if(queryIndex>-1){var queryEnd=hashIndex>-1?hashIndex:path.length,queryParams=parseQueryString(path.slice(queryIndex+1,queryEnd));for(var key4 in queryParams)queryData[key4]=queryParams[key4]}if(hashIndex>-1){var hashParams=parseQueryString(path.slice(hashIndex+1));for(var key4 in hashParams)hashData[key4]=hashParams[key4]}return path.slice(0,pathEnd)}var asyncId,supportsPushState="function"==typeof $window.history.pushState,callAsync0="function"==typeof setImmediate?setImmediate:setTimeout,router={prefix:"#!"};return router.getPath=function(){switch(router.prefix.charAt(0)){case"#":return normalize1("hash").slice(router.prefix.length);case"?":return normalize1("search").slice(router.prefix.length)+normalize1("hash");default:return normalize1("pathname").slice(router.prefix.length)+normalize1("search")+normalize1("hash")}},router.setPath=function(path,data,options){var queryData={},hashData={};if(path=parsePath(path,queryData,hashData),null!=data){for(var key4 in data)queryData[key4]=data[key4];path=path.replace(/:([^\/]+)/g,function(match2,token){return delete queryData[token],data[token]})}var query=buildQueryString(queryData);query&&(path+="?"+query);var hash=buildQueryString(hashData);if(hash&&(path+="#"+hash),supportsPushState){var state=options?options.state:null,title=options?options.title:null;$window.onpopstate(),options&&options.replace?$window.history.replaceState(state,title,router.prefix+path):$window.history.pushState(state,title,router.prefix+path)}else $window.location.href=router.prefix+path},router.defineRoutes=function(routes,resolve,reject){function resolveRoute(){var path=router.getPath(),params={},pathname=parsePath(path,params,params),state=$window.history.state;if(null!=state)for(var k in state)params[k]=state[k];for(var route0 in routes){var matcher=new RegExp("^"+route0.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(matcher.test(pathname))return void pathname.replace(matcher,function(){for(var keys=route0.match(/:[^\/]+/g)||[],values=[].slice.call(arguments,1,-2),i=0;i<keys.length;i++)params[keys[i].replace(/:|\./g,"")]=decodeURIComponent(values[i]);resolve(routes[route0],params,path,route0)})}reject(path,params)}supportsPushState?$window.onpopstate=debounceAsync(resolveRoute):"#"===router.prefix.charAt(0)&&($window.onhashchange=resolveRoute),resolveRoute()},router};m.route=function($window,redrawService0){var render1,component,attrs3,currentPath,lastUpdate,routeService=coreRouter($window),identity=function(v){return v},route=function(root,defaultRoute,routes){if(null==root)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var run1=function(){null!=render1&&redrawService0.render(root,render1(Vnode(component,attrs3.key,attrs3)))},bail=function(path){if(path===defaultRoute)throw new Error("Could not resolve default route "+defaultRoute);routeService.setPath(defaultRoute,null,{replace:!0})};routeService.defineRoutes(routes,function(payload,params,path){var update=lastUpdate=function(routeResolver,comp){update===lastUpdate&&(component=null==comp||"function"!=typeof comp.view&&"function"!=typeof comp?"div":comp,attrs3=params,currentPath=path,lastUpdate=null,render1=(routeResolver.render||identity).bind(routeResolver),run1())};payload.view||"function"==typeof payload?update({},payload):payload.onmatch?Promise.resolve(payload.onmatch(params,path)).then(function(resolved){update(payload,resolved)},bail):update(payload,"div")},bail),redrawService0.subscribe(root,run1)};return route.set=function(path,data,options){null!=lastUpdate&&(options=options||{},options.replace=!0),lastUpdate=null,routeService.setPath(path,data,options)},route.get=function(){return currentPath},route.prefix=function(prefix0){routeService.prefix=prefix0},route.link=function(vnode1){vnode1.dom.setAttribute("href",routeService.prefix+vnode1.attrs.href),vnode1.dom.onclick=function(e){if(!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault(),e.redraw=!1;var href=this.getAttribute("href");0===href.indexOf(routeService.prefix)&&(href=href.slice(routeService.prefix.length)),route.set(href,void 0,void 0)}}},route.param=function(key3){return void 0!==attrs3&&void 0!==key3?attrs3[key3]:attrs3},route}(window,redrawService),m.withAttr=function(attrName,callback1,context){return function(e){callback1.call(context||this,attrName in e.currentTarget?e.currentTarget[attrName]:e.currentTarget.getAttribute(attrName))}};var _28=coreRenderer(window);m.render=_28.render,m.redraw=redrawService.redraw,m.request=requestService.request,m.jsonp=requestService.jsonp,m.parseQueryString=parseQueryString,m.buildQueryString=buildQueryString,m.version="1.1.6",m.vnode=Vnode,module.exports=m}()}).call(exports,__webpack_require__(61).setImmediate,__webpack_require__(23))},function(module,exports,__webpack_require__){"use strict";var _this=this;Object.defineProperty(exports,"__esModule",{value:!0}),exports.clone=function(obj){var clonedObj;return"object"==typeof obj&&null!==obj?(Array.isArray(obj)?(clonedObj=[],obj.forEach(function(item){return clonedObj.push(exports.clone(item))})):(clonedObj={},Object.keys(obj).forEach(function(key){return clonedObj[key]=exports.clone(obj[key])})),clonedObj):obj},exports.cleanString=function(){for(var classNames=[],_i=0;_i<arguments.length;_i++)classNames[_i]=arguments[_i];return classNames.filter(function(x){return"string"==typeof x}).map(function(x){return x.trim()}).join(" ")},exports.isFn=function(fn){return"function"==typeof fn},exports.isObj=function(obj){return null!==obj&&"object"==typeof obj},exports.isPlainObj=function(obj){return exports.isObj(obj)&&!exports.isArr(obj)&&!exports.isFn(obj)},exports.isArr=function(arr){return Array.isArray(arr)},exports.exec=function(fn){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return exports.isFn(fn)?fn.apply(_this,args):void 0},exports.mapRange=function(value,_a){var from=_a.from,to=_a.to;return from[0]+(value-to[0])*(to[1]-to[0])/(from[1]-from[0])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),util_2=__webpack_require__(0),Path=function(){function Path(pathOrString,pieceNum){if(void 0===pieceNum){this.pieces_=pathOrString.split("/");for(var copyTo=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[copyTo]=this.pieces_[i],copyTo++);this.pieces_.length=copyTo,this.pieceNum_=0}else this.pieces_=pathOrString,this.pieceNum_=pieceNum}return Object.defineProperty(Path,"Empty",{get:function(){return new Path("")},enumerable:!0,configurable:!0}),Path.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},Path.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},Path.prototype.popFront=function(){var pieceNum=this.pieceNum_;return pieceNum<this.pieces_.length&&pieceNum++,new Path(this.pieces_,pieceNum)},Path.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},Path.prototype.toString=function(){for(var pathString="",i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(pathString+="/"+this.pieces_[i]);return pathString||"/"},Path.prototype.toUrlEncodedString=function(){for(var pathString="",i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(pathString+="/"+encodeURIComponent(String(this.pieces_[i])));return pathString||"/"},Path.prototype.slice=function(begin){return void 0===begin&&(begin=0),this.pieces_.slice(this.pieceNum_+begin)},Path.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length-1;i++)pieces.push(this.pieces_[i]);return new Path(pieces,0)},Path.prototype.child=function(childPathObj){for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length;i++)pieces.push(this.pieces_[i]);if(childPathObj instanceof Path)for(var i=childPathObj.pieceNum_;i<childPathObj.pieces_.length;i++)pieces.push(childPathObj.pieces_[i]);else for(var childPieces=childPathObj.split("/"),i=0;i<childPieces.length;i++)childPieces[i].length>0&&pieces.push(childPieces[i]);return new Path(pieces,0)},Path.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},Path.relativePath=function(outerPath,innerPath){var outer=outerPath.getFront(),inner=innerPath.getFront();if(null===outer)return innerPath;if(outer===inner)return Path.relativePath(outerPath.popFront(),innerPath.popFront());throw new Error("INTERNAL ERROR: innerPath ("+innerPath+") is not within outerPath ("+outerPath+")")},Path.comparePaths=function(left,right){for(var leftKeys=left.slice(),rightKeys=right.slice(),i=0;i<leftKeys.length&&i<rightKeys.length;i++){var cmp=util_1.nameCompare(leftKeys[i],rightKeys[i]);if(0!==cmp)return cmp}return leftKeys.length===rightKeys.length?0:leftKeys.length<rightKeys.length?-1:1},Path.prototype.equals=function(other){if(this.getLength()!==other.getLength())return!1;for(var i=this.pieceNum_,j=other.pieceNum_;i<=this.pieces_.length;i++,j++)if(this.pieces_[i]!==other.pieces_[j])return!1;return!0},Path.prototype.contains=function(other){var i=this.pieceNum_,j=other.pieceNum_;if(this.getLength()>other.getLength())return!1;for(;i<this.pieces_.length;){if(this.pieces_[i]!==other.pieces_[j])return!1;++i,++j}return!0},Path}();exports.Path=Path;var ValidationPath=function(){function ValidationPath(path,errorPrefix_){this.errorPrefix_=errorPrefix_,this.parts_=path.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=util_2.stringLength(this.parts_[i]);this.checkValid_()}return Object.defineProperty(ValidationPath,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(ValidationPath,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),ValidationPath.prototype.push=function(child){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(child),this.byteLength_+=util_2.stringLength(child),this.checkValid_()},ValidationPath.prototype.pop=function(){var last=this.parts_.pop();this.byteLength_-=util_2.stringLength(last),this.parts_.length>0&&(this.byteLength_-=1)},ValidationPath.prototype.checkValid_=function(){if(this.byteLength_>ValidationPath.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+ValidationPath.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>ValidationPath.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ValidationPath.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},ValidationPath.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},ValidationPath}();exports.ValidationPath=ValidationPath},function(module,exports){function cssWithMappingToString(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=toComment(cssMapping);return[content].concat(cssMapping.sources.map(function(source){return"/*# sourceURL="+cssMapping.sourceRoot+source+" */"})).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}module.exports=function(useSourceMap){var list=[];return list.toString=function(){return this.map(function(item){var content=cssWithMappingToString(item,useSourceMap);return item[2]?"@media "+item[2]+"{"+content+"}":content}).join("")},list.i=function(modules,mediaQuery){"string"==typeof modules&&(modules=[[null,modules,""]]);for(var alreadyImportedModules={},i=0;i<this.length;i++){var id=this[i][0];"number"==typeof id&&(alreadyImportedModules[id]=!0)}for(i=0;i<modules.length;i++){var item=modules[i];"number"==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]="("+item[2]+") and ("+mediaQuery+")"),list.push(item))}},list}},function(module,exports,__webpack_require__){function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{for(var parts=[],j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],css=item[1],media=item[2],sourceMap=item[3],part={css:css,media:media,sourceMap:sourceMap};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if("top"===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling):target.appendChild(style):target.insertBefore(style,target.firstChild),stylesInsertedAtTop.push(style);else if("bottom"===options.insertAt)target.appendChild(style);else{if("object"!=typeof options.insertAt||!options.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var nextSibling=getElement(options.insertInto+" "+options.insertAt.before);target.insertBefore(style,nextSibling)}}function removeStyleElement(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);idx>=0&&stylesInsertedAtTop.splice(idx,1)}function createStyleElement(options){var style=document.createElement("style");return options.attrs.type="text/css",addAttrs(style,options.attrs),insertStyleElement(options,style),style}function createLinkElement(options){var link=document.createElement("link");return options.attrs.type="text/css",options.attrs.rel="stylesheet",addAttrs(link,options.attrs),insertStyleElement(options,link),link}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css){if(!(result=options.transform(obj.css)))return function(){};obj.css=result}if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else obj.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(style=createLinkElement(options),update=updateLink.bind(null,style,options),remove=function(){removeStyleElement(style),style.href&&URL.revokeObjectURL(style.href)}):(style=createStyleElement(options),update=applyToTag.bind(null,style),remove=function(){removeStyleElement(style)});return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,obj){var css=obj.css,media=obj.media;if(media&&style.setAttribute("media",media),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}function updateLink(link,options,obj){var css=obj.css,sourceMap=obj.sourceMap,autoFixUrls=void 0===options.convertToAbsoluteUrls&&sourceMap;(options.convertToAbsoluteUrls||autoFixUrls)&&(css=fixUrls(css)),sourceMap&&(css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */");var blob=new Blob([css],{type:"text/css"}),oldSrc=link.href;link.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}var stylesInDom={},isOldIE=function(fn){var memo;return function(){return void 0===memo&&(memo=fn.apply(this,arguments)),memo}}(function(){return window&&document&&document.all&&!window.atob}),getElement=function(fn){var memo={};return function(selector){if(void 0===memo[selector]){var styleTarget=fn.call(this,selector);if(styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[selector]=styleTarget}return memo[selector]}}(function(target){return document.querySelector(target)}),singleton=null,singletonCounter=0,stylesInsertedAtTop=[],fixUrls=__webpack_require__(212);module.exports=function(list,options){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");options=options||{},options.attrs="object"==typeof options.attrs?options.attrs:{},options.singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE()),options.insertInto||(options.insertInto="head"),options.insertAt||(options.insertAt="bottom");var styles=listToStyles(list,options);return addStylesToDom(styles,options),function(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];domStyle.refs--,mayRemove.push(domStyle)}if(newList){addStylesToDom(listToStyles(newList,options),options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(0===domStyle.refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};var replaceText=function(){var textStore=[];return function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")}}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var helpers_1=__webpack_require__(13);exports.devent=function(event,options){return void 0===options&&(options={redraw:!1,passive:!1,preventDefault:!0,stopPropagation:!1}),options.redraw||(event.redraw=!1),options.passive||(event.passive=!1),options.preventDefault&&event.preventDefault(),options.stopPropagation&&event.stopPropagation(),event},exports.getContainerElementByClassName=function(dom,className){for(var container=dom.parentElement;null!==container&&-1===container.className.indexOf(className);)container=container.parentElement;return container},exports.getRectStyle=function(rect){return helpers_1.rectKeys.reduce(function(obj,key){return void 0===rect[key]?obj:(obj[key]=rect[key]+"px",obj)},{})},exports.getInnerRect=function(dom){var integerProp=function(prop){return parseInt(getComputedStyle(dom)[prop]||"0",10)};return{height:integerProp("height"),left:integerProp("paddingLeft")+integerProp("marginLeft"),top:integerProp("paddingTop")+integerProp("marginTop"),width:integerProp("width")}},exports.getOuterRect=function(dom){var rect=dom.getBoundingClientRect();return{height:rect.height,left:rect.left,top:rect.top,width:rect.width}},exports.isInViewport=function(rect){var html=document.documentElement;return rect.top>=0&&rect.left>=0&&rect.top+rect.height<=(window.innerHeight||html.clientHeight)&&rect.left+rect.width<=(window.innerWidth||html.clientWidth)},exports.getComputedStyleNumber=function(dom,property){var style=getComputedStyle(dom)[property];return style?parseFloat(style):0},exports.getTransitionDuration=function(dom){return 1e3*(exports.getComputedStyleNumber(dom,"transitionDelay")+exports.getComputedStyleNumber(dom,"transitionDuration"))},exports.setStyle=function(dom,style){return Object.keys(style).forEach(function(k){return dom.style[k]=String(style[k])})},exports.getScaleFromFirstContainer=function(dom,containerClassName,original){if(!dom)return 1;for(var container=dom.parentElement,item=dom;null!==container&&-1===container.className.indexOf(containerClassName);)item=container,container=container.parentElement;if(!container)return 1;var containerRect=container.getBoundingClientRect();return containerRect.width>containerRect.height?item.offsetHeight/original.height:item.offsetWidth/original.width},exports.getClientXY=function(event){return event.clientX?{x:event.clientX,y:event.clientY}:event.touches&&event.touches[0]?{x:event.touches[0].clientX,y:event.touches[0].clientY}:event.changedTouches&&event.changedTouches[0]?{x:event.changedTouches[0].clientX,y:event.changedTouches[0].clientY}:{x:0,y:0}},exports.getOffsetXY=function(event){var rect=event.target.getBoundingClientRect(),_a=exports.getClientXY(event),x=_a.x,y=_a.y;return x-=rect.left,y-=rect.top,{x:x,y:y}},exports.preventDrag=function(element){return element.ondragstart=function(e){return e.preventDefault(),e.stopPropagation(),!1}}},function(module,exports,__webpack_require__){"use strict";function setNodeFromJSON(val){nodeFromJSON=val}function setMaxNode(val){MAX_NODE=val}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var nodeFromJSON,MAX_NODE,Index_1=__webpack_require__(36),util_1=__webpack_require__(1),Node_1=__webpack_require__(11),LeafNode_1=__webpack_require__(37);exports.setNodeFromJSON=setNodeFromJSON,exports.setMaxNode=setMaxNode;var PriorityIndex=function(_super){function PriorityIndex(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PriorityIndex,_super),PriorityIndex.prototype.compare=function(a,b){var aPriority=a.node.getPriority(),bPriority=b.node.getPriority(),indexCmp=aPriority.compareTo(bPriority);return 0===indexCmp?util_1.nameCompare(a.name,b.name):indexCmp},PriorityIndex.prototype.isDefinedOn=function(node){return!node.getPriority().isEmpty()},PriorityIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.getPriority().equals(newNode.getPriority())},PriorityIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN},PriorityIndex.prototype.maxPost=function(){return new Node_1.NamedNode(util_1.MAX_NAME,new LeafNode_1.LeafNode("[PRIORITY-POST]",MAX_NODE))},PriorityIndex.prototype.makePost=function(indexValue,name){var priorityNode=nodeFromJSON(indexValue);return new Node_1.NamedNode(name,new LeafNode_1.LeafNode("[PRIORITY-POST]",priorityNode))},PriorityIndex.prototype.toString=function(){return".priority"},PriorityIndex}(Index_1.Index);exports.PriorityIndex=PriorityIndex,exports.PRIORITY_INDEX=new PriorityIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var EventAggregator=function(){function EventAggregator(){this.subs={},this._id=0}return EventAggregator.getInstance=function(type){return void 0===type&&(type="main"),void 0===EventAggregator.instances[type]&&(EventAggregator.instances[type]=new EventAggregator),EventAggregator.instances[type]},EventAggregator.prototype.on=function(event,fn,once){var _this=this;if(void 0===once&&(once=!1),Array.isArray(event)){var subs_1=event.map(function(e){return _this.on(e,fn,once)});return{off:function(){return subs_1.forEach(function(sub){return sub.off()})}}}return this.addSub(event,fn,once)},EventAggregator.prototype.once=function(event,fn){return this.on(event,fn,!0)},EventAggregator.prototype.emit=function(event,data){var _this=this;return Array.isArray(event)?event.forEach(function(e){return _this.emit(e,data)}):(this.emitSubs(event,data,event),this.emitSubs("*",data,event)),this},EventAggregator.prototype.off=function(event,id){return this.subs[event].splice(this.subs[event].findIndex(function(sub){return sub._id===id}),1),this},EventAggregator.prototype.addSub=function(event,fn,once){var _this=this;void 0===once&&(once=!1),void 0===this.subs[event]&&(this.subs[event]=[]);var id=this.getNextId();return this.subs[event].push({_id:id,_fn:fn,once:once}),{off:function(){return _this.off(event,id)}}},EventAggregator.prototype.emitSubs=function(event,data,originalEvent){if(void 0!==this.subs[event])for(var i=0;i<this.subs[event].length;i++){var sub=this.subs[event][i];"function"==typeof sub._fn?(sub._fn(data,originalEvent),!0===sub.once&&(this.off(event,sub._id),i--)):(this.off(event,sub._id),i--)}},EventAggregator.prototype.getNextId=function(){return this._id++},EventAggregator.instances={},EventAggregator}(),debounce=function(fn,threshhold,scope){void 0===threshhold&&(threshhold=100),void 0===scope&&(scope=null);var deferTimer;return function(){var args=arguments;clearTimeout(deferTimer),deferTimer=setTimeout(function(){fn.apply(scope,args)},threshhold)}};exports.debounce=debounce;var throttle=function(fn,threshhold,scope){void 0===threshhold&&(threshhold=100),void 0===scope&&(scope=null);var last,deferTimer;return function(){var now=Date.now(),args=arguments;last&&now<last+threshhold?(clearTimeout(deferTimer),deferTimer=setTimeout(function(){last=now,fn.apply(scope,args)},threshhold)):(last=now,fn.apply(scope,args))}};exports.throttle=throttle,exports.default=EventAggregator},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var EMPTY_NODE,util_1=__webpack_require__(0),util_2=__webpack_require__(1),SortedMap_1=__webpack_require__(38),Node_1=__webpack_require__(11),snap_1=__webpack_require__(71),PriorityIndex_1=__webpack_require__(8),KeyIndex_1=__webpack_require__(28),IndexMap_1=__webpack_require__(73),LeafNode_1=__webpack_require__(37),comparators_1=__webpack_require__(75),ChildrenNode=function(){function ChildrenNode(children_,priorityNode_,indexMap_){this.children_=children_,this.priorityNode_=priorityNode_,this.indexMap_=indexMap_,this.lazyHash_=null,this.priorityNode_&&snap_1.validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&util_1.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(ChildrenNode,"EMPTY_NODE",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR),null,IndexMap_1.IndexMap.Default))},enumerable:!0,configurable:!0}),ChildrenNode.prototype.isLeafNode=function(){return!1},ChildrenNode.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},ChildrenNode.prototype.updatePriority=function(newPriorityNode){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,newPriorityNode,this.indexMap_)},ChildrenNode.prototype.getImmediateChild=function(childName){if(".priority"===childName)return this.getPriority();var child=this.children_.get(childName);return null===child?EMPTY_NODE:child},ChildrenNode.prototype.getChild=function(path){var front=path.getFront();return null===front?this:this.getImmediateChild(front).getChild(path.popFront())},ChildrenNode.prototype.hasChild=function(childName){return null!==this.children_.get(childName)},ChildrenNode.prototype.updateImmediateChild=function(childName,newChildNode){if(util_1.assert(newChildNode,"We should always be passing snapshot nodes"),".priority"===childName)return this.updatePriority(newChildNode);var namedNode=new Node_1.NamedNode(childName,newChildNode),newChildren=void 0,newIndexMap=void 0,newPriority=void 0;return newChildNode.isEmpty()?(newChildren=this.children_.remove(childName),newIndexMap=this.indexMap_.removeFromIndexes(namedNode,this.children_)):(newChildren=this.children_.insert(childName,newChildNode),newIndexMap=this.indexMap_.addToIndexes(namedNode,this.children_)),newPriority=newChildren.isEmpty()?EMPTY_NODE:this.priorityNode_,new ChildrenNode(newChildren,newPriority,newIndexMap)},ChildrenNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();if(null===front)return newChildNode;util_1.assert(".priority"!==path.getFront()||1===path.getLength(),".priority must be the last token in a path");var newImmediateChild=this.getImmediateChild(front).updateChild(path.popFront(),newChildNode);return this.updateImmediateChild(front,newImmediateChild)},ChildrenNode.prototype.isEmpty=function(){return this.children_.isEmpty()},ChildrenNode.prototype.numChildren=function(){return this.children_.count()},ChildrenNode.prototype.val=function(exportFormat){if(this.isEmpty())return null;var obj={},numKeys=0,maxKey=0,allIntegerKeys=!0;if(this.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){obj[key]=childNode.val(exportFormat),numKeys++,allIntegerKeys&&ChildrenNode.INTEGER_REGEXP_.test(key)?maxKey=Math.max(maxKey,Number(key)):allIntegerKeys=!1}),!exportFormat&&allIntegerKeys&&maxKey<2*numKeys){var array=[];for(var key in obj)array[key]=obj[key];return array}return exportFormat&&!this.getPriority().isEmpty()&&(obj[".priority"]=this.getPriority().val()),obj},ChildrenNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash_1="";this.getPriority().isEmpty()||(toHash_1+="priority:"+snap_1.priorityHashText(this.getPriority().val())+":"),this.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){var childHash=childNode.hash();""!==childHash&&(toHash_1+=":"+key+":"+childHash)}),this.lazyHash_=""===toHash_1?"":util_2.sha1(toHash_1)}return this.lazyHash_},ChildrenNode.prototype.getPredecessorChildName=function(childName,childNode,index){var idx=this.resolveIndex_(index);if(idx){var predecessor=idx.getPredecessorKey(new Node_1.NamedNode(childName,childNode));return predecessor?predecessor.name:null}return this.children_.getPredecessorKey(childName)},ChildrenNode.prototype.getFirstChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var minKey=idx.minKey();return minKey&&minKey.name}return this.children_.minKey()},ChildrenNode.prototype.getFirstChild=function(indexDefinition){var minKey=this.getFirstChildName(indexDefinition);return minKey?new Node_1.NamedNode(minKey,this.children_.get(minKey)):null},ChildrenNode.prototype.getLastChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var maxKey=idx.maxKey();return maxKey&&maxKey.name}return this.children_.maxKey()},ChildrenNode.prototype.getLastChild=function(indexDefinition){var maxKey=this.getLastChildName(indexDefinition);return maxKey?new Node_1.NamedNode(maxKey,this.children_.get(maxKey)):null},ChildrenNode.prototype.forEachChild=function(index,action){var idx=this.resolveIndex_(index);return idx?idx.inorderTraversal(function(wrappedNode){return action(wrappedNode.name,wrappedNode.node)}):this.children_.inorderTraversal(action)},ChildrenNode.prototype.getIterator=function(indexDefinition){return this.getIteratorFrom(indexDefinition.minPost(),indexDefinition)},ChildrenNode.prototype.getIteratorFrom=function(startPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getIteratorFrom(startPost,function(key){return key});for(var iterator=this.children_.getIteratorFrom(startPost.name,Node_1.NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,startPost)<0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.getReverseIterator=function(indexDefinition){return this.getReverseIteratorFrom(indexDefinition.maxPost(),indexDefinition)},ChildrenNode.prototype.getReverseIteratorFrom=function(endPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getReverseIteratorFrom(endPost,function(key){return key});for(var iterator=this.children_.getReverseIteratorFrom(endPost.name,Node_1.NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,endPost)>0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.compareTo=function(other){return this.isEmpty()?other.isEmpty()?0:-1:other.isLeafNode()||other.isEmpty()?1:other===exports.MAX_NODE?-1:0},ChildrenNode.prototype.withIndex=function(indexDefinition){if(indexDefinition===KeyIndex_1.KEY_INDEX||this.indexMap_.hasIndex(indexDefinition))return this;var newIndexMap=this.indexMap_.addIndex(indexDefinition,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,newIndexMap)},ChildrenNode.prototype.isIndexed=function(index){return index===KeyIndex_1.KEY_INDEX||this.indexMap_.hasIndex(index)},ChildrenNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode())return!1;var otherChildrenNode=other;if(this.getPriority().equals(otherChildrenNode.getPriority())){if(this.children_.count()===otherChildrenNode.children_.count()){for(var thisIter=this.getIterator(PriorityIndex_1.PRIORITY_INDEX),otherIter=otherChildrenNode.getIterator(PriorityIndex_1.PRIORITY_INDEX),thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext();thisCurrent&&otherCurrent;){if(thisCurrent.name!==otherCurrent.name||!thisCurrent.node.equals(otherCurrent.node))return!1;thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext()}return null===thisCurrent&&null===otherCurrent}return!1}return!1},ChildrenNode.prototype.resolveIndex_=function(indexDefinition){return indexDefinition===KeyIndex_1.KEY_INDEX?null:this.indexMap_.get(indexDefinition.toString())},ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,ChildrenNode}();exports.ChildrenNode=ChildrenNode;var MaxNode=function(_super){function MaxNode(){return _super.call(this,new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap_1.IndexMap.Default)||this}return __extends(MaxNode,_super),MaxNode.prototype.compareTo=function(other){return other===this?0:1},MaxNode.prototype.equals=function(other){return other===this},MaxNode.prototype.getPriority=function(){return this},MaxNode.prototype.getImmediateChild=function(childName){return ChildrenNode.EMPTY_NODE},MaxNode.prototype.isEmpty=function(){return!1},MaxNode}(ChildrenNode);exports.MaxNode=MaxNode,exports.MAX_NODE=new MaxNode,Object.defineProperties(Node_1.NamedNode,{MIN:{value:new Node_1.NamedNode(util_2.MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new Node_1.NamedNode(util_2.MAX_NAME,exports.MAX_NODE)}}),KeyIndex_1.KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode_1.LeafNode.__childrenNodeConstructor=ChildrenNode,snap_1.setMaxNode(exports.MAX_NODE),PriorityIndex_1.setMaxNode(exports.MAX_NODE)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var NamedNode=function(){function NamedNode(name,node){this.name=name,this.node=node}return NamedNode.Wrap=function(name,node){return new NamedNode(name,node)},NamedNode}();exports.NamedNode=NamedNode},function(module,__webpack_exports__,__webpack_require__){"use strict";function isDef(p){return null!=p}function isJustDef(p){return void 0!==p}function isFunction(p){return"function"==typeof p}function isObject(p){return"object"==typeof p}function isNonNullObject(p){return isObject(p)&&null!==p}function isNonArrayObject(p){return isObject(p)&&!Array.isArray(p)}function isString(p){return"string"==typeof p||p instanceof String}function isNumber(p){return"number"==typeof p||p instanceof Number}function isNativeBlob(p){return isNativeBlobDefined()&&p instanceof Blob}function isNativeBlobDefined(){return"undefined"!=typeof Blob}__webpack_exports__.a=isDef,__webpack_exports__.c=isJustDef,__webpack_exports__.b=isFunction,__webpack_exports__.i=isObject,__webpack_exports__.g=isNonNullObject,__webpack_exports__.f=isNonArrayObject,__webpack_exports__.j=isString,__webpack_exports__.h=isNumber,__webpack_exports__.d=isNativeBlob,__webpack_exports__.e=isNativeBlobDefined},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},_this=this;Object.defineProperty(exports,"__esModule",{value:!0}),exports.rectKeys=["left","top","width","height"],exports.rectConstrainKeys=["minWidth","minHeight","maxWidth","maxHeight"],exports.getScale=function(original,target,maximize){var maxWidthScale=target.width/original.width,maxHeightScale=target.height/original.height;return maximize?maxHeightScale<maxWidthScale?maxWidthScale:maxHeightScale:maxHeightScale>maxWidthScale?maxWidthScale:maxHeightScale},exports.setScale=function(obj,scale){return Object.keys(obj).reduce(function(scaled,key){return scaled[key]=obj[key]*scale,scaled},{})},exports.round=function(obj){return Object.keys(obj).reduce(function(rounded,key){return rounded[key]=Math.round(obj[key]),rounded},{})},exports.rectIsEqual=function(prev,curr){return prev.top===curr.top&&prev.left===curr.left&&prev.width===curr.width&&prev.height===curr.height},exports.getRect=function(obj){var rect={};return void 0!==obj.left&&(rect.left=obj.left),void 0!==obj.top&&(rect.top=obj.top),void 0!==obj.width&&(rect.width=obj.width),void 0!==obj.height&&(rect.height=obj.height),rect},exports.getConstrainedRect=function(rect,constrain){return constrain.minTop&&rect.top<constrain.minTop&&(rect.top=constrain.minTop),constrain.minLeft&&rect.left<constrain.minLeft&&(rect.left=constrain.minLeft),constrain.minWidth&&rect.width<constrain.minWidth&&(rect.width=constrain.minWidth),constrain.minHeight&&rect.height<constrain.minHeight&&(rect.height=constrain.minHeight),constrain.maxTop&&rect.top>constrain.maxTop&&(rect.top=constrain.maxTop),constrain.maxLeft&&rect.left>constrain.maxLeft&&(rect.left=constrain.maxLeft),constrain.maxWidth&&rect.width>constrain.maxWidth&&(rect.width=constrain.maxWidth),constrain.maxHeight&&rect.height>constrain.maxHeight&&(rect.height=constrain.maxHeight),rect.width<=0&&(rect.width=constrain.minWidth||20),rect.height<=0&&(rect.height=constrain.minHeight||20),rect},exports.pause=function(ms){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new Promise(function(resolve){return setTimeout(resolve,ms)})]})})},exports.generateStroke=function(width,color){for(var str="",i=-width;i<width;i++)str+=width+"px "+i+"px 0 "+color+","+-width+"px "+i+"px 0 "+color+","+i+"px "+width+"px 0 "+color+","+i+"px "+-width+"px 0 "+color+",";return str.slice(0,-1)},exports.pipe=function(data,mutators){return __awaiter(_this,void 0,void 0,function(){var _i,mutators_1,m;return __generator(this,function(_a){switch(_a.label){case 0:_i=0,mutators_1=mutators,_a.label=1;case 1:return _i<mutators_1.length?(m=mutators_1[_i],[4,m(data)]):[3,4];case 2:data=_a.sent(),_a.label=3;case 3:return _i++,[3,1];case 4:return[2,data]}})})},exports.pipeline=function(mutators){return function(data){return exports.pipe(data,mutators)}},exports.parseQuery=function(url){void 0===url&&(url=window.location.search.substring(1));var vars=url.split("&"),obj={};return vars.forEach(function(v){var pair=v.split("=");obj[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}),obj}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Dependency=function(){function Dependency(data,type){this.data=void 0,this.subs=[],this.subId=0,this.data=data,this.type=type}return Dependency.prototype.set=function(data,caller){if(!caller||caller!==this.type)throw new Error("Cannot manually call the set method");var prevData=this.data;this.data=data,this.subs.forEach(function(sub){return sub.method(data,prevData)})},Dependency.prototype.get=function(){return this.data},Dependency.prototype.getType=function(){return this.type},Dependency.prototype.onchange=function(method){var _this=this,id=this.subId++;return this.subs.push({method:method,id:id}),{off:function(){return _this.subs=_this.subs.filter(function(sub){return sub.id!==id})},id:id}},Dependency}();exports.Dependency=Dependency;var DependencyInjector=function(){function DependencyInjector(type){this.deps={},this.type=type}return DependencyInjector.getInstance=function(type){return void 0===type&&(type="main"),void 0===DependencyInjector.instances[type]&&(DependencyInjector.instances[type]=new DependencyInjector(type)),DependencyInjector.instances[type]},DependencyInjector.prototype.register=function(key,dep){var _this=this;return"string"==typeof key?void 0===this.deps[key]?this.deps[key]=new Dependency(dep,this.type):this.deps[key].set(dep,this.type):Object.keys(key).forEach(function(k){return _this.register(k,key[k])}),this},DependencyInjector.prototype.requestRaw=function(deps){var _this=this;return deps.map(function(key){return _this.initDep(key),_this.deps[key]})},DependencyInjector.prototype.resolveRawFrom=function(deps,method,scope){return void 0===scope&&(scope=null),this.resolveFrom(deps,method,scope,!0)},DependencyInjector.prototype.resolveRaw=function(method,scope){return void 0===scope&&(scope=null),this.resolve(method,scope,!0)},DependencyInjector.prototype.invokeRawFrom=function(deps,method,scope){return void 0===scope&&(scope=null),this.invokeFrom(deps,method,scope,!0)},DependencyInjector.prototype.request=function(deps){return this.requestRaw(deps).map(function(dep){return dep?dep.get():void 0})},DependencyInjector.prototype.invokeRaw=function(method,scope){return void 0===scope&&(scope=null),this.invoke(method,scope,!0)},DependencyInjector.prototype.resolveFrom=function(deps,method,scope,raw){var _this=this;return void 0===scope&&(scope=null),void 0===raw&&(raw=!1),function(){for(var otherArgs=[],_i=0;_i<arguments.length;_i++)otherArgs[_i]=arguments[_i];var args=_this[raw?"requestRaw":"request"](deps);return method.apply(scope,args.concat(otherArgs))}},DependencyInjector.prototype.resolve=function(method,scope,raw){void 0===scope&&(scope=null),void 0===raw&&(raw=!1);var deps=[],match=method.toString().match(/^function\s*[^\(]*\(\s*([^\)]*)\)/m);return match&&match[1]&&(deps=match[1].replace(/ /g,"").split(",")),this.resolveFrom(deps,method,scope,raw)},DependencyInjector.prototype.invokeFrom=function(deps,method,scope,raw){return void 0===scope&&(scope=null),void 0===raw&&(raw=!1),this.resolveFrom(deps,method,scope,raw)()},DependencyInjector.prototype.invoke=function(method,scope,raw){return void 0===scope&&(scope=null),void 0===raw&&(raw=!1),this.resolve(method,scope,raw)()},DependencyInjector.prototype.initDep=function(key){void 0===this.deps[key]&&(this.deps[key]=new Dependency(void 0,this.type))},DependencyInjector.instances={},DependencyInjector}();exports.default=DependencyInjector},function(module,__webpack_exports__,__webpack_require__){"use strict";function prependCode(code){return"storage/"+code}function unknown(){return new FirebaseStorageError(Code.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function objectNotFound(path){return new FirebaseStorageError(Code.OBJECT_NOT_FOUND,"Object '"+path+"' does not exist.")}function quotaExceeded(bucket){return new FirebaseStorageError(Code.QUOTA_EXCEEDED,"Quota for bucket '"+bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){return new FirebaseStorageError(Code.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function unauthorized(path){return new FirebaseStorageError(Code.UNAUTHORIZED,"User does not have permission to access '"+path+"'.")}function retryLimitExceeded(){return new FirebaseStorageError(Code.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new FirebaseStorageError(Code.CANCELED,"User canceled the upload/download.")}function invalidUrl(url){return new FirebaseStorageError(Code.INVALID_URL,"Invalid URL '"+url+"'.")}function invalidDefaultBucket(bucket){return new FirebaseStorageError(Code.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+bucket+"'.")}function cannotSliceBlob(){return new FirebaseStorageError(Code.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new FirebaseStorageError(Code.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new FirebaseStorageError(Code.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function invalidArgument(index,fnName,message){return new FirebaseStorageError(Code.INVALID_ARGUMENT,"Invalid argument in `"+fnName+"` at index "+index+": "+message)}function invalidArgumentCount(argMin,argMax,fnName,real){var countPart,plural;return argMin===argMax?(countPart=argMin,plural=1===argMin?"argument":"arguments"):(countPart="between "+argMin+" and "+argMax,plural="arguments"),new FirebaseStorageError(Code.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+fnName+"`: Expected "+countPart+" "+plural+", received "+real+".")}function appDeleted(){return new FirebaseStorageError(Code.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(name){return new FirebaseStorageError(Code.INVALID_ROOT_OPERATION,"The operation '"+name+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(format,message){return new FirebaseStorageError(Code.INVALID_FORMAT,"String does not match format '"+format+"': "+message)}function internalError(message){throw new FirebaseStorageError(Code.INTERNAL_ERROR,"Internal error: "+message)}__webpack_require__.d(__webpack_exports__,"a",function(){return Code}),__webpack_exports__.s=unknown,__webpack_exports__.m=objectNotFound,__webpack_exports__.n=quotaExceeded,__webpack_exports__.q=unauthenticated,__webpack_exports__.r=unauthorized,__webpack_exports__.o=retryLimitExceeded,__webpack_exports__.c=canceled,__webpack_exports__.k=invalidUrl,__webpack_exports__.h=invalidDefaultBucket,__webpack_exports__.d=cannotSliceBlob,__webpack_exports__.p=serverFileWrongSize,__webpack_exports__.l=noDownloadURL,__webpack_exports__.f=invalidArgument,__webpack_exports__.g=invalidArgumentCount,__webpack_exports__.b=appDeleted,__webpack_exports__.j=invalidRootOperation,__webpack_exports__.i=invalidFormat,__webpack_exports__.e=internalError;var FirebaseStorageError=(__webpack_require__(42),function(){function FirebaseStorageError(code,message){this.code_=prependCode(code),this.message_="Firebase Storage: "+message,this.serverResponse_=null,this.name_="FirebaseError"}return FirebaseStorageError.prototype.codeProp=function(){return this.code},FirebaseStorageError.prototype.codeEquals=function(code){return prependCode(code)===this.codeProp()},FirebaseStorageError.prototype.serverResponseProp=function(){return this.serverResponse_},FirebaseStorageError.prototype.setServerResponseProp=function(serverResponse){this.serverResponse_=serverResponse},Object.defineProperty(FirebaseStorageError.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseStorageError.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseStorageError.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseStorageError.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),FirebaseStorageError}()),Code={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(error){!0===window.debug&&console.error(error.message,error.stack)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IMAGE="image",exports.TEXT="text",exports.SHAPE="shape"},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_require__.d(__webpack_exports__,"firebase",function(){return firebase});var __WEBPACK_IMPORTED_MODULE_0__src_firebaseApp__=__webpack_require__(126),firebase=Object(__WEBPACK_IMPORTED_MODULE_0__src_firebaseApp__.a)();__webpack_exports__.default=firebase},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Path_1=__webpack_require__(4),util_1=__webpack_require__(0),util_2=__webpack_require__(1),util_3=__webpack_require__(0),util_4=__webpack_require__(0);exports.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,exports.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,exports.MAX_LEAF_SIZE_=10485760,exports.isValidKey=function(key){return"string"==typeof key&&0!==key.length&&!exports.INVALID_KEY_REGEX_.test(key)},exports.isValidPathString=function(pathString){return"string"==typeof pathString&&0!==pathString.length&&!exports.INVALID_PATH_REGEX_.test(pathString)},exports.isValidRootPathString=function(pathString){return pathString&&(pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")),exports.isValidPathString(pathString)},exports.isValidPriority=function(priority){return null===priority||"string"==typeof priority||"number"==typeof priority&&!util_2.isInvalidJSONNumber(priority)||priority&&"object"==typeof priority&&util_1.contains(priority,".sv")},exports.validateFirebaseDataArg=function(fnName,argumentNumber,data,path,optional){optional&&void 0===data||exports.validateFirebaseData(util_3.errorPrefix(fnName,argumentNumber,optional),data,path)},exports.validateFirebaseData=function(errorPrefix,data,path_){var path=path_ instanceof Path_1.Path?new Path_1.ValidationPath(path_,errorPrefix):path_;if(void 0===data)throw new Error(errorPrefix+"contains undefined "+path.toErrorString());if("function"==typeof data)throw new Error(errorPrefix+"contains a function "+path.toErrorString()+" with contents = "+data.toString());if(util_2.isInvalidJSONNumber(data))throw new Error(errorPrefix+"contains "+data.toString()+" "+path.toErrorString());if("string"==typeof data&&data.length>exports.MAX_LEAF_SIZE_/3&&util_4.stringLength(data)>exports.MAX_LEAF_SIZE_)throw new Error(errorPrefix+"contains a string greater than "+exports.MAX_LEAF_SIZE_+" utf8 bytes "+path.toErrorString()+" ('"+data.substring(0,50)+"...')");if(data&&"object"==typeof data){var hasDotValue_1=!1,hasActualChild_1=!1;if(util_1.forEach(data,function(key,value){if(".value"===key)hasDotValue_1=!0;else if(".priority"!==key&&".sv"!==key&&(hasActualChild_1=!0,!exports.isValidKey(key)))throw new Error(errorPrefix+" contains an invalid key ("+key+") "+path.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');path.push(key),exports.validateFirebaseData(errorPrefix,value,path),path.pop()}),hasDotValue_1&&hasActualChild_1)throw new Error(errorPrefix+' contains ".value" child '+path.toErrorString()+" in addition to actual children.")}},exports.validateFirebaseMergePaths=function(errorPrefix,mergePaths){var i,curPath;for(i=0;i<mergePaths.length;i++){curPath=mergePaths[i];for(var keys=curPath.slice(),j=0;j<keys.length;j++)if(".priority"===keys[j]&&j===keys.length-1);else if(!exports.isValidKey(keys[j]))throw new Error(errorPrefix+"contains an invalid key ("+keys[j]+") in path "+curPath.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}mergePaths.sort(Path_1.Path.comparePaths);var prevPath=null;for(i=0;i<mergePaths.length;i++){if(curPath=mergePaths[i],null!==prevPath&&prevPath.contains(curPath))throw new Error(errorPrefix+"contains a path "+prevPath.toString()+" that is ancestor of another path "+curPath.toString());prevPath=curPath}},exports.validateFirebaseMergeDataArg=function(fnName,argumentNumber,data,path,optional){if(!optional||void 0!==data){var errorPrefix=util_3.errorPrefix(fnName,argumentNumber,optional);if(!data||"object"!=typeof data||Array.isArray(data))throw new Error(errorPrefix+" must be an object containing the children to replace.");var mergePaths=[];util_1.forEach(data,function(key,value){var curPath=new Path_1.Path(key);if(exports.validateFirebaseData(errorPrefix,value,path.child(curPath)),".priority"===curPath.getBack()&&!exports.isValidPriority(value))throw new Error(errorPrefix+"contains an invalid value for '"+curPath.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");mergePaths.push(curPath)}),exports.validateFirebaseMergePaths(errorPrefix,mergePaths)}},exports.validatePriority=function(fnName,argumentNumber,priority,optional){if(!optional||void 0!==priority){if(util_2.isInvalidJSONNumber(priority))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"is "+priority.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!exports.isValidPriority(priority))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},exports.validateEventType=function(fnName,argumentNumber,eventType,optional){if(!optional||void 0!==eventType)switch(eventType){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},exports.validateKey=function(fnName,argumentNumber,key,optional){if(!(optional&&void 0===key||exports.isValidKey(key)))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'was an invalid key = "'+key+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},exports.validatePathString=function(fnName,argumentNumber,pathString,optional){if(!(optional&&void 0===pathString||exports.isValidPathString(pathString)))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'was an invalid path = "'+pathString+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},exports.validateRootPathString=function(fnName,argumentNumber,pathString,optional){pathString&&(pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")),exports.validatePathString(fnName,argumentNumber,pathString,optional)},exports.validateWritablePath=function(fnName,path){if(".info"===path.getFront())throw new Error(fnName+" failed = Can't modify data under /.info/")},exports.validateUrl=function(fnName,argumentNumber,parsedUrl){var pathString=parsedUrl.path.toString();if("string"!=typeof parsedUrl.repoInfo.host||0===parsedUrl.repoInfo.host.length||!exports.isValidKey(parsedUrl.repoInfo.namespace)||0!==pathString.length&&!exports.isValidRootPathString(pathString))throw new Error(util_3.errorPrefix(fnName,argumentNumber,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},exports.validateCredential=function(fnName,argumentNumber,cred,optional){if((!optional||void 0!==cred)&&"string"!=typeof cred)throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid credential (a string).")},exports.validateBoolean=function(fnName,argumentNumber,bool,optional){if((!optional||void 0!==bool)&&"boolean"!=typeof bool)throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a boolean.")},exports.validateString=function(fnName,argumentNumber,string,optional){if((!optional||void 0!==string)&&"string"!=typeof string)throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid string.")},exports.validateObject=function(fnName,argumentNumber,obj,optional){if(!(optional&&void 0===obj||obj&&"object"==typeof obj&&null!==obj))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid object.")},exports.validateObjectContainsKey=function(fnName,argumentNumber,obj,key,optional,opt_type){if(!obj||"object"!=typeof obj||!util_1.contains(obj,key)){if(optional)return;throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must contain the key "'+key+'"')}if(opt_type){var val=util_1.safeGet(obj,key);if("number"===opt_type&&"number"!=typeof val||"string"===opt_type&&"string"!=typeof val||"boolean"===opt_type&&"boolean"!=typeof val||"function"===opt_type&&"function"!=typeof val||"object"===opt_type&&"object"!=typeof val&&val)throw optional?new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'contains invalid value for key "'+key+'" (must be of type "'+opt_type+'")'):new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must contain the key "'+key+'" with type "'+opt_type+'"')}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0);!function(OperationType){OperationType[OperationType.OVERWRITE=0]="OVERWRITE",OperationType[OperationType.MERGE=1]="MERGE",OperationType[OperationType.ACK_USER_WRITE=2]="ACK_USER_WRITE",OperationType[OperationType.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(exports.OperationType||(exports.OperationType={}));var OperationSource=function(){function OperationSource(fromUser,fromServer,queryId,tagged){this.fromUser=fromUser,this.fromServer=fromServer,this.queryId=queryId,this.tagged=tagged,util_1.assert(!tagged||fromServer,"Tagged queries must be from server.")}return OperationSource.User=new OperationSource(!0,!1,null,!1),OperationSource.Server=new OperationSource(!1,!0,null,!1),OperationSource.forServerTaggedQuery=function(queryId){return new OperationSource(!1,!0,queryId,!0)},OperationSource}();exports.OperationSource=OperationSource},function(module,__webpack_exports__,__webpack_require__){"use strict";function make(resolver){return new Promise(resolver)}function resolve(value){return Promise.resolve(value)}function reject(error){return Promise.reject(error)}__webpack_exports__.a=make,__webpack_exports__.c=resolve,__webpack_exports__.b=reject},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var dom_1=__webpack_require__(7),Transition=function(){function Transition(){this.loaded=!1}return Transition.prototype.view=function(v){return this.inject(v),v.children},Transition.prototype.oncreate=function(v){var _this=this,delay=v.attrs.delay&&v.attrs.order?v.attrs.delay*v.attrs.order:0,dom=this.findTransitionElement(v);dom&&setTimeout(function(){dom.classList.remove("before"),setTimeout(function(){_this.loaded=!0},dom_1.getTransitionDuration(dom))},delay)},Transition.prototype.onbeforeremove=function(v){var delay=v.attrs.delay&&v.attrs.order?v.attrs.delay*v.attrs.order:0;if(this.findTransitionElement(v))return setTimeout(function(){v.dom.classList.add("after")},delay),new Promise(function(resolve){return setTimeout(function(){resolve()},dom_1.getTransitionDuration(v.dom)+delay)})},Transition.prototype.inject=function(v){var _this=this;Array.isArray(v.children)&&v.children.forEach(function(c){"object"!=typeof c||null===c||Array.isArray(c)||(c.attrs||(c.attrs={}),c.attrs.className=c.attrs.className+" "+(_this.loaded?"":"before")+" "+v.attrs.className)})},Transition.prototype.findTransitionElement=function(v){if(!v||"object"!=typeof v)return!1;if(v.dom&&v.dom.classList)return v.dom;if(Array.isArray(v.children))for(var _i=0,_a=v.children;_i<_a.length;_i++){var c=_a[_i],cv=this.findTransitionElement(c);if(cv&&cv.classList)return cv}return!1},Transition}();exports.default=Transition},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Change=function(){function Change(type,snapshotNode,childName,oldSnap,prevName){this.type=type,this.snapshotNode=snapshotNode,this.childName=childName,this.oldSnap=oldSnap,this.prevName=prevName}return Change.valueChange=function(snapshot){return new Change(Change.VALUE,snapshot)},Change.childAddedChange=function(childKey,snapshot){return new Change(Change.CHILD_ADDED,snapshot,childKey)},Change.childRemovedChange=function(childKey,snapshot){return new Change(Change.CHILD_REMOVED,snapshot,childKey)},Change.childChangedChange=function(childKey,newSnapshot,oldSnapshot){return new Change(Change.CHILD_CHANGED,newSnapshot,childKey,oldSnapshot)},Change.childMovedChange=function(childKey,snapshot){return new Change(Change.CHILD_MOVED,snapshot,childKey)},Change.CHILD_ADDED="child_added",Change.CHILD_REMOVED="child_removed",Change.CHILD_CHANGED="child_changed",Change.CHILD_MOVED="child_moved",Change.VALUE="value",Change}();exports.Change=Change},function(module,__webpack_exports__,__webpack_require__){"use strict";function contains(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function forEach(obj,f){for(var key in obj)contains(obj,key)&&f(key,obj[key])}function clone(obj){if(null==obj)return{};var c={};return forEach(obj,function(key,val){c[key]=val}),c}__webpack_exports__.b=forEach,__webpack_exports__.a=clone},function(module,exports,__webpack_require__){(function(global){function bind(obj,fn){return function(){return fn.apply(obj,Array.prototype.slice.call(arguments,0))}}function slice(arr,index){return Array.prototype.slice.call(arr,index||0)}function each(obj,fn){pluck(obj,function(val,key){return fn(val,key),!1})}function map(obj,fn){var res=isList(obj)?[]:{};return pluck(obj,function(v,k){return res[k]=fn(v,k),!1}),res}function pluck(obj,fn){if(isList(obj)){for(var i=0;i<obj.length;i++)if(fn(obj[i],i))return obj[i]}else for(var key in obj)if(obj.hasOwnProperty(key)&&fn(obj[key],key))return obj[key]}function isList(val){return null!=val&&"function"!=typeof val&&"number"==typeof val.length}function isFunction(val){return val&&"[object Function]"==={}.toString.call(val)}function isObject(val){return val&&"[object Object]"==={}.toString.call(val)}var assign=function(){return Object.assign?Object.assign:function(obj,props1,props2,etc){for(var i=1;i<arguments.length;i++)each(Object(arguments[i]),function(val,key){obj[key]=val});return obj}}(),create=function(){function F(){}return Object.create?function(obj,assignProps1,assignProps2,etc){var assignArgsList=slice(arguments,1);return assign.apply(this,[Object.create(obj)].concat(assignArgsList))}:function(obj,assignProps1,assignProps2,etc){var assignArgsList=slice(arguments,1);return F.prototype=obj,assign.apply(this,[new F].concat(assignArgsList))}}(),trim=function(){return String.prototype.trim?function(str){return String.prototype.trim.call(str)}:function(str){return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}(),Global="undefined"!=typeof window?window:global;module.exports={assign:assign,create:create,trim:trim,bind:bind,slice:slice,each:each,map:map,pluck:pluck,isList:isList,isFunction:isFunction,isObject:isObject,Global:Global}}).call(exports,__webpack_require__(23))},function(module,exports,__webpack_require__){var content=__webpack_require__(219);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var __EMPTY_NODE,Index_1=__webpack_require__(36),Node_1=__webpack_require__(11),util_1=__webpack_require__(1),util_2=__webpack_require__(0),KeyIndex=function(_super){function KeyIndex(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(KeyIndex,_super),Object.defineProperty(KeyIndex,"__EMPTY_NODE",{get:function(){return __EMPTY_NODE},set:function(val){__EMPTY_NODE=val},enumerable:!0,configurable:!0}),KeyIndex.prototype.compare=function(a,b){return util_1.nameCompare(a.name,b.name)},KeyIndex.prototype.isDefinedOn=function(node){throw util_2.assertionError("KeyIndex.isDefinedOn not expected to be called.")},KeyIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!1},KeyIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN},KeyIndex.prototype.maxPost=function(){return new Node_1.NamedNode(util_1.MAX_NAME,__EMPTY_NODE)},KeyIndex.prototype.makePost=function(indexValue,name){return util_2.assert("string"==typeof indexValue,"KeyIndex indexValue must always be a string."),new Node_1.NamedNode(indexValue,__EMPTY_NODE)},KeyIndex.prototype.toString=function(){return".key"},KeyIndex}(Index_1.Index);exports.KeyIndex=KeyIndex,exports.KEY_INDEX=new KeyIndex},function(module,exports,__webpack_require__){"use strict";function nodeFromJSON(json,priority){if(void 0===priority&&(priority=null),null===json)return ChildrenNode_1.ChildrenNode.EMPTY_NODE;if("object"==typeof json&&".priority"in json&&(priority=json[".priority"]),util_2.assert(null===priority||"string"==typeof priority||"number"==typeof priority||"object"==typeof priority&&".sv"in priority,"Invalid priority type found: "+typeof priority),"object"==typeof json&&".value"in json&&null!==json[".value"]&&(json=json[".value"]),"object"!=typeof json||".sv"in json){var jsonLeaf=json;return new LeafNode_1.LeafNode(jsonLeaf,nodeFromJSON(priority))}if(json instanceof Array||!USE_HINZE){var node_1=ChildrenNode_1.ChildrenNode.EMPTY_NODE,jsonObj_1=json;return util_1.forEach(jsonObj_1,function(key,childData){if(util_1.contains(jsonObj_1,key)&&"."!==key.substring(0,1)){var childNode=nodeFromJSON(childData);!childNode.isLeafNode()&&childNode.isEmpty()||(node_1=node_1.updateImmediateChild(key,childNode))}}),node_1.updatePriority(nodeFromJSON(priority))}var children_1=[],childrenHavePriority_1=!1,hinzeJsonObj_1=json;if(util_1.forEach(hinzeJsonObj_1,function(key,child){if("string"!=typeof key||"."!==key.substring(0,1)){var childNode=nodeFromJSON(hinzeJsonObj_1[key]);childNode.isEmpty()||(childrenHavePriority_1=childrenHavePriority_1||!childNode.getPriority().isEmpty(),children_1.push(new Node_1.NamedNode(key,childNode)))}}),0==children_1.length)return ChildrenNode_1.ChildrenNode.EMPTY_NODE;var childSet=childSet_1.buildChildSet(children_1,comparators_1.NAME_ONLY_COMPARATOR,function(namedNode){return namedNode.name},comparators_1.NAME_COMPARATOR);if(childrenHavePriority_1){var sortedChildSet=childSet_1.buildChildSet(children_1,PriorityIndex_1.PRIORITY_INDEX.getCompare());return new ChildrenNode_1.ChildrenNode(childSet,nodeFromJSON(priority),new IndexMap_1.IndexMap({".priority":sortedChildSet},{".priority":PriorityIndex_1.PRIORITY_INDEX}))}return new ChildrenNode_1.ChildrenNode(childSet,nodeFromJSON(priority),IndexMap_1.IndexMap.Default)}Object.defineProperty(exports,"__esModule",{value:!0});var ChildrenNode_1=__webpack_require__(10),LeafNode_1=__webpack_require__(37),Node_1=__webpack_require__(11),util_1=__webpack_require__(0),util_2=__webpack_require__(0),childSet_1=__webpack_require__(74),comparators_1=__webpack_require__(75),IndexMap_1=__webpack_require__(73),PriorityIndex_1=__webpack_require__(8),USE_HINZE=!0;exports.nodeFromJSON=nodeFromJSON,PriorityIndex_1.setNodeFromJSON(nodeFromJSON)},function(module,__webpack_exports__,__webpack_require__){"use strict";function formatValidator(stringFormat){switch(stringFormat){case StringFormat.RAW:case StringFormat.BASE64:case StringFormat.BASE64URL:case StringFormat.DATA_URL:return;default:throw"Expected one of the event types: ["+StringFormat.RAW+", "+StringFormat.BASE64+", "+StringFormat.BASE64URL+", "+StringFormat.DATA_URL+"]."}}function dataFromString(format,string){switch(format){case StringFormat.RAW:return new StringData(utf8Bytes_(string));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(format,string));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(string),dataURLContentType_(string))}throw __WEBPACK_IMPORTED_MODULE_0__error__.s()}function utf8Bytes_(string){for(var b=[],i=0;i<string.length;i++){var c=string.charCodeAt(i);if(c<=127)b.push(c);else if(c<=2047)b.push(192|c>>6,128|63&c);else if(55296==(64512&c)){var valid=i<string.length-1&&56320==(64512&string.charCodeAt(i+1));if(valid){var hi=c,lo=string.charCodeAt(++i);c=65536|(1023&hi)<<10|1023&lo,b.push(240|c>>18,128|c>>12&63,128|c>>6&63,128|63&c)}else b.push(239,191,189)}else 56320==(64512&c)?b.push(239,191,189):b.push(224|c>>12,128|c>>6&63,128|63&c)}return new Uint8Array(b)}function percentEncodedBytes_(string){var decoded;try{decoded=decodeURIComponent(string)}catch(e){throw __WEBPACK_IMPORTED_MODULE_0__error__.i(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(decoded)}function base64Bytes_(format,string){switch(format){case StringFormat.BASE64:var hasMinus=-1!==string.indexOf("-"),hasUnder=-1!==string.indexOf("_");if(hasMinus||hasUnder){var invalidChar=hasMinus?"-":"_";throw __WEBPACK_IMPORTED_MODULE_0__error__.i(format,"Invalid character '"+invalidChar+"' found: is it base64url encoded?")}break;case StringFormat.BASE64URL:var hasPlus=-1!==string.indexOf("+"),hasSlash=-1!==string.indexOf("/");if(hasPlus||hasSlash){var invalidChar=hasPlus?"+":"/";throw __WEBPACK_IMPORTED_MODULE_0__error__.i(format,"Invalid character '"+invalidChar+"' found: is it base64 encoded?")}string=string.replace(/-/g,"+").replace(/_/g,"/")}var bytes;try{bytes=atob(string)}catch(e){throw __WEBPACK_IMPORTED_MODULE_0__error__.i(format,"Invalid character found")}for(var array=new Uint8Array(bytes.length),i=0;i<bytes.length;i++)array[i]=bytes.charCodeAt(i);return array}function dataURLBytes_(string){var parts=new DataURLParts(string);return parts.base64?base64Bytes_(StringFormat.BASE64,parts.rest):percentEncodedBytes_(parts.rest)}function dataURLContentType_(string){return new DataURLParts(string).contentType}function endsWith(s,end){return!!(s.length>=end.length)&&s.substring(s.length-end.length)===end}__webpack_require__.d(__webpack_exports__,"a",function(){return StringFormat}),__webpack_exports__.c=formatValidator,__webpack_exports__.b=dataFromString;var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(15),StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},StringData=function(){function StringData(data,opt_contentType){this.data=data,this.contentType=opt_contentType||null}return StringData}(),DataURLParts=function(){function DataURLParts(dataURL){this.base64=!1,this.contentType=null;var matches=dataURL.match(/^data:([^,]+)?,/);if(null===matches)throw __WEBPACK_IMPORTED_MODULE_0__error__.i(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var middle=matches[1]||null;null!=middle&&(this.base64=endsWith(middle,";base64"),this.contentType=this.base64?middle.substring(0,middle.length-";base64".length):middle),this.rest=dataURL.substring(dataURL.indexOf(",")+1)}return DataURLParts}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function taskStateFromInternalTaskState(state){switch(state){case InternalTaskState.RUNNING:case InternalTaskState.PAUSING:case InternalTaskState.CANCELING:return TaskState.RUNNING;case InternalTaskState.PAUSED:return TaskState.PAUSED;case InternalTaskState.SUCCESS:return TaskState.SUCCESS;case InternalTaskState.CANCELED:return TaskState.CANCELED;case InternalTaskState.ERROR:default:return TaskState.ERROR}}__webpack_require__.d(__webpack_exports__,"b",function(){return TaskEvent}),__webpack_require__.d(__webpack_exports__,"a",function(){return InternalTaskState}),__webpack_require__.d(__webpack_exports__,"c",function(){return TaskState}),__webpack_exports__.d=taskStateFromInternalTaskState;var TaskEvent={STATE_CHANGED:"state_changed"},InternalTaskState={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"}},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},_this=this;Object.defineProperty(exports,"__esModule",{value:!0});var DTI=__webpack_require__(214),dom_1=__webpack_require__(7);exports.createImage=function(imageData,maxWidth,maxHeight){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new Promise(function(resolve,reject){var image=new Image;image.onload=function(){var width=image.naturalWidth,height=image.naturalHeight,ratio=height/width;ratio<1?(maxWidth&&width>maxWidth&&(width=Math.floor(maxWidth),height=Math.floor(ratio*maxWidth)),maxHeight&&height>maxHeight&&(height=Math.floor(maxHeight),width=Math.floor(ratio*maxHeight))):(maxHeight&&height>maxHeight&&(height=Math.floor(maxHeight),width=Math.floor(ratio*maxHeight)),maxWidth&&width>maxWidth&&(width=Math.floor(maxWidth),height=Math.floor(ratio*maxWidth))),resolve({image:image,width:width,height:height})},image.onerror=function(err){return reject(err)},image.src=imageData})]})})},exports.compress=function(imageData,_a){var _b=void 0===_a?{quality:.9,pixelated:!1}:_a,type=_b.type,quality=_b.quality,pixelated=_b.pixelated,maxHeight=_b.maxHeight,maxWidth=_b.maxWidth;return __awaiter(_this,void 0,void 0,function(){var _c,image,width,height,canvas,ctx;return __generator(this,function(_d){switch(_d.label){case 0:return void 0===type&&(type=exports.getImageType(imageData)||"jpeg"),[4,exports.createImage(imageData,maxWidth,maxHeight)];case 1:if(_c=_d.sent(),image=_c.image,width=_c.width,height=_c.height,image.naturalWidth===width&&image.naturalHeight===height&&1===quality)return[2,imageData];if(canvas=document.createElement("canvas"),canvas.width=width,canvas.height=height,!(ctx=canvas.getContext("2d")))throw new Error("canvas not initialized");return ctx.imageSmoothingEnabled=pixelated,ctx.drawImage(image,0,0,width,height),[2,canvas.toDataURL("image/"+type,quality)]}})})},exports.getImageType=function(base64){var match=base64.match(/data:image\/([a-zA-Z]*);base64/);return match?match[1]||"jpeg":"jpeg"},exports.uploadImage=function(image,_a){var quality=_a.quality,maxWidth=_a.maxWidth,maxHeight=_a.maxHeight;return new Promise(function(resolve){var fReader=new FileReader;fReader.onload=function(){return exports.compress(fReader.result,{quality:quality,maxWidth:maxWidth,maxHeight:maxHeight}).then(function(compressed){return resolve(compressed)}).catch(function(err){return resolve(fReader.result)})},fReader.readAsDataURL(image)})},exports.imageUrlToB64=function(url,quality,maxWidth,maxHeight){return new Promise(function(resolve){var xhr=new XMLHttpRequest;xhr.onload=function(){var reader=new FileReader;reader.onloadend=function(){return exports.compress(reader.result,{quality:quality,maxWidth:maxWidth,maxHeight:maxHeight}).then(function(compressed){return resolve(compressed)}).catch(function(err){return resolve(reader.result)})},reader.readAsDataURL(xhr.response)},xhr.open("GET",url),xhr.responseType="blob",xhr.send()})},exports.isBase64=function(base64){return!!base64.match(/data:image\/([a-zA-Z]*);base64/)},exports.renderServer=function(html,dimensions){return __awaiter(_this,void 0,void 0,function(){var res,blob;return __generator(this,function(_a){switch(_a.label){case 0:return[4,fetch("http://localhost:3000/html/",{body:JSON.stringify({html:html,dimensions:dimensions}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},method:"POST"})];case 1:return res=_a.sent(),[4,res.blob()];case 2:return blob=_a.sent(),[4,URL.createObjectURL(blob)];case 3:return[2,_a.sent()]}})})},exports.domToImage=function(node){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){return[2,DTI.toPng(node)]})})},exports.downloadImage=function(imageData,name){var link=document.createElement("a");link.download=name,link.href=imageData,link.click()},exports.getThumb=function(original,options){return void 0===options&&(options={quality:.5,maxWidth:128,maxHeight:128,pixelated:!1}),exports.compress(original,options)},exports.modifyPixels=function(imageData,eachRow,pixelated){return void 0===pixelated&&(pixelated=!1),new Promise(function(resolve,reject){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");if(!ctx)throw new Error("canvas not initialized");var image=new Image;image.onload=function(){canvas.width=image.naturalWidth,canvas.height=image.naturalHeight,ctx.imageSmoothingEnabled=pixelated,ctx.drawImage(image,0,0);for(var buffer=ctx.getImageData(0,0,canvas.width,canvas.height),data=buffer.data,pixelsPerRow=4*canvas.width,h=0;h<canvas.height;h++){var offset=h*pixelsPerRow,modified=eachRow(data.slice(offset,offset+pixelsPerRow),h);if(modified&&modified.length===pixelsPerRow)for(var i=0;i<pixelsPerRow;i++)data[offset+i]=modified[i]}ctx.putImageData(buffer,0,0),resolve(canvas.toDataURL("png"))},image.onerror=function(err){return reject(err)},image.src=imageData})},exports.colorPicker=function(canvas,onhover,onclick){var ctx=canvas.getContext("2d");if(!ctx)throw new Error("canvas not initialized");var pick=function(event){var _a=dom_1.getOffsetXY(event),x=_a.x,y=_a.y,pixel=ctx.getImageData(x,y,1,1),data=pixel.data;return[data[0],data[1],data[2],data[3]]};canvas.addEventListener("mousemove",function(event){return onhover.apply(void 0,pick(event))}),canvas.addEventListener("mouseup",function(event){return onclick.apply(void 0,pick(event))}),canvas.addEventListener("touchmove",function(event){return onhover.apply(void 0,pick(event))}),canvas.addEventListener("touchend",function(event){return onclick.apply(void 0,pick(event))})},exports.avgPixel=function(pixels){for(var r=0,g=0,b=0,a=0,i=0;i<pixels.length;i+=4)void 0!==pixels[i]&&(r+=pixels[i],g+=pixels[i+1],b+=pixels[i+2],a+=pixels[i+3]);var total=pixels.length/4;return[r/total,g/total,b/total,a/total]}},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),dom_1=__webpack_require__(7),logger_1=__webpack_require__(16),object_1=__webpack_require__(3),Area_1=__webpack_require__(59);__webpack_require__(231);var domEA=eventaggregator_1.default.getInstance("dom"),DragItem=function(){function DragItem(){this.staticPosition={},this.initialPosition={},this.position={},this.constrain={minWidth:20,minHeight:20},this.dragStarted=0,this.resizeStarted=0,this.dragMoved=!1,this.resizeMoved=!1,this.events=[],this.data={},this.type="main"}return DragItem.prototype.getBoundingClientRect=function(){return dom_1.getOuterRect(this.dom)},DragItem.prototype.getData=function(key){return key?this.data[key]:this.data},DragItem.prototype.updatePosition=function(position){this.setPosition(position),this.setDOMPosition(position)},DragItem.prototype.setStaticPosition=function(position){this.staticPosition=position},DragItem.prototype.getPosition=function(_a){var snapToGrid=(void 0===_a?{}:_a).snapToGrid,position={height:this.position.height,left:this.position.left,top:this.position.top,width:this.position.width};if(snapToGrid&&this.targetArea){var grid=this.targetArea.getConstraints().grid;if(grid)return DragItem.snapToRelativeGrid(position,grid)}return position},DragItem.withinArea=function(position,area){var positionBottom=position.top+position.height,positionRight=position.left+position.width,areaBottom=area.top+area.height,areaRight=area.left+area.width;return position.top<area.top&&position.top>area.top-(position.height+1)?position.top=area.top:positionBottom>areaBottom&&positionBottom<areaBottom+(position.height+1)&&(position.top=areaBottom-position.height),position.left<area.left&&position.left>area.left-(position.width+1)?position.left=area.left:positionRight>areaRight&&positionRight<areaRight+(position.width+1)&&(position.left=areaRight-position.width),position},DragItem.snapToRelativeGrid=function(position,grid){return{height:Math.round(position.height/grid.height)*grid.height,left:Math.round(position.left/grid.width)*grid.width,top:Math.round(position.top/grid.height)*grid.height,width:Math.round(position.width/grid.width)*grid.width}},DragItem.snapToFixedGrid=function(position,areaRect,grid,withOffsets){void 0===withOffsets&&(withOffsets=!1);var offsets=withOffsets?{left:areaRect.left%grid.width,top:areaRect.top%grid.height}:{left:0,top:0};return{height:Math.round(position.height/grid.height)*grid.height,left:Math.round(position.left/grid.width)*grid.width+offsets.left,top:Math.round(position.top/grid.height)*grid.height+offsets.top,width:Math.round(position.width/grid.width)*grid.width}},DragItem.prototype.reset=function(hard){hard&&(this.previousFixedPosition={},this.lastTargetArea=void 0,this.position={},this.clearDOMPosition()),this.staticPosition={},this.resizeSide=void 0,this.dragStarted=0,this.resizeStarted=0,this.targetArea=void 0,this.sourceArea=void 0,this.pressStamp=0,this.dom.classList.remove("within-area","dragging","resizing"),Area_1.getAreas(this.type).forEach(function(area){area.setFocus(!1),area.setDisabled(!1)}),this.placeholder&&dom_1.setStyle(this.placeholder,{display:"none"})},DragItem.prototype.oninit=function(vnode){this.setState(vnode.attrs)},DragItem.prototype.oncreate=function(vnode){var _this=this;this.dom=vnode.dom,!0===this.preventPosition?this.clearDOMPosition():this.setDOMRelativePosition(this.position),this.events=[domEA.on(["mousemove","touchmove"],function(event){return _this.onMouseMove(event)}),domEA.on("contextmenu",function(event){-1!==event.path.indexOf(_this.dom)&&(_this.reset(!0),m.redraw())}),domEA.on(["mouseup","touchend"],function(event){return _this.onMouseUp(event)})]},DragItem.prototype.onbeforeupdate=function(vnode,old){return this.setState(vnode.attrs),DragItem.attrsChanged(vnode.attrs,old.attrs)},DragItem.prototype.onupdate=function(vnode){this.dom=vnode.dom,!0===this.preventPosition?this.clearDOMPosition():this.setDOMRelativePosition(this.position)},DragItem.prototype.onremove=function(vnode){this.events.forEach(function(event){return event.off()})},DragItem.prototype.view=function(vnode){var _this=this;return[m("div",{className:object_1.cleanString("component--DragItem",vnode.attrs.className,!vnode.attrs.dragHandle&&"handle"),style:vnode.attrs.style,onmousedown:function(event){_this.pressStamp=Date.now(),vnode.attrs.dragHandle||vnode.attrs.preventMove||_this.onDrag(dom_1.devent(event))},ontouchstart:function(event){_this.pressStamp=Date.now(),vnode.attrs.dragHandle||vnode.attrs.preventMove||_this.onDrag(dom_1.devent(event))},onmouseup:function(event){_this.onClick(dom_1.devent(event))},ontouchend:function(event){_this.onClick(dom_1.devent(event))}},vnode.attrs.dragHandle&&!vnode.attrs.preventMove&&this.getDragHandleView(vnode),!vnode.attrs.preventResize&&this.getResizeBorderView(vnode),vnode.children),vnode.attrs.keepPlaceholder&&this.getPlaceholderView(vnode)]},DragItem.prototype.getDragHandleView=function(vnode){var _this=this;return m("div",{className:"handle",onmousedown:function(event){_this.onDrag(dom_1.devent(event))}},!0===vnode.attrs.dragHandle?null:vnode.attrs.dragHandle)},DragItem.prototype.getPlaceholderView=function(vnode){var _this=this;return m("div",{oncreate:function(node){_this.placeholder=node.dom,dom_1.setStyle(_this.placeholder,{position:"relative",display:"none",backgroundColor:"#aaa"})},className:"component--drag placeholder"})},DragItem.prototype.getResizeBorderView=function(vnode){var _this=this;return[m("div",{onmousedown:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("left")},ontouchstart:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("left")},className:"border left"}),m("div",{onmousedown:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("right")},ontouchstart:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("right")},className:"border right"}),m("div",{onmousedown:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("top")},ontouchstart:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("top")},className:"border top"}),m("div",{onmousedown:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("bottom")},ontouchstartF:function(event){dom_1.devent(event,{stopPropagation:!0}),_this.onResize("bottom")},className:"border bottom"})]},DragItem.attrsChanged=function(next,prev){return next.onitemmovestart!==prev.onitemmovestart||next.onitemmove!==prev.onitemmove||next.onitemmoveend!==prev.onitemmoveend||next.onitemresizestart!==prev.onitemresizestart||next.onitemresize!==prev.onitemresize||next.onitemresizeend!==prev.onitemresizeend||next.onclick!==prev.onclick||next.dragHandle!==prev.dragHandle||next.preventMove!==prev.preventMove||next.preventResize!==prev.preventResize||next.position!==prev.position||next.preventPosition!==prev.preventPosition},DragItem.prototype.setState=function(attrs){var _this=this;Object.keys(attrs).forEach(function(key){return _this[key]=attrs[key]}),this.initialPosition=attrs.position||{}},DragItem.prototype.setInitialPosition=function(){var _a=this.getBoundingClientRect(),width=_a.width,height=_a.height;return this.position=__assign({},this.position,{top:0,left:0,width:width,height:height}),this.position},DragItem.prototype.getSourceArea=function(){var _this=this;return Area_1.getAreas(this.type).find(function(a){return-1!==a.getItems().findIndex(function(i){return i===_this})})},DragItem.prototype.getTargetArea=function(){var _this=this,targetArea=void 0;return Area_1.getAreas(this.type).forEach(function(area){area.setDisabled(!1),area.setFocus(!1),void 0===targetArea&&area.withinArea(_this.getBoundingClientRect())&&(targetArea=area)}),targetArea},DragItem.prototype.getCursorOffset=function(x,y){return{left:x+this.dragOffset.left,top:y+this.dragOffset.top}},DragItem.prototype.setDOMFixedPosition=function(position){void 0===position&&(position=this.position),this.setDOMPosition(position),this.sourceArea&&this.sourceArea===this.targetArea?dom_1.setStyle(this.dom,{position:"fixed"}):dom_1.setStyle(this.dom,{position:"fixed",zIndex:999})},DragItem.prototype.setDOMRelativePosition=function(position){void 0===position&&(position=this.position),this.setDOMPosition(position),dom_1.setStyle(this.dom,{position:"absolute",zIndex:0})},DragItem.prototype.setDOMPosition=function(position){void 0===position&&(position=this.position),dom_1.setStyle(this.dom,__assign({},dom_1.getRectStyle(position)))},DragItem.prototype.clearDOMPosition=function(){dom_1.setStyle(this.dom,{height:this.initialPosition.height||"",left:this.initialPosition.left||"",position:"",top:this.initialPosition.top||"",width:this.initialPosition.width||"",zIndex:""})},DragItem.prototype.getRelativePoints=function(area){var itemRect=this.getBoundingClientRect(),areaRect=area.getBoundingClientRect();return{left:itemRect.left-areaRect.left,top:itemRect.top-areaRect.top}},DragItem.prototype.setPosition=function(position){this.position=__assign({},this.position,position)},DragItem.getFixedOffset=function(position,x,y){return{left:position.left-x,top:position.top-y}},DragItem.prototype.getCalculatedPosition=function(position){if(void 0===this.targetArea)return position;var _a=this.targetArea.getConstraints(),grid=_a.grid,constrain=_a.constrain;if(void 0!==grid&&grid.width>0&&grid.height>0&&(position=DragItem.snapToFixedGrid(position,this.targetArea.getBoundingClientRect(),grid,!0)),void 0!==constrain){var areaRect=this.targetArea.getBoundingClientRect();position=__assign({},position,DragItem.withinArea(position,areaRect))}return position},DragItem.prototype.onClick=function(event){Date.now()<this.pressStamp+250&&object_1.exec(this.onclick,event,this)},DragItem.prototype.onDrag=function(event){if(this.dragStarted=Date.now(),this.dragMoved=!1,this.setInitialPosition(),this.previousFixedPosition=this.getBoundingClientRect(),this.sourceArea=this.getSourceArea(),this.placeholder){if(!this.placeholderPosition){var _a=this.previousFixedPosition,width=_a.width,height=_a.height;this.placeholderPosition={width:width,height:height}}dom_1.setStyle(this.placeholder,dom_1.getRectStyle(this.placeholderPosition))}var _b=dom_1.getClientXY(event),x=_b.x,y=_b.y;this.dragOffset=DragItem.getFixedOffset(this.previousFixedPosition,x,y),object_1.exec(this.onitemmovestart,event,this,this.sourceArea,this.targetArea),this.dom.classList.add("dragging")},DragItem.prototype.onDragMove=function(event){var _this=this;this.lastTargetArea=this.targetArea,this.targetArea=this.getTargetArea(),this.dragMoved=!0;var disable=function(area){_this.preventDrop=!0,area.setDisabled(!0),area.setFocus(!1),_this.dom.classList.remove("within-area")};if(this.targetArea)try{!1===this.targetArea.onItemHover(event,this,this.sourceArea,this.targetArea!==this.lastTargetArea&&this.targetArea!==this.sourceArea)?disable(this.targetArea):function(area){area.setFocus(!0),area.setDisabled(!1),_this.preventDrop=!1,_this.dom.classList.add("within-area")}(this.targetArea)}catch(err){logger_1.default(err),disable(this.targetArea)}var position=__assign({},this.previousFixedPosition,this.staticPosition),_a=dom_1.getClientXY(event),x=_a.x,y=_a.y;position=__assign({},position,this.getCursorOffset(x,y)),position=this.getCalculatedPosition(position),this.setDOMFixedPosition(position),this.placeholder&&dom_1.setStyle(this.placeholder,{display:""}),object_1.exec(this.onitemmove,event,this,this.sourceArea,this.targetArea)},DragItem.prototype.onDragUp=function(event){if(this.dragStarted=0,!1!==this.dragMoved){if(Area_1.getAreas(this.type).forEach(function(area){area.setFocus(!1),area.setDisabled(!1)}),this.staticPosition={},this.placeholder&&dom_1.setStyle(this.placeholder,{display:"none"}),this.targetArea&&!0===this.preventDrop)return this.preventDrop=!1,void(this.sourceArea?this.sourceArea.onItemRemove(event,this):this.reset(!0));var position=this.getBoundingClientRect();this.targetArea&&(this.setPosition(__assign({},position,this.getRelativePoints(this.targetArea),this.staticPosition)),this.setDOMRelativePosition(this.position),object_1.exec(this.onitemmoveend,event,this,this.sourceArea,this.targetArea)),this.targetArea&&this.targetArea!==this.sourceArea&&this.targetArea.onItemDrop(event,this,this.sourceArea),this.sourceArea?this.sourceArea!==this.targetArea&&this.sourceArea.onItemRemove(event,this):this.clearDOMPosition(),this.dom.classList.remove("dragging","within-area")}},DragItem.prototype.onResize=function(side){this.resizeStarted=Date.now(),this.resizeMoved=!1,this.previousFixedPosition=this.getBoundingClientRect(),this.sourceArea=this.targetArea=this.getSourceArea(),this.resizeSide=side,object_1.exec(this.onitemresizestart,event,this,this.sourceArea),this.dom.classList.add("resizing")},DragItem.prototype.onResizeMove=function(x,y){if(this.sourceArea){this.resizeMoved=!0;var areaRect=this.sourceArea.getBoundingClientRect(),position=__assign({},this.position),diff={left:0,top:0,right:0,bottom:0};if("left"===this.resizeSide){diff.left=x-this.previousFixedPosition.left;var diffLeft=this.position.left+diff.left;diffLeft<0&&(diff.left-=diffLeft),position.left=this.position.left+diff.left,position.width=this.position.width-diff.left}else if("top"===this.resizeSide){diff.top=y-this.previousFixedPosition.top;var diffTop=this.position.top+diff.top;diffTop<0&&(diff.top-=diffTop),position.top=this.position.top+diff.top,position.height=this.position.height-diff.top}else if("right"===this.resizeSide){diff.right=x-this.position.width-this.previousFixedPosition.left;var diffRight=position.left+this.position.width+diff.right;diffRight>areaRect.width&&(diff.right+=areaRect.width-diffRight),position.width=this.position.width+diff.right}else if("bottom"===this.resizeSide){diff.bottom=y-this.position.height-this.previousFixedPosition.top;var diffBottom=position.top+this.position.height+diff.bottom;diffBottom>areaRect.height&&(diff.bottom+=areaRect.height-diffBottom),position.height=this.position.height+diff.bottom}var grid=this.sourceArea.getConstraints().grid;void 0!==grid&&grid.width>0&&grid.height>0&&(position=DragItem.snapToRelativeGrid(position,grid)),this.setDOMRelativePosition(position),object_1.exec(this.onitemresize,event,this,this.sourceArea)}},DragItem.prototype.onResizeUp=function(event){if(this.resizeStarted=0,!1!==this.resizeMoved){var position=this.getBoundingClientRect();this.setPosition(__assign({},position,this.targetArea?this.getRelativePoints(this.targetArea):{})),object_1.exec(this.onitemresizeend,event,this,this.sourceArea),this.dom.classList.remove("resizing")}},DragItem.prototype.onMouseUp=function(event){if(!(this.dragStarted<1&&this.resizeStarted<1)){if(Date.now()<this.pressStamp+250)return this.dragStarted=0,void(this.resizeStarted=0);0!==this.dragStarted?this.onDragUp(event):0!==this.resizeStarted&&this.onResizeUp(event),this.reset()}},DragItem.prototype.onMouseMove=function(event){if(!(Date.now()<this.pressStamp+250))if(this.dragStarted>0&&Date.now()-this.dragStarted>250)this.onDragMove(event);else if(this.resizeStarted>0&&Date.now()-this.resizeStarted>250){var _a=dom_1.getClientXY(event),x=_a.x,y=_a.y;this.onResizeMove(x,y)}},DragItem}();exports.default=DragItem},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var DOMStorageWrapper_1=__webpack_require__(142),MemoryStorage_1=__webpack_require__(143),createStoragefor=function(domStorageName){try{if("undefined"!=typeof window&&void 0!==window[domStorageName]){var domStorage=window[domStorageName];return domStorage.setItem("firebase:sentinel","cache"),domStorage.removeItem("firebase:sentinel"),new DOMStorageWrapper_1.DOMStorageWrapper(domStorage)}}catch(e){}return new MemoryStorage_1.MemoryStorage};exports.PersistentStorage=createStoragefor("localStorage"),exports.SessionStorage=createStoragefor("sessionStorage")},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROTOCOL_VERSION="5",exports.VERSION_PARAM="v",exports.TRANSPORT_SESSION_PARAM="s",exports.REFERER_PARAM="r",exports.FORGE_REF="f",exports.FORGE_DOMAIN="firebaseio.com",exports.LAST_SESSION_PARAM="ls",exports.WEBSOCKET="websocket",exports.LONG_POLLING="long_polling"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Node_1=__webpack_require__(11),util_1=__webpack_require__(1),Index=function(){function Index(){}return Index.prototype.getCompare=function(){return this.compare.bind(this)},Index.prototype.indexedValueChanged=function(oldNode,newNode){var oldWrapped=new Node_1.NamedNode(util_1.MIN_NAME,oldNode),newWrapped=new Node_1.NamedNode(util_1.MIN_NAME,newNode);return 0!==this.compare(oldWrapped,newWrapped)},Index.prototype.minPost=function(){return Node_1.NamedNode.MIN},Index}();exports.Index=Index},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __childrenNodeConstructor,util_1=__webpack_require__(0),util_2=__webpack_require__(1),snap_1=__webpack_require__(71),LeafNode=function(){function LeafNode(value_,priorityNode_){void 0===priorityNode_&&(priorityNode_=LeafNode.__childrenNodeConstructor.EMPTY_NODE),this.value_=value_,this.priorityNode_=priorityNode_,this.lazyHash_=null,util_1.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),snap_1.validatePriorityNode(this.priorityNode_)}return Object.defineProperty(LeafNode,"__childrenNodeConstructor",{get:function(){return __childrenNodeConstructor},set:function(val){__childrenNodeConstructor=val},enumerable:!0,configurable:!0}),LeafNode.prototype.isLeafNode=function(){return!0},LeafNode.prototype.getPriority=function(){return this.priorityNode_},LeafNode.prototype.updatePriority=function(newPriorityNode){return new LeafNode(this.value_,newPriorityNode)},LeafNode.prototype.getImmediateChild=function(childName){return".priority"===childName?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.getChild=function(path){return path.isEmpty()?this:".priority"===path.getFront()?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.hasChild=function(){return!1},LeafNode.prototype.getPredecessorChildName=function(childName,childNode){return null},LeafNode.prototype.updateImmediateChild=function(childName,newChildNode){return".priority"===childName?this.updatePriority(newChildNode):newChildNode.isEmpty()&&".priority"!==childName?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(childName,newChildNode).updatePriority(this.priorityNode_)},LeafNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();return null===front?newChildNode:newChildNode.isEmpty()&&".priority"!==front?this:(util_1.assert(".priority"!==front||1===path.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(front,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(path.popFront(),newChildNode)))},LeafNode.prototype.isEmpty=function(){return!1},LeafNode.prototype.numChildren=function(){return 0},LeafNode.prototype.forEachChild=function(index,action){return!1},LeafNode.prototype.val=function(exportFormat){return exportFormat&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},LeafNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash="";this.priorityNode_.isEmpty()||(toHash+="priority:"+snap_1.priorityHashText(this.priorityNode_.val())+":");var type=typeof this.value_;toHash+=type+":",toHash+="number"===type?util_2.doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=util_2.sha1(toHash)}return this.lazyHash_},LeafNode.prototype.getValue=function(){return this.value_},LeafNode.prototype.compareTo=function(other){return other===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:other instanceof LeafNode.__childrenNodeConstructor?-1:(util_1.assert(other.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(other))},LeafNode.prototype.compareToLeafNode_=function(otherLeaf){var otherLeafType=typeof otherLeaf.value_,thisLeafType=typeof this.value_,otherIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType),thisIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);return util_1.assert(otherIndex>=0,"Unknown leaf type: "+otherLeafType),util_1.assert(thisIndex>=0,"Unknown leaf type: "+thisLeafType),otherIndex===thisIndex?"object"===thisLeafType?0:this.value_<otherLeaf.value_?-1:this.value_===otherLeaf.value_?0:1:thisIndex-otherIndex},LeafNode.prototype.withIndex=function(){return this},LeafNode.prototype.isIndexed=function(){return!0},LeafNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode()){var otherLeaf=other;return this.value_===otherLeaf.value_&&this.priorityNode_.equals(otherLeaf.priorityNode_)}return!1},LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"],LeafNode}();exports.LeafNode=LeafNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse_,resultGenerator_){void 0===resultGenerator_&&(resultGenerator_=null),this.isReverse_=isReverse_,this.resultGenerator_=resultGenerator_,this.nodeStack_=[];for(var cmp=1;!node.isEmpty();)if(node=node,cmp=startKey?comparator(node.key,startKey):1,isReverse_&&(cmp*=-1),cmp<0)node=this.isReverse_?node.left:node.right;else{if(0===cmp){this.nodeStack_.push(node);break}this.nodeStack_.push(node),node=this.isReverse_?node.right:node.left}}return SortedMapIterator.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var result,node=this.nodeStack_.pop();if(result=this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value},this.isReverse_)for(node=node.left;!node.isEmpty();)this.nodeStack_.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack_.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return this.nodeStack_.length>0},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var node=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value}},SortedMapIterator}();exports.SortedMapIterator=SortedMapIterator;var LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null!=color?color:LLRBNode.RED,this.left=null!=left?left:SortedMap.EMPTY_NODE,this.right=null!=right?right:SortedMap.EMPTY_NODE}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null!=key?key:this.key,null!=value?value:this.value,null!=color?color:this.color,null!=left?left:this.left,null!=right?right:this.right)},LLRBNode.prototype.count=function(){return this.left.count()+1+this.right.count()},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},LLRBNode.prototype.minKey=function(){return this.min_().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var cmp,n;return n=this,cmp=comparator(key,n.key),n=cmp<0?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator)),n.fixUp_()},LLRBNode.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var n=this;return n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()},LLRBNode.prototype.remove=function(key,comparator){var n,smallest;if(n=this,comparator(key,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===comparator(key,n.key)){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;smallest=n.right.min_(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp_()},LLRBNode.prototype.isRed_=function(){return this.color},LLRBNode.prototype.fixUp_=function(){var n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n},LLRBNode.prototype.moveRedLeft_=function(){var n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n},LLRBNode.prototype.moveRedRight_=function(){var n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n},LLRBNode.prototype.rotateLeft_=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight_=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip_=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth_=function(){var blackDepth=this.check_();return Math.pow(2,blackDepth)<=this.count()+1},LLRBNode.prototype.check_=function(){var blackDepth;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((blackDepth=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return blackDepth+(this.isRed_()?0:1)},LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}();exports.LLRBNode=LLRBNode;var LLRBEmptyNode=function(){function LLRBEmptyNode(){}return LLRBEmptyNode.prototype.copy=function(key,value,color,left,right){return this},LLRBEmptyNode.prototype.insert=function(key,value,comparator){return new LLRBNode(key,value,null)},LLRBEmptyNode.prototype.remove=function(key,comparator){return this},LLRBEmptyNode.prototype.count=function(){return 0},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(action){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(action){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.check_=function(){return 0},LLRBEmptyNode.prototype.isRed_=function(){return!1},LLRBEmptyNode}();exports.LLRBEmptyNode=LLRBEmptyNode;var SortedMap=function(){function SortedMap(comparator_,root_){void 0===root_&&(root_=SortedMap.EMPTY_NODE),this.comparator_=comparator_,this.root_=root_}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator_,this.root_.insert(key,value,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator_,this.root_.remove(key,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var cmp,node=this.root_;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key)))return node.value;cmp<0?node=node.left:cmp>0&&(node=node.right)}return null},SortedMap.prototype.getPredecessorKey=function(key){for(var cmp,node=this.root_,rightParent=null;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key))){if(node.left.isEmpty())return rightParent?rightParent.key:null;for(node=node.left;!node.right.isEmpty();)node=node.right;return node.key}cmp<0?node=node.left:cmp>0&&(rightParent=node,node=node.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},SortedMap.prototype.isEmpty=function(){return this.root_.isEmpty()},SortedMap.prototype.count=function(){return this.root_.count()},SortedMap.prototype.minKey=function(){return this.root_.minKey()},SortedMap.prototype.maxKey=function(){return this.root_.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root_.inorderTraversal(action)},SortedMap.prototype.reverseTraversal=function(action){return this.root_.reverseTraversal(action)},SortedMap.prototype.getIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getReverseIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!0,resultGenerator)},SortedMap.prototype.getReverseIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!0,resultGenerator)},SortedMap.EMPTY_NODE=new LLRBEmptyNode,SortedMap}();exports.SortedMap=SortedMap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ServerValues_1=__webpack_require__(77),nodeFromJSON_1=__webpack_require__(29),Path_1=__webpack_require__(4),SparseSnapshotTree_1=__webpack_require__(78),SyncTree_1=__webpack_require__(148),SnapshotHolder_1=__webpack_require__(159),util_1=__webpack_require__(0),util_2=__webpack_require__(1),util_3=__webpack_require__(0),AuthTokenProvider_1=__webpack_require__(160),StatsManager_1=__webpack_require__(51),StatsReporter_1=__webpack_require__(162),StatsListener_1=__webpack_require__(83),EventQueue_1=__webpack_require__(163),PersistentConnection_1=__webpack_require__(84),ReadonlyRestClient_1=__webpack_require__(168),Database_1=__webpack_require__(66),Repo=function(){function Repo(repoInfo_,forceRestClient,app){var _this=this;this.repoInfo_=repoInfo_,this.app=app,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue_1.EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new SparseSnapshotTree_1.SparseSnapshotTree,this.persistentConnection_=null;var authTokenProvider=new AuthTokenProvider_1.AuthTokenProvider(app);if(this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo_),forceRestClient||util_2.beingCrawled())this.server_=new ReadonlyRestClient_1.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),authTokenProvider),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var authOverride=app.options.databaseAuthVariableOverride;if(void 0!==authOverride&&null!==authOverride){if("object"!=typeof authOverride)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{util_1.stringify(authOverride)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new PersistentConnection_1.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),authTokenProvider,authOverride),this.server_=this.persistentConnection_}authTokenProvider.addTokenChangeListener(function(token){_this.server_.refreshAuthToken(token)}),this.statsReporter_=StatsManager_1.StatsManager.getOrCreateReporter(repoInfo_,function(){return new StatsReporter_1.StatsReporter(_this.stats_,_this.server_)}),this.transactions_init_(),this.infoData_=new SnapshotHolder_1.SnapshotHolder,this.infoSyncTree_=new SyncTree_1.SyncTree({startListening:function(query,tag,currentHashFn,onComplete){var infoEvents=[],node=_this.infoData_.getNode(query.path);return node.isEmpty()||(infoEvents=_this.infoSyncTree_.applyServerOverwrite(query.path,node),setTimeout(function(){onComplete("ok")},0)),infoEvents},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new SyncTree_1.SyncTree({startListening:function(query,tag,currentHashFn,onComplete){return _this.server_.listen(query,currentHashFn,tag,function(status,data){var events=onComplete(status,data);_this.eventQueue_.raiseEventsForChangedPath(query.path,events)}),[]},stopListening:function(query,tag){_this.server_.unlisten(query,tag)}})}return Repo.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},Repo.prototype.name=function(){return this.repoInfo_.namespace},Repo.prototype.serverTime=function(){var offsetNode=this.infoData_.getNode(new Path_1.Path(".info/serverTimeOffset")),offset=offsetNode.val()||0;return(new Date).getTime()+offset},Repo.prototype.generateServerValues=function(){return ServerValues_1.generateWithValues({timestamp:this.serverTime()})},Repo.prototype.onDataUpdate_=function(pathString,data,isMerge,tag){this.dataUpdateCount++;var path=new Path_1.Path(pathString);data=this.interceptServerDataCallback_?this.interceptServerDataCallback_(pathString,data):data;var events=[];if(tag)if(isMerge){var taggedChildren=util_3.map(data,function(raw){return nodeFromJSON_1.nodeFromJSON(raw)});events=this.serverSyncTree_.applyTaggedQueryMerge(path,taggedChildren,tag)}else{var taggedSnap=nodeFromJSON_1.nodeFromJSON(data);events=this.serverSyncTree_.applyTaggedQueryOverwrite(path,taggedSnap,tag)}else if(isMerge){var changedChildren=util_3.map(data,function(raw){return nodeFromJSON_1.nodeFromJSON(raw)});events=this.serverSyncTree_.applyServerMerge(path,changedChildren)}else{var snap=nodeFromJSON_1.nodeFromJSON(data);events=this.serverSyncTree_.applyServerOverwrite(path,snap)}var affectedPath=path;events.length>0&&(affectedPath=this.rerunTransactions_(path)),this.eventQueue_.raiseEventsForChangedPath(affectedPath,events)},Repo.prototype.interceptServerData_=function(callback){this.interceptServerDataCallback_=callback},Repo.prototype.onConnectStatus_=function(connectStatus){this.updateInfo_("connected",connectStatus),!1===connectStatus&&this.runOnDisconnectEvents_()},Repo.prototype.onServerInfoUpdate_=function(updates){var _this=this;util_2.each(updates,function(value,key){_this.updateInfo_(key,value)})},Repo.prototype.updateInfo_=function(pathString,value){var path=new Path_1.Path("/.info/"+pathString),newNode=nodeFromJSON_1.nodeFromJSON(value);this.infoData_.updateSnapshot(path,newNode);var events=this.infoSyncTree_.applyServerOverwrite(path,newNode);this.eventQueue_.raiseEventsForChangedPath(path,events)},Repo.prototype.getNextWriteId_=function(){return this.nextWriteId_++},Repo.prototype.setWithPriority=function(path,newVal,newPriority,onComplete){var _this=this;this.log_("set",{path:path.toString(),value:newVal,priority:newPriority});var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(newVal,newPriority),newNode=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues),writeId=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserOverwrite(path,newNode,writeId,!0);this.eventQueue_.queueEvents(events),this.server_.put(path.toString(),newNodeUnresolved.val(!0),function(status,errorReason){var success="ok"===status;success||util_2.warn("set at "+path+" failed: "+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId,!success);_this.eventQueue_.raiseEventsForChangedPath(path,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)});var affectedPath=this.abortTransactions_(path);this.rerunTransactions_(affectedPath),this.eventQueue_.raiseEventsForChangedPath(affectedPath,[])},Repo.prototype.update=function(path,childrenToMerge,onComplete){var _this=this;this.log_("update",{path:path.toString(),value:childrenToMerge});var empty=!0,serverValues=this.generateServerValues(),changedChildren={};if(util_3.forEach(childrenToMerge,function(changedKey,changedValue){empty=!1;var newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(changedValue);changedChildren[changedKey]=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues)}),empty)util_2.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(onComplete,"ok");else{var writeId_1=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserMerge(path,changedChildren,writeId_1);this.eventQueue_.queueEvents(events),this.server_.merge(path.toString(),childrenToMerge,function(status,errorReason){var success="ok"===status;success||util_2.warn("update at "+path+" failed: "+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId_1,!success),affectedPath=clearEvents.length>0?_this.rerunTransactions_(path):path;_this.eventQueue_.raiseEventsForChangedPath(affectedPath,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)}),util_3.forEach(childrenToMerge,function(changedPath){var affectedPath=_this.abortTransactions_(path.child(changedPath));_this.rerunTransactions_(affectedPath)}),this.eventQueue_.raiseEventsForChangedPath(path,[])}},Repo.prototype.runOnDisconnectEvents_=function(){var _this=this;this.log_("onDisconnectEvents");var serverValues=this.generateServerValues(),resolvedOnDisconnectTree=ServerValues_1.resolveDeferredValueTree(this.onDisconnect_,serverValues),events=[];resolvedOnDisconnectTree.forEachTree(Path_1.Path.Empty,function(path,snap){events=events.concat(_this.serverSyncTree_.applyServerOverwrite(path,snap));var affectedPath=_this.abortTransactions_(path);_this.rerunTransactions_(affectedPath)}),this.onDisconnect_=new SparseSnapshotTree_1.SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(Path_1.Path.Empty,events)},Repo.prototype.onDisconnectCancel=function(path,onComplete){var _this=this;this.server_.onDisconnectCancel(path.toString(),function(status,errorReason){"ok"===status&&_this.onDisconnect_.forget(path),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectSet=function(path,value,onComplete){var _this=this,newNode=nodeFromJSON_1.nodeFromJSON(value);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),function(status,errorReason){"ok"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectSetWithPriority=function(path,value,priority,onComplete){var _this=this,newNode=nodeFromJSON_1.nodeFromJSON(value,priority);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),function(status,errorReason){"ok"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectUpdate=function(path,childrenToMerge,onComplete){var _this=this;if(util_3.isEmpty(childrenToMerge))return util_2.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(onComplete,"ok");this.server_.onDisconnectMerge(path.toString(),childrenToMerge,function(status,errorReason){"ok"===status&&util_3.forEach(childrenToMerge,function(childName,childNode){var newChildNode=nodeFromJSON_1.nodeFromJSON(childNode);_this.onDisconnect_.remember(path.child(childName),newChildNode)}),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.addEventCallbackForQuery=function(query,eventRegistration){var events;events=".info"===query.path.getFront()?this.infoSyncTree_.addEventRegistration(query,eventRegistration):this.serverSyncTree_.addEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.removeEventCallbackForQuery=function(query,eventRegistration){var events;events=".info"===query.path.getFront()?this.infoSyncTree_.removeEventRegistration(query,eventRegistration):this.serverSyncTree_.removeEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},Repo.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},Repo.prototype.stats=function(showDelta){if(void 0===showDelta&&(showDelta=!1),"undefined"!=typeof console){var stats;showDelta?(this.statsListener_||(this.statsListener_=new StatsListener_1.StatsListener(this.stats_)),stats=this.statsListener_.get()):stats=this.stats_.get();var longestName=Object.keys(stats).reduce(function(previousValue,currentValue){return Math.max(currentValue.length,previousValue)},0);util_3.forEach(stats,function(stat,value){for(var i=stat.length;i<longestName+2;i++)stat+=" ";console.log(stat+value)})}},Repo.prototype.statsIncrementCounter=function(metric){this.stats_.incrementCounter(metric),this.statsReporter_.includeStat(metric)},Repo.prototype.log_=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var prefix="";this.persistentConnection_&&(prefix=this.persistentConnection_.id+":"),util_2.log.apply(void 0,[prefix].concat(var_args))},Repo.prototype.callOnCompleteCallback=function(callback,status,errorReason){callback&&util_2.exceptionGuard(function(){if("ok"==status)callback(null);else{var code=(status||"error").toUpperCase(),message=code;errorReason&&(message+=": "+errorReason);var error=new Error(message);error.code=code,callback(error)}})},Object.defineProperty(Repo.prototype,"database",{get:function(){return this.__database||(this.__database=new Database_1.Database(this))},enumerable:!0,configurable:!0}),Repo}();exports.Repo=Repo},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var CacheNode=function(){function CacheNode(node_,fullyInitialized_,filtered_){this.node_=node_,this.fullyInitialized_=fullyInitialized_,this.filtered_=filtered_}return CacheNode.prototype.isFullyInitialized=function(){return this.fullyInitialized_},CacheNode.prototype.isFiltered=function(){return this.filtered_},CacheNode.prototype.isCompleteForPath=function(path){if(path.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var childKey=path.getFront();return this.isCompleteForChild(childKey)},CacheNode.prototype.isCompleteForChild=function(key){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(key)},CacheNode.prototype.getNode=function(){return this.node_},CacheNode}();exports.CacheNode=CacheNode},function(module,__webpack_exports__,__webpack_require__){"use strict";var CODES={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},ERROR_MAP=(_a={},_a[CODES.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",_a[CODES.AVAILABLE_IN_SW]="This method is available in a service worker context.",_a[CODES.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",_a[CODES.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",_a[CODES.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",_a[CODES.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",_a[CODES.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",_a[CODES.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",_a[CODES.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",_a[CODES.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",_a[CODES.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",_a[CODES.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",_a[CODES.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",_a[CODES.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",_a[CODES.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",_a[CODES.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",_a[CODES.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",_a[CODES.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",_a[CODES.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",_a[CODES.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",_a[CODES.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",_a[CODES.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",_a[CODES.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",_a[CODES.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",_a[CODES.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",_a[CODES.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",_a[CODES.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",_a[CODES.BAD_SCOPE]="The service worker scope must be a string with at least one character.",_a[CODES.BAD_VAPID_KEY]="The public VAPID key must be a string with at least one character.",_a[CODES.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",_a[CODES.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",_a[CODES.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",_a[CODES.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",_a);__webpack_exports__.a={codes:CODES,map:ERROR_MAP};var _a},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",function(){return domainBase}),__webpack_require__.d(__webpack_exports__,"g",function(){return downloadBase}),__webpack_require__.d(__webpack_exports__,"a",function(){return apiBaseUrl}),__webpack_require__.d(__webpack_exports__,"b",function(){return apiUploadBaseUrl}),__webpack_require__.d(__webpack_exports__,"c",function(){return configOption}),__webpack_require__.d(__webpack_exports__,"d",function(){return defaultMaxOperationRetryTime}),__webpack_require__.d(__webpack_exports__,"e",function(){return defaultMaxUploadRetryTime}),__webpack_require__.d(__webpack_exports__,"h",function(){return minSafeInteger});var domainBase="https://firebasestorage.googleapis.com",downloadBase="https://firebasestorage.googleapis.com",apiBaseUrl="/v0",apiUploadBaseUrl="/v0",configOption="storageBucket",defaultMaxOperationRetryTime=12e4,defaultMaxUploadRetryTime=6e4,minSafeInteger=-9007199254740991},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Location});var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(15),Location=function(){function Location(bucket,path){this.bucket=bucket,this.path_=path}return Object.defineProperty(Location.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Location.prototype.fullServerUrl=function(){var encode=encodeURIComponent;return"/b/"+encode(this.bucket)+"/o/"+encode(this.path)},Location.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},Location.makeFromBucketSpec=function(bucketString){var bucketLocation;try{bucketLocation=Location.makeFromUrl(bucketString)}catch(e){return new Location(bucketString,"")}if(""===bucketLocation.path)return bucketLocation;throw __WEBPACK_IMPORTED_MODULE_0__error__.h(bucketString)},Location.makeFromUrl=function(url){function gsModify(loc){"/"===loc.path.charAt(loc.path.length-1)&&(loc.path_=loc.path_.slice(0,-1))}function httpModify(loc){loc.path_=decodeURIComponent(loc.path)}for(var location=null,gsRegex=new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),gsIndices={bucket:1,path:3},httpRegex=new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),httpIndices={bucket:1,path:3},groups=[{regex:gsRegex,indices:gsIndices,postModify:gsModify},{regex:httpRegex,indices:httpIndices,postModify:httpModify}],i=0;i<groups.length;i++){var group=groups[i],captures=group.regex.exec(url);if(captures){var bucketValue=captures[group.indices.bucket],pathValue=captures[group.indices.path];pathValue||(pathValue=""),location=new Location(bucketValue,pathValue),group.postModify(location);break}}if(null==location)throw __WEBPACK_IMPORTED_MODULE_0__error__.k(url);return location},Location}()},function(module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},_this=this;Object.defineProperty(exports,"__esModule",{value:!0});var firebase,easydeps_1=__webpack_require__(14),Firebase=__webpack_require__(119),object_1=__webpack_require__(3);easydeps_1.default.getInstance();exports.push=function(ref,data){return firebase.database().ref(ref).push(data)},exports.transaction=function(ref,init,mutate,after){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new Promise(function(resolve,reject){return firebase.database().ref(ref).transaction(function(old){return null===old?object_1.exec(init):object_1.exec(mutate,old)},function(err,committed,snapshot){object_1.exec(after,err,committed,snapshot),err?reject(err):resolve(snapshot)},!0)})]})})},exports.get=function(ref,onchange){if(!onchange)return firebase.database().ref(ref).once("value");firebase.database().ref(ref).on("value",onchange)},exports.default=function(firebaseConfig){return firebase=Firebase.initializeApp(firebaseConfig)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var onDisconnect_1=__webpack_require__(69),TransactionResult_1=__webpack_require__(144),util_1=__webpack_require__(1),NextPushId_1=__webpack_require__(145),Query_1=__webpack_require__(70),Repo_1=__webpack_require__(39),Path_1=__webpack_require__(4),QueryParams_1=__webpack_require__(169),validation_1=__webpack_require__(19),util_2=__webpack_require__(0),util_3=__webpack_require__(0),SyncPoint_1=__webpack_require__(81),Reference=function(_super){function Reference(repo,path){if(!(repo instanceof Repo_1.Repo))throw new Error("new Reference() no longer supported - use app.database().");return _super.call(this,repo,path,QueryParams_1.QueryParams.DEFAULT,!1)||this}return __extends(Reference,_super),Reference.prototype.getKey=function(){return util_2.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},Reference.prototype.child=function(pathString){return util_2.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof pathString?pathString=String(pathString):pathString instanceof Path_1.Path||(null===this.path.getFront()?validation_1.validateRootPathString("Reference.child",1,pathString,!1):validation_1.validatePathString("Reference.child",1,pathString,!1)),new Reference(this.repo,this.path.child(pathString))},Reference.prototype.getParent=function(){util_2.validateArgCount("Reference.parent",0,0,arguments.length);var parentPath=this.path.parent();return null===parentPath?null:new Reference(this.repo,parentPath)},Reference.prototype.getRoot=function(){util_2.validateArgCount("Reference.root",0,0,arguments.length);for(var ref=this;null!==ref.getParent();)ref=ref.getParent();return ref},Reference.prototype.databaseProp=function(){return this.repo.database},Reference.prototype.set=function(newVal,onComplete){util_2.validateArgCount("Reference.set",1,2,arguments.length),validation_1.validateWritablePath("Reference.set",this.path),validation_1.validateFirebaseDataArg("Reference.set",1,newVal,this.path,!1),util_2.validateCallback("Reference.set",2,onComplete,!0);var deferred=new util_3.Deferred;return this.repo.setWithPriority(this.path,newVal,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.update=function(objectToMerge,onComplete){if(util_2.validateArgCount("Reference.update",1,2,arguments.length),validation_1.validateWritablePath("Reference.update",this.path),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[""+i]=objectToMerge[i];objectToMerge=newObjectToMerge,util_1.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validation_1.validateFirebaseMergeDataArg("Reference.update",1,objectToMerge,this.path,!1),util_2.validateCallback("Reference.update",2,onComplete,!0);var deferred=new util_3.Deferred;return this.repo.update(this.path,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.setWithPriority=function(newVal,newPriority,onComplete){if(util_2.validateArgCount("Reference.setWithPriority",2,3,arguments.length),validation_1.validateWritablePath("Reference.setWithPriority",this.path),validation_1.validateFirebaseDataArg("Reference.setWithPriority",1,newVal,this.path,!1),validation_1.validatePriority("Reference.setWithPriority",2,newPriority,!1),util_2.validateCallback("Reference.setWithPriority",3,onComplete,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var deferred=new util_3.Deferred;return this.repo.setWithPriority(this.path,newVal,newPriority,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.remove=function(onComplete){return util_2.validateArgCount("Reference.remove",0,1,arguments.length),validation_1.validateWritablePath("Reference.remove",this.path),util_2.validateCallback("Reference.remove",1,onComplete,!0),this.set(null,onComplete)},Reference.prototype.transaction=function(transactionUpdate,onComplete,applyLocally){if(util_2.validateArgCount("Reference.transaction",1,3,arguments.length),validation_1.validateWritablePath("Reference.transaction",this.path),util_2.validateCallback("Reference.transaction",1,transactionUpdate,!1),util_2.validateCallback("Reference.transaction",2,onComplete,!0),validation_1.validateBoolean("Reference.transaction",3,applyLocally,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===applyLocally&&(applyLocally=!0);var deferred=new util_3.Deferred;"function"==typeof onComplete&&deferred.promise.catch(function(){});var promiseComplete=function(error,committed,snapshot){error?deferred.reject(error):deferred.resolve(new TransactionResult_1.TransactionResult(committed,snapshot)),"function"==typeof onComplete&&onComplete(error,committed,snapshot)};return this.repo.startTransaction(this.path,transactionUpdate,promiseComplete,applyLocally),deferred.promise},Reference.prototype.setPriority=function(priority,onComplete){util_2.validateArgCount("Reference.setPriority",1,2,arguments.length),validation_1.validateWritablePath("Reference.setPriority",this.path),validation_1.validatePriority("Reference.setPriority",1,priority,!1),util_2.validateCallback("Reference.setPriority",2,onComplete,!0);var deferred=new util_3.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),priority,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.push=function(value,onComplete){util_2.validateArgCount("Reference.push",0,2,arguments.length),validation_1.validateWritablePath("Reference.push",this.path),validation_1.validateFirebaseDataArg("Reference.push",1,value,this.path,!0),util_2.validateCallback("Reference.push",2,onComplete,!0);var promise,now=this.repo.serverTime(),name=NextPushId_1.nextPushId(now),thennablePushRef=this.child(name),pushRef=this.child(name);return promise=null!=value?thennablePushRef.set(value,onComplete).then(function(){return pushRef}):Promise.resolve(pushRef),thennablePushRef.then=promise.then.bind(promise),thennablePushRef.catch=promise.then.bind(promise,void 0),"function"==typeof onComplete&&promise.catch(function(){}),thennablePushRef},Reference.prototype.onDisconnect=function(){return validation_1.validateWritablePath("Reference.onDisconnect",this.path),new onDisconnect_1.OnDisconnect(this.repo,this.path)},Object.defineProperty(Reference.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),Reference}(Query_1.Query);exports.Reference=Reference,Query_1.Query.__referenceConstructor=Reference,SyncPoint_1.SyncPoint.__referenceConstructor=Reference},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),validation_1=__webpack_require__(19),Path_1=__webpack_require__(4),PriorityIndex_1=__webpack_require__(8),DataSnapshot=function(){function DataSnapshot(node_,ref_,index_){this.node_=node_,this.ref_=ref_,this.index_=index_}return DataSnapshot.prototype.val=function(){return util_1.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},DataSnapshot.prototype.exportVal=function(){return util_1.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},DataSnapshot.prototype.toJSON=function(){return util_1.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},DataSnapshot.prototype.exists=function(){return util_1.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},DataSnapshot.prototype.child=function(childPathString){util_1.validateArgCount("DataSnapshot.child",0,1,arguments.length),childPathString=String(childPathString),validation_1.validatePathString("DataSnapshot.child",1,childPathString,!1);var childPath=new Path_1.Path(childPathString),childRef=this.ref_.child(childPath);return new DataSnapshot(this.node_.getChild(childPath),childRef,PriorityIndex_1.PRIORITY_INDEX)},DataSnapshot.prototype.hasChild=function(childPathString){util_1.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validation_1.validatePathString("DataSnapshot.hasChild",1,childPathString,!1);var childPath=new Path_1.Path(childPathString);return!this.node_.getChild(childPath).isEmpty()},DataSnapshot.prototype.getPriority=function(){return util_1.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},DataSnapshot.prototype.forEach=function(action){var _this=this;return util_1.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),util_1.validateCallback("DataSnapshot.forEach",1,action,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(key,node){return action(new DataSnapshot(node,_this.ref_.child(key),PriorityIndex_1.PRIORITY_INDEX))})},DataSnapshot.prototype.hasChildren=function(){return util_1.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(DataSnapshot.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),DataSnapshot.prototype.numChildren=function(){return util_1.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},DataSnapshot.prototype.getRef=function(){return util_1.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(DataSnapshot.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),DataSnapshot}();exports.DataSnapshot=DataSnapshot},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var emptyChildrenSingleton,SortedMap_1=__webpack_require__(38),Path_1=__webpack_require__(4),util_1=__webpack_require__(1),util_2=__webpack_require__(0),EmptyChildren=function(){return emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap_1.SortedMap(util_1.stringCompare)),emptyChildrenSingleton},ImmutableTree=function(){function ImmutableTree(value,children){void 0===children&&(children=EmptyChildren()),this.value=value,this.children=children}return ImmutableTree.fromObject=function(obj){var tree=ImmutableTree.Empty;return util_2.forEach(obj,function(childPath,childSnap){tree=tree.set(new Path_1.Path(childPath),childSnap)}),tree},ImmutableTree.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},ImmutableTree.prototype.findRootMostMatchingPathAndValue=function(relativePath,predicate){if(null!=this.value&&predicate(this.value))return{path:Path_1.Path.Empty,value:this.value};if(relativePath.isEmpty())return null;var front=relativePath.getFront(),child=this.children.get(front);if(null!==child){var childExistingPathAndValue=child.findRootMostMatchingPathAndValue(relativePath.popFront(),predicate);if(null!=childExistingPathAndValue){return{path:new Path_1.Path(front).child(childExistingPathAndValue.path),value:childExistingPathAndValue.value}}return null}return null},ImmutableTree.prototype.findRootMostValueAndPath=function(relativePath){return this.findRootMostMatchingPathAndValue(relativePath,function(){return!0})},ImmutableTree.prototype.subtree=function(relativePath){if(relativePath.isEmpty())return this;var front=relativePath.getFront(),childTree=this.children.get(front);return null!==childTree?childTree.subtree(relativePath.popFront()):ImmutableTree.Empty},ImmutableTree.prototype.set=function(relativePath,toSet){if(relativePath.isEmpty())return new ImmutableTree(toSet,this.children);var front=relativePath.getFront(),child=this.children.get(front)||ImmutableTree.Empty,newChild=child.set(relativePath.popFront(),toSet),newChildren=this.children.insert(front,newChild);return new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.remove=function(relativePath){if(relativePath.isEmpty())return this.children.isEmpty()?ImmutableTree.Empty:new ImmutableTree(null,this.children);var front=relativePath.getFront(),child=this.children.get(front);if(child){var newChild=child.remove(relativePath.popFront()),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),null===this.value&&newChildren.isEmpty()?ImmutableTree.Empty:new ImmutableTree(this.value,newChildren)}return this},ImmutableTree.prototype.get=function(relativePath){if(relativePath.isEmpty())return this.value;var front=relativePath.getFront(),child=this.children.get(front);return child?child.get(relativePath.popFront()):null},ImmutableTree.prototype.setTree=function(relativePath,newTree){if(relativePath.isEmpty())return newTree;var front=relativePath.getFront(),child=this.children.get(front)||ImmutableTree.Empty,newChild=child.setTree(relativePath.popFront(),newTree),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.fold=function(fn){return this.fold_(Path_1.Path.Empty,fn)},ImmutableTree.prototype.fold_=function(pathSoFar,fn){var accum={};return this.children.inorderTraversal(function(childKey,childTree){accum[childKey]=childTree.fold_(pathSoFar.child(childKey),fn)}),fn(pathSoFar,this.value,accum)},ImmutableTree.prototype.findOnPath=function(path,f){return this.findOnPath_(path,Path_1.Path.Empty,f)},ImmutableTree.prototype.findOnPath_=function(pathToFollow,pathSoFar,f){var result=!!this.value&&f(pathSoFar,this.value);if(result)return result;if(pathToFollow.isEmpty())return null;var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.findOnPath_(pathToFollow.popFront(),pathSoFar.child(front),f):null},ImmutableTree.prototype.foreachOnPath=function(path,f){return this.foreachOnPath_(path,Path_1.Path.Empty,f)},ImmutableTree.prototype.foreachOnPath_=function(pathToFollow,currentRelativePath,f){if(pathToFollow.isEmpty())return this;this.value&&f(currentRelativePath,this.value);var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.foreachOnPath_(pathToFollow.popFront(),currentRelativePath.child(front),f):ImmutableTree.Empty},ImmutableTree.prototype.foreach=function(f){this.foreach_(Path_1.Path.Empty,f)},ImmutableTree.prototype.foreach_=function(currentRelativePath,f){this.children.inorderTraversal(function(childName,childTree){childTree.foreach_(currentRelativePath.child(childName),f)}),this.value&&f(currentRelativePath,this.value)},ImmutableTree.prototype.foreachChild=function(f){this.children.inorderTraversal(function(childName,childTree){childTree.value&&f(childName,childTree.value)})},ImmutableTree.Empty=new ImmutableTree(null),ImmutableTree}();exports.ImmutableTree=ImmutableTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Change_1=__webpack_require__(24),ChildrenNode_1=__webpack_require__(10),PriorityIndex_1=__webpack_require__(8),IndexedFilter=function(){function IndexedFilter(index_){this.index_=index_}return IndexedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){util_1.assert(snap.isIndexed(this.index_),"A node must be indexed if only a child is updated");var oldChild=snap.getImmediateChild(key);return oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))&&oldChild.isEmpty()==newChild.isEmpty()?snap:(null!=optChangeAccumulator&&(newChild.isEmpty()?snap.hasChild(key)?optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key,oldChild)):util_1.assert(snap.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):oldChild.isEmpty()?optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key,newChild)):optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key,newChild,oldChild))),snap.isLeafNode()&&newChild.isEmpty()?snap:snap.updateImmediateChild(key,newChild).withIndex(this.index_))},IndexedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){return null!=optChangeAccumulator&&(oldSnap.isLeafNode()||oldSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){newSnap.hasChild(key)||optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key,childNode))}),newSnap.isLeafNode()||newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){if(oldSnap.hasChild(key)){var oldChild=oldSnap.getImmediateChild(key);oldChild.equals(childNode)||optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key,childNode,oldChild))}else optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key,childNode))})),newSnap.withIndex(this.index_)},IndexedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap.isEmpty()?ChildrenNode_1.ChildrenNode.EMPTY_NODE:oldSnap.updatePriority(newPriority)},IndexedFilter.prototype.filtersNodes=function(){return!1},IndexedFilter.prototype.getIndexedFilter=function(){return this},IndexedFilter.prototype.getIndex=function(){return this.index_},IndexedFilter}();exports.IndexedFilter=IndexedFilter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var StatsCollection_1=__webpack_require__(161),StatsManager=function(){function StatsManager(){}return StatsManager.getCollection=function(repoInfo){var hashString=repoInfo.toString();return this.collections_[hashString]||(this.collections_[hashString]=new StatsCollection_1.StatsCollection),this.collections_[hashString]},StatsManager.getOrCreateReporter=function(repoInfo,creatorFunction){var hashString=repoInfo.toString();return this.reporters_[hashString]||(this.reporters_[hashString]=creatorFunction()),this.reporters_[hashString]},StatsManager.collections_={},StatsManager.reporters_={},StatsManager}();exports.StatsManager=StatsManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Repo_1=__webpack_require__(39),util_2=__webpack_require__(1),parser_1=__webpack_require__(67),validation_1=__webpack_require__(19);__webpack_require__(171);var _staticInstance,RepoManager=function(){function RepoManager(){this.repos_={},this.useRestClient_=!1}return RepoManager.getInstance=function(){return _staticInstance||(_staticInstance=new RepoManager),_staticInstance},RepoManager.prototype.interrupt=function(){for(var appName in this.repos_)for(var dbUrl in this.repos_[appName])this.repos_[appName][dbUrl].interrupt()},RepoManager.prototype.resume=function(){for(var appName in this.repos_)for(var dbUrl in this.repos_[appName])this.repos_[appName][dbUrl].resume()},RepoManager.prototype.databaseFromApp=function(app,url){var dbUrl=url||app.options.databaseURL;void 0===dbUrl&&util_2.fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var parsedUrl=parser_1.parseRepoInfo(dbUrl),repoInfo=parsedUrl.repoInfo;return validation_1.validateUrl("Invalid Firebase Database URL",1,parsedUrl),parsedUrl.path.isEmpty()||util_2.fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(repoInfo,app).database},RepoManager.prototype.deleteRepo=function(repo){var appRepos=util_1.safeGet(this.repos_,repo.app.name);appRepos&&util_1.safeGet(appRepos,repo.repoInfo_.toURLString())===repo||util_2.fatal("Database "+repo.app.name+"("+repo.repoInfo_+") has already been deleted."),repo.interrupt(),delete appRepos[repo.repoInfo_.toURLString()]},RepoManager.prototype.createRepo=function(repoInfo,app){var appRepos=util_1.safeGet(this.repos_,app.name);appRepos||(appRepos={},this.repos_[app.name]=appRepos);var repo=util_1.safeGet(appRepos,repoInfo.toURLString());return repo&&util_2.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),repo=new Repo_1.Repo(repoInfo,this.useRestClient_,app),appRepos[repoInfo.toURLString()]=repo,repo},RepoManager.prototype.forceRestClient=function(forceRestClient){this.useRestClient_=forceRestClient},RepoManager}();exports.RepoManager=RepoManager},function(module,__webpack_exports__,__webpack_require__){"use strict";function validate(name,specs,passed){for(var minArgs=specs.length,maxArgs=specs.length,i=0;i<specs.length;i++)if(specs[i].optional){minArgs=i;break}if(!(minArgs<=passed.length&&passed.length<=maxArgs))throw __WEBPACK_IMPORTED_MODULE_0__error__.g(minArgs,maxArgs,name,passed.length);for(var i=0;i<passed.length;i++)try{specs[i].validator(passed[i])}catch(e){throw e instanceof Error?__WEBPACK_IMPORTED_MODULE_0__error__.f(i,name,e.message):__WEBPACK_IMPORTED_MODULE_0__error__.f(i,name,e)}}function and_(v1,v2){return function(p){v1(p),v2(p)}}function stringSpec(opt_validator,opt_optional){function stringValidator(p){if(!__WEBPACK_IMPORTED_MODULE_2__type__.j(p))throw"Expected string."}var validator;return validator=opt_validator?and_(stringValidator,opt_validator):stringValidator,new ArgSpec(validator,opt_optional)}function uploadDataSpec(){function validator(p){if(!(p instanceof Uint8Array||p instanceof ArrayBuffer||__WEBPACK_IMPORTED_MODULE_2__type__.e()&&p instanceof Blob))throw"Expected Blob or File."}return new ArgSpec(validator)}function metadataSpec(opt_optional){return new ArgSpec(__WEBPACK_IMPORTED_MODULE_1__metadata__.c,opt_optional)}function nonNegativeNumberSpec(){function validator(p){if(!(__WEBPACK_IMPORTED_MODULE_2__type__.h(p)&&p>=0))throw"Expected a number 0 or greater."}return new ArgSpec(validator)}function looseObjectSpec(opt_validator,opt_optional){function validator(p){if(!(null===p||__WEBPACK_IMPORTED_MODULE_2__type__.a(p)&&p instanceof Object))throw"Expected an Object.";void 0!==opt_validator&&null!==opt_validator&&opt_validator(p)}return new ArgSpec(validator,opt_optional)}function nullFunctionSpec(opt_optional){function validator(p){if(null!==p&&!__WEBPACK_IMPORTED_MODULE_2__type__.b(p))throw"Expected a Function."}return new ArgSpec(validator,opt_optional)}__webpack_exports__.g=validate,__webpack_exports__.e=stringSpec,__webpack_exports__.f=uploadDataSpec,__webpack_exports__.b=metadataSpec,__webpack_exports__.c=nonNegativeNumberSpec,__webpack_exports__.a=looseObjectSpec,__webpack_exports__.d=nullFunctionSpec;var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_1__metadata__=__webpack_require__(54),__WEBPACK_IMPORTED_MODULE_2__type__=__webpack_require__(12),ArgSpec=function(){function ArgSpec(validator,opt_optional){var self=this;this.validator=function(p){self.optional&&!__WEBPACK_IMPORTED_MODULE_2__type__.c(p)||validator(p)},this.optional=!!opt_optional}return ArgSpec}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function noXform_(metadata,value){return value}function xformPath(fullPath){return!__WEBPACK_IMPORTED_MODULE_3__type__.j(fullPath)||fullPath.length<2?fullPath:(fullPath=fullPath,__WEBPACK_IMPORTED_MODULE_2__path__.b(fullPath))}function getMappings(){function mappingsXformPath(metadata,fullPath){return xformPath(fullPath)}function xformSize(metadata,size){return __WEBPACK_IMPORTED_MODULE_3__type__.a(size)?+size:size}function xformTokens(metadata,tokens){if(!(__WEBPACK_IMPORTED_MODULE_3__type__.j(tokens)&&tokens.length>0))return[];var encode=encodeURIComponent;return tokens.split(",").map(function(token){var bucket=metadata.bucket,path=metadata.fullPath,urlPart="/b/"+encode(bucket)+"/o/"+encode(path);return __WEBPACK_IMPORTED_MODULE_4__url__.a(urlPart)+__WEBPACK_IMPORTED_MODULE_4__url__.c({alt:"media",token:token})})}if(mappings_)return mappings_;var mappings=[];mappings.push(new Mapping("bucket")),mappings.push(new Mapping("generation")),mappings.push(new Mapping("metageneration")),mappings.push(new Mapping("name","fullPath",!0));var nameMapping=new Mapping("name");nameMapping.xform=mappingsXformPath,mappings.push(nameMapping);var sizeMapping=new Mapping("size");return sizeMapping.xform=xformSize,mappings.push(sizeMapping),mappings.push(new Mapping("timeCreated")),mappings.push(new Mapping("updated")),mappings.push(new Mapping("md5Hash",null,!0)),mappings.push(new Mapping("cacheControl",null,!0)),mappings.push(new Mapping("contentDisposition",null,!0)),mappings.push(new Mapping("contentEncoding",null,!0)),mappings.push(new Mapping("contentLanguage",null,!0)),mappings.push(new Mapping("contentType",null,!0)),mappings.push(new Mapping("metadata","customMetadata",!0)),mappings.push(new Mapping("downloadTokens","downloadURLs",!1,xformTokens)),mappings_=mappings}function addRef(metadata,authWrapper){function generateRef(){var bucket=metadata.bucket,path=metadata.fullPath,loc=new __WEBPACK_IMPORTED_MODULE_1__location__.a(bucket,path);return authWrapper.makeStorageReference(loc)}Object.defineProperty(metadata,"ref",{get:generateRef})}function fromResource(authWrapper,resource,mappings){var metadata={};metadata.type="file";for(var len=mappings.length,i=0;i<len;i++){var mapping=mappings[i];metadata[mapping.local]=mapping.xform(metadata,resource[mapping.server])}return addRef(metadata,authWrapper),metadata}function fromResourceString(authWrapper,resourceString,mappings){var obj=__WEBPACK_IMPORTED_MODULE_0__json__.a(resourceString);return null===obj?null:fromResource(authWrapper,obj,mappings)}function toResourceString(metadata,mappings){for(var resource={},len=mappings.length,i=0;i<len;i++){var mapping=mappings[i];mapping.writable&&(resource[mapping.server]=metadata[mapping.local])}return JSON.stringify(resource)}function metadataValidator(p){if(!p||!__WEBPACK_IMPORTED_MODULE_3__type__.i(p))throw"Expected Metadata object.";for(var key in p){var val=p[key];if("customMetadata"===key){if(!__WEBPACK_IMPORTED_MODULE_3__type__.i(val))throw"Expected object for 'customMetadata' mapping."}else if(__WEBPACK_IMPORTED_MODULE_3__type__.g(val))throw"Mapping for '"+key+"' cannot be an object."}}__webpack_exports__.b=getMappings,__webpack_exports__.a=fromResourceString,__webpack_exports__.d=toResourceString,__webpack_exports__.c=metadataValidator;var __WEBPACK_IMPORTED_MODULE_0__json__=__webpack_require__(186),__WEBPACK_IMPORTED_MODULE_1__location__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_2__path__=__webpack_require__(97),__WEBPACK_IMPORTED_MODULE_3__type__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_4__url__=__webpack_require__(55),Mapping=function(){function Mapping(server,opt_local,opt_writable,opt_xform){this.server=server,this.local=opt_local||server,this.writable=!!opt_writable,this.xform=opt_xform||noXform_}return Mapping}(),mappings_=null},function(module,__webpack_exports__,__webpack_require__){"use strict";function makeNormalUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__.f+__WEBPACK_IMPORTED_MODULE_0__constants__.a+urlPart}function makeDownloadUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__.g+__WEBPACK_IMPORTED_MODULE_0__constants__.a+urlPart}function makeUploadUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__.f+__WEBPACK_IMPORTED_MODULE_0__constants__.b+urlPart}function makeQueryString(params){var encode=encodeURIComponent,queryPart="?";return __WEBPACK_IMPORTED_MODULE_1__object__.b(params,function(key,val){var nextPart=encode(key)+"="+encode(val);queryPart=queryPart+nextPart+"&"}),queryPart=queryPart.slice(0,-1)}__webpack_exports__.b=makeNormalUrl,__webpack_exports__.a=makeDownloadUrl,__webpack_exports__.d=makeUploadUrl,__webpack_exports__.c=makeQueryString;var __WEBPACK_IMPORTED_MODULE_0__constants__=__webpack_require__(42),__WEBPACK_IMPORTED_MODULE_1__object__=__webpack_require__(25)},function(module,__webpack_exports__,__webpack_require__){"use strict";function contains(array,elem){return-1!==array.indexOf(elem)}function clone(arraylike){return Array.prototype.slice.call(arraylike)}function remove(array,elem){var i=array.indexOf(elem);-1!==i&&array.splice(i,1)}__webpack_exports__.b=contains,__webpack_exports__.a=clone,__webpack_exports__.c=remove},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var Store=__webpack_require__(101),cached={};exports.get=function(key,sync){return void 0===sync&&(sync=!0),void 0===key?cached:sync?(void 0===cached[key]&&(cached[key]=Store.get(key)),cached[key]):cached[key]},exports.clear=function(key,_a){var _b=void 0===_a?{local:!1,sync:!0}:_a,local=_b.local,sync=_b.sync;return void 0===key?(sync&&Store.clearAll(),local&&Object.keys(function(k){return delete cached[k]}),cached):(sync&&Store.remove(key),local&&delete cached[key],cached[key])},exports.add=function(key,data,sync){if(void 0===sync&&(sync=!0),exports.get(key,sync),void 0===cached[key])exports.set(key,data,data,sync);else if(Array.isArray(cached[key]))Array.isArray(data)?exports.set(key,cached[key].concat(data),data,sync):exports.set(key,cached[key].concat([data]),[data],sync);else{if("object"!=typeof cached[key]||null===cached[key])throw new Error("Cannot use add on a primitive data type");if("object"!=typeof data||null===data)throw new Error("Cannot add primitive data on an object, please wrap it in an object first");exports.set(key,__assign({},cached[key],data),data,sync)}return cached[key]},exports.set=function(key,data,addition,sync){void 0===addition&&(addition=data),void 0===sync&&(sync=!0),cached[key]=data;var setData=function(k,a){try{return Store.set(key,addition),!0}catch(err){return!1}};if(!sync)return cached[key];if(!setData()){if(!0===confirm("LocalStorage is full. Do you want te clear the locally stored "+(key||"data")+"?")&&(Store.remove(key),!setData())){!0===confirm("LocalStorage is full. Do you want te clear all locally stored data?")&&(Store.clearAll(),setData()||alert("The data is to big to add to the LocalStorage. The data will not be persistent."))}}return cached[key]}},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),dom_1=__webpack_require__(7),object_1=__webpack_require__(3),HolderContent_1=__webpack_require__(215),Holder=function(){function Holder(){}return Holder.prototype.view=function(v){var h=v.attrs.holder;return m("div",{className:object_1.cleanString("holder",v.attrs.className,h.selected&&"selected"),style:exports.getHolderStyle(h,v.attrs.position),onclick:function(event){return object_1.exec(v.attrs.onclick,dom_1.devent(event))}},m(HolderContent_1.default,{holder:v.attrs.holder,thumb:v.attrs.thumb}))},Holder}();exports.default=Holder,exports.getHolderStyle=function(h,position){return void 0===position&&(position=h.position),__assign({},dom_1.getRectStyle(position),{position:"absolute",overflow:"hidden",whiteSpace:"pre",display:"flex",alignItems:"center",backgroundColor:h.content&&h.content.backgroundColor||"",opacity:h.content&&h.content.opacity||"",imageRendering:h.content&&h.content.pixelated?"pixelated":""})}},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),dom_1=__webpack_require__(7),object_1=__webpack_require__(3),Item_1=__webpack_require__(33);__webpack_require__(233);var areas={};exports.getAreas=function(type){return areas[type]||[]};var DragArea=function(){function DragArea(){this.items=[],this.type="main"}return DragArea.prototype.getBoundingClientRect=function(){return dom_1.getOuterRect(this.dom)},DragArea.prototype.setFocus=function(focus){return this.dom.classList[focus?"add":"remove"]("focus")},DragArea.prototype.setDisabled=function(disabled){return this.dom.classList[disabled?"add":"remove"]("disabled")},DragArea.prototype.getItems=function(){return this.items},DragArea.prototype.withinArea=function(itemRect,options){void 0===options&&(options={});var areaRect=this.getBoundingClientRect();return options.complete?itemRect.left>=areaRect.left&&itemRect.left+itemRect.width<=areaRect.left+areaRect.width&&itemRect.top>=areaRect.top&&itemRect.top+itemRect.height<=areaRect.top+areaRect.height:options.margin?itemRect.left+options.margin>=areaRect.left&&itemRect.left+itemRect.width-options.margin<=areaRect.left+areaRect.width&&itemRect.top+options.margin>=areaRect.top&&itemRect.top+itemRect.height-options.margin<=areaRect.top+areaRect.height:itemRect.left+itemRect.width>=areaRect.left&&itemRect.left<=areaRect.left+areaRect.width&&itemRect.top+itemRect.height>=areaRect.top&&itemRect.top<=areaRect.top+areaRect.height},DragArea.prototype.getConstraints=function(){return{grid:this.grid,constrain:this.constrain}},DragArea.prototype.onItemDrop=function(event,item,sourceArea){return object_1.exec(this.onareadrop,dom_1.devent(event),item,sourceArea,this)},DragArea.prototype.onItemHover=function(event,item,sourceArea,initial){return object_1.exec(this.onareahover,dom_1.devent(event),item,sourceArea,this,initial)},DragArea.prototype.onItemRemove=function(event,item){return object_1.exec(this.onarearemove,dom_1.devent(event),item,this)},DragArea.prototype.onbeforeupdate=function(vnode,old){return this.attrsChanged(vnode.attrs,old.attrs)},DragArea.prototype.onupdate=function(vnode){this.setState(vnode.attrs),this.setItems(vnode.children)},DragArea.prototype.oninit=function(vnode){this.setState(vnode.attrs)},DragArea.prototype.onremove=function(vnode){var dragAreas=exports.getAreas(this.type);dragAreas.splice(dragAreas.indexOf(this),1)},DragArea.prototype.oncreate=function(vnode){this.dom=vnode.dom,void 0===areas[this.type]&&(areas[this.type]=[]),areas[this.type].push(this),this.setItems(vnode.children)},DragArea.prototype.view=function(vnode){var _this=this;return m("div",{className:object_1.cleanString("component--DragArea",vnode.attrs.className),style:__assign({},vnode.attrs.style||{},dom_1.getRectStyle(vnode.attrs.position||{})),onclick:function(event){return object_1.exec(_this.onclick,dom_1.devent(event),_this)}},vnode.children)},DragArea.prototype.attrsChanged=function(next,prev){return next.className!==prev.className||next.onareadrop!==prev.onareadrop||next.onareahover!==prev.onareahover||next.onarearemove!==prev.onarearemove||next.grid!==prev.grid||next.constrain!==prev.constrain},DragArea.prototype.setState=function(attrs){var _this=this;Object.keys(attrs).forEach(function(key){return _this[key]=attrs[key]})},DragArea.prototype.setItems=function(children){var _this=this;Array.isArray(children)&&(this.items=[],children.forEach(function(v){"object"==typeof v&&null!==v&&!1===Array.isArray(v)&&v.state instanceof Item_1.default&&_this.items.push(v.state)}))},DragArea}();exports.default=DragArea},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),dom_1=__webpack_require__(7),object_1=__webpack_require__(3),controller_1=__webpack_require__(251);__webpack_require__(252);var Library=function(_super){function Library(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Library,_super),Library.prototype.oncreate=function(vnode){this.construct(),this.refresh(),object_1.exec(vnode.attrs.oncontainercreate,this.container)},Library.prototype.onupdate=function(vnode){this.refresh(),object_1.exec(vnode.attrs.oncontainercreate,this.container)},Library.prototype.onremove=function(vnode){this.destruct()},Library.prototype.view=function(vnode){var _this=this,children=vnode.children;return m("div",{className:object_1.cleanString("component--library",vnode.attrs.direction||"horizontal",vnode.attrs.className)},m("div",{oncreate:function(node){return _this.prev=node.dom},className:"nav prev",onclick:function(event){return dom_1.devent(event)&&_this.navigate(-1)}},"<"),m("div",{oncreate:function(node){return _this.container=node.dom},className:"items",onmousedown:function(event){return _this.startDragSlide(event)},ontouchstart:function(event){return _this.startDragSlide(event)}},children.map(function(child,index){return m("div",{className:"item",onclick:function(event){return object_1.exec(vnode.attrs.onclick,dom_1.devent(event),index)}},child)})),m("div",{oncreate:function(node){return _this.next=node.dom},className:"nav next",onclick:function(event){return dom_1.devent(event)&&_this.navigate(1)}},">"))},Library}(controller_1.default);exports.default=Library},function(module,exports,__webpack_require__){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var apply=Function.prototype.apply;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},__webpack_require__(112),exports.setImmediate=setImmediate,exports.clearImmediate=clearImmediate},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var constants_1=__webpack_require__(46);exports.assert=function(assertion,message){if(!assertion)throw exports.assertionError(message)},exports.assertionError=function(message){return new Error("Firebase Database ("+constants_1.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+message)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},byteArrayToString=function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(c1<128)out[c++]=String.fromCharCode(c1);else if(c1>191&&c1<224){var c2=bytes[pos++];out[c++]=String.fromCharCode((31&c1)<<6|63&c2)}else if(c1>239&&c1<365){var c2=bytes[pos++],c3=bytes[pos++],c4=bytes[pos++],u=((7&c1)<<18|(63&c2)<<12|(63&c3)<<6|63&c4)-65536;out[c++]=String.fromCharCode(55296+(u>>10)),out[c++]=String.fromCharCode(56320+(1023&u))}else{var c2=bytes[pos++],c3=bytes[pos++];out[c++]=String.fromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join("")};exports.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte1=byte1>>2,outByte2=(3&byte1)<<4|byte2>>4,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,haveByte2||(outByte3=64)),output.push(byteToCharMap[outByte1],byteToCharMap[outByte2],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join("")},encodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?atob(input):byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();for(var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],haveByte2=i<input.length,byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length,byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length,byte4=haveByte4?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();var outByte1=byte1<<2|byte2>>4;if(output.push(outByte1),64!=byte3){var outByte2=byte2<<4&240|byte3>>2;if(output.push(outByte2),64!=byte4){var outByte3=byte3<<6&192|byte4;output.push(outByte3)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return exports.base64.encodeByteArray(utf8Bytes,!0)},exports.base64Decode=function(str){try{return exports.base64.decodeString(str,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}},function(module,exports,__webpack_require__){"use strict";function jsonEval(str){return JSON.parse(str)}function stringify(data){return JSON.stringify(data)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.jsonEval=jsonEval,exports.stringify=stringify},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},exports.safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]},exports.forEach=function(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])},exports.extend=function(objTo,objFrom){return exports.forEach(objFrom,function(key,value){objTo[key]=value}),objTo},exports.clone=function(obj){return exports.extend({},obj)},exports.isNonNullObject=function(obj){return"object"==typeof obj&&null!==obj},exports.isEmpty=function(obj){for(var key in obj)return!1;return!0},exports.getCount=function(obj){var rv=0;for(var key in obj)rv++;return rv},exports.map=function(obj,f,opt_obj){var res={};for(var key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res},exports.findKey=function(obj,fn,opt_this){for(var key in obj)if(fn.call(opt_this,obj[key],key,obj))return key},exports.findValue=function(obj,fn,opt_this){var key=exports.findKey(obj,fn,opt_this);return key&&obj[key]},exports.getAnyKey=function(obj){for(var key in obj)return key},exports.getValues=function(obj){var res=[],i=0;for(var key in obj)res[i++]=obj[key];return res},exports.every=function(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&!fn(key,obj[key]))return!1;return!0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),parser_1=__webpack_require__(67),Path_1=__webpack_require__(4),Reference_1=__webpack_require__(47),Repo_1=__webpack_require__(39),RepoManager_1=__webpack_require__(52),util_2=__webpack_require__(0),validation_1=__webpack_require__(19),Database=function(){function Database(repo_){this.repo_=repo_,repo_ instanceof Repo_1.Repo||util_1.fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new Reference_1.Reference(repo_,Path_1.Path.Empty),this.INTERNAL=new DatabaseInternals(this)}return Object.defineProperty(Database.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),Database.prototype.ref=function(pathString){return this.checkDeleted_("ref"),util_2.validateArgCount("database.ref",0,1,arguments.length),void 0!==pathString?this.root_.child(pathString):this.root_},Database.prototype.refFromURL=function(url){var apiName="database.refFromURL";this.checkDeleted_(apiName),util_2.validateArgCount(apiName,1,1,arguments.length);var parsedURL=parser_1.parseRepoInfo(url);validation_1.validateUrl(apiName,1,parsedURL);var repoInfo=parsedURL.repoInfo;return repoInfo.host!==this.repo_.repoInfo_.host&&util_1.fatal(apiName+": Host name does not match the current database: (found "+repoInfo.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(parsedURL.path.toString())},Database.prototype.checkDeleted_=function(apiName){null===this.repo_&&util_1.fatal("Cannot call "+apiName+" on a deleted database.")},Database.prototype.goOffline=function(){util_2.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},Database.prototype.goOnline=function(){util_2.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},Database.ServerValue={TIMESTAMP:{".sv":"timestamp"}},Database}();exports.Database=Database;var DatabaseInternals=function(){function DatabaseInternals(database){this.database=database}return DatabaseInternals.prototype.delete=function(){return this.database.checkDeleted_("delete"),RepoManager_1.RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},DatabaseInternals}();exports.DatabaseInternals=DatabaseInternals},function(module,exports,__webpack_require__){"use strict";function decodePath(pathString){for(var pathStringDecoded="",pieces=pathString.split("/"),i=0;i<pieces.length;i++)if(pieces[i].length>0){var piece=pieces[i];try{piece=decodeURIComponent(piece.replace(/\+/g," "))}catch(e){}pathStringDecoded+="/"+piece}return pathStringDecoded}Object.defineProperty(exports,"__esModule",{value:!0});var Path_1=__webpack_require__(4),RepoInfo_1=__webpack_require__(68),util_1=__webpack_require__(1);exports.parseRepoInfo=function(dataURL){var parsedUrl=exports.parseURL(dataURL),namespace=parsedUrl.subdomain;"firebase"===parsedUrl.domain&&util_1.fatal(parsedUrl.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),namespace&&"undefined"!=namespace||util_1.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),parsedUrl.secure||util_1.warnIfPageIsSecure();var webSocketOnly="ws"===parsedUrl.scheme||"wss"===parsedUrl.scheme;return{repoInfo:new RepoInfo_1.RepoInfo(parsedUrl.host,parsedUrl.secure,namespace,webSocketOnly),path:new Path_1.Path(parsedUrl.pathString)}},exports.parseURL=function(dataURL){var host="",domain="",subdomain="",pathString="",secure=!0,scheme="https",port=443;if("string"==typeof dataURL){var colonInd=dataURL.indexOf("//");colonInd>=0&&(scheme=dataURL.substring(0,colonInd-1),dataURL=dataURL.substring(colonInd+2));var slashInd=dataURL.indexOf("/");-1===slashInd&&(slashInd=dataURL.length),host=dataURL.substring(0,slashInd),pathString=decodePath(dataURL.substring(slashInd));var parts=host.split(".");3===parts.length?(domain=parts[1],subdomain=parts[0].toLowerCase()):2===parts.length&&(domain=parts[0]),colonInd=host.indexOf(":"),colonInd>=0&&(secure="https"===scheme||"wss"===scheme,port=parseInt(host.substring(colonInd+1),10))}return{host:host,port:port,domain:domain,subdomain:subdomain,secure:secure,scheme:scheme,pathString:pathString}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(0),storage_1=__webpack_require__(34),Constants_1=__webpack_require__(35),RepoInfo=function(){function RepoInfo(host,secure,namespace,webSocketOnly,persistenceKey){void 0===persistenceKey&&(persistenceKey=""),this.secure=secure,this.namespace=namespace,this.webSocketOnly=webSocketOnly,this.persistenceKey=persistenceKey,this.host=host.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=storage_1.PersistentStorage.get("host:"+host)||this.host}return RepoInfo.prototype.needsQueryParam=function(){return this.host!==this.internalHost},RepoInfo.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},RepoInfo.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},RepoInfo.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},RepoInfo.prototype.updateHost=function(newHost){newHost!==this.internalHost&&(this.internalHost=newHost,this.isCacheableHost()&&storage_1.PersistentStorage.set("host:"+this.host,this.internalHost))},RepoInfo.prototype.connectionURL=function(type,params){util_1.assert("string"==typeof type,"typeof type must == string"),util_1.assert("object"==typeof params,"typeof params must == object");var connURL;if(type===Constants_1.WEBSOCKET)connURL=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(type!==Constants_1.LONG_POLLING)throw new Error("Unknown connection type: "+type);connURL=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(params.ns=this.namespace);var pairs=[];return util_2.forEach(params,function(key,value){pairs.push(key+"="+value)}),connURL+pairs.join("&")},RepoInfo.prototype.toString=function(){var str=this.toURLString();return this.persistenceKey&&(str+="<"+this.persistenceKey+">"),str},RepoInfo.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},RepoInfo}();exports.RepoInfo=RepoInfo},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),validation_1=__webpack_require__(19),util_2=__webpack_require__(1),util_3=__webpack_require__(0),OnDisconnect=function(){function OnDisconnect(repo_,path_){this.repo_=repo_,this.path_=path_}return OnDisconnect.prototype.cancel=function(onComplete){util_1.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),util_1.validateCallback("OnDisconnect.cancel",1,onComplete,!0);var deferred=new util_3.Deferred;return this.repo_.onDisconnectCancel(this.path_,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.remove=function(onComplete){util_1.validateArgCount("OnDisconnect.remove",0,1,arguments.length),validation_1.validateWritablePath("OnDisconnect.remove",this.path_),util_1.validateCallback("OnDisconnect.remove",1,onComplete,!0);var deferred=new util_3.Deferred;return this.repo_.onDisconnectSet(this.path_,null,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.set=function(value,onComplete){util_1.validateArgCount("OnDisconnect.set",1,2,arguments.length),validation_1.validateWritablePath("OnDisconnect.set",this.path_),validation_1.validateFirebaseDataArg("OnDisconnect.set",1,value,this.path_,!1),util_1.validateCallback("OnDisconnect.set",2,onComplete,!0);var deferred=new util_3.Deferred;return this.repo_.onDisconnectSet(this.path_,value,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.setWithPriority=function(value,priority,onComplete){util_1.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validation_1.validateWritablePath("OnDisconnect.setWithPriority",this.path_),validation_1.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,value,this.path_,!1),validation_1.validatePriority("OnDisconnect.setWithPriority",2,priority,!1),util_1.validateCallback("OnDisconnect.setWithPriority",3,onComplete,!0);var deferred=new util_3.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,value,priority,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.update=function(objectToMerge,onComplete){if(util_1.validateArgCount("OnDisconnect.update",1,2,arguments.length),validation_1.validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[""+i]=objectToMerge[i];objectToMerge=newObjectToMerge,util_2.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validation_1.validateFirebaseMergeDataArg("OnDisconnect.update",1,objectToMerge,this.path_,!1),util_1.validateCallback("OnDisconnect.update",2,onComplete,!0);var deferred=new util_3.Deferred;return this.repo_.onDisconnectUpdate(this.path_,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect}();exports.OnDisconnect=OnDisconnect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __referenceConstructor,util_1=__webpack_require__(0),KeyIndex_1=__webpack_require__(28),PriorityIndex_1=__webpack_require__(8),ValueIndex_1=__webpack_require__(72),PathIndex_1=__webpack_require__(76),util_2=__webpack_require__(1),Path_1=__webpack_require__(4),validation_1=__webpack_require__(19),util_3=__webpack_require__(0),EventRegistration_1=__webpack_require__(146),util_4=__webpack_require__(0),Query=function(){function Query(repo,path,queryParams_,orderByCalled_){this.repo=repo,this.path=path,this.queryParams_=queryParams_,this.orderByCalled_=orderByCalled_}return Object.defineProperty(Query,"__referenceConstructor",{get:function(){return util_1.assert(__referenceConstructor,"Reference.ts has not been loaded"),__referenceConstructor},set:function(val){__referenceConstructor=val},enumerable:!0,configurable:!0}),Query.validateQueryEndpoints_=function(params){var startNode=null,endNode=null;if(params.hasStart()&&(startNode=params.getIndexStartValue()),params.hasEnd()&&(endNode=params.getIndexEndValue()),params.getIndex()===KeyIndex_1.KEY_INDEX){var tooManyArgsError="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",wrongArgTypeError="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(params.hasStart()){if(params.getIndexStartName()!=util_2.MIN_NAME)throw new Error(tooManyArgsError);if("string"!=typeof startNode)throw new Error(wrongArgTypeError)}if(params.hasEnd()){if(params.getIndexEndName()!=util_2.MAX_NAME)throw new Error(tooManyArgsError);if("string"!=typeof endNode)throw new Error(wrongArgTypeError)}}else if(params.getIndex()===PriorityIndex_1.PRIORITY_INDEX){if(null!=startNode&&!validation_1.isValidPriority(startNode)||null!=endNode&&!validation_1.isValidPriority(endNode))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(util_1.assert(params.getIndex()instanceof PathIndex_1.PathIndex||params.getIndex()===ValueIndex_1.VALUE_INDEX,"unknown index type."),null!=startNode&&"object"==typeof startNode||null!=endNode&&"object"==typeof endNode)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},Query.validateLimit_=function(params){if(params.hasStart()&&params.hasEnd()&&params.hasLimit()&&!params.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},Query.prototype.validateNoPreviousOrderByCall_=function(fnName){if(!0===this.orderByCalled_)throw new Error(fnName+": You can't combine multiple orderBy calls.")},Query.prototype.getQueryParams=function(){return this.queryParams_},Query.prototype.getRef=function(){return util_3.validateArgCount("Query.ref",0,0,arguments.length),new Query.__referenceConstructor(this.repo,this.path)},Query.prototype.on=function(eventType,callback,cancelCallbackOrContext,context){util_3.validateArgCount("Query.on",2,4,arguments.length),validation_1.validateEventType("Query.on",1,eventType,!1),util_3.validateCallback("Query.on",2,callback,!1);var ret=Query.getCancelAndContextArgs_("Query.on",cancelCallbackOrContext,context);if("value"===eventType)this.onValueEvent(callback,ret.cancel,ret.context);else{var callbacks={};callbacks[eventType]=callback,this.onChildEvent(callbacks,ret.cancel,ret.context)}return callback},Query.prototype.onValueEvent=function(callback,cancelCallback,context){var container=new EventRegistration_1.ValueEventRegistration(callback,cancelCallback||null,context||null);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.onChildEvent=function(callbacks,cancelCallback,context){var container=new EventRegistration_1.ChildEventRegistration(callbacks,cancelCallback,context);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.off=function(eventType,callback,context){util_3.validateArgCount("Query.off",0,3,arguments.length),validation_1.validateEventType("Query.off",1,eventType,!0),util_3.validateCallback("Query.off",2,callback,!0),util_3.validateContextObject("Query.off",3,context,!0);var container=null,callbacks=null;if("value"===eventType){var valueCallback=callback||null;container=new EventRegistration_1.ValueEventRegistration(valueCallback,null,context||null)}else eventType&&(callback&&(callbacks={},callbacks[eventType]=callback),container=new EventRegistration_1.ChildEventRegistration(callbacks,null,context||null));this.repo.removeEventCallbackForQuery(this,container)},Query.prototype.once=function(eventType,userCallback,cancelOrContext,context){var _this=this;util_3.validateArgCount("Query.once",1,4,arguments.length),validation_1.validateEventType("Query.once",1,eventType,!1),util_3.validateCallback("Query.once",2,userCallback,!0);var ret=Query.getCancelAndContextArgs_("Query.once",cancelOrContext,context),firstCall=!0,deferred=new util_4.Deferred;deferred.promise.catch(function(){});var onceCallback=function(snapshot){firstCall&&(firstCall=!1,_this.off(eventType,onceCallback),userCallback&&userCallback.bind(ret.context)(snapshot),deferred.resolve(snapshot))};return this.on(eventType,onceCallback,function(err){_this.off(eventType,onceCallback),ret.cancel&&ret.cancel.bind(ret.context)(err),deferred.reject(err)}),deferred.promise},Query.prototype.limitToFirst=function(limit){if(util_3.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Query(this.repo,this.path,this.queryParams_.limitToFirst(limit),this.orderByCalled_)},Query.prototype.limitToLast=function(limit){if(util_3.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Query(this.repo,this.path,this.queryParams_.limitToLast(limit),this.orderByCalled_)},Query.prototype.orderByChild=function(path){if(util_3.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===path)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===path)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===path)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');validation_1.validatePathString("Query.orderByChild",1,path,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var parsedPath=new Path_1.Path(path);if(parsedPath.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var index=new PathIndex_1.PathIndex(parsedPath),newParams=this.queryParams_.orderBy(index);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByKey=function(){util_3.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var newParams=this.queryParams_.orderBy(KeyIndex_1.KEY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByPriority=function(){util_3.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var newParams=this.queryParams_.orderBy(PriorityIndex_1.PRIORITY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByValue=function(){util_3.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var newParams=this.queryParams_.orderBy(ValueIndex_1.VALUE_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.startAt=function(value,name){void 0===value&&(value=null),util_3.validateArgCount("Query.startAt",0,2,arguments.length),validation_1.validateFirebaseDataArg("Query.startAt",1,value,this.path,!0),validation_1.validateKey("Query.startAt",2,name,!0);var newParams=this.queryParams_.startAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===value&&(value=null,name=null),new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.endAt=function(value,name){void 0===value&&(value=null),util_3.validateArgCount("Query.endAt",0,2,arguments.length),validation_1.validateFirebaseDataArg("Query.endAt",1,value,this.path,!0),validation_1.validateKey("Query.endAt",2,name,!0);var newParams=this.queryParams_.endAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.equalTo=function(value,name){if(util_3.validateArgCount("Query.equalTo",1,2,arguments.length),validation_1.validateFirebaseDataArg("Query.equalTo",1,value,this.path,!1),validation_1.validateKey("Query.equalTo",2,name,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(value,name).endAt(value,name)},Query.prototype.toString=function(){return util_3.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},Query.prototype.toJSON=function(){return util_3.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},Query.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},Query.prototype.queryIdentifier=function(){var obj=this.queryObject(),id=util_2.ObjectToUniqueKey(obj);return"{}"===id?"default":id},Query.prototype.isEqual=function(other){if(util_3.validateArgCount("Query.isEqual",1,1,arguments.length),!(other instanceof Query)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var sameRepo=this.repo===other.repo,samePath=this.path.equals(other.path),sameQueryIdentifier=this.queryIdentifier()===other.queryIdentifier();return sameRepo&&samePath&&sameQueryIdentifier},Query.getCancelAndContextArgs_=function(fnName,cancelOrContext,context){var ret={cancel:null,context:null};if(cancelOrContext&&context)ret.cancel=cancelOrContext,util_3.validateCallback(fnName,3,ret.cancel,!0),ret.context=context,util_3.validateContextObject(fnName,4,ret.context,!0);else if(cancelOrContext)if("object"==typeof cancelOrContext&&null!==cancelOrContext)ret.context=cancelOrContext;else{if("function"!=typeof cancelOrContext)throw new Error(util_3.errorPrefix(fnName,3,!0)+" must either be a cancel callback or a context object.");ret.cancel=cancelOrContext}return ret},Object.defineProperty(Query.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),Query}();exports.Query=Query},function(module,exports,__webpack_require__){"use strict";function setMaxNode(val){MAX_NODE=val}Object.defineProperty(exports,"__esModule",{value:!0});var MAX_NODE,util_1=__webpack_require__(0),util_2=__webpack_require__(1),util_3=__webpack_require__(0);exports.setMaxNode=setMaxNode,exports.priorityHashText=function(priority){return"number"==typeof priority?"number:"+util_2.doubleToIEEE754String(priority):"string:"+priority},exports.validatePriorityNode=function(priorityNode){if(priorityNode.isLeafNode()){var val=priorityNode.val();util_1.assert("string"==typeof val||"number"==typeof val||"object"==typeof val&&util_3.contains(val,".sv"),"Priority must be a string or number.")}else util_1.assert(priorityNode===MAX_NODE||priorityNode.isEmpty(),"priority of unexpected type.");util_1.assert(priorityNode===MAX_NODE||priorityNode.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Index_1=__webpack_require__(36),Node_1=__webpack_require__(11),util_1=__webpack_require__(1),nodeFromJSON_1=__webpack_require__(29),ValueIndex=function(_super){function ValueIndex(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ValueIndex,_super),ValueIndex.prototype.compare=function(a,b){var indexCmp=a.node.compareTo(b.node);return 0===indexCmp?util_1.nameCompare(a.name,b.name):indexCmp},ValueIndex.prototype.isDefinedOn=function(node){return!0},ValueIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.equals(newNode)},ValueIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN},ValueIndex.prototype.maxPost=function(){return Node_1.NamedNode.MAX},ValueIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON_1.nodeFromJSON(indexValue);return new Node_1.NamedNode(name,valueNode)},ValueIndex.prototype.toString=function(){return".value"},ValueIndex}(Index_1.Index);exports.ValueIndex=ValueIndex,exports.VALUE_INDEX=new ValueIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defaultIndexMap,util_1=__webpack_require__(0),childSet_1=__webpack_require__(74),util_2=__webpack_require__(0),Node_1=__webpack_require__(11),PriorityIndex_1=__webpack_require__(8),KeyIndex_1=__webpack_require__(28),fallbackObject={},IndexMap=function(){function IndexMap(indexes_,indexSet_){this.indexes_=indexes_,this.indexSet_=indexSet_}return Object.defineProperty(IndexMap,"Default",{get:function(){return util_1.assert(fallbackObject&&PriorityIndex_1.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PriorityIndex_1.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),IndexMap.prototype.get=function(indexKey){var sortedMap=util_2.safeGet(this.indexes_,indexKey);if(!sortedMap)throw new Error("No index defined for "+indexKey);return sortedMap===fallbackObject?null:sortedMap},IndexMap.prototype.hasIndex=function(indexDefinition){return util_2.contains(this.indexSet_,indexDefinition.toString())},IndexMap.prototype.addIndex=function(indexDefinition,existingChildren){util_1.assert(indexDefinition!==KeyIndex_1.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var childList=[],sawIndexedValue=!1,iter=existingChildren.getIterator(Node_1.NamedNode.Wrap),next=iter.getNext();next;)sawIndexedValue=sawIndexedValue||indexDefinition.isDefinedOn(next.node),childList.push(next),next=iter.getNext();var newIndex;newIndex=sawIndexedValue?childSet_1.buildChildSet(childList,indexDefinition.getCompare()):fallbackObject;var indexName=indexDefinition.toString(),newIndexSet=util_2.clone(this.indexSet_);newIndexSet[indexName]=indexDefinition;var newIndexes=util_2.clone(this.indexes_);return newIndexes[indexName]=newIndex,new IndexMap(newIndexes,newIndexSet)},IndexMap.prototype.addToIndexes=function(namedNode,existingChildren){var _this=this;return new IndexMap(util_2.map(this.indexes_,function(indexedChildren,indexName){var index=util_2.safeGet(_this.indexSet_,indexName);if(util_1.assert(index,"Missing index implementation for "+indexName),indexedChildren===fallbackObject){if(index.isDefinedOn(namedNode.node)){for(var childList=[],iter=existingChildren.getIterator(Node_1.NamedNode.Wrap),next=iter.getNext();next;)next.name!=namedNode.name&&childList.push(next),next=iter.getNext();return childList.push(namedNode),childSet_1.buildChildSet(childList,index.getCompare())}return fallbackObject}var existingSnap=existingChildren.get(namedNode.name),newChildren=indexedChildren;return existingSnap&&(newChildren=newChildren.remove(new Node_1.NamedNode(namedNode.name,existingSnap))),newChildren.insert(namedNode,namedNode.node)}),this.indexSet_)},IndexMap.prototype.removeFromIndexes=function(namedNode,existingChildren){return new IndexMap(util_2.map(this.indexes_,function(indexedChildren){if(indexedChildren===fallbackObject)return indexedChildren;var existingSnap=existingChildren.get(namedNode.name);return existingSnap?indexedChildren.remove(new Node_1.NamedNode(namedNode.name,existingSnap)):indexedChildren}),this.indexSet_)},IndexMap}();exports.IndexMap=IndexMap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var SortedMap_1=__webpack_require__(38),SortedMap_2=__webpack_require__(38),LOG_2=Math.log(2),Base12Num=function(){function Base12Num(length){this.count=function(num){return parseInt(Math.log(num)/LOG_2,10)}(length+1),this.current_=this.count-1;var mask=function(bits){return parseInt(Array(bits+1).join("1"),2)}(this.count);this.bits_=length+1&mask}return Base12Num.prototype.nextBitIsOne=function(){var result=!(this.bits_&1<<this.current_);return this.current_--,result},Base12Num}();exports.buildChildSet=function(childList,cmp,keyFn,mapSortFn){childList.sort(cmp);var buildBalancedTree=function(low,high){var namedNode,key,length=high-low;if(0==length)return null;if(1==length)return namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode,new SortedMap_1.LLRBNode(key,namedNode.node,SortedMap_1.LLRBNode.BLACK,null,null);var middle=parseInt(length/2,10)+low,left=buildBalancedTree(low,middle),right=buildBalancedTree(middle+1,high);return namedNode=childList[middle],key=keyFn?keyFn(namedNode):namedNode,new SortedMap_1.LLRBNode(key,namedNode.node,SortedMap_1.LLRBNode.BLACK,left,right)},base12=new Base12Num(childList.length),root=function(base12){for(var node=null,root=null,index=childList.length,buildPennant=function(chunkSize,color){var low=index-chunkSize,high=index;index-=chunkSize;var childTree=buildBalancedTree(low+1,high),namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode;attachPennant(new SortedMap_1.LLRBNode(key,namedNode.node,color,null,childTree))},attachPennant=function(pennant){node?(node.left=pennant,node=pennant):(root=pennant,node=pennant)},i=0;i<base12.count;++i){var isOne=base12.nextBitIsOne(),chunkSize=Math.pow(2,base12.count-(i+1));isOne?buildPennant(chunkSize,SortedMap_1.LLRBNode.BLACK):(buildPennant(chunkSize,SortedMap_1.LLRBNode.BLACK),buildPennant(chunkSize,SortedMap_1.LLRBNode.RED))}return root}(base12);return new SortedMap_2.SortedMap(mapSortFn||cmp,root)}},function(module,exports,__webpack_require__){"use strict";function NAME_ONLY_COMPARATOR(left,right){return util_1.nameCompare(left.name,right.name)}function NAME_COMPARATOR(left,right){return util_1.nameCompare(left,right)}Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1);exports.NAME_ONLY_COMPARATOR=NAME_ONLY_COMPARATOR,exports.NAME_COMPARATOR=NAME_COMPARATOR},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(1),Index_1=__webpack_require__(36),ChildrenNode_1=__webpack_require__(10),Node_1=__webpack_require__(11),nodeFromJSON_1=__webpack_require__(29),PathIndex=function(_super){function PathIndex(indexPath_){var _this=_super.call(this)||this;return _this.indexPath_=indexPath_,util_1.assert(!indexPath_.isEmpty()&&".priority"!==indexPath_.getFront(),"Can't create PathIndex with empty path or .priority key"),_this}return __extends(PathIndex,_super),PathIndex.prototype.extractChild=function(snap){return snap.getChild(this.indexPath_)},PathIndex.prototype.isDefinedOn=function(node){return!node.getChild(this.indexPath_).isEmpty()},PathIndex.prototype.compare=function(a,b){var aChild=this.extractChild(a.node),bChild=this.extractChild(b.node),indexCmp=aChild.compareTo(bChild);return 0===indexCmp?util_2.nameCompare(a.name,b.name):indexCmp},PathIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON_1.nodeFromJSON(indexValue),node=ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,valueNode);return new Node_1.NamedNode(name,node)},PathIndex.prototype.maxPost=function(){var node=ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,ChildrenNode_1.MAX_NODE);return new Node_1.NamedNode(util_2.MAX_NAME,node)},PathIndex.prototype.toString=function(){return this.indexPath_.slice().join("/")},PathIndex}(Index_1.Index);exports.PathIndex=PathIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Path_1=__webpack_require__(4),SparseSnapshotTree_1=__webpack_require__(78),LeafNode_1=__webpack_require__(37),nodeFromJSON_1=__webpack_require__(29),PriorityIndex_1=__webpack_require__(8);exports.generateWithValues=function(values){return values=values||{},values.timestamp=values.timestamp||(new Date).getTime(),values},exports.resolveDeferredValue=function(value,serverValues){return value&&"object"==typeof value?(util_1.assert(".sv"in value,"Unexpected leaf node or priority contents"),serverValues[value[".sv"]]):value},exports.resolveDeferredValueTree=function(tree,serverValues){var resolvedTree=new SparseSnapshotTree_1.SparseSnapshotTree;return tree.forEachTree(new Path_1.Path(""),function(path,node){resolvedTree.remember(path,exports.resolveDeferredValueSnapshot(node,serverValues))}),resolvedTree},exports.resolveDeferredValueSnapshot=function(node,serverValues){var newNode,rawPri=node.getPriority().val(),priority=exports.resolveDeferredValue(rawPri,serverValues);if(node.isLeafNode()){var leafNode=node,value=exports.resolveDeferredValue(leafNode.getValue(),serverValues);return value!==leafNode.getValue()||priority!==leafNode.getPriority().val()?new LeafNode_1.LeafNode(value,nodeFromJSON_1.nodeFromJSON(priority)):node}var childrenNode=node;return newNode=childrenNode,priority!==childrenNode.getPriority().val()&&(newNode=newNode.updatePriority(new LeafNode_1.LeafNode(priority))),childrenNode.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){var newChildNode=exports.resolveDeferredValueSnapshot(childNode,serverValues);newChildNode!==childNode&&(newNode=newNode.updateImmediateChild(childName,newChildNode))}),newNode}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Path_1=__webpack_require__(4),PriorityIndex_1=__webpack_require__(8),CountedSet_1=__webpack_require__(79),SparseSnapshotTree=function(){function SparseSnapshotTree(){this.value_=null,this.children_=null}return SparseSnapshotTree.prototype.find=function(path){if(null!=this.value_)return this.value_.getChild(path);if(path.isEmpty()||null==this.children_)return null;var childKey=path.getFront();if(path=path.popFront(),this.children_.contains(childKey)){return this.children_.get(childKey).find(path)}return null},SparseSnapshotTree.prototype.remember=function(path,data){if(path.isEmpty())this.value_=data,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(path,data);else{null==this.children_&&(this.children_=new CountedSet_1.CountedSet);var childKey=path.getFront();this.children_.contains(childKey)||this.children_.add(childKey,new SparseSnapshotTree);var child=this.children_.get(childKey);path=path.popFront(),child.remember(path,data)}},SparseSnapshotTree.prototype.forget=function(path){if(path.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var value=this.value_;this.value_=null;var self_1=this;return value.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,tree){self_1.remember(new Path_1.Path(key),tree)}),this.forget(path)}if(null!==this.children_){var childKey=path.getFront();if(path=path.popFront(),this.children_.contains(childKey)){this.children_.get(childKey).forget(path)&&this.children_.remove(childKey)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},SparseSnapshotTree.prototype.forEachTree=function(prefixPath,func){null!==this.value_?func(prefixPath,this.value_):this.forEachChild(function(key,tree){var path=new Path_1.Path(prefixPath.toString()+"/"+key);tree.forEachTree(path,func)})},SparseSnapshotTree.prototype.forEachChild=function(func){null!==this.children_&&this.children_.each(function(key,tree){func(key,tree)})},SparseSnapshotTree}();exports.SparseSnapshotTree=SparseSnapshotTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),CountedSet=function(){function CountedSet(){this.set={}}return CountedSet.prototype.add=function(item,val){this.set[item]=null===val||val},CountedSet.prototype.contains=function(key){return util_1.contains(this.set,key)},CountedSet.prototype.get=function(item){return this.contains(item)?this.set[item]:void 0},CountedSet.prototype.remove=function(item){delete this.set[item]},CountedSet.prototype.clear=function(){this.set={}},CountedSet.prototype.isEmpty=function(){return util_1.isEmpty(this.set)},CountedSet.prototype.count=function(){return util_1.getCount(this.set)},CountedSet.prototype.each=function(fn){util_1.forEach(this.set,function(k,v){return fn(k,v)})},CountedSet.prototype.keys=function(){var keys=[];return util_1.forEach(this.set,function(k){keys.push(k)}),keys},CountedSet}();exports.CountedSet=CountedSet},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Operation_1=__webpack_require__(20),Path_1=__webpack_require__(4),Overwrite=function(){function Overwrite(source,path,snap){this.source=source,this.path=path,this.snap=snap,this.type=Operation_1.OperationType.OVERWRITE}return Overwrite.prototype.operationForChild=function(childName){return this.path.isEmpty()?new Overwrite(this.source,Path_1.Path.Empty,this.snap.getImmediateChild(childName)):new Overwrite(this.source,this.path.popFront(),this.snap)},Overwrite}();exports.Overwrite=Overwrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __referenceConstructor,CacheNode_1=__webpack_require__(40),ChildrenNode_1=__webpack_require__(10),util_1=__webpack_require__(0),util_2=__webpack_require__(0),ViewCache_1=__webpack_require__(82),View_1=__webpack_require__(152),SyncPoint=function(){function SyncPoint(){this.views_={}}return Object.defineProperty(SyncPoint,"__referenceConstructor",{get:function(){return util_1.assert(__referenceConstructor,"Reference.ts has not been loaded"),__referenceConstructor},set:function(val){util_1.assert(!__referenceConstructor,"__referenceConstructor has already been defined"),__referenceConstructor=val},enumerable:!0,configurable:!0}),SyncPoint.prototype.isEmpty=function(){return util_2.isEmpty(this.views_)},SyncPoint.prototype.applyOperation=function(operation,writesCache,optCompleteServerCache){var queryId=operation.source.queryId;if(null!==queryId){var view=util_2.safeGet(this.views_,queryId);return util_1.assert(null!=view,"SyncTree gave us an op for an invalid query."),view.applyOperation(operation,writesCache,optCompleteServerCache)}var events_1=[];return util_2.forEach(this.views_,function(key,view){events_1=events_1.concat(view.applyOperation(operation,writesCache,optCompleteServerCache))}),events_1},SyncPoint.prototype.addEventRegistration=function(query,eventRegistration,writesCache,serverCache,serverCacheComplete){var queryId=query.queryIdentifier(),view=util_2.safeGet(this.views_,queryId);if(!view){var eventCache=writesCache.calcCompleteEventCache(serverCacheComplete?serverCache:null),eventCacheComplete=!1;eventCache?eventCacheComplete=!0:serverCache instanceof ChildrenNode_1.ChildrenNode?(eventCache=writesCache.calcCompleteEventChildren(serverCache),eventCacheComplete=!1):(eventCache=ChildrenNode_1.ChildrenNode.EMPTY_NODE,eventCacheComplete=!1);var viewCache=new ViewCache_1.ViewCache(new CacheNode_1.CacheNode(eventCache,eventCacheComplete,!1),new CacheNode_1.CacheNode(serverCache,serverCacheComplete,!1));view=new View_1.View(query,viewCache),this.views_[queryId]=view}return view.addEventRegistration(eventRegistration),view.getInitialEvents(eventRegistration)},SyncPoint.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var queryId=query.queryIdentifier(),removed=[],cancelEvents=[],hadCompleteView=this.hasCompleteView();if("default"===queryId){var self_1=this;util_2.forEach(this.views_,function(viewQueryId,view){cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(delete self_1.views_[viewQueryId],view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery()))})}else{var view=util_2.safeGet(this.views_,queryId);view&&(cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(delete this.views_[queryId],view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery())))}return hadCompleteView&&!this.hasCompleteView()&&removed.push(new SyncPoint.__referenceConstructor(query.repo,query.path)),{removed:removed,events:cancelEvents}},SyncPoint.prototype.getQueryViews=function(){var _this=this;return Object.keys(this.views_).map(function(key){return _this.views_[key]}).filter(function(view){return!view.getQuery().getQueryParams().loadsAllData()})},SyncPoint.prototype.getCompleteServerCache=function(path){var serverCache=null;return util_2.forEach(this.views_,function(key,view){serverCache=serverCache||view.getCompleteServerCache(path)}),serverCache},SyncPoint.prototype.viewForQuery=function(query){if(query.getQueryParams().loadsAllData())return this.getCompleteView();var queryId=query.queryIdentifier();return util_2.safeGet(this.views_,queryId)},SyncPoint.prototype.viewExistsForQuery=function(query){return null!=this.viewForQuery(query)},SyncPoint.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},SyncPoint.prototype.getCompleteView=function(){return util_2.findValue(this.views_,function(view){return view.getQuery().getQueryParams().loadsAllData()})||null},SyncPoint}();exports.SyncPoint=SyncPoint},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ChildrenNode_1=__webpack_require__(10),CacheNode_1=__webpack_require__(40),ViewCache=function(){function ViewCache(eventCache_,serverCache_){this.eventCache_=eventCache_,this.serverCache_=serverCache_}return ViewCache.prototype.updateEventSnap=function(eventSnap,complete,filtered){return new ViewCache(new CacheNode_1.CacheNode(eventSnap,complete,filtered),this.serverCache_)},ViewCache.prototype.updateServerSnap=function(serverSnap,complete,filtered){return new ViewCache(this.eventCache_,new CacheNode_1.CacheNode(serverSnap,complete,filtered))},ViewCache.prototype.getEventCache=function(){return this.eventCache_},ViewCache.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},ViewCache.prototype.getServerCache=function(){return this.serverCache_},ViewCache.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},ViewCache.Empty=new ViewCache(new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,!1,!1),new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,!1,!1)),ViewCache}();exports.ViewCache=ViewCache},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),StatsListener=function(){function StatsListener(collection_){this.collection_=collection_,this.last_=null}return StatsListener.prototype.get=function(){var newStats=this.collection_.get(),delta=util_1.clone(newStats);return this.last_&&util_1.forEach(this.last_,function(stat,value){delta[stat]=delta[stat]-value}),this.last_=newStats,delta},StatsListener}();exports.StatsListener=StatsListener},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var app_1=__webpack_require__(18),util_1=__webpack_require__(0),util_2=__webpack_require__(0),util_3=__webpack_require__(0),util_4=__webpack_require__(1),Path_1=__webpack_require__(4),VisibilityMonitor_1=__webpack_require__(164),OnlineMonitor_1=__webpack_require__(165),util_5=__webpack_require__(0),Connection_1=__webpack_require__(86),util_6=__webpack_require__(0),util_7=__webpack_require__(0),ServerActions_1=__webpack_require__(89),RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=3e5,PersistentConnection=function(_super){function PersistentConnection(repoInfo_,onDataUpdate_,onConnectStatus_,onServerInfoUpdate_,authTokenProvider_,authOverride_){var _this=_super.call(this)||this;if(_this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.onConnectStatus_=onConnectStatus_,_this.onServerInfoUpdate_=onServerInfoUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.authOverride_=authOverride_,_this.id=PersistentConnection.nextPersistentConnectionId_++,_this.log_=util_4.logWrapper("p:"+_this.id+":"),_this.interruptReasons_={},_this.listens_={},_this.outstandingPuts_=[],_this.outstandingPutCount_=0,_this.onDisconnectRequestQueue_=[],_this.connected_=!1,_this.reconnectDelay_=RECONNECT_MIN_DELAY,_this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,_this.securityDebugCallback_=null,_this.lastSessionId=null,_this.establishConnectionTimer_=null,_this.visible_=!1,_this.requestCBHash_={},_this.requestNumber_=0,_this.realtime_=null,_this.authToken_=null,_this.forceTokenRefresh_=!1,_this.invalidAuthTokenCount_=0,_this.firstConnection_=!0,_this.lastConnectionAttemptTime_=null,_this.lastConnectionEstablishedTime_=null,authOverride_&&!util_7.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return _this.scheduleConnect_(0),VisibilityMonitor_1.VisibilityMonitor.getInstance().on("visible",_this.onVisible_,_this),-1===repoInfo_.host.indexOf("fblocal")&&OnlineMonitor_1.OnlineMonitor.getInstance().on("online",_this.onOnline_,_this),_this}return __extends(PersistentConnection,_super),PersistentConnection.prototype.sendRequest=function(action,body,onResponse){var curReqNum=++this.requestNumber_,msg={r:curReqNum,a:action,b:body};this.log_(util_2.stringify(msg)),util_3.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(msg),onResponse&&(this.requestCBHash_[curReqNum]=onResponse)},PersistentConnection.prototype.listen=function(query,currentHashFn,tag,onComplete){var queryId=query.queryIdentifier(),pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+queryId),this.listens_[pathString]=this.listens_[pathString]||{},util_3.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),util_3.assert(!this.listens_[pathString][queryId],"listen() called twice for same path/queryId.");var listenSpec={onComplete:onComplete,hashFn:currentHashFn,query:query,tag:tag};this.listens_[pathString][queryId]=listenSpec,this.connected_&&this.sendListen_(listenSpec)},PersistentConnection.prototype.sendListen_=function(listenSpec){var _this=this,query=listenSpec.query,pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_("Listen on "+pathString+" for "+queryId);var req={p:pathString};listenSpec.tag&&(req.q=query.queryObject(),req.t=listenSpec.tag),req.h=listenSpec.hashFn(),this.sendRequest("q",req,function(message){var payload=message.d,status=message.s;PersistentConnection.warnOnListenWarnings_(payload,query),(_this.listens_[pathString]&&_this.listens_[pathString][queryId])===listenSpec&&(_this.log_("listen response",message),"ok"!==status&&_this.removeListen_(pathString,queryId),listenSpec.onComplete&&listenSpec.onComplete(status,payload))})},PersistentConnection.warnOnListenWarnings_=function(payload,query){if(payload&&"object"==typeof payload&&util_1.contains(payload,"w")){var warnings=util_1.safeGet(payload,"w");if(Array.isArray(warnings)&&~warnings.indexOf("no_index")){var indexSpec='".indexOn": "'+query.getQueryParams().getIndex().toString()+'"',indexPath=query.path.toString();util_4.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+indexSpec+" at "+indexPath+" to your security rules for better performance.")}}},PersistentConnection.prototype.refreshAuthToken=function(token){this.authToken_=token,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(token)},PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_=function(credential){(credential&&40===credential.length||util_5.isAdmin(credential))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},PersistentConnection.prototype.tryAuth=function(){var _this=this;if(this.connected_&&this.authToken_){var token_1=this.authToken_,authMethod=util_5.isValidFormat(token_1)?"auth":"gauth",requestData={cred:token_1};null===this.authOverride_?requestData.noauth=!0:"object"==typeof this.authOverride_&&(requestData.authvar=this.authOverride_),this.sendRequest(authMethod,requestData,function(res){var status=res.s,data=res.d||"error";_this.authToken_===token_1&&("ok"===status?_this.invalidAuthTokenCount_=0:_this.onAuthRevoked_(status,data))})}},PersistentConnection.prototype.unlisten=function(query,tag){var pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_("Unlisten called for "+pathString+" "+queryId),util_3.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(pathString,queryId)&&this.connected_&&this.sendUnlisten_(pathString,queryId,query.queryObject(),tag)},PersistentConnection.prototype.sendUnlisten_=function(pathString,queryId,queryObj,tag){this.log_("Unlisten on "+pathString+" for "+queryId);var req={p:pathString};tag&&(req.q=queryObj,req.t=tag),this.sendRequest("n",req)},PersistentConnection.prototype.onDisconnectPut=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_("o",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"o",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectMerge=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_("om",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"om",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectCancel=function(pathString,onComplete){this.connected_?this.sendOnDisconnect_("oc",pathString,null,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"oc",data:null,onComplete:onComplete})},PersistentConnection.prototype.sendOnDisconnect_=function(action,pathString,data,onComplete){var request={p:pathString,d:data};this.log_("onDisconnect "+action,request),this.sendRequest(action,request,function(response){onComplete&&setTimeout(function(){onComplete(response.s,response.d)},Math.floor(0))})},PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){this.putInternal("p",pathString,data,onComplete,hash)},PersistentConnection.prototype.merge=function(pathString,data,onComplete,hash){this.putInternal("m",pathString,data,onComplete,hash)},PersistentConnection.prototype.putInternal=function(action,pathString,data,onComplete,hash){var request={p:pathString,d:data};void 0!==hash&&(request.h=hash),this.outstandingPuts_.push({action:action,request:request,onComplete:onComplete}),this.outstandingPutCount_++;var index=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(index):this.log_("Buffering put: "+pathString)},PersistentConnection.prototype.sendPut_=function(index){var _this=this,action=this.outstandingPuts_[index].action,request=this.outstandingPuts_[index].request,onComplete=this.outstandingPuts_[index].onComplete;this.outstandingPuts_[index].queued=this.connected_,this.sendRequest(action,request,function(message){_this.log_(action+" response",message),delete _this.outstandingPuts_[index],_this.outstandingPutCount_--,0===_this.outstandingPutCount_&&(_this.outstandingPuts_=[]),onComplete&&onComplete(message.s,message.d)})},PersistentConnection.prototype.reportStats=function(stats){var _this=this;if(this.connected_){var request={c:stats};this.log_("reportStats",request),this.sendRequest("s",request,function(result){if("ok"!==result.s){var errorReason=result.d;_this.log_("reportStats","Error sending stats: "+errorReason)}})}},PersistentConnection.prototype.onDataMessage_=function(message){if("r"in message){this.log_("from server: "+util_2.stringify(message));var reqNum=message.r,onResponse=this.requestCBHash_[reqNum];onResponse&&(delete this.requestCBHash_[reqNum],onResponse(message.b))}else{if("error"in message)throw"A server-side error has occurred: "+message.error;"a"in message&&this.onDataPush_(message.a,message.b)}},PersistentConnection.prototype.onDataPush_=function(action,body){this.log_("handleServerMessage",action,body),"d"===action?this.onDataUpdate_(body.p,body.d,!1,body.t):"m"===action?this.onDataUpdate_(body.p,body.d,!0,body.t):"c"===action?this.onListenRevoked_(body.p,body.q):"ac"===action?this.onAuthRevoked_(body.s,body.d):"sd"===action?this.onSecurityDebugPacket_(body):util_4.error("Unrecognized action received from server: "+util_2.stringify(action)+"\nAre you using the latest client?")},PersistentConnection.prototype.onReady_=function(timestamp,sessionId){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(timestamp),this.lastSessionId=sessionId,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},PersistentConnection.prototype.scheduleConnect_=function(timeout){var _this=this;util_3.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){_this.establishConnectionTimer_=null,_this.establishConnection_()},Math.floor(timeout))},PersistentConnection.prototype.onVisible_=function(visible){visible&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=visible},PersistentConnection.prototype.onOnline_=function(online){online?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},PersistentConnection.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var timeSinceLastConnectSucceeded=(new Date).getTime()-this.lastConnectionEstablishedTime_;timeSinceLastConnectSucceeded>3e4&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var timeSinceLastConnectAttempt=(new Date).getTime()-this.lastConnectionAttemptTime_,reconnectDelay=Math.max(0,this.reconnectDelay_-timeSinceLastConnectAttempt);reconnectDelay=Math.random()*reconnectDelay,this.log_("Trying to reconnect in "+reconnectDelay+"ms"),this.scheduleConnect_(reconnectDelay),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},PersistentConnection.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var onDataMessage_1=this.onDataMessage_.bind(this),onReady_1=this.onReady_.bind(this),onDisconnect_1=this.onRealtimeDisconnect_.bind(this),connId_1=this.id+":"+PersistentConnection.nextConnectionId_++,self_1=this,lastSessionId_1=this.lastSessionId,canceled_1=!1,connection_1=null,closeFn_1=function(){connection_1?connection_1.close():(canceled_1=!0,onDisconnect_1())},sendRequestFn=function(msg){util_3.assert(connection_1,"sendRequest call when we're not connected not allowed."),connection_1.sendRequest(msg)};this.realtime_={close:closeFn_1,sendRequest:sendRequestFn};var forceRefresh=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(forceRefresh).then(function(result){canceled_1?util_4.log("getToken() completed but was canceled"):(util_4.log("getToken() completed. Creating connection."),self_1.authToken_=result&&result.accessToken,connection_1=new Connection_1.Connection(connId_1,self_1.repoInfo_,onDataMessage_1,onReady_1,onDisconnect_1,function(reason){util_4.warn(reason+" ("+self_1.repoInfo_.toString()+")"),self_1.interrupt("server_kill")},lastSessionId_1))}).then(null,function(error){self_1.log_("Failed to get token: "+error),canceled_1||(util_6.CONSTANTS.NODE_ADMIN&&util_4.warn(error),closeFn_1())})}},PersistentConnection.prototype.interrupt=function(reason){util_4.log("Interrupting connection for reason: "+reason),this.interruptReasons_[reason]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},PersistentConnection.prototype.resume=function(reason){util_4.log("Resuming connection for reason: "+reason),delete this.interruptReasons_[reason],util_1.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))},PersistentConnection.prototype.handleTimestamp_=function(timestamp){var delta=timestamp-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:delta})},PersistentConnection.prototype.cancelSentTransactions_=function(){for(var i=0;i<this.outstandingPuts_.length;i++){var put=this.outstandingPuts_[i];put&&"h"in put.request&&put.queued&&(put.onComplete&&put.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},PersistentConnection.prototype.onListenRevoked_=function(pathString,query){var queryId;queryId=query?query.map(function(q){return util_4.ObjectToUniqueKey(q)}).join("$"):"default";var listen=this.removeListen_(pathString,queryId);listen&&listen.onComplete&&listen.onComplete("permission_denied")},PersistentConnection.prototype.removeListen_=function(pathString,queryId){var listen,normalizedPathString=new Path_1.Path(pathString).toString();return void 0!==this.listens_[normalizedPathString]?(listen=this.listens_[normalizedPathString][queryId],delete this.listens_[normalizedPathString][queryId],0===util_1.getCount(this.listens_[normalizedPathString])&&delete this.listens_[normalizedPathString]):listen=void 0,listen},PersistentConnection.prototype.onAuthRevoked_=function(statusCode,explanation){util_4.log("Auth token revoked: "+statusCode+"/"+explanation),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==statusCode&&"permission_denied"!==statusCode||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},PersistentConnection.prototype.onSecurityDebugPacket_=function(body){this.securityDebugCallback_?this.securityDebugCallback_(body):"msg"in body&&"undefined"!=typeof console&&console.log("FIREBASE: "+body.msg.replace("\n","\nFIREBASE: "))},PersistentConnection.prototype.restoreState_=function(){var _this=this;this.tryAuth(),util_1.forEach(this.listens_,function(pathString,queries){util_1.forEach(queries,function(key,listenSpec){_this.sendListen_(listenSpec)})});for(var i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){var request=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(request.action,request.pathString,request.data,request.onComplete)}},PersistentConnection.prototype.sendConnectStats_=function(){var stats={},clientName="js";util_6.CONSTANTS.NODE_ADMIN?clientName="admin_node":util_6.CONSTANTS.NODE_CLIENT&&(clientName="node"),stats["sdk."+clientName+"."+app_1.default.SDK_VERSION.replace(/\./g,"-")]=1,util_7.isMobileCordova()?stats["framework.cordova"]=1:util_7.isReactNative()&&(stats["framework.reactnative"]=1),this.reportStats(stats)},PersistentConnection.prototype.shouldReconnect_=function(){var online=OnlineMonitor_1.OnlineMonitor.getInstance().currentlyOnline();return util_1.isEmpty(this.interruptReasons_)&&online},PersistentConnection.nextPersistentConnectionId_=0,PersistentConnection.nextConnectionId_=0,PersistentConnection}(ServerActions_1.ServerActions);exports.PersistentConnection=PersistentConnection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),EventEmitter=function(){function EventEmitter(allowedEvents_){this.allowedEvents_=allowedEvents_,this.listeners_={},util_1.assert(Array.isArray(allowedEvents_)&&allowedEvents_.length>0,"Requires a non-empty array")}return EventEmitter.prototype.trigger=function(eventType){for(var var_args=[],_i=1;_i<arguments.length;_i++)var_args[_i-1]=arguments[_i];if(Array.isArray(this.listeners_[eventType]))for(var listeners=this.listeners_[eventType].slice(),i=0;i<listeners.length;i++)listeners[i].callback.apply(listeners[i].context,var_args)},EventEmitter.prototype.on=function(eventType,callback,context){this.validateEventType_(eventType),this.listeners_[eventType]=this.listeners_[eventType]||[],this.listeners_[eventType].push({callback:callback,context:context});var eventData=this.getInitialEvent(eventType);eventData&&callback.apply(context,eventData)},EventEmitter.prototype.off=function(eventType,callback,context){this.validateEventType_(eventType);for(var listeners=this.listeners_[eventType]||[],i=0;i<listeners.length;i++)if(listeners[i].callback===callback&&(!context||context===listeners[i].context))return void listeners.splice(i,1)},EventEmitter.prototype.validateEventType_=function(eventType){util_1.assert(this.allowedEvents_.find(function(et){return et===eventType}),"Unknown event: "+eventType)},EventEmitter}();exports.EventEmitter=EventEmitter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),storage_1=__webpack_require__(34),Constants_1=__webpack_require__(35),TransportManager_1=__webpack_require__(166),Connection=function(){function Connection(id,repoInfo_,onMessage_,onReady_,onDisconnect_,onKill_,lastSessionId){this.id=id,this.repoInfo_=repoInfo_,this.onMessage_=onMessage_,this.onReady_=onReady_,this.onDisconnect_=onDisconnect_,this.onKill_=onKill_,this.lastSessionId=lastSessionId,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=util_1.logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager_1.TransportManager(repoInfo_),this.log_("Connection created"),this.start_()}return Connection.prototype.start_=function(){var _this=this,conn=this.transportManager_.initialTransport();this.conn_=new conn(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessageReceived=this.connReceiver_(this.conn_),onConnectionLost=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){_this.conn_&&_this.conn_.open(onMessageReceived,onConnectionLost)},Math.floor(0));var healthyTimeout_ms=conn.healthyTimeout||0;healthyTimeout_ms>0&&(this.healthyTimeout_=util_1.setTimeoutNonBlocking(function(){_this.healthyTimeout_=null,_this.isHealthy_||(_this.conn_&&_this.conn_.bytesReceived>102400?(_this.log_("Connection exceeded healthy timeout but has received "+_this.conn_.bytesReceived+" bytes.  Marking connection healthy."),_this.isHealthy_=!0,_this.conn_.markConnectionHealthy()):_this.conn_&&_this.conn_.bytesSent>10240?_this.log_("Connection exceeded healthy timeout but has sent "+_this.conn_.bytesSent+" bytes.  Leaving connection alive."):(_this.log_("Closing unhealthy connection after timeout."),_this.close()))},Math.floor(healthyTimeout_ms)))},Connection.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},Connection.prototype.disconnReceiver_=function(conn){var _this=this;return function(everConnected){conn===_this.conn_?_this.onConnectionLost_(everConnected):conn===_this.secondaryConn_?(_this.log_("Secondary connection lost."),_this.onSecondaryConnectionLost_()):_this.log_("closing an old connection")}},Connection.prototype.connReceiver_=function(conn){var _this=this;return function(message){2!=_this.state_&&(conn===_this.rx_?_this.onPrimaryMessageReceived_(message):conn===_this.secondaryConn_?_this.onSecondaryMessageReceived_(message):_this.log_("message on old connection"))}},Connection.prototype.sendRequest=function(dataMsg){var msg={t:"d",d:dataMsg};this.sendData_(msg)},Connection.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},Connection.prototype.onSecondaryControl_=function(controlData){if("t"in controlData){var cmd=controlData.t;"a"===cmd?this.upgradeIfSecondaryHealthy_():"r"===cmd?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===cmd&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},Connection.prototype.onSecondaryMessageReceived_=function(parsedData){var layer=util_1.requireKey("t",parsedData),data=util_1.requireKey("d",parsedData);if("c"==layer)this.onSecondaryControl_(data);else{if("d"!=layer)throw new Error("Unknown protocol layer: "+layer);this.pendingDataMessages.push(data)}},Connection.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},Connection.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},Connection.prototype.onPrimaryMessageReceived_=function(parsedData){var layer=util_1.requireKey("t",parsedData),data=util_1.requireKey("d",parsedData);"c"==layer?this.onControl_(data):"d"==layer&&this.onDataMessage_(data)},Connection.prototype.onDataMessage_=function(message){this.onPrimaryResponse_(),this.onMessage_(message)},Connection.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},Connection.prototype.onControl_=function(controlData){var cmd=util_1.requireKey("t",controlData);if("d"in controlData){var payload=controlData.d;if("h"===cmd)this.onHandshake_(payload);else if("n"===cmd){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===cmd?this.onConnectionShutdown_(payload):"r"===cmd?this.onReset_(payload):"e"===cmd?util_1.error("Server Error: "+payload):"o"===cmd?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):util_1.error("Unknown control packet command: "+cmd)}},Connection.prototype.onHandshake_=function(handshake){var timestamp=handshake.ts,version=handshake.v,host=handshake.h;this.sessionId=handshake.s,this.repoInfo_.updateHost(host),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,timestamp),Constants_1.PROTOCOL_VERSION!==version&&util_1.warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},Connection.prototype.tryStartUpgrade_=function(){var conn=this.transportManager_.upgradeTransport();conn&&this.startUpgrade_(conn)},Connection.prototype.startUpgrade_=function(conn){var _this=this;this.secondaryConn_=new conn(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessage=this.connReceiver_(this.secondaryConn_),onDisconnect=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(onMessage,onDisconnect),util_1.setTimeoutNonBlocking(function(){_this.secondaryConn_&&(_this.log_("Timed out trying to upgrade."),_this.secondaryConn_.close())},Math.floor(6e4))},Connection.prototype.onReset_=function(host){this.log_("Reset packet received.  New host: "+host),this.repoInfo_.updateHost(host),1===this.state_?this.close():(this.closeConnections_(),this.start_())},Connection.prototype.onConnectionEstablished_=function(conn,timestamp){var _this=this;this.log_("Realtime connection established."),this.conn_=conn,this.state_=1,this.onReady_&&(this.onReady_(timestamp,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):util_1.setTimeoutNonBlocking(function(){_this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},Connection.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},Connection.prototype.onSecondaryConnectionLost_=function(){var conn=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==conn&&this.rx_!==conn||this.close()},Connection.prototype.onConnectionLost_=function(everConnected){this.conn_=null,everConnected||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(storage_1.PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},Connection.prototype.onConnectionShutdown_=function(reason){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(reason),this.onKill_=null),this.onDisconnect_=null,this.close()},Connection.prototype.sendData_=function(data){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(data)},Connection.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},Connection.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},Connection}();exports.Connection=Connection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),CountedSet_1=__webpack_require__(79),StatsManager_1=__webpack_require__(51),PacketReceiver_1=__webpack_require__(167),Constants_1=__webpack_require__(35),util_2=__webpack_require__(0),util_3=__webpack_require__(0);exports.FIREBASE_LONGPOLL_START_PARAM="start",exports.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",exports.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",exports.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",exports.FIREBASE_LONGPOLL_ID_PARAM="id",exports.FIREBASE_LONGPOLL_PW_PARAM="pw",exports.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",exports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",exports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",exports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",exports.FIREBASE_LONGPOLL_DATA_PARAM="d",exports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",exports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var BrowserPollConnection=function(){function BrowserPollConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId,this.repoInfo=repoInfo,this.transportSessionId=transportSessionId,this.lastSessionId=lastSessionId,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=util_1.logWrapper(connId),this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo),this.urlFn=function(params){return repoInfo.connectionURL(Constants_1.LONG_POLLING,params)}}return BrowserPollConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.curSegmentNum=0,this.onDisconnect_=onDisconnect,this.myPacketOrderer=new PacketReceiver_1.PacketReceiver(onMessage),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){_this.log_("Timed out trying to connect."),_this.onClosed_(),_this.connectTimeoutTimer_=null},Math.floor(3e4)),util_1.executeWhenDOMReady(function(){if(!_this.isClosed_){_this.scriptTagHolder=new FirebaseIFrameScriptHolder(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var command=args[0],arg1=args[1],arg2=args[2];args[3],args[4];if(_this.incrementIncomingBytes_(args),_this.scriptTagHolder)if(_this.connectTimeoutTimer_&&(clearTimeout(_this.connectTimeoutTimer_),_this.connectTimeoutTimer_=null),_this.everConnected_=!0,command==exports.FIREBASE_LONGPOLL_START_PARAM)_this.id=arg1,_this.password=arg2;else{if(command!==exports.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw new Error("Unrecognized command received: "+command);arg1?(_this.scriptTagHolder.sendNewPolls=!1,_this.myPacketOrderer.closeAfter(arg1,function(){_this.onClosed_()})):_this.onClosed_()}},function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var pN=args[0],data=args[1];_this.incrementIncomingBytes_(args),_this.myPacketOrderer.handleResponse(pN,data)},function(){_this.onClosed_()},_this.urlFn);var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_START_PARAM]="t",urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),_this.scriptTagHolder.uniqueCallbackIdentifier&&(urlParams[exports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=_this.scriptTagHolder.uniqueCallbackIdentifier),urlParams[Constants_1.VERSION_PARAM]=Constants_1.PROTOCOL_VERSION,_this.transportSessionId&&(urlParams[Constants_1.TRANSPORT_SESSION_PARAM]=_this.transportSessionId),_this.lastSessionId&&(urlParams[Constants_1.LAST_SESSION_PARAM]=_this.lastSessionId),!util_3.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Constants_1.FORGE_DOMAIN)&&(urlParams[Constants_1.REFERER_PARAM]=Constants_1.FORGE_REF);var connectURL=_this.urlFn(urlParams);_this.log_("Connecting via long-poll to "+connectURL),_this.scriptTagHolder.addTag(connectURL,function(){})}})},BrowserPollConnection.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},BrowserPollConnection.forceAllow=function(){BrowserPollConnection.forceAllow_=!0},BrowserPollConnection.forceDisallow=function(){BrowserPollConnection.forceDisallow_=!0},BrowserPollConnection.isAvailable=function(){return BrowserPollConnection.forceAllow_||!BrowserPollConnection.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!util_1.isChromeExtensionContentScript()&&!util_1.isWindowsStoreApp()&&!util_3.isNodeSdk()},BrowserPollConnection.prototype.markConnectionHealthy=function(){},BrowserPollConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},BrowserPollConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},BrowserPollConnection.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},BrowserPollConnection.prototype.send=function(data){var dataStr=util_2.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter("bytes_sent",dataStr.length);for(var base64data=util_2.base64Encode(dataStr),dataSegs=util_1.splitStringBySize(base64data,1840),i=0;i<dataSegs.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,dataSegs.length,dataSegs[i]),this.curSegmentNum++},BrowserPollConnection.prototype.addDisconnectPingFrame=function(id,pw){if(!util_3.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=id,urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=pw,this.myDisconnFrame.src=this.urlFn(urlParams),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},BrowserPollConnection.prototype.incrementIncomingBytes_=function(args){var bytesReceived=util_2.stringify(args).length;this.bytesReceived+=bytesReceived,this.stats_.incrementCounter("bytes_received",bytesReceived)},BrowserPollConnection}();exports.BrowserPollConnection=BrowserPollConnection;var FirebaseIFrameScriptHolder=function(){function FirebaseIFrameScriptHolder(commandCB,onMessageCB,onDisconnect,urlFn){if(this.onDisconnect=onDisconnect,this.urlFn=urlFn,this.outstandingRequests=new CountedSet_1.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,util_3.isNodeSdk())this.commandCB=commandCB,this.onMessageCB=onMessageCB;else{this.uniqueCallbackIdentifier=util_1.LUIDGenerator(),window[exports.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=commandCB,window[exports.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=onMessageCB,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();var script="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){script='<script>document.domain="'+document.domain+'";<\/script>'}var iframeContents="<html><body>"+script+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(iframeContents),this.myIFrame.doc.close()}catch(e){util_1.log("frame writing exception"),e.stack&&util_1.log(e.stack),util_1.log(e)}}}return FirebaseIFrameScriptHolder.createIFrame_=function(){var iframe=document.createElement("iframe");if(iframe.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(iframe);try{iframe.contentWindow.document||util_1.log("No IE domain setting required")}catch(e){var domain=document.domain;iframe.src="javascript:void((function(){document.open();document.domain='"+domain+"';document.close();})())"}return iframe.contentDocument?iframe.doc=iframe.contentDocument:iframe.contentWindow?iframe.doc=iframe.contentWindow.document:iframe.document&&(iframe.doc=iframe.document),iframe},FirebaseIFrameScriptHolder.prototype.close=function(){var _this=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==_this.myIFrame&&(document.body.removeChild(_this.myIFrame),_this.myIFrame=null)},Math.floor(0))),util_3.isNodeSdk()&&this.myID){var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var theURL=this.urlFn(urlParams);FirebaseIFrameScriptHolder.nodeRestRequest(theURL)}var onDisconnect=this.onDisconnect;onDisconnect&&(this.onDisconnect=null,onDisconnect())},FirebaseIFrameScriptHolder.prototype.startLongPoll=function(id,pw){for(this.myID=id,this.myPW=pw,this.alive=!0;this.newRequest_(););},FirebaseIFrameScriptHolder.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var theURL=this.urlFn(urlParams),curDataString="",i=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+curDataString.length<=1870))break;var theSeg=this.pendingSegs.shift();curDataString=curDataString+"&"+exports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+theSeg.seg+"&"+exports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+theSeg.ts+"&"+exports.FIREBASE_LONGPOLL_DATA_PARAM+i+"="+theSeg.d,i++}return theURL+=curDataString,this.addLongPollTag_(theURL,this.currentSerial),!0}return!1},FirebaseIFrameScriptHolder.prototype.enqueueSegment=function(segnum,totalsegs,data){this.pendingSegs.push({seg:segnum,ts:totalsegs,d:data}),this.alive&&this.newRequest_()},FirebaseIFrameScriptHolder.prototype.addLongPollTag_=function(url,serial){var _this=this;this.outstandingRequests.add(serial,1);var doNewRequest=function(){_this.outstandingRequests.remove(serial),_this.newRequest_()},keepaliveTimeout=setTimeout(doNewRequest,Math.floor(25e3)),readyStateCB=function(){clearTimeout(keepaliveTimeout),doNewRequest()};this.addTag(url,readyStateCB)},FirebaseIFrameScriptHolder.prototype.addTag=function(url,loadCB){var _this=this;util_3.isNodeSdk()?this.doNodeLongPoll(url,loadCB):setTimeout(function(){try{if(!_this.sendNewPolls)return;var newScript_1=_this.myIFrame.doc.createElement("script");newScript_1.type="text/javascript",newScript_1.async=!0,newScript_1.src=url,newScript_1.onload=newScript_1.onreadystatechange=function(){var rstate=newScript_1.readyState;rstate&&"loaded"!==rstate&&"complete"!==rstate||(newScript_1.onload=newScript_1.onreadystatechange=null,newScript_1.parentNode&&newScript_1.parentNode.removeChild(newScript_1),loadCB())},newScript_1.onerror=function(){util_1.log("Long-poll script failed to load: "+url),_this.sendNewPolls=!1,_this.close()},_this.myIFrame.doc.body.appendChild(newScript_1)}catch(e){}},Math.floor(1))},FirebaseIFrameScriptHolder}();exports.FirebaseIFrameScriptHolder=FirebaseIFrameScriptHolder},function(module,exports,__webpack_require__){"use strict";(function(process){function setWebSocketImpl(impl){WebSocketImpl=impl}Object.defineProperty(exports,"__esModule",{value:!0});var app_1=__webpack_require__(18),util_1=__webpack_require__(0),util_2=__webpack_require__(1),StatsManager_1=__webpack_require__(51),Constants_1=__webpack_require__(35),util_3=__webpack_require__(0),storage_1=__webpack_require__(34),util_4=__webpack_require__(0),util_5=__webpack_require__(0),WebSocketImpl=null;"undefined"!=typeof MozWebSocket?WebSocketImpl=MozWebSocket:"undefined"!=typeof WebSocket&&(WebSocketImpl=WebSocket),exports.setWebSocketImpl=setWebSocketImpl;var WebSocketConnection=function(){function WebSocketConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=util_2.logWrapper(this.connId),this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo),this.connURL=WebSocketConnection.connectionURL_(repoInfo,transportSessionId,lastSessionId)}return WebSocketConnection.connectionURL_=function(repoInfo,transportSessionId,lastSessionId){var urlParams={};return urlParams[Constants_1.VERSION_PARAM]=Constants_1.PROTOCOL_VERSION,!util_5.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Constants_1.FORGE_DOMAIN)&&(urlParams[Constants_1.REFERER_PARAM]=Constants_1.FORGE_REF),transportSessionId&&(urlParams[Constants_1.TRANSPORT_SESSION_PARAM]=transportSessionId),lastSessionId&&(urlParams[Constants_1.LAST_SESSION_PARAM]=lastSessionId),repoInfo.connectionURL(Constants_1.WEBSOCKET,urlParams)},WebSocketConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.onDisconnect=onDisconnect,this.onMessage=onMessage,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,storage_1.PersistentStorage.set("previous_websocket_failure",!0);try{if(util_5.isNodeSdk()){var device=util_3.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",options={headers:{"User-Agent":"Firebase/"+Constants_1.PROTOCOL_VERSION+"/"+app_1.default.SDK_VERSION+"/"+process.platform+"/"+device}},env=Object({NODE_ENV:"production"}),proxy=0==this.connURL.indexOf("wss://")?env.HTTPS_PROXY||env.https_proxy:env.HTTP_PROXY||env.http_proxy;proxy&&(options.proxy={origin:proxy}),this.mySock=new WebSocketImpl(this.connURL,[],options)}else this.mySock=new WebSocketImpl(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var error=e.message||e.data;return error&&this.log_(error),void this.onClosed_()}this.mySock.onopen=function(){_this.log_("Websocket connected."),_this.everConnected_=!0},this.mySock.onclose=function(){_this.log_("Websocket connection was disconnected."),_this.mySock=null,_this.onClosed_()},this.mySock.onmessage=function(m){_this.handleIncomingFrame(m)},this.mySock.onerror=function(e){_this.log_("WebSocket error.  Closing connection.");var error=e.message||e.data;error&&_this.log_(error),_this.onClosed_()}},WebSocketConnection.prototype.start=function(){},WebSocketConnection.forceDisallow=function(){WebSocketConnection.forceDisallow_=!0},WebSocketConnection.isAvailable=function(){var isOldAndroid=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var oldAndroidRegex=/Android ([0-9]{0,}\.[0-9]{0,})/,oldAndroidMatch=navigator.userAgent.match(oldAndroidRegex);oldAndroidMatch&&oldAndroidMatch.length>1&&parseFloat(oldAndroidMatch[1])<4.4&&(isOldAndroid=!0)}return!isOldAndroid&&null!==WebSocketImpl&&!WebSocketConnection.forceDisallow_},WebSocketConnection.previouslyFailed=function(){return storage_1.PersistentStorage.isInMemoryStorage||!0===storage_1.PersistentStorage.get("previous_websocket_failure")},WebSocketConnection.prototype.markConnectionHealthy=function(){storage_1.PersistentStorage.remove("previous_websocket_failure")},WebSocketConnection.prototype.appendFrame_=function(data){if(this.frames.push(data),this.frames.length==this.totalFrames){var fullMess=this.frames.join("");this.frames=null;var jsonMess=util_4.jsonEval(fullMess);this.onMessage(jsonMess)}},WebSocketConnection.prototype.handleNewFrameCount_=function(frameCount){this.totalFrames=frameCount,this.frames=[]},WebSocketConnection.prototype.extractFrameCount_=function(data){if(util_1.assert(null===this.frames,"We already have a frame buffer"),data.length<=6){var frameCount=Number(data);if(!isNaN(frameCount))return this.handleNewFrameCount_(frameCount),null}return this.handleNewFrameCount_(1),data},WebSocketConnection.prototype.handleIncomingFrame=function(mess){if(null!==this.mySock){var data=mess.data;if(this.bytesReceived+=data.length,this.stats_.incrementCounter("bytes_received",data.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(data);else{var remainingData=this.extractFrameCount_(data);null!==remainingData&&this.appendFrame_(remainingData)}}},WebSocketConnection.prototype.send=function(data){this.resetKeepAlive();var dataStr=util_4.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter("bytes_sent",dataStr.length);var dataSegs=util_2.splitStringBySize(dataStr,16384);dataSegs.length>1&&this.sendString_(String(dataSegs.length));for(var i=0;i<dataSegs.length;i++)this.sendString_(dataSegs[i])},WebSocketConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},WebSocketConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},WebSocketConnection.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},WebSocketConnection.prototype.resetKeepAlive=function(){var _this=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){_this.mySock&&_this.sendString_("0"),_this.resetKeepAlive()},Math.floor(45e3))},WebSocketConnection.prototype.sendString_=function(str){try{this.mySock.send(str)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},WebSocketConnection.responsesRequiredToBeHealthy=2,WebSocketConnection.healthyTimeout=3e4,WebSocketConnection}();exports.WebSocketConnection=WebSocketConnection}).call(exports,__webpack_require__(44))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ServerActions=function(){function ServerActions(){}return ServerActions.prototype.put=function(pathString,data,onComplete,hash){},ServerActions.prototype.merge=function(pathString,data,onComplete,hash){},ServerActions.prototype.refreshAuthToken=function(token){},ServerActions.prototype.onDisconnectPut=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectMerge=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectCancel=function(pathString,onComplete){},ServerActions.prototype.reportStats=function(stats){},ServerActions}();exports.ServerActions=ServerActions},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var IndexedFilter_1=__webpack_require__(50),PriorityIndex_1=__webpack_require__(8),Node_1=__webpack_require__(11),ChildrenNode_1=__webpack_require__(10),RangedFilter=function(){function RangedFilter(params){this.indexedFilter_=new IndexedFilter_1.IndexedFilter(params.getIndex()),this.index_=params.getIndex(),this.startPost_=RangedFilter.getStartPost_(params),this.endPost_=RangedFilter.getEndPost_(params)}return RangedFilter.prototype.getStartPost=function(){return this.startPost_},RangedFilter.prototype.getEndPost=function(){return this.endPost_},RangedFilter.prototype.matches=function(node){return this.index_.compare(this.getStartPost(),node)<=0&&this.index_.compare(node,this.getEndPost())<=0},RangedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.matches(new Node_1.NamedNode(key,newChild))||(newChild=ChildrenNode_1.ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)},RangedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){newSnap.isLeafNode()&&(newSnap=ChildrenNode_1.ChildrenNode.EMPTY_NODE);var filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);var self=this;return newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){self.matches(new Node_1.NamedNode(key,childNode))||(filtered=filtered.updateImmediateChild(key,ChildrenNode_1.ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(oldSnap,filtered,optChangeAccumulator)},RangedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},RangedFilter.prototype.filtersNodes=function(){return!0},RangedFilter.prototype.getIndexedFilter=function(){return this.indexedFilter_},RangedFilter.prototype.getIndex=function(){return this.index_},RangedFilter.getStartPost_=function(params){if(params.hasStart()){var startName=params.getIndexStartName();return params.getIndex().makePost(params.getIndexStartValue(),startName)}return params.getIndex().minPost()},RangedFilter.getEndPost_=function(params){if(params.hasEnd()){var endName=params.getIndexEndName();return params.getIndex().makePost(params.getIndexEndValue(),endName)}return params.getIndex().maxPost()},RangedFilter}();exports.RangedFilter=RangedFilter},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_1__models_errors__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__),__webpack_require__(41)),__WEBPACK_IMPORTED_MODULE_2__models_token_manager__=__webpack_require__(178),__WEBPACK_IMPORTED_MODULE_3__models_notification_permission__=__webpack_require__(93),SENDER_ID_OPTION_NAME="messagingSenderId",ControllerInterface=function(){function ControllerInterface(app){var _this=this;if(this.errorFactory_=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__.ErrorFactory("messaging","Messaging",__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.map),!app.options[SENDER_ID_OPTION_NAME]||"string"!=typeof app.options[SENDER_ID_OPTION_NAME])throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.BAD_SENDER_ID);this.messagingSenderId_=app.options[SENDER_ID_OPTION_NAME],this.tokenManager_=new __WEBPACK_IMPORTED_MODULE_2__models_token_manager__.a,this.app=app,this.INTERNAL={},this.INTERNAL.delete=function(){return _this.delete}}return ControllerInterface.prototype.getToken=function(){var _this=this,currentPermission=this.getNotificationPermission_();return currentPermission!==__WEBPACK_IMPORTED_MODULE_3__models_notification_permission__.a.granted?currentPermission===__WEBPACK_IMPORTED_MODULE_3__models_notification_permission__.a.denied?Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this.getSWRegistration_().then(function(registration){return _this.tokenManager_.getSavedToken(_this.messagingSenderId_,registration).then(function(token){return token||_this.tokenManager_.createToken(_this.messagingSenderId_,registration)})})},ControllerInterface.prototype.deleteToken=function(token){var _this=this;return this.tokenManager_.deleteToken(token).then(function(){return _this.getSWRegistration_().then(function(registration){if(registration)return registration.pushManager.getSubscription()}).then(function(subscription){if(subscription)return subscription.unsubscribe()})})},ControllerInterface.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.SHOULD_BE_INHERITED)},ControllerInterface.prototype.requestPermission=function(){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.AVAILABLE_IN_WINDOW)},ControllerInterface.prototype.useServiceWorker=function(registration){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.AVAILABLE_IN_WINDOW)},ControllerInterface.prototype.onMessage=function(nextOrObserver,optError,optCompleted){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.AVAILABLE_IN_WINDOW)},ControllerInterface.prototype.onTokenRefresh=function(nextOrObserver,optError,optCompleted){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.AVAILABLE_IN_WINDOW)},ControllerInterface.prototype.setBackgroundMessageHandler=function(callback){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.AVAILABLE_IN_SW)},ControllerInterface.prototype.delete=function(){return this.tokenManager_.closeDatabase()},ControllerInterface.prototype.getNotificationPermission_=function(){return Notification.permission},ControllerInterface.prototype.getTokenManager=function(){return this.tokenManager_},ControllerInterface}();__webpack_exports__.a=ControllerInterface},function(module,__webpack_exports__,__webpack_require__){"use strict";var FCM_APPLICATION_SERVER_KEY=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],SUBSCRIPTION_DETAILS={userVisibleOnly:!0,applicationServerKey:new Uint8Array(FCM_APPLICATION_SERVER_KEY)};__webpack_exports__.a={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:FCM_APPLICATION_SERVER_KEY,SUBSCRIPTION_OPTIONS:SUBSCRIPTION_DETAILS}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={granted:"granted",default:"default",denied:"denied"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var PARAMS={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},msgType={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},createNewMsg=function(msgType,msgData){return _a={},_a[PARAMS.TYPE_OF_MSG]=msgType,_a[PARAMS.DATA]=msgData,_a;var _a};__webpack_exports__.a={PARAMS:PARAMS,TYPES_OF_MSG:msgType,createNewMsg:createNewMsg}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ErrorCode});var ErrorCode;!function(ErrorCode){ErrorCode[ErrorCode.NO_ERROR=0]="NO_ERROR",ErrorCode[ErrorCode.NETWORK_ERROR=1]="NETWORK_ERROR",ErrorCode[ErrorCode.ABORT=2]="ABORT"}(ErrorCode||(ErrorCode={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Reference});var __WEBPACK_IMPORTED_MODULE_0__implementation_args__=__webpack_require__(53),__WEBPACK_IMPORTED_MODULE_1__implementation_blob__=__webpack_require__(98),__WEBPACK_IMPORTED_MODULE_2__implementation_error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_3__implementation_location__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_4__implementation_metadata__=__webpack_require__(54),__WEBPACK_IMPORTED_MODULE_5__implementation_object__=__webpack_require__(25),__WEBPACK_IMPORTED_MODULE_6__implementation_path__=__webpack_require__(97),__WEBPACK_IMPORTED_MODULE_7__implementation_requests__=__webpack_require__(99),__WEBPACK_IMPORTED_MODULE_8__implementation_string__=__webpack_require__(30),__WEBPACK_IMPORTED_MODULE_9__implementation_type__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_10__task__=__webpack_require__(189),Reference=function(){function Reference(authWrapper,location){this.authWrapper=authWrapper,location instanceof __WEBPACK_IMPORTED_MODULE_3__implementation_location__.a?this.location=location:this.location=__WEBPACK_IMPORTED_MODULE_3__implementation_location__.a.makeFromUrl(location)}return Reference.prototype.toString=function(){return __WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},Reference.prototype.newRef=function(authWrapper,location){return new Reference(authWrapper,location)},Reference.prototype.mappings=function(){return __WEBPACK_IMPORTED_MODULE_4__implementation_metadata__.b()},Reference.prototype.child=function(childPath){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("child",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.e()],arguments);var newPath=__WEBPACK_IMPORTED_MODULE_6__implementation_path__.a(this.location.path,childPath),location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__.a(this.location.bucket,newPath);return this.newRef(this.authWrapper,location)},Object.defineProperty(Reference.prototype,"parent",{get:function(){var newPath=__WEBPACK_IMPORTED_MODULE_6__implementation_path__.c(this.location.path);if(null===newPath)return null;var location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__.a(this.location.bucket,newPath);return this.newRef(this.authWrapper,location)},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"root",{get:function(){var location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__.a(this.location.bucket,"");return this.newRef(this.authWrapper,location)},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"name",{get:function(){return __WEBPACK_IMPORTED_MODULE_6__implementation_path__.b(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),Reference.prototype.put=function(data,metadata){return void 0===metadata&&(metadata=null),__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("put",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.f(),__WEBPACK_IMPORTED_MODULE_0__implementation_args__.b(!0)],arguments),this.throwIfRoot_("put"),new __WEBPACK_IMPORTED_MODULE_10__task__.a(this,this.authWrapper,this.location,this.mappings(),new __WEBPACK_IMPORTED_MODULE_1__implementation_blob__.a(data),metadata)},Reference.prototype.putString=function(string,format,opt_metadata){void 0===format&&(format=__WEBPACK_IMPORTED_MODULE_8__implementation_string__.a.RAW),__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("putString",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.e(),__WEBPACK_IMPORTED_MODULE_0__implementation_args__.e(__WEBPACK_IMPORTED_MODULE_8__implementation_string__.c,!0),__WEBPACK_IMPORTED_MODULE_0__implementation_args__.b(!0)],arguments),this.throwIfRoot_("putString");var data=__WEBPACK_IMPORTED_MODULE_8__implementation_string__.b(format,string),metadata=__WEBPACK_IMPORTED_MODULE_5__implementation_object__.a(opt_metadata);return!__WEBPACK_IMPORTED_MODULE_9__implementation_type__.a(metadata.contentType)&&__WEBPACK_IMPORTED_MODULE_9__implementation_type__.a(data.contentType)&&(metadata.contentType=data.contentType),new __WEBPACK_IMPORTED_MODULE_10__task__.a(this,this.authWrapper,this.location,this.mappings(),new __WEBPACK_IMPORTED_MODULE_1__implementation_blob__.a(data.data,!0),metadata)},Reference.prototype.delete=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("delete",[],arguments),this.throwIfRoot_("delete");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__.d(self.authWrapper,self.location);return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})},Reference.prototype.getMetadata=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__.e(self.authWrapper,self.location,self.mappings());return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})},Reference.prototype.updateMetadata=function(metadata){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("updateMetadata",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.b()],arguments),this.throwIfRoot_("updateMetadata");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__.i(self.authWrapper,self.location,metadata,self.mappings());return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})},Reference.prototype.getDownloadURL=function(){return __WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(metadata){var url=metadata.downloadURLs[0];if(__WEBPACK_IMPORTED_MODULE_9__implementation_type__.a(url))return url;throw __WEBPACK_IMPORTED_MODULE_2__implementation_error__.l()})},Reference.prototype.throwIfRoot_=function(name){if(""===this.location.path)throw __WEBPACK_IMPORTED_MODULE_2__implementation_error__.j(name)},Reference}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function parent(path){if(0==path.length)return null;var index=path.lastIndexOf("/");return-1===index?"":path.slice(0,index)}function child(path,childPath){var canonicalChildPath=childPath.split("/").filter(function(component){return component.length>0}).join("/");return 0===path.length?canonicalChildPath:path+"/"+canonicalChildPath}function lastComponent(path){var index=path.lastIndexOf("/",path.length-2);return-1===index?path:path.slice(index+1)}__webpack_exports__.c=parent,__webpack_exports__.a=child,__webpack_exports__.b=lastComponent},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return FbsBlob});var __WEBPACK_IMPORTED_MODULE_0__fs__=__webpack_require__(187),__WEBPACK_IMPORTED_MODULE_1__string__=__webpack_require__(30),__WEBPACK_IMPORTED_MODULE_2__type__=__webpack_require__(12),FbsBlob=function(){function FbsBlob(data,opt_elideCopy){var size=0,blobType="";__WEBPACK_IMPORTED_MODULE_2__type__.d(data)?(this.data_=data,size=data.size,blobType=data.type):data instanceof ArrayBuffer?(opt_elideCopy?this.data_=new Uint8Array(data):(this.data_=new Uint8Array(data.byteLength),this.data_.set(new Uint8Array(data))),size=this.data_.length):data instanceof Uint8Array&&(opt_elideCopy?this.data_=data:(this.data_=new Uint8Array(data.length),this.data_.set(data)),size=data.length),this.size_=size,this.type_=blobType}return FbsBlob.prototype.size=function(){return this.size_},FbsBlob.prototype.type=function(){return this.type_},FbsBlob.prototype.slice=function(startByte,endByte){if(__WEBPACK_IMPORTED_MODULE_2__type__.d(this.data_)){var realBlob=this.data_,sliced=__WEBPACK_IMPORTED_MODULE_0__fs__.b(realBlob,startByte,endByte);return null===sliced?null:new FbsBlob(sliced)}return new FbsBlob(new Uint8Array(this.data_.buffer,startByte,endByte-startByte),!0)},FbsBlob.getBlob=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];if(__WEBPACK_IMPORTED_MODULE_2__type__.e()){var blobby=var_args.map(function(val){return val instanceof FbsBlob?val.data_:val});return new FbsBlob(__WEBPACK_IMPORTED_MODULE_0__fs__.a.apply(null,blobby))}var uint8Arrays=var_args.map(function(val){return __WEBPACK_IMPORTED_MODULE_2__type__.j(val)?__WEBPACK_IMPORTED_MODULE_1__string__.b(__WEBPACK_IMPORTED_MODULE_1__string__.a.RAW,val).data:val.data_}),finalLength_1=0;uint8Arrays.forEach(function(array){finalLength_1+=array.byteLength});var merged_1=new Uint8Array(finalLength_1),index_1=0;return uint8Arrays.forEach(function(array){for(var i=0;i<array.length;i++)merged_1[index_1++]=array[i]}),new FbsBlob(merged_1,!0)},FbsBlob.prototype.uploadData=function(){return this.data_},FbsBlob}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function handlerCheck(cndn){if(!cndn)throw __WEBPACK_IMPORTED_MODULE_2__error__.s()}function metadataHandler(authWrapper,mappings){function handler(xhr,text){var metadata=__WEBPACK_IMPORTED_MODULE_3__metadata__.a(authWrapper,text,mappings);return handlerCheck(null!==metadata),metadata}return handler}function sharedErrorHandler(location){function errorHandler(xhr,err){var newErr;return newErr=401===xhr.getStatus()?__WEBPACK_IMPORTED_MODULE_2__error__.q():402===xhr.getStatus()?__WEBPACK_IMPORTED_MODULE_2__error__.n(location.bucket):403===xhr.getStatus()?__WEBPACK_IMPORTED_MODULE_2__error__.r(location.path):err,newErr.setServerResponseProp(err.serverResponseProp()),newErr}return errorHandler}function objectErrorHandler(location){function errorHandler(xhr,err){var newErr=shared(xhr,err);return 404===xhr.getStatus()&&(newErr=__WEBPACK_IMPORTED_MODULE_2__error__.m(location.path)),newErr.setServerResponseProp(err.serverResponseProp()),newErr}var shared=sharedErrorHandler(location);return errorHandler}function getMetadata(authWrapper,location,mappings){var urlPart=location.fullServerUrl(),url=__WEBPACK_IMPORTED_MODULE_7__url__.b(urlPart),timeout=authWrapper.maxOperationRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"GET",metadataHandler(authWrapper,mappings),timeout);return requestInfo.errorHandler=objectErrorHandler(location),requestInfo}function updateMetadata(authWrapper,location,metadata,mappings){var urlPart=location.fullServerUrl(),url=__WEBPACK_IMPORTED_MODULE_7__url__.b(urlPart),body=__WEBPACK_IMPORTED_MODULE_3__metadata__.d(metadata,mappings),headers={"Content-Type":"application/json; charset=utf-8"},timeout=authWrapper.maxOperationRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"PATCH",metadataHandler(authWrapper,mappings),timeout);return requestInfo.headers=headers,requestInfo.body=body,requestInfo.errorHandler=objectErrorHandler(location),requestInfo}function deleteObject(authWrapper,location){function handler(xhr,text){}var urlPart=location.fullServerUrl(),url=__WEBPACK_IMPORTED_MODULE_7__url__.b(urlPart),timeout=authWrapper.maxOperationRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"DELETE",handler,timeout);return requestInfo.successCodes=[200,204],requestInfo.errorHandler=objectErrorHandler(location),requestInfo}function determineContentType_(metadata,blob){return metadata&&metadata.contentType||blob&&blob.type()||"application/octet-stream"}function metadataForUpload_(location,blob,opt_metadata){var metadata=__WEBPACK_IMPORTED_MODULE_4__object__.a(opt_metadata);return metadata.fullPath=location.path,metadata.size=blob.size(),metadata.contentType||(metadata.contentType=determineContentType_(null,blob)),metadata}function multipartUpload(authWrapper,location,mappings,blob,opt_metadata){var urlPart=location.bucketOnlyServerUrl(),headers={"X-Goog-Upload-Protocol":"multipart"},boundary=function(){for(var str="",i=0;i<2;i++)str+=Math.random().toString().slice(2);return str}();headers["Content-Type"]="multipart/related; boundary="+boundary;var metadata=metadataForUpload_(location,blob,opt_metadata),metadataString=__WEBPACK_IMPORTED_MODULE_3__metadata__.d(metadata,mappings),preBlobPart="--"+boundary+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+metadataString+"\r\n--"+boundary+"\r\nContent-Type: "+metadata.contentType+"\r\n\r\n",postBlobPart="\r\n--"+boundary+"--",body=__WEBPACK_IMPORTED_MODULE_1__blob__.a.getBlob(preBlobPart,blob,postBlobPart);if(null===body)throw __WEBPACK_IMPORTED_MODULE_2__error__.d();var urlParams={name:metadata.fullPath},url=__WEBPACK_IMPORTED_MODULE_7__url__.d(urlPart),timeout=authWrapper.maxUploadRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"POST",metadataHandler(authWrapper,mappings),timeout);return requestInfo.urlParams=urlParams,requestInfo.headers=headers,requestInfo.body=body.uploadData(),requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}function checkResumeHeader_(xhr,opt_allowed){var status;try{status=xhr.getResponseHeader("X-Goog-Upload-Status")}catch(e){handlerCheck(!1)}var allowed=opt_allowed||["active"];return handlerCheck(__WEBPACK_IMPORTED_MODULE_0__array__.b(allowed,status)),status}function createResumableUpload(authWrapper,location,mappings,blob,opt_metadata){function handler(xhr,text){checkResumeHeader_(xhr);var url;try{url=xhr.getResponseHeader("X-Goog-Upload-URL")}catch(e){handlerCheck(!1)}return handlerCheck(__WEBPACK_IMPORTED_MODULE_6__type__.j(url)),url}var urlPart=location.bucketOnlyServerUrl(),metadata=metadataForUpload_(location,blob,opt_metadata),urlParams={name:metadata.fullPath},url=__WEBPACK_IMPORTED_MODULE_7__url__.d(urlPart),headers={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":blob.size(),"X-Goog-Upload-Header-Content-Type":metadata.contentType,"Content-Type":"application/json; charset=utf-8"},body=__WEBPACK_IMPORTED_MODULE_3__metadata__.d(metadata,mappings),timeout=authWrapper.maxUploadRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"POST",handler,timeout);return requestInfo.urlParams=urlParams,requestInfo.headers=headers,requestInfo.body=body,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}function getResumableUploadStatus(authWrapper,location,url,blob){function handler(xhr,text){var sizeString,status=checkResumeHeader_(xhr,["active","final"]);try{sizeString=xhr.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){handlerCheck(!1)}var size=parseInt(sizeString,10);return handlerCheck(!isNaN(size)),new ResumableUploadStatus(size,blob.size(),"final"===status)}var headers={"X-Goog-Upload-Command":"query"},timeout=authWrapper.maxUploadRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"POST",handler,timeout);return requestInfo.headers=headers,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}function continueResumableUpload(location,authWrapper,url,blob,chunkSize,mappings,opt_status,opt_progressCallback){function handler(xhr,text){var metadata,uploadStatus=checkResumeHeader_(xhr,["active","final"]),newCurrent=status.current+bytesToUpload,size=blob.size();return metadata="final"===uploadStatus?metadataHandler(authWrapper,mappings)(xhr,text):null,new ResumableUploadStatus(newCurrent,size,"final"===uploadStatus,metadata)}var status=new ResumableUploadStatus(0,0);if(opt_status?(status.current=opt_status.current,status.total=opt_status.total):(status.current=0,status.total=blob.size()),blob.size()!==status.total)throw __WEBPACK_IMPORTED_MODULE_2__error__.p();var bytesLeft=status.total-status.current,bytesToUpload=bytesLeft;chunkSize>0&&(bytesToUpload=Math.min(bytesToUpload,chunkSize));var startByte=status.current,endByte=startByte+bytesToUpload,uploadCommand=bytesToUpload===bytesLeft?"upload, finalize":"upload",headers={"X-Goog-Upload-Command":uploadCommand,"X-Goog-Upload-Offset":status.current},body=blob.slice(startByte,endByte);if(null===body)throw __WEBPACK_IMPORTED_MODULE_2__error__.d();var timeout=authWrapper.maxUploadRetryTime(),requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__.a(url,"POST",handler,timeout);return requestInfo.headers=headers,requestInfo.body=body.uploadData(),requestInfo.progressCallback=opt_progressCallback||null,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}__webpack_exports__.e=getMetadata,__webpack_exports__.i=updateMetadata,__webpack_exports__.d=deleteObject,__webpack_exports__.g=multipartUpload,__webpack_require__.d(__webpack_exports__,"a",function(){return ResumableUploadStatus}),__webpack_exports__.c=createResumableUpload,__webpack_exports__.f=getResumableUploadStatus,__webpack_require__.d(__webpack_exports__,"h",function(){return resumableUploadChunkSize}),__webpack_exports__.b=continueResumableUpload;var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(56),__WEBPACK_IMPORTED_MODULE_1__blob__=__webpack_require__(98),__WEBPACK_IMPORTED_MODULE_2__error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_3__metadata__=__webpack_require__(54),__WEBPACK_IMPORTED_MODULE_4__object__=__webpack_require__(25),__WEBPACK_IMPORTED_MODULE_5__requestinfo__=__webpack_require__(188),__WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_7__url__=__webpack_require__(55),ResumableUploadStatus=function(){function ResumableUploadStatus(current,total,finalized,metadata){this.current=current,this.total=total,this.finalized=!!finalized,this.metadata=metadata||null}return ResumableUploadStatus}(),resumableUploadChunkSize=262144},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var cache={};exports.spreadHexRange=function(start,end){for(var list=[],i=parseInt(start,16);i<=parseInt(end,16);i++)list.push(i.toString(16));return list},exports.createStylesheet=function(id,content){var styleElement=document.getElementById(id);styleElement&&document.getElementsByTagName("head")[0].removeChild(styleElement),styleElement=document.createElement("style"),styleElement.type="text/css",styleElement.id=id,styleElement.innerHTML=content,document.getElementsByTagName("head")[0].appendChild(styleElement)},exports.generateIconStylesheet=function(unicodes){var stylesheet="";return unicodes.forEach(function(unicode){stylesheet+=".icon-"+unicode+":before{content:'\\"+unicode+"'}"}),stylesheet},exports.setIcons=function(font,range){void 0===cache[font]&&(cache[font]=exports.spreadHexRange(range[0],range[1]),exports.createStylesheet(font,exports.generateIconStylesheet(cache[font])))},exports.getIconClassNames=function(font){return cache[font].map(function(unicode){return"icon-"+unicode})},exports.getIcons=function(font){return cache[font]}},function(module,exports,__webpack_require__){var engine=__webpack_require__(200),storages=__webpack_require__(201),plugins=[__webpack_require__(208)];module.exports=engine.createStore(storages,plugins)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(27);var Checkbox=function(){function Checkbox(){}return Checkbox.prototype.view=function(v){var _this=this,id=Math.random().toString();return m("div",{className:object_1.cleanString("component--Checkbox",v.attrs.className),style:v.attrs.style},m("input",{id:id,type:"checkbox",checked:v.attrs.checked,onchange:function(evt){return _this.emitEvent(v.attrs.onclick,evt)}}),v.attrs.label&&m("label",{htmlFor:id},v.attrs.label))},Checkbox.prototype.emitEvent=function(eventCb,event){event.redraw=!1,object_1.exec(eventCb,event.target.checked,event,function(checked){return event.target.checked=checked})},Checkbox}();exports.default=Checkbox},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(225);var Dialog=function(){function Dialog(){}return Dialog.prototype.view=function(v){return m("div",{className:object_1.cleanString("component--Dialog",v.attrs.className)},m("div",{className:"container",onclick:function(event){return object_1.exec(v.attrs.oncontainerclick,event)}}),m("div",{className:"dialog"},v.children))},Dialog}();exports.default=Dialog},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(27);var Slider=function(){function Slider(){}return Slider.prototype.view=function(v){var _this=this,id=Math.random().toString();return m("div",{className:object_1.cleanString("component--Slider",v.attrs.className),style:v.attrs.style},m("input",{id:id,type:"range",value:v.attrs.value,defaultValue:v.attrs.default,min:v.attrs.min,max:v.attrs.max,step:v.attrs.step,onchange:function(evt){return _this.emitEvent(v.attrs.onchange,evt)},oninput:function(evt){return _this.emitEvent(v.attrs.oninput,evt)}}),v.attrs.label&&m("label",{htmlFor:id},v.attrs.label))},Slider.prototype.emitEvent=function(eventCb,event){event.redraw=!1,object_1.exec(eventCb,event.target.value,event,function(value){return event.target.value=value})},Slider}();exports.default=Slider},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAABUFBMVEUAAABEREBEREBFRUFHR0NEREBFRUFFRUBEREBGRkJEREASEhECAgEGBgUBAQABAQEEBAMGBgYkJCIBAQEDAwICAgEMDAsDAwMHBwdMTEc5OTYICAcMDAsZGRgJCQgLCwsCAgECAgINDQsCAgIMDAwRERAdHRsrKylLS0cdHRsJCQkaGhgAAAAICAgHBwYGBgUICAgSEhESEhECAgIXFxYnJyUlJSMCAgECAgIBAQEEBAQlJSMKCgkCAgIODg0REQ8XFxYPDw4CAgIeHhwLCwoSEhEmJiMaGhgBAQEFBQUBAQELCwsBAQAHBwcYGBcmJiMRERAhIR8GBgYvLyw/PzsDAwMSEhICAgIXFxUKCgkYGBclJSIEBAQeHh0WFhYsLCkbGxkRERAgIB4cHBohISAgIB4tLSo1NTEFBQUICAcSEhEsLCkAAAAjIyEAAAADAwMcPlXkAAAAbnRSTlMAAg0KBwsFAwgEDgf5+/qH6RYJjLDq7e+vFhX9r4sFifbPkY+zsooWEQzastaQPzjstIhyZiYXurX3gnpZ8tWgmWZKD3hyYyncx7+9rKmQi15QRDEaoGzSqZmUfk9BMiAar4JvZjwbE+LevG9pWvRLA8EAAA1MSURBVGjerVr7V9RGFL6zSWaSACtsQelWKFRFkBZUysMqBUHLS6iI1me1tbXv7v7/v/W+MpNsdrU9p3vauJPM5M7c797vPhZoJBlA0ogB4jwy4GhsojwGE+epgayR4M0ot2DSPMVJjQQgSxoWIGrwGBeZBo55EVh5SQNv8iJ8DgD4Tscy0ga+0yYpykgSa3ScJw7HDRas70QZvJFGrJNcElmchOOwURpb3agFHMY4B2waG7ykDrec4jhOLU5PYwfAYxvhOEvTDG/SO21E8yM6bEwbo5sQJ3J4kYk3aU+2Af/vJ0MZEZ+7JCOB6SH+8D+1r4NvTvdf5AyewxV45IhHTPiszH167tynU1Pnzp27SV9vTt2k8U0cT03xmJ7Pyfgcfe0Z63N5yTLYmM9hAVLGg2TC/vnrE6Oj58/j5fr50dGJ6zjGb/h1FC8TfKGbeJWvdBmlSTie4DGtvC7zn69a06MrBBE6nU6326Frp/5VLzoeeDMsuvaNBYcy1HZt0nDgEsCnlZX/ctzt//zzuzGkgkeKMggPl+QQ5oQt+Wvfc3TCR8UFQU8fWpeQrvKYbDly4AifXg1c2D/YON4+ITDfHvTZcnf/0lcE8aWtZ1cO9mf4UZg0e8e6gEeUoQyUCZ2yjJnfj7bv7+ytJQboM9es62rkwQLwZ7q9enp/a3azorCvv4kh4GGEgAyUddGcPG0vpNYZkQE3Z+r6v/VgDICeG+NsnLx+shmek5ChCuklbMtl4A8fniX07pjeQSzx0XDdpIYn2zTHEdWQqNXTyyW7nH0YC5/FiIc6f5qDX97c2OFlFulP4IJLI3WzHb5yFQCXM7zE4PA9HqZ4jpgYxIPImmw3EXzAY3q4hGudQRlK0wCffVK33ZEbpC7m2ZR41wGsPrkgz1lIhnhkbLuFTwIU7xjdaUHMJmGE2/HzxUjduEbGx3CLGoQMcQdkq0fFbmYReANWZOREMKS7AviJhy3IDNkFH9OCcYjJrboPDk9eRWVYXZ7SfIB3B/xcgC9slyYJPiDLN49J0UQ1Rh9HcS/wCt3Fj8Gyuwl3GLAW4LvRrrcum/BGSVdqA2pdB6cGwMdap7H20nCdO5pX2qAcCGyrjgLy6nM2LsIExD9yxYNsQIE/aZCMXPGQfVaB75aBh1KsZYXZO97jM/GPzNA51M46tPrrU4BgdqxvAb7OiSOXx9SuRFdiZ7B3OIMTCHhj1c8j9ZcMgBY2v/2F/cMEuAT44TrvDqN12UaBR8Zcnibw693fPK04H9+NZUNi65o5BaJMVnWmNB2Xge/2AJ+SriQXcupUr592CPifh/xGI1WOEeA/f82q5TRGaRoFkZB6PCEhRmyXNlbEWti9TM+JVsQ4xe8FHwJ+4tJViBLnXVTyq4wwCTICrawBQNCVkTjozMq+AG8SeYlyfUbPKdK8akAVDzI7tq6qrhT4ICMrNpZY83oDnz99GDvdKNmEKgeIOr+PwKmMmGxXckvyk5oMAZ4U6uQdmtCCeXOsmODhggxK9FjItbMY2D+CbTqIheqrMpRWbGQUD7Yj9kmIT/D5+Z9aAPISkpElJCOC4+PFt+0yZaouGilxVz2HIOAdJc0BRJ4fI+U/e/bpkitATTKUIQDAbvtxDpCJrggPNQmJJz05hNIKu4IRu9JYGyGI5vHjXba7Eh6SqBvj+J1BV4nmswH4IEhpRQsMn7dn6C8k2hnNIRKPuST/TIwiUvGgOQPjSfPyVVRDpLYLJVtNLegYF1PGLzIIr5LqosAVFlxGwNfjSXPyY4hpn+U8kYsc7x/ombsoTp5zfRL8Iy7XUSZK3xNPslIdpUEocIkxQ6/u7mWOz8nBluK1cDsP1ce0NrvU7Ac80kq5jspURqac6AAeHY7+2AbjeVhNPfiHnoPGCnyVI5s31tjdqnli4mOtQRkbzc7M9iprQ15K06t4hHjymcSTGq24tCSj7C+0aGFng2c+3wPjRDmQM7eXVat2A+SMNRkMvM2tX1T4Cwge4HYO9dxbLaPFMFg1gcB5Wtcy8DUZIkTiuz+H15UDWFovctuJrR/AUCFLwEdVPJyONZHo5WHiLuO5XJLNgMfQznqwyFtbe8COiTIYD4m9igfrwqEzftJrwEr1EOooXSR4tHbWZaoWNdtvSI2OUkBZ43UlY9OXVlSI1FFCcrn3D4Dl8fK58dhPWmAsgM9tAh4qQz2+2wM8UX2oo0IOZxCPjc2e+YyLA+EGpX4XZNgQT+rAMwcSX/m8hHT1aqNbN5RtwkW4PaRKOjaJAl+rTy62wfk6KsgwAY/qouc/FDJcRVeOuLyeSATg2cfYzwPvPlpv9i2WZ54tEB7K7UEG+ZjtA7wKYcxDHZUCymjsrM8MKMAvPAfZt9eV95cB8aQzfHkNMuV2zy0ZvJv1VXn9MLVcKHJaR7laPPG0ElfrqDgBuDNzofgoFzX9nU3gWOtUV7wvraOIVurAazyRpCBwOaz+efveyv3bt1dW7h3JaSYeyHjl9ksoc3uwZVMvTLsKPBWmXIwFbqFF7R/W2u3Hj9fG1l7Kxmb/Grv6+JerbbzQltSdhOudyOxXn3RCYaqLAn9Z8J8/tVR5FW71cInx52Ihg+oTmSQ9M59TcI4HC1OyaP9LAOUe6PWPqEhjzID6ZLKNKzNfD0ouSngm3CiFoa9k0bWfQANCBhU8LJ1D9/W++iQOmKsNqMwkgumvBPhrd6EoxqDkH4qH5DLlwlSumkggrZhK7E00+dREZOGmAP/5l6h7JrmG4uH9Q3TFx1Tgg4wAfDUXjQtu4SA0/y3NZCE21eZEUfMbGgoePHaD44meQ0mP5ovuZFE+J4tQCDjg5ir4x5pHluPJF/V4IqWDt11xgNjbQBZDi4DvKvDa6Eyh4h+CB8eTOvAhnuhyE/CIRXeJAo9CvsNJUoxp/UccSVySF3gYBr5ZjydcnwDrikAsFGxzAdVBi4HvECYgRUyOmAVdJeUegPXxpFMFXgtTbfSU8HC4SIBX63KpJrylPJ6GKoPO9eF4wiBWkzYVQsD/DA4Fs/HyMX19YgrduXLbo1uOJ5NjxKGh6GfbFX/Bi4UhVBcDj+pSkEHeacv+4SSeDEgkmFbUPxQPDXwZ6Z6B7yrwWliB53aPR8aOKfGkf2Gaie3W8DBREhN3abPbbxwK/1A8Qp/BknXVZGij0wWuzwI+ov8AvEnEQRQPNcNU8BjQ6Ay0oniEHK8opErAo5DManMjmHrokZlocCIhjU6vK+tJT/TvYIFphTEx6ujQ6MFDc6P3Njqtz+mCvyjRJmXgFYAYlK9qfZ8PNTpjsSutF7UnUIonnWo88bryqiVV9m90ajwRbufEMDQtNW9pzXngIZEADaBc4v0jxOvBiQSEYGqqoFaAd6mRJCDgoZRZ6Nt7fLeWSPQrlgs+8/EE1WVwEu8h99zeUBlq2sbXJ/0bnZpz52q7KCnCS8aYqHXxTSKogEeidaw2Ou0HG53ONzpjKH3uCfBf3w23imM3Ijm29zGmlQHxxPOVJ6SyEJn69E7pXlqqrTVPF1W+t9GZVPGAs7f3MA2+ffv+X/eO5NwTx3/dx/HKvZdvfTnjNC+MNS/sV5h668py0a3gobmpfsqFqX7Ac7twSdEjG1iYEq1kpQSKDMdib3A2TKrXJ55LhPM8H5UL0xqtMIghSUOF7S6Ne6fq5aI5EDxUteW8kDy+ujuJJ+O/QuZ6in5H9fVks++PqRMv1rjfZVi14fdBLb7cVqfPb7EHWM0GLgHD/GWtdFXqMja3d0F7yJpvxSb0GQy0/+ij385vZ+BBLDmZg6Hlo5F6YXryxgBwilfpWdKYDHjo72u1fVExe7cFkcoAH7AtODDLD5q9fb6TPQCqT+o9y5RkwNkfm/1+vL61vgTG+X68NnglNiw9mKnMHyU8IAP5g5Egw+hvlNkvL5sDfjDf3pumqVZ7Bgoi9dhg+WimNP/WSUQyKJ4wx6l/RJ4IzrZGB/3Gf2H9lecRTQoUH8RlvRtK+ak30rwINab0ZBZef/9ueenRw5eLdV2F8cHJl4+WlpffLY9Rvmu9wsnGxotJMy9WQZv2aRkPM7385Mbi8fjhfv3FVZm/HW08+HHx4p0FSLLQaMiAeqkzgsf2rwDSUAffs2Qu2f15wr+zTvN1mS/egFGuF9LD/5fX6ceK7guSkXFAgPC3HziE9O+Rf/E3F2E81wZ2XAmuYjjTyxvEJavgixjgY6oMl5mzw2Fcz/+Ft9W/6gl/P409HgoqEC4bv2+xDP2B1vfbuWeZQvb39h/j45OLi+Pj41cWr4yPX8SLjH9cxK8IhL9549n9NXAKqig8kyT60U+rBiD8MY72LAu+ol9tW62F+XwBL/ittTuftORrOj+P45wuyfwC3ZyfNiUniz1BgbMGtPhKaFzpIRtj4b98hOu1aGRlSPFsxD8ylQHC7cxXpF/2Y0tntY7wyqAYxzgGGcdAYwMeDwlK/o9vEt24jiOGJ/TI1F+kfpQ6yticTIR4mXiBLokzzFdBhpBeKJ4VH01+yniEnky1+NLagDEMTWSjYzVOLb6MkrniYTlA/wP5eZ2lMaSQFgAAAABJRU5ErkJggg=="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAq1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0NbREAAAAOHRSTlMA7J4Euq3SYlb62/UX50DWzfDge743MSvJMxMK2cY7B+SIJQ+jScKDHRp/RLaykHVmWU6oXm1SmERD0zUAAAQuSURBVGje7ZnpkqIwFEajtDjIjuwqoCzivtu8/5NNWUICBCE60jUz5ffLsoBTN+fmggI++eSTT96cbdBtOcEWKJ3WowAmaT0M6CStp/OB/LUQVlx/vT1rmi1ABntAvT3gQBcg4gG0kKNUgIzPoIVci5UM+uDPMtJ+9ffncAby+fVWyMjabRSW7dDd86wtiH8Qkywng2oFQu1kNGZZ0WkFcvGSfFShBYgmJcV8+2+HUAFTgojXt0NiMbPBZrTTuyGjq5KOwdMyw5mjN0P8HX+/x37POEtN12tGPQPRR42QZQq5AAC6d8jYegJCHXt7n7yS2Imer8TVvETpjxqcHDMnm+0gc+KSOxHGt9L3oD5cppvJuosJyLsrlO61XxooXTYphg6JIasoPUfZ16+YNSlBtiNCCOWY8CSvb1fP99RvXykwNhogg1BCfujxVbW4x3HPuH/c56fwRAeEEGdQnEZVymiGmXJph6EZ2Z1RhJDQLLvEKMebCT6luPolkDxeibZX4jtjiFSiWlyMcTt/ukjX1wgPh6uwIL7HW7B4ZgzbUzn7eWV0+rU8L16XEELpNJSoXnuQ4qG97wo0Er2MX4BoNGwVM3bjIMmC9v5KYhJEmXJPQwTkQ701o/GN2Q/V4vM0pJBCQrX8QDALkP2ze6sjz0D2ySEa6l3JySYg8qIcXFQqijyPySGUPoB9JRlofpwgRTw6IjyEl5GXmBhiIedSbuOC+AQv7CnwkGh28FCP2YQQISo6RzGCBMuXDkYXHo63ud0IUfYFoV8CKMY4lRnr26y1dwqkLO0myPgA9Ag510A58YYtMKR7qf4Q1tIZcg2QibAw4bqLOsCz6OUoDJ21hT2UkZdFPcScBvAatEFV3qO2uToMOC65HGXK1UJk1I6mBSozW0NGdFtOROlg9nFIMdGqmrHqybD1iofYQ9jJ3pIjgZhCJYJyJmityof4kALt4xBcKM4Q6w7xd7BKeck1QcRq50CbMLjzvJclouz8esjkgXPhCzLUnPNq+97QxyG4c5xRHv9VtfCIwj2G0A8YuoqPfzz2HNv7OIRRnGrn1gQ9Vljgcbg5C72kFAwysB44N6EPUXdBTRbDHMWugqhOjQ98fzTZ54c+DuEvDxi5WXIETeGQF2Vng/L/XfQVVMVSCevA7fM7m+iXFqVLyLkBSGIj+52LG5rNEF1Fzi0XECWeQgovaJtGiLOGDNMBpInnMtx463ETRNugcRMC8iymaH8zDRB9g/3QJKZA+0kthNInSdUoILVPBLHQbFc0FzyZeMkSQDS0B6UVeD6LudwIcZCPCPPxtP3qP58NVIe5Aq+Fm3p1EMqIGHg/n4FX4w/ZGoiV24MaeD32Vi5BWOnUS2MyaGB9B71Xcwo2LNFLGhbyXonM/Levm/L5VyE/8Vr2R14w/8yr8k8++eTvyG+Zid2kX/1F1AAAAABJRU5ErkJggg=="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAolBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgESU6AAAANXRSTlMA2pemgfJvowX64yXVq3YdwJ6HTAnnkFpTQSkVC8euNe/r3s/LuXtcSC4Q9q9+bGHwizsysfQ9FrMAAAJeSURBVGje7djpkppAFIbhg5qRVQX3fd9GncyS7/5vLUUPDE6QpZtDqlLh+aU/5C3sloNQpVKp/B961nBw3dl2Z+ENLZ1KoJ+cNe70nTF3p90yEWMe2pxncbjgIePAdjZjG4m0MbFoIJVHDOrI4FBhHWSal90QOlSIg1wWpE6vIacWKZsu6s0v7g4pzsRjiBQ28XhCmuPfiPR79MCgJqGbGcFPegAyakkRzURgSw/8gIRGUmQ6RKhdVsQhMhF4KiliPBN1EdjxR6Ifuo3AtJTIinwTBM6lRLokNMO3/JFojjxHK88fmVCgBeFWQsT1j/JhEYXb+I0/YujiKGJevcPn8UdaweW//TWlD+yRjX+M2Suw919YAHBkj4zFlRwAluGrd+7IXoxn+DRxx28AFndErMT+bpK8YKUzRwbiHhmfLuRjv0Cuxazd3I80Oo44I9EXFJtXnBFTLDUic+5IuGlruHNij/wKp0hkwx4RE3COb27MEXEdHOE7o8caeSVfH39wWSPdzzEVM2GMbMXANRAzZ4ycE/+Andgibjg94lZcEWMW3c7FNJgi4jgjJJiyRMxg+yZYsETE9vWQ6KNw5AZbbF8k0wpHJt4kmLnJhsUioSXSrHWWiIZUA47ICzK0i0d6mZ+6Fo+8IdO4aMRCNq1opIMcWsUiS+RhqD/28JlIF5/Ebj0/ZxQ8JsrHImUz5NUhZS5yO5EiC/mtSdEWElqkpAsZlxmpMCGlTgoakLRU2L4GJG1JWhPSRiTpDHl9neTYUOCRlCOUyG3jFZQ4xVadf+3bfU3N5kqVSqXyD/oN91R/tmnlLNcAAAAASUVORK5CYII="},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var base_1=__webpack_require__(109),firebase_1=__webpack_require__(45),Main_1=__webpack_require__(199),definition_1=__webpack_require__(281),stats_1=__webpack_require__(282);window.debug=!1;var targetElement=document.getElementById("ojc_root"),_a=base_1.default({Main:Main_1.default,definition:definition_1.default,targetElement:targetElement}),domEA=(_a.deps,_a.domEA),productEA=_a.productEA;firebase_1.default({apiKey:"AIzaSyBw7ATTC57iMtK8cqhCP4VYoFXXTXEPizo",authDomain:"ojpc-2150e.firebaseapp.com",databaseURL:"https://ojpc-2150e.firebaseio.com",projectId:"ojpc-2150e",storageBucket:"",messagingSenderId:"705130650445"}),stats_1.registerBrowser(),productEA.on("export",function(event){window.onproductsubmit(event)}),domEA.emit("ready",event),window.loadproduct=function(definition){return productEA.emit("import",definition)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var detect_browser_1=__webpack_require__(110),easydeps_1=__webpack_require__(14),eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),productManager_1=__webpack_require__(113),dom_1=__webpack_require__(7),domEA=eventaggregator_1.default.getInstance("dom"),productEA=eventaggregator_1.default.getInstance("product"),deps=easydeps_1.default.getInstance();window.addEventListener("mousemove",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("mousemove",event)}),window.addEventListener("touchmove",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("touchmove",event)}),window.addEventListener("mousedown",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("mousedown",event)}),window.addEventListener("touchstart",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("touchstart",event)}),window.addEventListener("mouseup",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("mouseup",event)}),window.addEventListener("touchend",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("touchend",event)}),window.addEventListener("resize",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("resize",event)}),window.addEventListener("mousewheel",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("scroll",event)}),window.addEventListener("click",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("click",event)}),window.addEventListener("keydown",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("keydown",event)}),window.addEventListener("keyup",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("keyup",event)}),window.addEventListener("contextmenu",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("contextmenu",event)}),document.addEventListener("dragenter",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("dragenter",event)}),document.addEventListener("dragstart",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("dragstart",event)}),document.addEventListener("dragleave",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("dragleave",event)}),document.addEventListener("dragstop",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("dragstop",event)}),document.addEventListener("drop",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("drop",event)}),document.addEventListener("dragover",function(event){dom_1.devent(event,{preventDefault:!1}),domEA.emit("dragover",event)}),productEA.on("change",function(){m.redraw()}),exports.default=function(productConfigurator){var productManager=new productManager_1.default(productConfigurator.definition);return deps.register({browser:detect_browser_1.detect(),domEA:domEA,productEA:productEA,productManager:productManager}),m.mount(productConfigurator.targetElement,productConfigurator.Main),{deps:deps,domEA:domEA,productEA:productEA}}},function(module,exports,__webpack_require__){(function(process){function detect(){var nodeVersion=getNodeVersion();return nodeVersion||("undefined"!=typeof navigator?parseUserAgent(navigator.userAgent):null)}function detectOS(userAgentString){var rules=getOperatingSystemRules(),detected=rules.filter(function(os){return os.rule&&os.rule.test(userAgentString)})[0];return detected?detected.name:null}function getNodeVersion(){return"undefined"==typeof navigator&&void 0!==process?{name:"node",version:process.version.slice(1),os:__webpack_require__(111).type().toLowerCase()}:null}function parseUserAgent(userAgentString){var browsers=getBrowserRules();if(!userAgentString)return null;var detected=browsers.map(function(browser){var match=browser.rule.exec(userAgentString),version=match&&match[1].split(/[._]/).slice(0,3);return version&&version.length<3&&(version=version.concat(1==version.length?[0,0]:[0])),match&&{name:browser.name,version:version.join(".")}}).filter(Boolean)[0]||null;return detected&&(detected.os=detectOS(userAgentString)),detected}function getBrowserRules(){return buildRules([["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/]])}function getOperatingSystemRules(){return buildRules([["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]])}function buildRules(ruleTuples){return ruleTuples.map(function(tuple){return{name:tuple[0],rule:tuple[1]}})}module.exports={detect:detect,detectOS:detectOS,getNodeVersion:getNodeVersion,parseUserAgent:parseUserAgent}}).call(exports,__webpack_require__(44))},function(module,exports){exports.endianness=function(){return"LE"},exports.hostname=function(){return"undefined"!=typeof location?location.hostname:""},exports.loadavg=function(){return[]},exports.uptime=function(){return 0},exports.freemem=function(){return Number.MAX_VALUE},exports.totalmem=function(){return Number.MAX_VALUE},exports.cpus=function(){return[]},exports.type=function(){return"Browser"},exports.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},exports.networkInterfaces=exports.getNetworkInterfaces=function(){return{}},exports.arch=function(){return"javascript"},exports.platform=function(){return"browser"},exports.tmpdir=exports.tmpDir=function(){return"/tmp"},exports.EOL="\n",exports.homedir=function(){return"/"}},function(module,exports,__webpack_require__){(function(global,process){!function(global,undefined){"use strict";function setImmediate(callback){"function"!=typeof callback&&(callback=new Function(""+callback));for(var args=new Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(undefined,args)}}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{run(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}if(!global.setImmediate){var registerImmediate,nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global,"[object process]"==={}.toString.call(global.process)?function(){registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}}():function(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage("","*"),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}()?function(){var messagePrefix="setImmediate$"+Math.random()+"$",onGlobalMessage=function(event){event.source===global&&"string"==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))};global.addEventListener?global.addEventListener("message",onGlobalMessage,!1):global.attachEvent("onmessage",onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}}():global.MessageChannel?function(){var channel=new MessageChannel;channel.port1.onmessage=function(event){runIfPresent(event.data)},registerImmediate=function(handle){channel.port2.postMessage(handle)}}():doc&&"onreadystatechange"in doc.createElement("script")?function(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}}():function(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}(),attachTo.setImmediate=setImmediate,attachTo.clearImmediate=clearImmediate}}("undefined"==typeof self?void 0===global?this:global:self)}).call(exports,__webpack_require__(23),__webpack_require__(44))},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var clone=__webpack_require__(114),eventaggregator_1=__webpack_require__(9),enums_1=__webpack_require__(17),helpers_1=__webpack_require__(13),productEA=eventaggregator_1.default.getInstance("product"),ProductManager=function(){function ProductManager(product,defaults,debounceTime){void 0===defaults&&(defaults=product.defaults),void 0===debounceTime&&(debounceTime=20);var _this=this;this.currentProductPartIndex=0,this.nextHolder_id=0,this.previewScale=1,this.id=product.id,this.debounceTime=debounceTime,this.defaults=defaults,this.productParts=clone(product.productParts);var pp=this.productParts[this.currentProductPartIndex];void 0!==pp&&void 0!==pp.layout&&(this.currentLayoutId=pp.layout.id),this.updateSelected(),productEA.on("import",function(definition){return _this.importDefinition(definition)})}return ProductManager.prototype.getProductParts=function(){return clone(this.productParts,!1)},ProductManager.prototype.getProductPartById=function(productPartId){var productPart=this.productParts.find(function(pp){return pp.id===productPartId});if(void 0===productPart)throw new Error('ProductPart with id "'+productPartId+'" does not exist');return clone(productPart,!1)},ProductManager.prototype.getProductPart=function(productPartIndex){return clone(this.getThisProductPart(productPartIndex),!1)},ProductManager.prototype.getContentOptions=function(productPartIndex){return clone(this.getThisContentOptions(productPartIndex),!1)},ProductManager.prototype.getLayouts=function(productPartIndex){return clone(this.getThisLayouts(productPartIndex),!1)},ProductManager.prototype.getLayout=function(layoutId,productPartIndex){return clone(this.getThisLayout(layoutId,productPartIndex),!1)},ProductManager.prototype.getHolders=function(productPartIndex){return clone(this.getThisHolders(productPartIndex),!1)},ProductManager.prototype.getHolder=function(holderId,productPartIndex){return clone(this.getThisHolder(holderId,productPartIndex),!1)},ProductManager.prototype.getScaledHolder=function(holder,scale){return void 0===scale&&(scale=this.previewScale),this.scaleHolder(clone(holder,!1),scale)},ProductManager.prototype.getScaledLayout=function(layout,scale){return void 0===scale&&(scale=this.previewScale),this.scaleLayout(clone(layout,!1),scale)},ProductManager.prototype.addHolder=function(holder,productPartIndex){var productPart=this.getThisProductPart(productPartIndex),nextId=this.getNextHolderId(productPart.layout.holders);return void 0===holder?holder={fixed:!1,id:nextId,position:{height:productPart.layout.position.height,left:0,top:0,width:productPart.layout.position.width},type:[enums_1.TEXT,enums_1.IMAGE,enums_1.SHAPE]}:holder.id=nextId,productPart.layout.holders.push(clone(holder,!1)),this.changed(),holder},ProductManager.prototype.updateHolder=function(holder,productPartIndex){var layout=this.getThisProductPart(productPartIndex).layout,exitstingHolder=layout.holders.find(function(h){return h.id===holder.id});if(void 0===exitstingHolder)throw new Error('Could not find an existing holder with id "'+holder.id+'"');return!0!==layout.fixed&&(!0!==exitstingHolder.fixed&&void 0!==holder.position&&this.updateHolderPosition(exitstingHolder,holder.position),void 0!==holder.depth&&this.updateHolderDepth(exitstingHolder,holder.depth,layout.holders)),void 0!==holder.content&&this.updateHolderContent(exitstingHolder,holder.content),void 0!==holder.filter&&this.updateHolderContentFilter(exitstingHolder,holder.filter),this.changed(),clone(exitstingHolder,!1)},ProductManager.prototype.removeHolderContent=function(holderId,productPartIndex){var holders=this.getThisProductPart(productPartIndex).layout.holders,exitstingHolder=holders.find(function(h){return h.id===holderId});if(void 0===exitstingHolder)throw new Error('Could not find an existing holder with id "'+holderId+'"');return exitstingHolder.fixed&&exitstingHolder.content&&delete exitstingHolder.content.value,this.changed(),exitstingHolder},ProductManager.prototype.removeHolder=function(holderId,productPartIndex){var layout=this.getThisProductPart(productPartIndex).layout,exitstingHolder=layout.holders.find(function(h){return h.id===holderId});if(void 0===exitstingHolder)throw new Error('Could not find an existing holder with id "'+holderId+'"');!0!==layout.fixed&&!0!==exitstingHolder.fixed&&(layout.holders=layout.holders.filter(function(holder){return holder.id!==holderId})),holderId===this.currentHolderId&&(this.currentHolderId=-1,this.updateSelected()),this.changed()},ProductManager.prototype.setCurrentProductPart=function(productPartId){this.currentProductPartIndex=this.productParts.findIndex(function(pp){return pp.id===productPartId}),this.updateSelected(),this.changed()},ProductManager.prototype.setCurrentHolder=function(holderId){this.currentHolderId===holderId&&(holderId=void 0),this.currentHolderId=holderId,this.updateSelected(),this.changed()},ProductManager.prototype.setCurrentLayout=function(layoutId,productPartIndex){var pp=this.getThisProductPart(productPartIndex);this.currentLayoutId=layoutId;var layout=this.getThisLayout(layoutId);pp.layout=clone(layout,!1),this.updateSelected(),this.changed()},ProductManager.prototype.addLayout=function(layout,productPartIndex){var pp=this.getThisProductPart(productPartIndex);return pp.layouts.push(clone(layout,!1)),this.changed(),pp.layout},ProductManager.prototype.setPreviewScale=function(scale){this.previewScale=scale,this.changed()},ProductManager.prototype.getPreviewScale=function(){return this.previewScale},ProductManager.prototype.submit=function(result,productPartIndex){var productPart=this.getProductPart(productPartIndex),productPartDefinition={id:productPart.id,layout:{holders:[],id:productPart.layout.id,position:productPart.layout.position}};return productPartDefinition.layout.holders=productPart.layout.holders.map(function(h){if(!h.content)return null;var holderResult=result.holders&&result.holders.find(function(hr){return hr.id===h.id});return{content:function(){if(holderResult&&holderResult.image)return holderResult.image;var cleanedContent=clone(h.content,!1);return delete cleanedContent.fixed,delete cleanedContent.originalValue,delete cleanedContent.thumb,cleanedContent}(),id:h.id,position:__assign({},h.position),type:h.type.slice()}}),productEA.emit("export",{definition:{id:this.id,productPart:productPartDefinition},result:result.result}),{definition:{id:this.id,productPart:productPartDefinition},result:result.result}},ProductManager.prototype.exportDefinition=function(){return this.productParts.map(function(pp){return{holders:pp.layout.holders.map(function(h){return clone({content:function(){var c=clone(h.content,!1);return c&&c.originalValue&&delete c.originalValue,c}(),id:h.id,position:h.position,type:h.type},!1)}),id:pp.id,layoutId:pp.layout.id}})},ProductManager.prototype.importDefinition=function(definition){var _this=this;definition.forEach(function(pp){var epp=_this.productParts.find(function(x){return x.id===pp.id});if(void 0===epp)throw new Error("ProductPart with id "+pp.id+" not found. Cannot import the definition");_this.currentLayoutId=pp.layoutId,epp.layout=clone(_this.getThisLayout(pp.layoutId),!1),pp.holders.forEach(function(h){var eh=epp.layout.holders.find(function(x){return x.id===h.id});void 0===eh?epp.layout.holders.push(h):Object.assign(eh,h)})}),this.updateSelected(),this.changed()},ProductManager.prototype.scale=function(position,scale){return void 0===scale&&(scale=1/this.previewScale),scale*position},ProductManager.prototype.scaleRect=function(position,scale){return void 0===scale&&(scale=1/this.previewScale),helpers_1.round(helpers_1.setScale(position,scale))},ProductManager.prototype.updateHolderPosition=function(holder,position){return position=this.scaleRect(position,1/this.previewScale),holder.position=__assign({},holder.position,position),holder.position},ProductManager.prototype.updateHolderContent=function(holder,content){return delete content.originalValue,-1!==holder.type.indexOf(enums_1.IMAGE)&&content.type===enums_1.IMAGE&&(content.originalValue=content.value),holder.content=__assign({},this.defaults,holder.content,content),holder.content},ProductManager.prototype.updateHolderContentFilter=function(holder,filter){if(void 0===holder.content)throw new Error("Holder has no content, cannot update filter.");return holder.content.filter=__assign({},filter),holder.content},ProductManager.prototype.updateHolderDepth=function(holder,direction,holders){var holderIndex=holders.indexOf(holder);if(direction>0)for(var i=0;i<direction;i++){var prevHolder=holders[holderIndex+1+i];prevHolder&&(holders[holderIndex+1+i]=holder,holders[holderIndex+i]=prevHolder)}else for(var i=0;i<Math.abs(direction);i++){var prevHolder=holders[holderIndex-1-i];prevHolder&&(holders[holderIndex-1-i]=holder,holders[holderIndex-i]=prevHolder)}return holders},ProductManager.prototype.updateSelected=function(){var _this=this;this.productParts.forEach(function(pp,ppi){pp.selected=ppi===_this.currentProductPartIndex,pp.layouts.forEach(function(t,ti){t.selected=t.id===_this.currentLayoutId}),void 0!==pp.layout&&void 0!==pp.layout.holders&&pp.layout.holders.forEach(function(h,hi){h.selected=h.id===_this.currentHolderId||h.id===_this.currentHolderId})})},ProductManager.prototype.changed=function(){productEA.emit("change",this.getProductPart())},ProductManager.prototype.getNextHolderId=function(holders){return holders&&holders.length>0&&(this.nextHolder_id=Math.max.apply(null,holders.map(function(holder){return holder.id}))+1),this.nextHolder_id++},ProductManager.prototype.scaleHolder=function(holder,scale){return holder.position=this.scaleRect(holder.position,scale),holder.content&&(holder.content.fontSize&&(holder.content.fontSize=this.scale(parseFloat(holder.content.fontSize),scale)+"px"),holder.content.lineHeight&&(holder.content.lineHeight=this.scale(parseFloat(holder.content.lineHeight),scale)+"px")),holder},ProductManager.prototype.scaleLayout=function(layout,scale){var _this=this;return layout.position=this.scaleRect(layout.position,scale),layout.holders=layout.holders.map(function(holder){return _this.scaleHolder(holder,scale)}),layout},ProductManager.prototype.getThisProductParts=function(){return this.productParts},ProductManager.prototype.getThisProductPartById=function(productPartId){var productPart=this.productParts.find(function(pp){return pp.id===productPartId});if(void 0===productPart)throw new Error('ProductPart with id "'+productPartId+'" does not exist');return productPart},ProductManager.prototype.getThisProductPart=function(productPartIndex){void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex);var pp=this.productParts[productPartIndex];if(void 0===pp)throw new Error('ProductPart with index "'+productPartIndex+'" does not exist');return pp},ProductManager.prototype.getThisContentOptions=function(productPartIndex){return void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex),this.productParts[productPartIndex].options},ProductManager.prototype.getThisLayouts=function(productPartIndex){return void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex),this.getThisProductPart(productPartIndex).layouts},ProductManager.prototype.getThisLayout=function(layoutId,productPartIndex){void 0===layoutId&&(layoutId=this.currentLayoutId),void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex);var layouts=this.getThisProductPart(productPartIndex).layouts||[],layout=layouts.find(function(l){return l.id===layoutId});if(void 0===layout)throw new Error('ProductPart with index "'+productPartIndex+'" has no layout with id "'+layoutId+'"');return layout},ProductManager.prototype.getThisHolders=function(productPartIndex){return void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex),this.getThisProductPart(productPartIndex).layout.holders},ProductManager.prototype.getThisHolder=function(holderId,productPartIndex){if(void 0===holderId&&(holderId=this.currentHolderId),void 0===productPartIndex&&(productPartIndex=this.currentProductPartIndex),void 0===holderId)throw new Error("HolderId is undefined. Initialize the current holder with setCurrentHolder(holderId: number)");var holders=this.getThisHolders(productPartIndex),holder=holders.find(function(h){return h.id===holderId});if(void 0===holder)throw new Error('ProductPart with index "'+productPartIndex+'" has no holder with id "'+holderId+'"');return holder},ProductManager}();exports.default=ProductManager},function(module,exports,__webpack_require__){(function(Buffer){var clone=function(){"use strict";function _instanceof(obj,type){return null!=type&&obj instanceof type}function clone(parent,circular,depth,prototype,includeNonEnumerable){function _clone(parent,depth){if(null===parent)return null;if(0===depth)return parent;var child,proto;if("object"!=typeof parent)return parent;if(_instanceof(parent,nativeMap))child=new nativeMap;else if(_instanceof(parent,nativeSet))child=new nativeSet;else if(_instanceof(parent,nativePromise))child=new nativePromise(function(resolve,reject){parent.then(function(value){resolve(_clone(value,depth-1))},function(err){reject(_clone(err,depth-1))})});else if(clone.__isArray(parent))child=[];else if(clone.__isRegExp(parent))child=new RegExp(parent.source,__getRegExpFlags(parent)),parent.lastIndex&&(child.lastIndex=parent.lastIndex);else if(clone.__isDate(parent))child=new Date(parent.getTime());else{if(useBuffer&&Buffer.isBuffer(parent))return child=new Buffer(parent.length),parent.copy(child),child;_instanceof(parent,Error)?child=Object.create(parent):void 0===prototype?(proto=Object.getPrototypeOf(parent),child=Object.create(proto)):(child=Object.create(prototype),proto=prototype)}if(circular){var index=allParents.indexOf(parent);if(-1!=index)return allChildren[index];allParents.push(parent),allChildren.push(child)}_instanceof(parent,nativeMap)&&parent.forEach(function(value,key){var keyChild=_clone(key,depth-1),valueChild=_clone(value,depth-1);child.set(keyChild,valueChild)}),_instanceof(parent,nativeSet)&&parent.forEach(function(value){var entryChild=_clone(value,depth-1);child.add(entryChild)});for(var i in parent){var attrs;proto&&(attrs=Object.getOwnPropertyDescriptor(proto,i)),attrs&&null==attrs.set||(child[i]=_clone(parent[i],depth-1))}if(Object.getOwnPropertySymbols)for(var symbols=Object.getOwnPropertySymbols(parent),i=0;i<symbols.length;i++){var symbol=symbols[i],descriptor=Object.getOwnPropertyDescriptor(parent,symbol);(!descriptor||descriptor.enumerable||includeNonEnumerable)&&(child[symbol]=_clone(parent[symbol],depth-1),descriptor.enumerable||Object.defineProperty(child,symbol,{enumerable:!1}))}if(includeNonEnumerable)for(var allPropertyNames=Object.getOwnPropertyNames(parent),i=0;i<allPropertyNames.length;i++){var propertyName=allPropertyNames[i],descriptor=Object.getOwnPropertyDescriptor(parent,propertyName);descriptor&&descriptor.enumerable||(child[propertyName]=_clone(parent[propertyName],depth-1),Object.defineProperty(child,propertyName,{enumerable:!1}))}return child}"object"==typeof circular&&(depth=circular.depth,prototype=circular.prototype,includeNonEnumerable=circular.includeNonEnumerable,circular=circular.circular);var allParents=[],allChildren=[],useBuffer=void 0!==Buffer;return void 0===circular&&(circular=!0),void 0===depth&&(depth=1/0),_clone(parent,depth)}function __objToStr(o){return Object.prototype.toString.call(o)}function __isDate(o){return"object"==typeof o&&"[object Date]"===__objToStr(o)}function __isArray(o){return"object"==typeof o&&"[object Array]"===__objToStr(o)}function __isRegExp(o){return"object"==typeof o&&"[object RegExp]"===__objToStr(o)}function __getRegExpFlags(re){var flags="";return re.global&&(flags+="g"),re.ignoreCase&&(flags+="i"),re.multiline&&(flags+="m"),flags}var nativeMap;try{nativeMap=Map}catch(_){nativeMap=function(){}}var nativeSet;try{nativeSet=Set}catch(_){nativeSet=function(){}}var nativePromise;try{nativePromise=Promise}catch(_){nativePromise=function(){}}return clone.clonePrototype=function(parent){if(null===parent)return null;var c=function(){};return c.prototype=parent,new c},clone.__objToStr=__objToStr,clone.__isDate=__isDate,clone.__isArray=__isArray,clone.__isRegExp=__isRegExp,clone.__getRegExpFlags=__getRegExpFlags,clone}();"object"==typeof module&&module.exports&&(module.exports=clone)}).call(exports,__webpack_require__(115).Buffer)},function(module,exports,__webpack_require__){"use strict";(function(global){function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length),that.__proto__=Buffer.prototype):(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?fromArrayBuffer(that,value,encodingOrOffset,length):"string"==typeof value?fromString(that,value,encodingOrOffset):fromObject(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromString(that,string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding);that=createBuffer(that,length);var actual=that.write(string,encoding);return actual!==length&&(that=that.slice(0,actual)),that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");return array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Buffer.TYPED_ARRAY_SUPPORT?(that=array,that.__proto__=Buffer.prototype):that=fromArrayLike(that,array),that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return that=createBuffer(that,len),0===that.length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||isnan(obj.length)?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128==(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!=0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isnan(val){return val!==val}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var base64=__webpack_require__(116),ieee754=__webpack_require__(117),isArray=__webpack_require__(118);exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=this.subarray(start,end),newBuf.__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(exports,__webpack_require__(23))},function(module,exports,__webpack_require__){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},function(module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},function(module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},function(module,exports,__webpack_require__){var firebase=__webpack_require__(120);__webpack_require__(138),__webpack_require__(140),__webpack_require__(175),__webpack_require__(182),module.exports=firebase},function(module,exports,__webpack_require__){__webpack_require__(121),module.exports=__webpack_require__(18).default},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__src_polyfills_promise__=__webpack_require__(122),__WEBPACK_IMPORTED_MODULE_1__src_shims_find__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__src_polyfills_promise__),__webpack_require__(124)),__WEBPACK_IMPORTED_MODULE_2__src_shims_findIndex__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__src_shims_find__),__webpack_require__(125));__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__src_shims_findIndex__)},function(module,exports,__webpack_require__){(function(global){var __global=function(){if(void 0!==global)return global;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")}();"undefined"==typeof Promise&&(__global.Promise=Promise=__webpack_require__(123))}).call(exports,__webpack_require__(23))},function(module,exports,__webpack_require__){(function(setImmediate){!function(root){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;if(0===self._state)return void self._deferreds.push(deferred);self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var setTimeoutFunc=setTimeout;Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(!arr||void 0===arr.length)throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}(this)}).call(exports,__webpack_require__(61).setImmediate)},function(module,exports){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return kValue;k++}}})},function(module,exports){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(predicate){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return k;k++}return-1}})},function(module,__webpack_exports__,__webpack_require__){"use strict";function createFirebaseNamespace(){function removeApp(name){callAppHooks(apps_[name],"delete"),delete apps_[name]}function app(name){return name=name||DEFAULT_ENTRY_NAME,contains(apps_,name)||error("no-app",{name:name}),apps_[name]}function initializeApp(options,name){void 0===name?name=DEFAULT_ENTRY_NAME:"string"==typeof name&&""!==name||error("bad-app-name",{name:name+""}),contains(apps_,name)&&error("duplicate-app",{name:name});var app=new FirebaseAppImpl(options,name,namespace);return apps_[name]=app,callAppHooks(app,"create"),app}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){factories[name]&&error("duplicate-service",{name:name}),factories[name]=createService,appHook&&(appHooks[name]=appHook,getApps().forEach(function(app){appHook("create",app)}));var serviceNamespace=function(appArg){return void 0===appArg&&(appArg=app()),"function"!=typeof appArg[name]&&error("invalid-app-argument",{name:name}),appArg[name]()};return void 0!==serviceProperties&&Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.deepExtend)(serviceNamespace,serviceProperties),namespace[name]=serviceNamespace,FirebaseAppImpl.prototype[name]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return this._getService.bind(this,name).apply(this,allowMultipleInstances?args:[])},serviceNamespace}function extendNamespace(props){Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.deepExtend)(namespace,props)}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);null!==factoryName&&appHooks[factoryName]&&appHooks[factoryName](eventName,app)})}function useAsService(app,name){if("serverAuth"===name)return null;var useService=name;app.options;return useService}var apps_={},factories={},appHooks={},namespace={__esModule:!0,initializeApp:initializeApp,app:app,apps:null,Promise:Promise,SDK_VERSION:"4.9.0",INTERNAL:{registerService:registerService,createFirebaseNamespace:createFirebaseNamespace,extendNamespace:extendNamespace,createSubscribe:__WEBPACK_IMPORTED_MODULE_0__firebase_util__.createSubscribe,ErrorFactory:__WEBPACK_IMPORTED_MODULE_0__firebase_util__.ErrorFactory,removeApp:removeApp,factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:__WEBPACK_IMPORTED_MODULE_0__firebase_util__.deepExtend}};return Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.patchProperty)(namespace,"default",namespace),Object.defineProperty(namespace,"apps",{get:getApps}),Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.patchProperty)(app,"App",FirebaseAppImpl),namespace}function error(code,args){throw appErrors.create(code,args)}__webpack_exports__.a=createFirebaseNamespace;var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0),contains=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__),function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}),DEFAULT_ENTRY_NAME="[DEFAULT]",tokenListeners=[],FirebaseAppImpl=function(){function FirebaseAppImpl(options,name,firebase_){this.firebase_=firebase_,this.isDeleted_=!1,this.services_={},this.name_=name,this.options_=Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.deepCopy)(options),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback),setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}return Object.defineProperty(FirebaseAppImpl.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_(),resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];return Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})}),Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=!0,_this.services_={}})},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(void 0===instanceIdentifier&&(instanceIdentifier=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[name]||(this.services_[name]={}),!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier!==DEFAULT_ENTRY_NAME?instanceIdentifier:void 0,service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]},FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__.deepExtend)(this,props),props.INTERNAL&&props.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)}),tokenListeners=[])},FirebaseAppImpl.prototype.checkDestroyed_=function(){this.isDeleted_&&error("app-deleted",{name:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log("dc");var errors={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},appErrors=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__.ErrorFactory("app","Firebase",errors)},function(module,exports,__webpack_require__){"use strict";function deepCopy(value){return deepExtend(void 0,value)}function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:var dateValue=source;return new Date(dateValue.getTime());case Object:void 0===target&&(target={});break;case Array:target=[];break;default:return source}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}function patchProperty(obj,prop,value){obj[prop]=value}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepCopy=deepCopy,exports.deepExtend=deepExtend,exports.patchProperty=patchProperty},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),"function"==typeof callback&&(_this.promise.catch(function(){}),1===callback.length?callback(error):callback(error,value))}},Deferred}();exports.Deferred=Deferred},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var constants_1=__webpack_require__(46);exports.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},exports.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(exports.getUA())},exports.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},exports.isNodeSdk=function(){return!0===constants_1.CONSTANTS.NODE_CLIENT||!0===constants_1.CONSTANTS.NODE_ADMIN}},function(module,exports,__webpack_require__){"use strict";function patchCapture(captureFake){var result=captureStackTrace;return captureStackTrace=captureFake,result}Object.defineProperty(exports,"__esModule",{value:!0});var ERROR_NAME="FirebaseError",captureStackTrace=Error.captureStackTrace;exports.patchCapture=patchCapture;var FirebaseError=function(){function FirebaseError(code,message){this.code=code,this.message=message;if(captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else{var err_1=Error.apply(this,arguments);this.name=ERROR_NAME,Object.defineProperty(this,"stack",{get:function(){return err_1.stack}})}}return FirebaseError}();exports.FirebaseError=FirebaseError,FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var message,template=this.errors[code],fullCode=this.service+"/"+code;message=void 0===template?"Error":template.replace(this.pattern,function(match,key){var value=data[key];return void 0!==value?value.toString():"<"+key+"?>"}),message=this.serviceName+": "+message+" ("+fullCode+").";var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&"_"!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}();exports.ErrorFactory=ErrorFactory},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var crypt_1=__webpack_require__(63),json_1=__webpack_require__(64);exports.decode=function(token){var header={},claims={},data={},signature="";try{var parts=token.split(".");header=json_1.jsonEval(crypt_1.base64Decode(parts[0])||""),claims=json_1.jsonEval(crypt_1.base64Decode(parts[1])||""),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},exports.isValidTimestamp=function(token){var validSince,validUntil,claims=exports.decode(token).claims,now=Math.floor((new Date).getTime()/1e3);return"object"==typeof claims&&(claims.hasOwnProperty("nbf")?validSince=claims.nbf:claims.hasOwnProperty("iat")&&(validSince=claims.iat),validUntil=claims.hasOwnProperty("exp")?claims.exp:validSince+86400),now&&validSince&&validUntil&&now>=validSince&&now<=validUntil},exports.issuedAtTime=function(token){var claims=exports.decode(token).claims;return"object"==typeof claims&&claims.hasOwnProperty("iat")?claims.iat:null},exports.isValidFormat=function(token){var decoded=exports.decode(token),claims=decoded.claims;return!!decoded.signature&&!!claims&&"object"==typeof claims&&claims.hasOwnProperty("iat")},exports.isAdmin=function(token){var claims=exports.decode(token).claims;return"object"==typeof claims&&!0===claims.admin}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj_1=__webpack_require__(65);exports.querystring=function(querystringParams){var params=[];return obj_1.forEach(querystringParams,function(key,value){Array.isArray(value)?value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+"="+encodeURIComponent(arrayVal))}):params.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}),params.length?"&"+params.join("&"):""},exports.querystringDecode=function(querystring){var obj={};return querystring.replace(/^\?/,"").split("&").forEach(function(token){if(token){var key=token.split("=");obj[key[0]]=key[1]}}),obj}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var hash_1=__webpack_require__(134),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=64,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return __extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if("string"==typeof buf)for(var i=0;i<16;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;i<16;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16;i<80;i++){var t=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=4294967295&(t<<1|t>>>31)}for(var f,k,a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0;i<80;i++){i<40?i<20?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):i<60?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=(a<<5|a>>>27)+f+e+k+W[i]&4294967295;e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+e&4294967295},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if("string"==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;i<5;i++)for(var j=24;j>=0;j-=8)digest[n]=this.chain_[i]>>j&255,++n;return digest},Sha1}(hash_1.Hash);exports.Sha1=Sha1},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Hash=function(){function Hash(){this.blockSize=-1}return Hash}();exports.Hash=Hash},function(module,exports,__webpack_require__){"use strict";function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)}function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then(function(){fn.apply(void 0,args)}).catch(function(error){onError&&onError(error)})}}function implementsAnyMethods(obj,methods){if("object"!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=methods;_i<methods_1.length;_i++){var method=methods_1[_i];if(method in obj&&"function"==typeof obj[method])return!0}return!1}function noop(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSubscribe=createSubscribe;var ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}return ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})},ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)}),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()}),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var observer,_this=this;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error("Missing Observer.");observer=implementsAnyMethods(nextOrObserver,["next","error","complete"])?nextOrObserver:{next:nextOrObserver,error:error,complete:complete},void 0===observer.next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}}),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0!==this.observers&&void 0!==this.observers[i]&&(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then(function(){_this.observers=void 0,_this.onNoObservers=void 0}))},ObserverProxy}();exports.async=async},function(module,exports,__webpack_require__){"use strict";function errorPrefix(fnName,argumentNumber,optional){var argName="";switch(argumentNumber){case 1:argName=optional?"first":"First";break;case 2:argName=optional?"second":"Second";break;case 3:argName=optional?"third":"Third";break;case 4:argName=optional?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var error=fnName+" failed: ";return error+=argName+" argument "}function validateNamespace(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&"string"!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid firebase namespace.")}function validateCallback(fnName,argumentNumber,callback,optional){if((!optional||callback)&&"function"!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid function.")}function validateContextObject(fnName,argumentNumber,context,optional){if((!optional||context)&&("object"!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid context object.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError="at least "+minCount:argCount>maxCount&&(argError=0===maxCount?"none":"no more than "+maxCount),argError){var error=fnName+" failed: Was called with "+argCount+(1===argCount?" argument.":" arguments.")+" Expects "+argError+".";throw new Error(error)}},exports.errorPrefix=errorPrefix,exports.validateNamespace=validateNamespace,exports.validateCallback=validateCallback,exports.validateContextObject=validateContextObject},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var assert_1=__webpack_require__(62);exports.stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=55296&&c<=56319){var high=c-55296;i++,assert_1.assert(i<str.length,"Surrogate pair missing trail surrogate.");c=65536+(high<<10)+(str.charCodeAt(i)-56320)}c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):c<65536?(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},exports.stringLength=function(str){for(var p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?p++:c<2048?p+=2:c>=55296&&c<=56319?(p+=4,i++):p+=3}return p}},function(module,exports,__webpack_require__){__webpack_require__(139)},function(module,exports,__webpack_require__){(function(global){(function(){function m(a){return"string"==typeof a}function ba(a){return"boolean"==typeof a}function ca(){}function da(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&void 0!==a.splice&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||void 0!==a.call&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&void 0===a.call)return"object";return b}function ea(a){return null===a}function fa(a){return"array"==da(a)}function ha(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function p(a){return"function"==da(a)}function q(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function r(a,b,c){return r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:la,r.apply(null,arguments)}function ma(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function t(a,b){function c(){}c.prototype=b.prototype,a.ib=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Rc=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}}function u(a){if(Error.captureStackTrace)Error.captureStackTrace(this,u);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}function oa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function qa(a){return ra.test(a)?(-1!=a.indexOf("&")&&(a=a.replace(sa,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(ta,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(ua,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(va,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(wa,"&#39;")),-1!=a.indexOf("\0")&&(a=a.replace(xa,"&#0;")),a):a}function v(a,b){return-1!=a.indexOf(b)}function ya(a,b){return a<b?-1:a>b?1:0}function za(a,b){b.unshift(a),u.call(this,oa.apply(null,b)),b.shift()}function Aa(a,b){throw new za("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1))}function Ca(a,b){var c=a.length,d=m(a)?a.split(""):a;for(--c;0<=c;--c)c in d&&b.call(void 0,d[c],c,a)}function Fa(a){a:{for(var b=Ga,c=a.length,d=m(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:m(a)?a.charAt(b):a[b]}function Ha(a,b){return 0<=Ba(a,b)}function Ia(a,b){b=Ba(a,b);var c;return(c=0<=b)&&Array.prototype.splice.call(a,b,1),c}function Ja(a,b){var c=0;Ca(a,function(d,e){b.call(void 0,d,e,a)&&1==Array.prototype.splice.call(a,e,1).length&&c++})}function Ka(a){return Array.prototype.concat.apply([],arguments)}function La(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function x(a){return v(Ma,a)}function Pa(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Qa(a){var d,b=[],c=0;for(d in a)b[c++]=a[d];return b}function Ra(a){var d,b=[],c=0;for(d in a)b[c++]=d;return b}function Sa(a){for(var b in a)return!1;return!0}function Ta(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0}function Ua(a){var c,b={};for(c in a)b[c]=a[c];return b}function Wa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Va.length;f++)c=Va[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Xa(a){return Xa[" "](a),a}function Ya(a,b){var c=Za;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function eb(){var a=k.document;return a?a.documentMode:void 0}function jb(a){return Ya(a,function(){for(var b=0,c=pa(String(fb)).split("."),d=pa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",l=d[f]||"";do{if(g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""],l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""],0==g[0].length&&0==l[0].length)break;b=ya(0==g[1].length?0:parseInt(g[1],10),0==l[1].length?0:parseInt(l[1],10))||ya(0==g[2].length,0==l[2].length)||ya(g[2],l[2]),g=g[3],l=l[3]}while(0==b)}return 0<=b})}function mb(a){a.prototype.then=a.prototype.then,a.prototype.$goog_Thenable=!0}function nb(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}}function ob(a,b,c){this.f=c,this.c=a,this.g=b,this.b=0,this.a=null}function pb(a,b){a.g(b),a.b<a.f&&(a.b++,b.next=a.a,a.a=b)}function sb(){var a=tb,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function qb(){this.next=this.b=this.a=null}function ub(a){k.setTimeout(function(){throw a},0)}function xb(){var a=k.MessageChannel;if(void 0===a&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!x("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none",a.src="",document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document,a.open(),a.write(""),a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host;a=r(function(a){"*"!=d&&a.origin!=d||a.data!=c||this.port1.onmessage()},this),b.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),void 0!==a&&!x("Trident")&&!x("MSIE")){var b=new a,c={},d=c;return b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.pb;c.pb=null,a()}},function(a){d.next={pb:a},d=d.next,b.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){k.setTimeout(a,0)}}function yb(a,b){zb||Ab(),Bb||(zb(),Bb=!0);var c=tb,d=rb.get();d.set(a,b),c.b?c.b.next=d:c.a=d,c.b=d}function Ab(){if(-1!=String(k.Promise).indexOf("[native code]")){var a=k.Promise.resolve(void 0);zb=function(){a.then(Cb)}}else zb=function(){var a=Cb;!p(k.setImmediate)||k.Window&&k.Window.prototype&&!x("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(wb||(wb=xb()),wb(a)):k.setImmediate(a)}}function Cb(){for(var a;a=sb();){try{a.a.call(a.b)}catch(b){ub(b)}pb(rb,a)}Bb=!1}function z(a,b){if(this.a=Db,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,a!=ca)try{var c=this;a.call(b,function(a){Eb(c,Fb,a)},function(a){if(!(a instanceof Gb))try{if(a instanceof Error)throw a;throw Error("Promise rejected.")}catch(e){}Eb(c,Hb,a)})}catch(d){Eb(this,Hb,d)}}function Ib(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function Kb(a,b,c){var d=Jb.get();return d.g=a,d.b=b,d.f=c,d}function A(a){if(a instanceof z)return a;var b=new z(ca);return Eb(b,Fb,a),b}function B(a){return new z(function(b,c){c(a)})}function Lb(a,b,c){Mb(a,b,c,null)||yb(ma(b,a))}function Nb(a){return new z(function(b,c){var d=a.length,e=[];if(d)for(var n,f=function(a,c){d--,e[a]=c,0==d&&b(e)},g=function(a){c(a)},l=0;l<a.length;l++)n=a[l],Lb(n,ma(f,l),g);else b(e)})}function Ob(a){return new z(function(b){var c=a.length,d=[];if(c)for(var g,e=function(a,e,f){c--,d[a]=e?{Ub:!0,value:f}:{Ub:!1,reason:f},0==c&&b(d)},f=0;f<a.length;f++)g=a[f],Lb(g,ma(e,f,!0),ma(e,f,!1));else b(d)})}function Qb(a,b){return b=Kb(b,b,void 0),b.c=!0,Rb(a,b),a}function Sb(a,b){if(a.a==Db)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.c||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==Db&&1==d?Sb(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Tb(c),Ub(c,e,Hb,b)))}a.c=null}else Eb(a,Hb,b)}function Rb(a,b){a.b||a.a!=Fb&&a.a!=Hb||Vb(a),a.f?a.f.next=b:a.b=b,a.f=b}function Pb(a,b,c,d){var e=Kb(null,null,null);return e.a=new z(function(a,g){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(D){g(D)}}:a,e.b=c?function(b){try{var e=c.call(d,b);void 0===e&&b instanceof Gb?g(b):a(e)}catch(D){g(D)}}:g}),e.a.c=a,Rb(a,e),e.a}function Eb(a,b,c){a.a==Db&&(a===c&&(b=Hb,c=new TypeError("Promise cannot resolve to itself")),a.a=1,Mb(c,a.Ac,a.Bc,a)||(a.i=c,a.a=b,a.c=null,Vb(a),b!=Hb||c instanceof Gb||Wb(a,c)))}function Mb(a,b,c,d){if(a instanceof z)return Rb(a,Kb(b||ca,c||null,d)),!0;if(nb(a))return a.then(b,c,d),!0;if(q(a))try{var e=a.then;if(p(e))return Xb(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1}function Xb(a,b,c,d,e){function f(a){l||(l=!0,d.call(e,a))}function g(a){l||(l=!0,c.call(e,a))}var l=!1;try{b.call(a,g,f)}catch(n){f(n)}}function Vb(a){a.h||(a.h=!0,yb(a.Qb,a))}function Tb(a){var b=null;return a.b&&(b=a.b,a.b=b.next,b.next=null),a.b||(a.f=null),b}function Ub(a,b,c,d){if(c==Hb&&b.b&&!b.c)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Yb(b,c,d);else try{b.c?b.g.call(b.f):Yb(b,c,d)}catch(e){Zb.call(null,e)}pb(Jb,b)}function Yb(a,b,c){b==Fb?a.g.call(a.f,c):a.b&&a.b.call(a.f,c)}function Wb(a,b){a.g=!0,yb(function(){a.g&&Zb.call(null,b)})}function Gb(a){u.call(this,a)}function ac(){this.a="",this.b=bc}function cc(a){return a instanceof ac&&a.constructor===ac&&a.b===bc?a.a:(Aa("expected object of type Const, got '"+a+"'"),"type_error:Const")}function dc(a){var b=new ac;return b.a=a,b}function ec(){this.a="",this.b=fc}function gc(a){return a instanceof ec&&a.constructor===ec&&a.b===fc?a.a:(Aa("expected object of type TrustedResourceUrl, got '"+a+"' of type "+da(a)),"type_error:TrustedResourceUrl")}function hc(a,b){return a=ic(a,b),b=new ec,b.a=a,b}function ic(a,b){var c=cc(a);if(!jc.test(c))throw Error("Invalid TrustedResourceUrl format: "+c);return c.replace(kc,function(a,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, "'+e+'", in format string, "'+c+'", but no valid label mapping found in args: '+JSON.stringify(b));return a=b[e],a instanceof ac?cc(a):encodeURIComponent(String(a))})}function lc(){this.a="",this.b=mc}function nc(a){return a instanceof lc&&a.constructor===lc&&a.b===mc?a.a:(Aa("expected object of type SafeUrl, got '"+a+"' of type "+da(a)),"type_error:SafeUrl")}function pc(a){return a instanceof lc?a:(a=a.la?a.ja():String(a),oc.test(a)||(a="about:invalid#zClosurez"),qc(a))}function qc(a){var b=new lc;return b.a=a,b}function rc(){this.a="",this.b=sc}function uc(a){return a instanceof rc&&a.constructor===rc&&a.b===sc?a.a:(Aa("expected object of type SafeHtml, got '"+a+"' of type "+da(a)),"type_error:SafeHtml")}function vc(a){var b=new rc;return b.a=a,b}function wc(a){var b=document;return m(a)?b.getElementById(a):a}function xc(a,b){Pa(b,function(b,d){b&&b.la&&(b=b.ja()),"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:yc.hasOwnProperty(d)?a.setAttribute(yc[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}function zc(a,b,c){var d=arguments,e=document,f=String(d[0]),g=d[1];if(!$b&&g&&(g.name||g.type)){if(f=["<",f],g.name&&f.push(' name="',qa(g.name),'"'),g.type){f.push(' type="',qa(g.type),'"');var l={};Wa(l,g),delete l.type,g=l}f.push(">"),f=f.join("")}return f=e.createElement(f),g&&(m(g)?f.className=g:fa(g)?f.className=g.join(" "):xc(f,g)),2<d.length&&Ac(e,f,d),f}function Ac(a,b,c){function d(c){c&&b.appendChild(m(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!ha(f)||q(f)&&0<f.nodeType?d(f):w(Bc(f)?La(f):f,d)}}function Bc(a){if(a&&"number"==typeof a.length){if(q(a))return"function"==typeof a.item||"string"==typeof a.item;if(p(a))return"function"==typeof a.item}return!1}function Cc(a){var b=[];return Dc(new Ec,a,b),b.join("")}function Ec(){}function Dc(a,b,c){if(null==b)c.push("null");else{if("object"==typeof b){if(fa(b)){var d=b;b=d.length,c.push("[");for(var e="",f=0;f<b;f++)c.push(e),Dc(a,d[f],c),e=",";return void c.push("]")}if(!(b instanceof String||b instanceof Number||b instanceof Boolean)){c.push("{"),e="";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&"function"!=typeof(f=b[d])&&(c.push(e),Fc(d,c),c.push(":"),Dc(a,f,c),e=",");return void c.push("}")}b=b.valueOf()}switch(typeof b){case"string":Fc(b,c);break;case"number":c.push(isFinite(b)&&!isNaN(b)?String(b):"null");break;case"boolean":c.push(String(b));break;case"function":c.push("null");break;default:throw Error("Unknown type: "+typeof b)}}}function Fc(a,b){b.push('"',a.replace(Hc,function(a){var b=Gc[a];return b||(b="\\u"+(65536|a.charCodeAt(0)).toString(16).substr(1),Gc[a]=b),b}),'"')}function Ic(){0!=Jc&&(Kc[this[ia]||(this[ia]=++ja)]=this),this.oa=this.oa,this.Fa=this.Fa}function Lc(a){a.oa||(a.oa=!0,a.ta(),0!=Jc&&(a=a[ia]||(a[ia]=++ja),delete Kc[a]))}function C(a,b){this.type=a,this.b=this.target=b,this.Bb=!0}function Qc(a,b){if(C.call(this,a?a.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,a){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.b=b,b=a.relatedTarget){if(cb){a:{try{Xa(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b,null===d?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=m(a.pointerType)?a.pointerType:Rc[a.pointerType]||"",this.a=a,a.defaultPrevented&&this.c()}}function Uc(a,b,c,d,e){this.listener=a,this.a=null,this.src=b,this.type=c,this.capture=!!d,this.La=e,this.key=++Tc,this.ma=this.Ha=!1}function Vc(a){a.ma=!0,a.listener=null,a.a=null,a.src=null,a.La=null}function Wc(a){this.src=a,this.a={},this.b=0}function Xc(a,b,c,d,e,f){var g=b.toString();(b=a.a[g])||(b=a.a[g]=[],a.b++);var l=Yc(b,c,e,f);return-1<l?(a=b[l],d||(a.Ha=!1)):(a=new Uc(c,a.src,g,!!e,f),a.Ha=d,b.push(a)),a}function Zc(a,b){var c=b.type;c in a.a&&Ia(a.a[c],b)&&(Vc(b),0==a.a[c].length&&(delete a.a[c],a.b--))}function Yc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.ma&&f.listener==b&&f.capture==!!c&&f.La==d)return e}return-1}function cd(a,b,c,d,e){if(d&&d.once)dd(a,b,c,d,e);else if(fa(b))for(var f=0;f<b.length;f++)cd(a,b[f],c,d,e);else c=ed(c),a&&a[Sc]?fd(a,b,c,q(d)?!!d.capture:!!d,e):gd(a,b,c,!1,d,e)}function gd(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=q(e)?!!e.capture:!!e,l=hd(a);if(l||(a[$c]=l=new Wc(a)),c=Xc(l,b,c,d,g,f),!c.a){if(d=id(),c.a=d,d.src=a,d.listener=c,a.addEventListener)Pc||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else{if(!a.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");a.attachEvent(jd(b.toString()),d)}bd++}}function id(){var a=kd,b=Nc?function(c){return a.call(b.src,b.listener,c)}:function(c){if(!(c=a.call(b.src,b.listener,c)))return c};return b}function dd(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)dd(a,b[f],c,d,e);else c=ed(c),a&&a[Sc]?ld(a,b,c,q(d)?!!d.capture:!!d,e):gd(a,b,c,!0,d,e)}function E(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)E(a,b[f],c,d,e);else d=q(d)?!!d.capture:!!d,c=ed(c),a&&a[Sc]?(a=a.u,(b=String(b).toString())in a.a&&(f=a.a[b],-1<(c=Yc(f,c,d,e))&&(Vc(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=hd(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yc(b,c,d,e)),(c=-1<a?b[a]:null)&&md(c))}function md(a){if("number"!=typeof a&&a&&!a.ma){var b=a.src;if(b&&b[Sc])Zc(b.u,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(jd(c),d),bd--,(c=hd(b))?(Zc(c,a),0==c.b&&(c.src=null,b[$c]=null)):Vc(a)}}}function jd(a){return a in ad?ad[a]:ad[a]="on"+a}function nd(a,b,c,d){var e=!0;if((a=hd(a))&&(b=a.a[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.ma&&(f=od(f,d),e=e&&!1!==f)}return e}function od(a,b){var c=a.listener,d=a.La||a.src;return a.Ha&&md(a),c.call(d,b)}function kd(a,b){if(a.ma)return!0;if(!Nc){if(!b)a:{b=["window","event"];for(var c=k,d=0;d<b.length;d++)if(null==(c=c[b[d]])){b=null;break a}b=c}if(d=b,b=new Qc(d,this),c=!0,!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}(e||void 0==d.returnValue)&&(d.returnValue=!0)}for(d=[],e=b.b;e;e=e.parentNode)d.push(e);for(a=a.type,e=d.length-1;0<=e;e--){b.b=d[e];var f=nd(d[e],a,!0,b);c=c&&f}for(e=0;e<d.length;e++)b.b=d[e],f=nd(d[e],a,!1,b),c=c&&f}return c}return od(a,new Qc(b,this))}function hd(a){return a=a[$c],a instanceof Wc?a:null}function ed(a){return p(a)?a:(a[pd]||(a[pd]=function(b){return a.handleEvent(b)}),a[pd])}function F(){Ic.call(this),this.u=new Wc(this),this.Ib=this,this.Ra=null}function G(a,b){var c,d=a.Ra;if(d)for(c=[];d;d=d.Ra)c.push(d);if(a=a.Ib,d=b.type||b,m(b))b=new C(b,a);else if(b instanceof C)b.target=b.target||a;else{var e=b;b=new C(d,a),Wa(b,e)}if(e=!0,c)for(var f=c.length-1;0<=f;f--){var g=b.b=c[f];e=qd(g,d,!0,b)&&e}if(g=b.b=a,e=qd(g,d,!0,b)&&e,e=qd(g,d,!1,b)&&e,c)for(f=0;f<c.length;f++)g=b.b=c[f],e=qd(g,d,!1,b)&&e}function fd(a,b,c,d,e){Xc(a.u,String(b),c,!1,d,e)}function ld(a,b,c,d,e){Xc(a.u,String(b),c,!0,d,e)}function qd(a,b,c,d){if(!(b=a.u.a[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.ma&&g.capture==c){var l=g.listener,n=g.La||g.src;g.Ha&&Zc(a.u,g),e=!1!==l.call(n,d)&&e}}return e&&0!=d.Bb}function rd(a,b,c){if(p(a))c&&(a=r(a,c));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=r(a.handleEvent,a)}return 2147483647<Number(b)?-1:k.setTimeout(a,b||0)}function sd(a){var b=null;return new z(function(c,d){-1==(b=rd(function(){c(void 0)},a))&&d(Error("Failed to schedule timer."))}).s(function(a){throw k.clearTimeout(b),a})}function td(a,b,c,d,e){this.reset(a,b,c,d,e)}function vd(a){this.f=a,this.b=this.c=this.a=null}function wd(a,b){this.name=a,this.value=b}function Ad(a){return a.c?a.c:a.a?Ad(a.a):(Aa("Root logger has no level set."),null)}function Dd(a){Cd||(Cd=new vd(""),Bd[""]=Cd,Cd.c=yd);var b;if(!(b=Bd[a])){b=new vd(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=Dd(a.substr(0,c)),c.b||(c.b={}),c.b[d]=b,b.a=c,Bd[a]=b}return b}function Ed(a,b){this.b={},this.a=[],this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Ed?(c=a.S(),d=a.P()):(c=Ra(a),d=Qa(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}function Fd(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Gd(a.b,d)&&(a.a[c++]=d),b++}a.a.length=c}if(a.c!=a.a.length){var e={};for(c=b=0;b<a.a.length;)d=a.a[b],Gd(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}function Gd(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function H(a,b){a&&a.log(zd,b,void 0)}function Hd(a){return Da(a,function(a){return a=a.toString(16),1<a.length?a:"0"+a}).join("")}function Kd(a){var b="";return Ld(a,function(a){b+=String.fromCharCode(a)}),b}function Ld(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=Jd[c];if(null!=e)return e;if(!/^[\s\xa0]*$/.test(c))throw Error("Unknown base64 encoding at char: "+c)}return b}Md();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),l=c(64);if(64===l&&-1===e)break;b(e<<2|f>>4),64!=g&&(b(f<<4&240|g>>2),64!=l&&b(g<<6&192|l))}}function Md(){if(!Id){Id={},Jd={};for(var a=0;65>a;a++)Id[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Jd[Id[a]]=a,62<=a&&(Jd["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}}function Nd(a,b){this.g=[],this.v=a,this.o=b||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function Qd(a,b,c){a.a=!0,a.c=c,a.f=!b,Rd(a)}function Pd(a){if(a.a){if(!a.u)throw new Sd;a.u=!1}}function Td(a,b){Ud(a,null,b,void 0)}function Ud(a,b,c,d){a.g.push([b,c,d]),a.a&&Rd(a)}function Vd(a){return Ea(a.g,function(a){return p(a[1])})}function Rd(a){if(a.h&&a.a&&Vd(a)){var b=a.h,c=Wd[b];c&&(k.clearTimeout(c.a),delete Wd[b]),a.h=0}a.b&&(a.b.l--,delete a.b),b=a.c;for(var d=c=!1;a.g.length&&!a.i;){var e=a.g.shift(),f=e[0],g=e[1];if(e=e[2],f=a.f?g:f)try{var l=f.call(e||a.o,b);void 0!==l&&(a.f=a.f&&(l==b||l instanceof Error),a.c=b=l),(nb(b)||"function"==typeof k.Promise&&b instanceof k.Promise)&&(d=!0,a.i=!0)}catch(n){b=n,a.f=!0,Vd(a)||(c=!0)}}a.c=b,d&&(l=r(a.m,a,!0),d=r(a.m,a,!1),b instanceof Nd?(Ud(b,l,d),b.w=!0):b.then(l,d)),c&&(b=new Xd(b),Wd[b.a]=b,a.h=b.a)}function Sd(){u.call(this)}function Od(){u.call(this)}function Xd(a){this.a=k.setTimeout(r(this.c,this),0),this.b=a}function Yd(){this.b=-1}function Zd(a,b){this.b=-1,this.b=$d,this.f=k.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=a,this.h=b,this.l=k.Int32Array?new Int32Array(64):Array(64),ae||(ae=k.Int32Array?new Int32Array(be):be),this.reset()}function ge(a){for(var b=a.f,c=a.l,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){e=0|c[b-15],d=0|c[b-2];var f=(0|c[b-16])+((e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(0|c[b-7])+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}d=0|a.a[0],e=0|a.a[1];var l=0|a.a[2],n=0|a.a[3],D=0|a.a[4],vb=0|a.a[5],tc=0|a.a[6];for(f=0|a.a[7],b=0;64>b;b++){var Bj=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&l^e&l)|0;g=D&vb^~D&tc,f=f+((D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))|0,g=g+(0|ae[b])|0,g=f+(g+(0|c[b])|0)|0,f=tc,tc=vb,vb=D,D=n+g|0,n=l,l=e,e=d,d=g+Bj|0}a.a[0]=a.a[0]+d|0,a.a[1]=a.a[1]+e|0,a.a[2]=a.a[2]+l|0,a.a[3]=a.a[3]+n|0,a.a[4]=a.a[4]+D|0,a.a[5]=a.a[5]+vb|0,a.a[6]=a.a[6]+tc|0,a.a[7]=a.a[7]+f|0}function he(a,b,c){void 0===c&&(c=b.length);var d=0,e=a.c;if(m(b))for(;d<c;)a.f[e++]=b.charCodeAt(d++),e==a.b&&(ge(a),e=0);else{if(!ha(b))throw Error("message must be string or array");for(;d<c;){var f=b[d++];if(!("number"==typeof f&&0<=f&&255>=f&&f==(0|f)))throw Error("message must be a byte array");a.f[e++]=f,e==a.b&&(ge(a),e=0)}}a.c=e,a.g+=c}function ie(){Zd.call(this,8,je)}function ke(a){if(a.P&&"function"==typeof a.P)return a.P();if(m(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Qa(a)}function le(a){if(a.S&&"function"==typeof a.S)return a.S();if(!a.P||"function"!=typeof a.P){if(ha(a)||m(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return Ra(a)}}function me(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(ha(a)||m(a))w(a,b,void 0);else for(var c=le(a),d=ke(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}function oe(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}}function pe(a,b){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,a instanceof pe){this.f=void 0!==b?b:a.f,qe(this,a.c),this.l=a.l,this.b=a.b,re(this,a.i),this.g=a.g,b=a.a;var c=new se;c.c=b.c,b.a&&(c.a=new Ed(b.a),c.b=b.b),te(this,c),this.h=a.h}else a&&(c=String(a).match(ne))?(this.f=!!b,qe(this,c[1]||"",!0),this.l=ue(c[2]||""),this.b=ue(c[3]||"",!0),re(this,c[4]),this.g=ue(c[5]||"",!0),te(this,c[6]||"",!0),this.h=ue(c[7]||"")):(this.f=!!b,this.a=new se(null,0,this.f))}function qe(a,b,c){a.c=c?ue(b,!0):b,a.c&&(a.c=a.c.replace(/:$/,""))}function re(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.i=b}else a.i=null}function te(a,b,c){b instanceof se?(a.a=b,Ae(a.a,a.f)):(c||(b=ve(b,Be)),a.a=new se(b,0,a.f))}function I(a,b,c){a.a.set(b,c)}function Ce(a,b){return a.a.get(b)}function De(a){return a instanceof pe?new pe(a):new pe(a,void 0)}function Ee(a,b){var c=new pe(null,void 0);return qe(c,"https"),a&&(c.b=a),b&&(c.g=b),c}function ue(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ve(a,b,c){return m(a)?(a=encodeURI(a).replace(b,Fe),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fe(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(15&a).toString(16)}function se(a,b,c){this.b=this.a=null,this.c=a||null,this.f=!!c}function Ge(a){a.a||(a.a=new Ed,a.b=0,a.c&&oe(a.c,function(b,c){He(a,decodeURIComponent(b.replace(/\+/g," ")),c)}))}function Ie(a){var b=le(a);if(void 0===b)throw Error("Keys are undefined");var c=new se(null,0,void 0);a=ke(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];fa(f)?Je(c,e,f):He(c,e,f)}return c}function He(a,b,c){Ge(a),a.c=null,b=Ke(a,b);var d=a.a.get(b);d||a.a.set(b,d=[]),d.push(c),a.b+=1}function Le(a,b){Ge(a),b=Ke(a,b),Gd(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,a=a.a,Gd(a.b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Fd(a)))}function Me(a,b){return Ge(a),b=Ke(a,b),Gd(a.a.b,b)}function Je(a,b,c){Le(a,b),0<c.length&&(a.c=null,a.a.set(Ke(a,b),La(c)),a.b+=c.length)}function Ke(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}function Ae(a,b){b&&!a.f&&(Ge(a),a.c=null,a.a.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(Le(this,b),Je(this,c,a))},a)),a.f=b}function Ne(){}function Oe(a){return a.c||(a.c=a.b())}function Qe(){}function Re(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return a.f}function Se(a){F.call(this),this.headers=new Ed,this.w=a||null,this.b=!1,this.v=this.a=null,this.g=this.I=this.i="",this.c=this.G=this.h=this.A=!1,this.f=0,this.m=null,this.l=Te,this.o=this.N=!1}function Ye(a,b,c,d,e){if(a.a)throw Error("[goog.net.XhrIo] Object is active with another request="+a.i+"; newUri="+b);c=c?c.toUpperCase():"GET",a.i=b,a.g="",a.I=c,a.A=!1,a.b=!0,a.a=a.w?a.w.a():Pe.a(),a.v=Oe(a.w?a.w:Pe),a.a.onreadystatechange=r(a.Ab,a);try{H(a.J,Ze(a,"Opening Xhr")),a.G=!0,a.a.open(c,String(b),!0),a.G=!1}catch(g){return H(a.J,Ze(a,"Error opening Xhr: "+g.message)),void $e(a,g)}b=d||"";var f=new Ed(a.headers);e&&me(e,function(a,b){f.set(b,a)}),e=Fa(f.S()),d=k.FormData&&b instanceof k.FormData,!Ha(Xe,c)||e||d||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),f.forEach(function(a,b){this.a.setRequestHeader(b,a)},a),a.l&&(a.a.responseType=a.l),"withCredentials"in a.a&&a.a.withCredentials!==a.N&&(a.a.withCredentials=a.N);try{af(a),0<a.f&&(a.o=bf(a.a),H(a.J,Ze(a,"Will abort after "+a.f+"ms if incomplete, xhr2 "+a.o)),a.o?(a.a.timeout=a.f,a.a.ontimeout=r(a.Ea,a)):a.m=rd(a.Ea,a.f,a)),H(a.J,Ze(a,"Sending request")),a.h=!0,a.a.send(b),a.h=!1}catch(g){H(a.J,Ze(a,"Send error: "+g.message)),$e(a,g)}}function bf(a){return y&&jb(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}function Ga(a){return"content-type"==a.toLowerCase()}function $e(a,b){a.b=!1,a.a&&(a.c=!0,a.a.abort(),a.c=!1),a.g=b,cf(a),df(a)}function cf(a){a.A||(a.A=!0,G(a,"complete"),G(a,"error"))}function ef(a){if(a.b&&void 0!==aa)if(a.v[1]&&4==ff(a)&&2==gf(a))H(a.J,Ze(a,"Local request error detected and ignored"));else if(a.h&&4==ff(a))rd(a.Ab,0,a);else if(G(a,"readystatechange"),4==ff(a)){H(a.J,Ze(a,"Request complete")),a.b=!1;try{var b=gf(a);a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=String(a.i).match(ne)[1]||null;if(!f&&k.self&&k.self.location){var g=k.self.location.protocol;f=g.substr(0,g.length-1)}e=!We.test(f?f.toLowerCase():"")}d=e}if(d)G(a,"complete"),G(a,"success");else{try{var l=2<ff(a)?a.a.statusText:""}catch(n){H(a.J,"Can not get status: "+n.message),l=""}a.g=l+" ["+gf(a)+"]",cf(a)}}finally{df(a)}}}function df(a,b){if(a.a){af(a);var c=a.a,d=a.v[0]?ca:null;a.a=null,a.v=null,b||G(a,"ready");try{c.onreadystatechange=d}catch(e){(a=a.J)&&a.log(xd,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function af(a){a.a&&a.o&&(a.a.ontimeout=null),"number"==typeof a.m&&(k.clearTimeout(a.m),a.m=null)}function ff(a){return a.a?a.a.readyState:0}function gf(a){try{return 2<ff(a)?a.a.status:-1}catch(b){return-1}}function hf(a){try{return a.a?a.a.responseText:""}catch(b){return H(a.J,"Can not get responseText: "+b.message),""}}function Ze(a,b){return b+" ["+a.I+" "+a.i+" "+gf(a)+"]"}function kf(a){var b={},c=b.document||document,d=gc(a),e=document.createElement("SCRIPT"),f={Cb:e,Ea:void 0},g=new Nd(lf,f),l=null,n=null!=b.timeout?b.timeout:5e3;return 0<n&&(l=window.setTimeout(function(){mf(e,!0);var a=new nf(of,"Timeout reached for loading script "+d);Pd(g),Qd(g,!1,a)},n),f.Ea=l),e.onload=e.onreadystatechange=function(){e.readyState&&"loaded"!=e.readyState&&"complete"!=e.readyState||(mf(e,b.Sc||!1,l),g.A(null))},e.onerror=function(){mf(e,!0,l);var a=new nf(pf,"Error while loading script "+d);Pd(g),Qd(g,!1,a)},f=b.attributes||{},Wa(f,{type:"text/javascript",charset:"UTF-8"}),xc(e,f),e.src=gc(a),qf(c).appendChild(e),g}function qf(a){var b;return(b=(a||document).getElementsByTagName("HEAD"))&&0!=b.length?b[0]:a.documentElement}function lf(){if(this&&this.Cb){var a=this.Cb;a&&"SCRIPT"==a.tagName&&mf(a,!0,this.Ea)}}function mf(a,b,c){null!=c&&k.clearTimeout(c),a.onload=ca,a.onerror=ca,a.onreadystatechange=ca,b&&window.setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},0)}function nf(a,b){var c="Jsloader error (code #"+a+")";b&&(c+=": "+b),u.call(this,c),this.code=a}function rf(){}function sf(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText=this.responseXML=null,this.a.onload=r(this.Wb,this),this.a.onerror=r(this.xb,this),this.a.onprogress=r(this.Xb,this),this.a.ontimeout=r(this.Yb,this)}function tf(a,b){a.readyState=b,a.onreadystatechange&&a.onreadystatechange()}function uf(){var a=J();return y&&!!kb&&11==kb||/Edge\/\d+/.test(a)}function vf(){return k.window&&k.window.location.href||""}function wf(a,b){b=b||k.window;var c="about:blank";a&&(c=nc(pc(a))),b.location.href=c}function xf(a,b){var d,c=[];for(d in a)d in b?typeof a[d]!=typeof b[d]?c.push(d):fa(a[d])?Ta(a[d],b[d])||c.push(d):"object"==typeof a[d]&&null!=a[d]&&null!=b[d]?0<xf(a[d],b[d]).length&&c.push(d):a[d]!==b[d]&&c.push(d):c.push(d);for(d in b)d in a||c.push(d);return c}function yf(){var a=J();return!((a=zf(a)!=Af?null:(a=a.match(/\sChrome\/(\d+)/i))&&2==a.length?parseInt(a[1],10):null)&&30>a)&&(!y||!kb||9<kb)}function Bf(a){return a=(a||J()).toLowerCase(),!!(a.match(/android/)||a.match(/webos/)||a.match(/iphone|ipad|ipod/)||a.match(/blackberry/)||a.match(/windows phone/)||a.match(/iemobile/))}function Cf(a){a=a||k.window;try{a.close()}catch(b){}}function Df(a,b,c){var d=Math.floor(1e9*Math.random()).toString();b=b||500,c=c||600;var e=(window.screen.availHeight-c)/2,f=(window.screen.availWidth-b)/2;b={width:b,height:c,top:0<e?e:0,left:0<f?f:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},c=J().toLowerCase(),d&&(b.target=d,v(c,"crios/")&&(b.target="_blank")),zf(J())==Ef&&(a=a||"http://localhost",b.scrollbars=!0),c=a||"",(d=b)||(d={}),a=window,b=c instanceof lc?c:pc(void 0!==c.href?c.href:String(c)),c=d.target||c.target,e=[];for(g in d)switch(g){case"width":case"height":case"top":case"left":e.push(g+"="+d[g]);break;case"target":case"noreferrer":break;default:e.push(g+"="+(d[g]?1:0))}var g=e.join(",");if((x("iPhone")&&!x("iPod")&&!x("iPad")||x("iPad")||x("iPod"))&&a.navigator&&a.navigator.standalone&&c&&"_self"!=c?(g=a.document.createElement("A"),b instanceof lc||b instanceof lc||(b=b.la?b.ja():String(b),oc.test(b)||(b="about:invalid#zClosurez"),b=qc(b)),g.href=nc(b),g.setAttribute("target",c),d.noreferrer&&g.setAttribute("rel","noreferrer"),d=document.createEvent("MouseEvent"),d.initMouseEvent("click",!0,!0,a,1),g.dispatchEvent(d),g={}):d.noreferrer?(g=a.open("",c,g),a=nc(b),g&&(bb&&v(a,";")&&(a="'"+a.replace(/'/g,"%27")+"'"),g.opener=null,dc("b/12014412, meta tag with sanitized URL"),a='<META HTTP-EQUIV="refresh" content="0; url='+qa(a)+'">',a=vc(a),g.document.write(uc(a)),g.document.close())):g=a.open(nc(b),c,g),g)try{g.focus()}catch(l){}return g}function Ff(a){return new z(function(b){function c(){sd(2e3).then(function(){if(a&&!a.closed)return c();b()})}return c()})}function Hf(){var a=null;return new z(function(b){"complete"==k.document.readyState?b():(a=function(){b()},dd(window,"load",a))}).s(function(b){throw E(window,"load",a),b})}function If(){return Jf(void 0)?Hf().then(function(){return new z(function(a,b){var c=k.document,d=setTimeout(function(){b(Error("Cordova framework is not ready."))},1e3);c.addEventListener("deviceready",function(){clearTimeout(d),a()},!1)})}):B(Error("Cordova must run in an Android or iOS file scheme."))}function Jf(a){return a=a||J(),!("file:"!==Kf()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))}function Lf(){var a=k.window;try{return!(!a||a==a.top)}catch(b){return!1}}function K(){return firebase.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":firebase.INTERNAL.hasOwnProperty("node")?"Node":"Browser"}function Mf(){var a=K();return"ReactNative"===a||"Node"===a}function zf(a){var b=a.toLowerCase();return v(b,"opera/")||v(b,"opr/")||v(b,"opios/")?"Opera":v(b,"iemobile")?"IEMobile":v(b,"msie")||v(b,"trident/")?"IE":v(b,"edge/")?"Edge":v(b,"firefox/")?Ef:v(b,"silk/")?"Silk":v(b,"blackberry")?"Blackberry":v(b,"webos")?"Webos":!v(b,"safari/")||v(b,"chrome/")||v(b,"crios/")||v(b,"android")?!v(b,"chrome/")&&!v(b,"crios/")||v(b,"edge/")?v(b,"android")?"Android":(a=a.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==a.length?a[1]:"Other":Af:"Safari"}function Of(a,b){b=b||[];var e,c=[],d={};for(e in Nf)d[Nf[e]]=!0;for(e=0;e<b.length;e++)void 0!==d[b[e]]&&(delete d[b[e]],c.push(b[e]));return c.sort(),b=c,b.length||(b=["FirebaseCore-web"]),c=K(),d="",(d="Browser"===c?zf(J()):c)+"/JsCore/"+a+"/"+b.join(",")}function J(){return k.navigator&&k.navigator.userAgent||""}function L(a,b){a=a.split("."),b=b||k;for(var c=0;c<a.length&&"object"==typeof b&&null!=b;c++)b=b[a[c]];return c!=a.length&&(b=void 0),b}function Pf(){try{var a=k.localStorage,b=Qf();if(a)return a.setItem(b,"1"),a.removeItem(b),!uf()||!!k.indexedDB}catch(c){}return!1}function Rf(){return(Sf()||"chrome-extension:"===Kf()||Jf())&&!Mf()&&Pf()}function Sf(){return"http:"===Kf()||"https:"===Kf()}function Kf(){return k.location&&k.location.protocol||null}function Tf(a){return a=a||J(),!Bf(a)&&zf(a)!=Ef}function Uf(a){return void 0===a?null:Cc(a)}function Vf(a){var c,b={};for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]&&(b[c]=a[c]);return b}function Wf(a){if(null!==a)return JSON.parse(a)}function Qf(a){return a||""+Math.floor(1e9*Math.random()).toString()}function Xf(a){return a=a||J(),"Safari"!=zf(a)&&!a.toLowerCase().match(/iphone|ipad|ipod/)}function Yf(){var a=k.___jsl;if(a&&a.H)for(var b in a.H)if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=a.H[b].L.concat(),a.CP)for(var c=0;c<a.CP.length;c++)a.CP[c]=null}function Zf(){var a=k.navigator;return!a||"boolean"!=typeof a.onLine||!Sf()&&"chrome-extension:"!==Kf()&&void 0===a.connection||a.onLine}function $f(a,b,c,d){if(a>b)throw Error("Short delay should be less than long delay!");this.c=a,this.b=b,a=c||J(),d=d||K(),this.a=Bf(a)||"ReactNative"===d}function ag(){var a=k.document;return!a||void 0===a.visibilityState||"visible"==a.visibilityState}function bg(){var a=k.document,b=null;return ag()||!a?A():new z(function(c){b=function(){ag()&&(a.removeEventListener("visibilitychange",b,!1),c())},a.addEventListener("visibilitychange",b,!1)}).s(function(c){throw a.removeEventListener("visibilitychange",b,!1),c})}function cg(a){try{var b=new Date(parseInt(a,10));if(!isNaN(b.getTime())&&!/[^0-9]/.test(a))return b.toUTCString()}catch(c){}return null}function M(a,b,c){eg?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c}):a[b]=c}function gg(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&M(a,c,b[c])}function hg(a){var b={};return gg(b,a),b}function ig(a){var c,b={};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function jg(a,b){if(!b||!b.length)return!0;if(!a)return!1;for(var c=0;c<b.length;c++){var d=a[b[c]];if(void 0===d||null===d||""===d)return!1}return!0}function kg(a){var b=a;if("object"==typeof a&&null!=a){b="length"in a?[]:{};for(var c in a)M(b,c,kg(a[c]))}return b}function lg(a){var b={},c=a[mg],d=a[ng];if(a=a[og],!c||!a)throw Error("Invalid provider user info!");b[pg]=d||null,b[qg]=c,M(this,rg,a),M(this,sg,kg(b))}function N(a,b){this.code=tg+a,this.message=b||ug[a]||""}function vg(a){var b=a&&a.code;return b?new N(b.substring(tg.length),a.message):null}function wg(a){var b=a[xg];if(void 0===b)throw new N("missing-continue-uri");if("string"!=typeof b||"string"==typeof b&&!b.length)throw new N("invalid-continue-uri");this.h=b,this.c=this.a=null,this.g=!1;var c=a[yg];if(c&&"object"==typeof c){b=c[zg];var d=c[Ag];if(c=c[Bg],"string"==typeof b&&b.length){if(this.a=b,void 0!==d&&"boolean"!=typeof d)throw new N("argument-error",Ag+" property must be a boolean when specified.");if(this.g=!!d,void 0!==c&&("string"!=typeof c||"string"==typeof c&&!c.length))throw new N("argument-error",Bg+" property must be a non empty string when specified.");this.c=c||null}else{if(void 0!==b)throw new N("argument-error",zg+" property must be a non empty string when specified.");if(void 0!==d||void 0!==c)throw new N("missing-android-pkg-name")}}else if(void 0!==c)throw new N("argument-error",yg+" property must be a non null object when specified.");if(this.b=null,(b=a[Cg])&&"object"==typeof b){if("string"==typeof(b=b[Dg])&&b.length)this.b=b;else if(void 0!==b)throw new N("argument-error",Dg+" property must be a non empty string when specified.")}else if(void 0!==b)throw new N("argument-error",Cg+" property must be a non null object when specified.");if(void 0!==(a=a[Eg])&&"boolean"!=typeof a)throw new N("argument-error",Eg+" property must be a boolean when specified.");if((this.f=!!a)&&!this.b&&!this.a)throw new N("argument-error",Eg+" property can't be true when no mobile application is provided.")}function Fg(a){var b={};b.continueUrl=a.h,b.canHandleCodeInApp=a.f,(b.androidPackageName=a.a)&&(b.androidMinimumVersion=a.c,b.androidInstallApp=a.g),b.iOSBundleId=a.b;for(var c in b)null===b[c]&&delete b[c];return b}function Gg(a){this.b=a.sub,na(),this.a=a.provider_id||a.firebase&&a.firebase.sign_in_provider||null}function Hg(a){if(a=a.split("."),3!=a.length)return null;a=a[1];for(var b=(4-a.length%4)%4,c=0;c<b;c++)a+=".";try{var d=JSON.parse(Kd(a));if(d.sub&&d.iss&&d.aud&&d.exp)return new Gg(d)}catch(e){}return null}function Lg(a){for(var b in Kg)if(Kg[b].Na==a)return Kg[b];return null}function Mg(a){var b={};b["facebook.com"]=Ng,b["google.com"]=Og,b["github.com"]=Pg,b["twitter.com"]=Qg;var c=a&&a[Rg];try{if(c)return b[c]?new b[c](a):new Sg(a);if(void 0!==a[Tg])return new Ug(a)}catch(d){}return null}function Ug(a){var b=a[Rg];if(!b&&a[Tg]){var c=Hg(a[Tg]);c&&c.a&&(b=c.a)}if(!b)throw Error("Invalid additional user info!");"anonymous"!=b&&"custom"!=b||(b=null),c=!1,void 0!==a.isNewUser?c=!!a.isNewUser:"identitytoolkit#SignupNewUserResponse"===a.kind&&(c=!0),M(this,"providerId",b),M(this,"isNewUser",c)}function Sg(a){Ug.call(this,a),a=Wf(a.rawUserInfo||"{}"),M(this,"profile",kg(a||{}))}function Ng(a){if(Sg.call(this,a),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Pg(a){if(Sg.call(this,a),"github.com"!=this.providerId)throw Error("Invalid provider ID!");M(this,"username",this.profile&&this.profile.login||null)}function Og(a){if(Sg.call(this,a),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qg(a){if(Sg.call(this,a),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");M(this,"username",a.screenName||null)}function Vg(a,b){return a.then(function(a){if(a[O]){var c=Hg(a[O]);if(!c||b!=c.b)throw new N("user-mismatch");return a}throw new N("user-mismatch")}).s(function(a){throw a&&a.code&&a.code==tg+"user-not-found"?new N("user-mismatch"):a})}function Wg(a,b){if(b.idToken||b.accessToken)b.idToken&&M(this,"idToken",b.idToken),b.accessToken&&M(this,"accessToken",b.accessToken);else{if(!b.oauthToken||!b.oauthTokenSecret)throw new N("internal-error","failed to construct a credential");M(this,"accessToken",b.oauthToken),M(this,"secret",b.oauthTokenSecret)}M(this,"providerId",a)}function Yg(a){var b={};return a.idToken&&(b.id_token=a.idToken),a.accessToken&&(b.access_token=a.accessToken),a.secret&&(b.oauth_token_secret=a.secret),b.providerId=a.providerId,{postBody:Ie(b).toString(),requestUri:"http://localhost"}}function ah(a,b){this.rc=b||[],gg(this,{providerId:a,isOAuthProvider:!0}),this.rb={},this.Wa=(Lg(a)||{}).Ma||null,this.Ua=null}function P(a){ah.call(this,a,Jg),this.a=[]}function bh(){P.call(this,"facebook.com")}function ch(a){if(!a)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var b=a;return q(a)&&(b=a.accessToken),(new bh).credential(null,b)}function dh(){P.call(this,"github.com")}function eh(a){if(!a)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var b=a;return q(a)&&(b=a.accessToken),(new dh).credential(null,b)}function fh(){P.call(this,"google.com"),this.sa("profile")}function gh(a,b){var c=a;return q(a)&&(c=a.idToken,b=a.accessToken),(new fh).credential(c,b)}function hh(){ah.call(this,"twitter.com",Ig)}function ih(a,b){var c=a;if(q(c)||(c={oauthToken:a,oauthTokenSecret:b}),!c.oauthToken||!c.oauthTokenSecret)throw new N("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Wg("twitter.com",c)}function jh(a,b){this.a=a,this.f=b,M(this,"providerId","password")}function mh(){gg(this,{providerId:"password",isOAuthProvider:!1})}function nh(a){if(!(a.Pa&&a.Oa||a.Da&&a.Y))throw new N("internal-error");this.a=a,M(this,"providerId","phone")}function oh(a){return a.a.Da&&a.a.Y?{temporaryProof:a.a.Da,phoneNumber:a.a.Y}:{sessionInfo:a.a.Pa,code:a.a.Oa}}function rh(a){try{this.a=a||firebase.auth()}catch(b){throw new N("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}gg(this,{providerId:"phone",isOAuthProvider:!1})}function th(a,b){if(!a)throw new N("missing-verification-id");if(!b)throw new N("missing-verification-code");return new nh({Pa:a,Oa:b})}function uh(a){if(a.temporaryProof&&a.phoneNumber)return new nh({Da:a.temporaryProof,Y:a.phoneNumber});var b=a&&a.providerId;if(!b||"password"===b)return null;var c=a&&a.oauthAccessToken,d=a&&a.oauthTokenSecret;a=a&&a.oauthIdToken;try{switch(b){case"google.com":return gh(a,c);case"facebook.com":return ch(c);case"github.com":return eh(c);case"twitter.com":return ih(c,d);default:return new P(b).credential(a,c)}}catch(e){return null}}function vh(a){if(!a.isOAuthProvider)throw new N("invalid-oauth-provider")}function wh(a,b,c,d,e){if(this.b=a,this.c=b||null,this.f=c||null,this.g=d||null,this.a=e||null,!this.f&&!this.a)throw new N("invalid-auth-event");if(this.f&&this.a)throw new N("invalid-auth-event");if(this.f&&!this.g)throw new N("invalid-auth-event")}function xh(a){return a=a||{},a.type?new wh(a.type,a.eventId,a.urlResponse,a.sessionId,a.error&&vg(a.error)):null}function yh(a){var b="unauthorized-domain",c=void 0,d=De(a);a=d.b,d=d.c,"chrome-extension"==d?c=oa("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",a):"http"==d||"https"==d?c=oa("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",a):b="operation-not-supported-in-this-environment",N.call(this,b,c)}function zh(a,b,c){N.call(this,a,c),a=b||{},a.sb&&M(this,"email",a.sb),a.Y&&M(this,"phoneNumber",a.Y),a.credential&&M(this,"credential",a.credential)}function Ah(a){if(a.code){var b=a.code||"";0==b.indexOf(tg)&&(b=b.substring(tg.length));var c={credential:uh(a)};if(a.email)c.sb=a.email;else{if(!a.phoneNumber)return new N(b,a.message||void 0);c.Y=a.phoneNumber}return new zh(b,c,a.message)}return null}function Bh(a){this.f=a}function Ch(a,b,c){var d="Node"==K();if(!(d=k.XMLHttpRequest||d&&firebase.INTERNAL.node&&firebase.INTERNAL.node.XMLHttpRequest))throw new N("internal-error","The XMLHttpRequest compatibility library was not found.");this.b=a,a=b||{},this.i=a.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=a.secureTokenTimeout||Dh,this.c=Ua(a.secureTokenHeaders||Eh),this.g=a.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=a.firebaseTimeout||Fh,this.a=Ua(a.firebaseHeaders||Gh),c&&(this.a["X-Client-Version"]=c,this.c["X-Client-Version"]=c),this.f=new rf,this.o=new Bh(d)}function Ih(a,b){b?a.a["X-Firebase-Locale"]=b:delete a.a["X-Firebase-Locale"]}function Jh(a,b){b?(a.a["X-Client-Version"]=b,a.c["X-Client-Version"]=b):(delete a.a["X-Client-Version"],delete a.c["X-Client-Version"])}function Kh(a,b,c,d,e,f,g){Zf()?(yf()?a=r(a.m,a):(Hh||(Hh=new z(function(a,b){Lh(a,b)})),a=r(a.u,a)),a(b,c,d,e,f,g)):c&&c(null)}function Lh(a,b){if(((window.gapi||{}).client||{}).request)a();else{k[Nh]=function(){((window.gapi||{}).client||{}).request?a():b(Error("CORS_UNSUPPORTED"))};Td(kf(hc(Mh,{onload:Nh})),function(){b(Error("CORS_UNSUPPORTED"))})}}function Oh(a,b){return new z(function(c,d){"refresh_token"==b.grant_type&&b.refresh_token||"authorization_code"==b.grant_type&&b.code?Kh(a,a.i+"?key="+encodeURIComponent(a.b),function(a){a?a.error?d(Ph(a)):a.access_token&&a.refresh_token?c(a):d(new N("internal-error")):d(new N("network-request-failed"))},"POST",Ie(b).toString(),a.c,a.l.get()):d(new N("internal-error"))})}function Qh(a,b,c,d,e,f){var g=De(a.g+b);I(g,"key",a.b),f&&I(g,"cb",na().toString());var l="GET"==c;if(l)for(var n in d)d.hasOwnProperty(n)&&I(g,n,d[n]);return new z(function(b,f){Kh(a,g.toString(),function(a){a?a.error?f(Ph(a,e||{})):b(a):f(new N("network-request-failed"))},c,l?void 0:Cc(Vf(d)),a.a,a.h.get())})}function Rh(a){if(!jf.test(a.email))throw new N("invalid-email")}function Sh(a){"email"in a&&Rh(a)}function Th(a,b){return Q(a,Uh,{identifier:b,continueUri:Sf()?vf():"http://localhost"}).then(function(a){return a.allProviders||[]})}function Vh(a){return Q(a,Wh,{}).then(function(a){return a.authorizedDomains||[]})}function Xh(a){if(!a[O])throw new N("internal-error")}function Yh(a){if(a.phoneNumber||a.temporaryProof){if(!a.phoneNumber||!a.temporaryProof)throw new N("internal-error")}else{if(!a.sessionInfo)throw new N("missing-verification-id");if(!a.code)throw new N("missing-verification-code")}}function sh(a,b){return Q(a,di,b)}function fi(a,b,c){return Q(a,gi,{idToken:b,deleteProvider:c})}function hi(a){if(!a.requestUri||!a.sessionId&&!a.postBody)throw new N("internal-error")}function ii(a){var b=null;if(a.needConfirmation?(a.code="account-exists-with-different-credential",b=Ah(a)):"FEDERATED_USER_ID_ALREADY_LINKED"==a.errorMessage?(a.code="credential-already-in-use",b=Ah(a)):"EMAIL_EXISTS"==a.errorMessage?(a.code="email-already-in-use",b=Ah(a)):a.errorMessage&&(b=ji(a.errorMessage)),b)throw b;if(!a[O])throw new N("internal-error")}function Xg(a,b){return b.returnIdpCredential=!0,Q(a,ki,b)}function Zg(a,b){return b.returnIdpCredential=!0,Q(a,li,b)}function $g(a,b){return b.returnIdpCredential=!0,b.autoCreate=!1,Q(a,mi,b)}function ni(a){if(!a.oobCode)throw new N("invalid-action-code")}function Q(a,b,c){if(!jg(c,b.ea))return B(new N("internal-error"));var e,d=b.zb||"POST";return A(c).then(b.D).then(function(){return b.T&&(c.returnSecureToken=!0),Qh(a,b.endpoint,d,c,b.Pb,b.nb||!1)}).then(function(a){return e=a}).then(b.O).then(function(){if(!b.ga)return e;if(!(b.ga in e))throw new N("internal-error");return e[b.ga]})}function ji(a){return Ph({error:{errors:[{message:a}],code:400,message:a}})}function Ph(a,b){var c=(a.error&&a.error.errors&&a.error.errors[0]||{}).reason||"",d={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(c=d[c]?new N(d[c]):null)return c;c=a.error&&a.error.message||"",d={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},Wa(d,b||{}),b=(b=c.match(/^[^\s]+\s*:\s*(.*)$/))&&1<b.length?b[1]:void 0;for(var e in d)if(0===c.indexOf(e))return new N(d[e],b);return!b&&a&&(b=Uf(a)),new N("internal-error",b)}function xi(a){for(var b in wi)if(wi[b].id===a)return a=wi[b],{firebaseEndpoint:a.Va,secureTokenEndpoint:a.ab};return null}function zi(a){this.b=a,this.a=null,this.Ya=Ai(this)}function Ai(a){return Bi().then(function(){return new z(function(b,c){L("gapi.iframes.getContext")().open({where:document.body,url:a.b,messageHandlersFilter:L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(d){function e(){clearTimeout(f),b()}a.a=d,a.a.restyle({setHideOnLeave:!1});var f=setTimeout(function(){c(Error("Network Error"))},Ci.get());d.ping(e).then(e,function(){c(Error("Network Error"))})})})})}function Di(a,b){return a.Ya.then(function(){return new z(function(c){a.a.send(b.type,b,c,L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function Ei(a,b){a.Ya.then(function(){a.a.register("authEvent",b,L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}function Bi(){return Hi||(Hi=new z(function(a,b){if(Zf()){var c=function(){Yf(),L("gapi.load")("gapi.iframes",{callback:a,ontimeout:function(){Yf(),b(Error("Network Error"))},timeout:Gi.get()})};if(L("gapi.iframes.Iframe"))a();else if(L("gapi.load"))c();else{var d="__iframefcb"+Math.floor(1e6*Math.random()).toString();k[d]=function(){L("gapi.load")?c():b(Error("Network Error"))},d=hc(Fi,{onload:d}),A(kf(d)).s(function(){b(Error("Network Error"))})}}else b(Error("Network Error"))}).s(function(a){throw Hi=null,a}))}function Ii(a,b,c){this.i=a,this.g=b,this.h=c,this.f=null,this.a=Ee(this.i,"/__/auth/iframe"),I(this.a,"apiKey",this.g),I(this.a,"appName",this.h),this.b=null,this.c=[]}function Ji(a,b,c,d,e){this.m=a,this.u=b,this.c=c,this.l=d,this.i=this.g=this.h=null,this.a=e,this.f=null}function Ki(a){try{return firebase.app(a).auth().Ka()}catch(b){return[]}}function Li(a,b,c,d,e){this.u=a,this.f=b,this.b=c,this.c=d||null,this.h=e||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function Mi(a){var b=vf();return Vh(a).then(function(a){a:{var c=De(b),e=c.c;c=c.b;for(var f=0;f<a.length;f++){var g=a[f],l=c,n=e;if(0==g.indexOf("chrome-extension://")?l=De(g).b==l&&"chrome-extension"==n:"http"!=n&&"https"!=n?l=!1:Gf.test(g)?l=l==g:(g=g.split(".").join("\\."),l=new RegExp("^(.+\\."+g+"|"+g+")$","i").test(l)),l){a=!0;break a}}a=!1}if(!a)throw new yh(vf())})}function Ni(a){return a.l?a.l:(a.l=Hf().then(function(){if(!a.o){var b=a.c,c=a.h,d=Ki(a.b),e=new Ii(a.u,a.f,a.b);e.f=b,e.b=c,e.c=La(d||[]),a.o=e.toString()}a.i=new zi(a.o),Oi(a)}),a.l)}function Qi(a){return a.m||(a.v=a.c?Of(a.c,Ki(a.b)):null,a.m=new Ch(a.f,xi(a.h),a.v)),a.m}function Ri(a,b,c,d,e,f,g,l,n,D){return a=new Ji(a,b,c,d,e),a.h=f,a.g=g,a.i=l,a.b=Ua(n||null),a.f=D,a.toString()}function Oi(a){if(!a.i)throw Error("IfcHandler must be initialized!");Ei(a.i,function(b){var c={};if(b&&b.authEvent){var d=!1;for(b=xh(b.authEvent),c=0;c<a.g.length;c++)d=a.g[c](b)||d;return c={},c.status=d?"ACK":"ERROR",A(c)}return c.status="ERROR",A(c)})}function Pi(a){var b={type:"webStorageSupport"};return Ni(a).then(function(){return Di(a.i,b)}).then(function(a){if(a&&a.length&&void 0!==a[0].webStorageSupport)return a[0].webStorageSupport;throw Error()})}function Si(a){if(this.a=a||firebase.INTERNAL.reactNative&&firebase.INTERNAL.reactNative.AsyncStorage,!this.a)throw new N("internal-error","The React Native compatibility library was not found.")}function Ti(){this.a={}}function Ui(a,b,c,d,e,f){try{var g=!!k.indexedDB}catch(l){g=!1}if(!g)throw new N("web-storage-unsupported");this.u=a,this.h=b,this.g=c,this.l=d,this.m=e,this.f={},this.c=[],this.a=0,this.o=f||k.indexedDB}function Wi(a){return new z(function(b,c){var d=a.o.open(a.u,a.m);d.onerror=function(a){c(Error(a.target.errorCode))},d.onupgradeneeded=function(b){b=b.target.result;try{b.createObjectStore(a.h,{keyPath:a.g})}catch(f){c(f)}},d.onsuccess=function(a){b(a.target.result)}})}function Xi(a){return a.i||(a.i=Wi(a)),a.i}function Yi(a,b){return b.objectStore(a.h)}function Zi(a,b,c){return b.transaction([a.h],c?"readwrite":"readonly")}function $i(a){return new z(function(b,c){a.onsuccess=function(a){a&&a.target?b(a.target.result):b()},a.onerror=function(a){c(Error(a.target.errorCode))}})}function aj(a){function b(){return a.b=sd(800).then(r(a.zc,a)).then(function(b){0<b.length&&w(a.c,function(a){a(b)})}).then(b).s(function(a){"STOP_EVENT"!=a.message&&b()}),a.b}a.b&&a.b.cancel("STOP_EVENT"),b()}function bj(){if(!cj()){if("Node"==K())throw new N("internal-error","The LocalStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=dj()||firebase.INTERNAL.node.localStorage}function dj(){try{var a=k.localStorage,b=Qf();return a&&(a.setItem(b,"1"),a.removeItem(b)),a}catch(c){return null}}function cj(){var a="Node"==K();if(!(a=dj()||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.localStorage))return!1;try{return a.setItem("__sak","1"),a.removeItem("__sak"),!0}catch(b){return!1}}function ej(){}function fj(){if(!gj()){if("Node"==K())throw new N("internal-error","The SessionStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=hj()||firebase.INTERNAL.node.sessionStorage}function hj(){try{var a=k.sessionStorage,b=Qf();return a&&(a.setItem(b,"1"),a.removeItem(b)),a}catch(c){return null}}function gj(){var a="Node"==K();if(!(a=hj()||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.sessionStorage))return!1;try{return a.setItem("__sak","1"),a.removeItem("__sak"),!0}catch(b){return!1}}function ij(){var a={};a.Browser=jj,a.Node=kj,a.ReactNative=lj,this.a=a[K()]}function oj(a){var b=new N("invalid-persistence-type"),c=new N("unsupported-persistence-type");a:{for(d in nj)if(nj[d]==a){var d=!0;break a}d=!1}if(!d||"string"!=typeof a)throw b;switch(K()){case"ReactNative":if("session"===a)throw c;break;case"Node":if("none"!==a)throw c;break;default:if(!Pf()&&"none"!==a)throw c}}function pj(a,b,c,d,e){this.i=a,this.g=b,this.A=c,this.u=d,this.v=e,this.a={},mj||(mj=new ij),a=mj;try{if(uf()){Vi||(Vi=new Ui("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var f=Vi}else f=new a.a.C;this.l=f}catch(g){this.l=new Ti,this.u=!0}try{this.o=new a.a.jb}catch(g){this.o=new Ti}this.w=new Ti,this.h=r(this.m,this),this.b={}}function rj(){return qj||(qj=new pj("firebase",":",!(Xf(J())||!Lf()),Tf(),Pf())),qj}function sj(a,b){switch(b){case"session":return a.o;case"none":return a.w;default:return a.l}}function tj(a,b,c){return a.i+a.g+b.name+(c?a.g+c:"")}function uj(a,b,c){return c=tj(a,b,c),"local"==b.C&&(a.b[c]=null),sj(a,b.C).X(c)}function vj(a,b,c,d){b=tj(a,b,c),a.v&&(a.b[b]=k.localStorage.getItem(b)),Sa(a.a)&&(sj(a,"local").ia(a.h),a.u||uf()||!a.v||wj(a)),a.a[b]||(a.a[b]=[]),a.a[b].push(d)}function xj(a,b,c){b=tj(a,yj("local"),b),a.a[b]&&(Ja(a.a[b],function(a){return a==c}),0==a.a[b].length&&delete a.a[b]),Sa(a.a)&&zj(a)}function wj(a){Aj(a),a.f=setInterval(function(){for(var b in a.a){var c=k.localStorage.getItem(b),d=a.b[b];c!=d&&(a.b[b]=c,c=new Qc({type:"storage",key:b,target:window,oldValue:d,newValue:c,a:!0}),a.m(c))}},1e3)}function Aj(a){a.f&&(clearInterval(a.f),a.f=null)}function zj(a){sj(a,"local").da(a.h),Aj(a)}function Cj(a){this.a=a,this.b=rj()}function Ej(a){return a.b.get(Dj,a.a).then(function(a){return xh(a)})}function Fj(){this.a=rj()}function Gj(a,b,c,d,e,f,g){this.u=a,this.i=b,this.l=c,this.m=d||null,this.o=g||null,this.h=b+":"+c,this.A=new Fj,this.g=new Cj(this.h),this.f=null,this.b=[],this.v=e||500,this.w=f||2e3,this.a=this.c=null}function Hj(a){return new N("invalid-cordova-configuration",a)}function Ij(){for(var a=20,b=[];0<a;)b.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),a--;return b.join("")}function Jj(a){var b=new ie;he(b,a),a=[];var c=8*b.g;56>b.c?he(b,fe,56-b.c):he(b,fe,b.b-(b.c-56));for(var d=63;56<=d;d--)b.f[d]=255&c,c/=256;for(ge(b),d=c=0;d<b.i;d++)for(var e=24;0<=e;e-=8)a[c++]=b.a[d]>>e&255;return Hd(a)}function Lj(a,b,c,d){var e=Ij(),f=new wh(b,d,null,e,new N("no-auth-event")),g=L("BuildInfo.packageName",k);if("string"!=typeof g)throw new N("invalid-cordova-configuration");var l=L("BuildInfo.displayName",k),n={};if(J().toLowerCase().match(/iphone|ipad|ipod/))n.ibi=g;else{if(!J().toLowerCase().match(/android/))return B(new N("operation-not-supported-in-this-environment"));n.apn=g}l&&(n.appDisplayName=l),e=Jj(e),n.sessionId=e;var D=Ri(a.u,a.i,a.l,b,c,null,d,a.m,n,a.o);return a.ba().then(function(){var b=a.h;return a.A.a.set(Dj,f.B(),b)}).then(function(){var b=L("cordova.plugins.browsertab.isAvailable",k);if("function"!=typeof b)throw new N("invalid-cordova-configuration");var c=null;b(function(b){if(b){if("function"!=typeof(c=L("cordova.plugins.browsertab.openUrl",k)))throw new N("invalid-cordova-configuration");c(D)}else{if("function"!=typeof(c=L("cordova.InAppBrowser.open",k)))throw new N("invalid-cordova-configuration");b=J(),b=!(!b.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!b.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),a.a=c(D,b?"_blank":"_system","location=yes")}})})}function Nj(a,b){for(var c=0;c<a.b.length;c++)try{a.b[c](b)}catch(d){}}function Kj(a){return a.f||(a.f=a.ba().then(function(){return new z(function(b){function c(d){return b(d),a.Ja(c),!1}a.ua(c),Oj(a)})})),a.f}function Mj(a){var b=null;return Ej(a.g).then(function(c){return b=c,c=a.g,uj(c.b,Dj,c.a)}).then(function(){return b})}function Oj(a){function b(b){e=!0,f&&f.cancel(),Mj(a).then(function(c){var e=d;if(c&&b&&b.url){e=null;var f=b.url,g=De(f),l=Ce(g,"link"),n=Ce(De(l),"link");g=Ce(g,"deep_link_id"),f=Ce(De(g),"link")||g||n||l||f,-1!=f.indexOf("/__/auth/callback")&&(e=De(f),e=Wf(Ce(e,"firebaseError")||null),e=(e="object"==typeof e?vg(e):null)?new wh(c.b,c.c,null,null,e):new wh(c.b,c.c,f,c.g)),e=e||d}Nj(a,e)})}var c=L("universalLinks.subscribe",k);if("function"!=typeof c)throw new N("invalid-cordova-configuration");var d=new wh("unknown",null,null,null,new N("no-auth-event")),e=!1,f=sd(a.v).then(function(){return Mj(a).then(function(){e||Nj(a,d)})}),g=k.handleOpenURL;k.handleOpenURL=function(a){if(0==a.toLowerCase().indexOf(L("BuildInfo.packageName",k).toLowerCase()+"://")&&b({url:a}),"function"==typeof g)try{g(a)}catch(n){console.error(n)}},c(null,b)}function Pj(a){this.a=a,this.b=rj()}function Rj(a){return a.b.set(Qj,"pending",a.a)}function Sj(a){return uj(a.b,Qj,a.a)}function Tj(a){return a.b.get(Qj,a.a).then(function(a){return"pending"==a})}function Uj(a,b,c){this.v=a,this.l=b,this.u=c,this.h=[],this.f=!1,this.i=r(this.m,this),this.c=new Vj,this.o=new Wj,this.g=new Pj(this.l+":"+this.u),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.o,this.b.linkViaPopup=this.o,this.b.reauthViaPopup=this.o,this.a=Xj(this.v,this.l,this.u,yi)}function Xj(a,b,c,d){var e=firebase.SDK_VERSION||null;return Jf()?new Gj(a,b,c,e,void 0,void 0,d):new Li(a,b,c,e,d)}function Yj(a){a.f||(a.f=!0,a.a.ua(a.i));var b=a.a;return a.a.ba().s(function(c){throw a.a==b&&a.reset(),c})}function Zj(a){a.a.Db()&&Yj(a).s(function(b){var c=new wh("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));ak(b)&&a.m(c)}),a.a.yb()||bk(a.c)}function ek(a,b,c,d,e,f){return a.a.vb(b,c,d,function(){a.f||(a.f=!0,a.a.ua(a.i))},function(){a.reset()},e,f)}function ak(a){return!(!a||"auth/cordova-not-ready"!=a.code)}function gk(a,b,c){var d=b+":"+c;return fk[d]||(fk[d]=new Uj(a,b,c)),fk[d]}function Vj(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function bk(a){a.g||(a.g=!0,hk(a,!1,null,null))}function ik(a,b,c){c=c.va(b.b,b.c);var d=b.f,e=b.g,f=!!b.b.match(/Redirect$/);return c(d,e).then(function(b){hk(a,f,b,null)}).s(function(b){hk(a,f,null,b)})}function jk(a,b){if(a.b=function(){return B(b)},a.c.length)for(var c=0;c<a.c.length;c++)a.c[c](b)}function kk(a,b){if(a.b=function(){return A(b)},a.f.length)for(var c=0;c<a.f.length;c++)a.f[c](b)}function hk(a,b,c,d){b?d?jk(a,d):kk(a,c):kk(a,{user:null}),a.f=[],a.c=[]}function lk(a){var b=new N("timeout");a.a&&a.a.cancel(),a.a=sd(dk.get()).then(function(){a.b||hk(a,!0,null,b)})}function Wj(){}function mk(a,b){var c=a.c,d=a.b;return b.va(d,c)(a.f,a.g).then(function(a){b.fa(d,a,null,c)}).s(function(a){b.fa(d,null,a,c)})}function nk(a,b){this.a=b,M(this,"verificationId",a)}function ok(a,b,c,d){return new rh(a).Qa(b,c).then(function(a){return new nk(a,d)})}function pk(a,b,c,d,e,f){if(this.h=a,this.i=b,this.g=c,this.c=d,this.f=e,this.l=!!f,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function rk(a,b){return b?(a.a=a.c,a.g()):(b=a.a,a.a*=2,a.a>a.f&&(a.a=a.f),b)}function qk(a,b){sk(a),a.b=sd(rk(a,b)).then(function(){return a.l?A():bg()}).then(function(){return a.h()}).then(function(){qk(a,!0)}).s(function(b){a.i(b)&&qk(a,!1)})}function sk(a){a.b&&(a.b.cancel(),a.b=null)}function tk(a){this.f=a,this.b=this.a=null,this.c=0}function uk(a,b){var c=b[O],d=b.refreshToken;b=vk(b.expiresIn),a.b=c,a.c=b,a.a=d}function vk(a){return na()+1e3*parseInt(a,10)}function wk(a,b){return Oh(a.f,b).then(function(b){return a.b=b.access_token,a.c=vk(b.expires_in),a.a=b.refresh_token,{accessToken:a.b,expirationTime:a.c,refreshToken:a.a}}).s(function(b){throw"auth/user-token-expired"==b.code&&(a.a=null),b})}function xk(a,b){this.a=a||null,this.b=b||null,gg(this,{lastSignInTime:cg(b||null),creationTime:cg(a||null)})}function yk(a){return new xk(a.a,a.b)}function zk(a,b,c,d,e,f){gg(this,{uid:a,displayName:d||null,photoURL:e||null,email:c||null,phoneNumber:f||null,providerId:b})}function Ak(a,b){C.call(this,a);for(var c in b)this[c]=b[c]}function Bk(a,b,c){this.A=[],this.G=a.apiKey,this.o=a.appName,this.w=a.authDomain||null,a=firebase.SDK_VERSION?Of(firebase.SDK_VERSION):null,this.c=new Ch(this.G,xi(yi),a),this.h=new tk(this.c),Ck(this,b[O]),uk(this.h,b),M(this,"refreshToken",this.h.a),Dk(this,c||{}),F.call(this),this.I=!1,this.w&&Rf()&&(this.a=gk(this.w,this.G,this.o)),this.N=[],this.i=null,this.l=Ek(this),this.U=r(this.Ga,this);var d=this;this.ha=null,this.ra=function(a){d.na(a.h)},this.W=null,this.R=[],this.qa=function(a){Fk(d,a.f)},this.V=null}function Gk(a,b){a.W&&E(a.W,"languageCodeChanged",a.ra),(a.W=b)&&cd(b,"languageCodeChanged",a.ra)}function Fk(a,b){a.R=b,Jh(a.c,firebase.SDK_VERSION?Of(firebase.SDK_VERSION,a.R):null)}function Hk(a,b){a.V&&E(a.V,"frameworkChanged",a.qa),(a.V=b)&&cd(b,"frameworkChanged",a.qa)}function Ik(a){try{return firebase.app(a.o).auth()}catch(b){throw new N("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+a.o+"'!")}}function Ek(a){return new pk(function(){return a.F(!0)},function(a){return!(!a||"auth/network-request-failed"!=a.code)},function(){var b=a.h.c-na()-3e5;return 0<b?b:0},3e4,96e4,!1)}function Jk(a){a.m||a.l.b||(a.l.start(),E(a,"tokenChanged",a.U),cd(a,"tokenChanged",a.U))}function Kk(a){E(a,"tokenChanged",a.U),sk(a.l)}function Ck(a,b){a.pa=b,M(a,"_lat",b)}function Lk(a,b){Ja(a.N,function(a){return a==b})}function Mk(a){for(var b=[],c=0;c<a.N.length;c++)b.push(a.N[c](a));return Ob(b).then(function(){return a})}function Nk(a){a.a&&!a.I&&(a.I=!0,a.a.subscribe(a))}function Dk(a,b){gg(a,{uid:b.uid,displayName:b.displayName||null,photoURL:b.photoURL||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,isAnonymous:b.isAnonymous||!1,metadata:new xk(b.createdAt,b.lastLoginAt),providerData:[]})}function Ok(){}function Pk(a){return A().then(function(){if(a.m)throw new N("app-deleted")})}function Qk(a){return Da(a.providerData,function(a){return a.providerId})}function Rk(a,b){b&&(Sk(a,b.providerId),a.providerData.push(b))}function Sk(a,b){Ja(a.providerData,function(a){return a.providerId==b})}function Tk(a,b,c){("uid"!=b||c)&&a.hasOwnProperty(b)&&M(a,b,c)}function Uk(a,b){a!=b&&(gg(a,{uid:b.uid,displayName:b.displayName,photoURL:b.photoURL,email:b.email,emailVerified:b.emailVerified,phoneNumber:b.phoneNumber,isAnonymous:b.isAnonymous,providerData:[]}),b.metadata?M(a,"metadata",yk(b.metadata)):M(a,"metadata",new xk),w(b.providerData,function(b){Rk(a,b)}),a.h=b.h,M(a,"refreshToken",a.h.a))}function Vk(a){return a.F().then(function(b){var c=a.isAnonymous;return Wk(a,b).then(function(){return c||Tk(a,"isAnonymous",!1),b})})}function Xk(a,b){b[O]&&a.pa!=b[O]&&(uk(a.h,b),G(a,new Ak("tokenChanged")),Ck(a,b[O]),Tk(a,"refreshToken",a.h.a))}function Wk(a,b){return Q(a.c,ti,{idToken:b}).then(r(a.kc,a))}function Yk(a){return(a=a.providerUserInfo)&&a.length?Da(a,function(a){return new zk(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl,a.phoneNumber)}):[]}function $k(a,b){return Vk(a).then(function(){if(Ha(Qk(a),b))return Mk(a).then(function(){throw new N("provider-already-linked")})})}function Zk(a,b,c){var d=uh(b);return b=Mg(b),hg({user:a,credential:d,additionalUserInfo:b,operationType:c})}function al(a,b){return Xk(a,b),a.reload().then(function(){return a})}function bl(a,b,c,d,e){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));if(a.i&&!e)return B(a.i);var f=Lg(c.providerId),g=Qf(a.uid+":::"),l=null;(!Tf()||Lf())&&a.w&&c.isOAuthProvider&&(l=Ri(a.w,a.G,a.o,b,c,null,g,firebase.SDK_VERSION||null));var n=Df(l,f&&f.za,f&&f.ya);return d=d().then(function(){if(cl(a),!e)return a.F().then(function(){})}).then(function(){return ek(a.a,n,b,c,g,!!l)}).then(function(){return new z(function(c,d){a.fa(b,null,new N("cancelled-popup-request"),a.g||null),a.f=c,a.v=d,a.g=g,a.b=a.a.Ca(a,b,n,g)})}).then(function(a){return n&&Cf(n),a?hg(a):null}).s(function(a){throw n&&Cf(n),a}),R(a,d,e)}function dl(a,b,c,d,e){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));if(a.i&&!e)return B(a.i);var f=null,g=Qf(a.uid+":::");return d=d().then(function(){if(cl(a),!e)return a.F().then(function(){})}).then(function(){return a.Z=g,Mk(a)}).then(function(b){return a.ca&&(b=a.ca,b=b.b.set(el,a.B(),b.a)),b}).then(function(){return a.a.Aa(b,c,g)}).s(function(b){if(f=b,a.ca)return fl(a.ca);throw f}).then(function(){if(f)throw f}),R(a,d,e)}function cl(a){if(!a.a||!a.I){if(a.a&&!a.I)throw new N("internal-error");throw new N("auth-domain-config-required")}}function R(a,b,c){var d=gl(a,b,c);return a.A.push(d),Qb(d,function(){Ia(a.A,d)}),d}function gl(a,b,c){return a.i&&!c?(b.cancel(),B(a.i)):b.s(function(b){throw!b||"auth/user-disabled"!=b.code&&"auth/user-token-expired"!=b.code||(a.i||G(a,new Ak("userInvalidated")),a.i=b),b})}function hl(a){if(!a.apiKey)return null;var b={apiKey:a.apiKey,authDomain:a.authDomain,appName:a.appName},c={};if(!(a.stsTokenManager&&a.stsTokenManager.accessToken&&a.stsTokenManager.expirationTime))return null;c[O]=a.stsTokenManager.accessToken,c.refreshToken=a.stsTokenManager.refreshToken||null,c.expiresIn=(a.stsTokenManager.expirationTime-na())/1e3;var d=new Bk(b,c,a);return a.providerData&&w(a.providerData,function(a){a&&Rk(d,hg(a))}),a.redirectEventId&&(d.Z=a.redirectEventId),d}function il(a,b,c,d){var e=new Bk(a,b);return c&&(e.ca=c),d&&Fk(e,d),e.reload().then(function(){return e})}function jl(a){this.a=a,this.b=rj()}function fl(a){return uj(a.b,el,a.a)}function kl(a,b){return a.b.get(el,a.a).then(function(a){return a&&b&&(a.authDomain=b),hl(a||{})})}function ll(a,b){this.a=a,this.b=b||rj(),this.c=null,this.f=ml(this),vj(this.b,yj("local"),this.a,r(this.g,this))}function ol(a,b){var d,c=[];for(d in nj)nj[d]!==b&&c.push(uj(a.b,yj(nj[d]),a.a));return c.push(uj(a.b,pl,a.a)),Nb(c)}function ml(a){var b=yj("local"),c=yj("session"),d=yj("none");return a.b.get(c,a.a).then(function(e){return e?c:a.b.get(d,a.a).then(function(c){return c?d:a.b.get(b,a.a).then(function(c){return c?b:a.b.get(pl,a.a).then(function(a){return a?yj(a):b})})})}).then(function(b){return a.c=b,ol(a,b.C)}).s(function(){a.c||(a.c=b)})}function yj(a){return{name:"authUser",C:a}}function ql(a){return nl(a,function(){return a.b.set(pl,a.c.C,a.a)})}function rl(a,b){return nl(a,function(){return a.b.set(a.c,b.B(),a.a)})}function sl(a){return nl(a,function(){return uj(a.b,a.c,a.a)})}function tl(a,b){return nl(a,function(){return a.b.get(a.c,a.a).then(function(a){return a&&b&&(a.authDomain=b),hl(a||{})})})}function nl(a,b){return a.f=a.f.then(b,b),a.f}function ul(a){if(this.l=!1,M(this,"app",a),!S(this).options||!S(this).options.apiKey)throw new N("invalid-api-key");a=firebase.SDK_VERSION?Of(firebase.SDK_VERSION):null,this.c=new Ch(S(this).options&&S(this).options.apiKey,xi(yi),a),this.N=[],this.m=[],this.I=[],this.Kb=firebase.INTERNAL.createSubscribe(r(this.ac,this)),this.R=void 0,this.Lb=firebase.INTERNAL.createSubscribe(r(this.bc,this)),vl(this,null),this.h=new ll(S(this).options.apiKey+":"+S(this).name),this.G=new jl(S(this).options.apiKey+":"+S(this).name),this.U=T(this,wl(this)),this.i=T(this,xl(this)),this.W=!1,this.ha=r(this.yc,this),this.Ga=r(this.ka,this),this.pa=r(this.Tb,this),this.qa=r(this.Zb,this),this.ra=r(this.$b,this),yl(this),this.INTERNAL={},this.INTERNAL.delete=r(this.delete,this),this.INTERNAL.logFramework=r(this.gc,this),this.o=0,F.call(this),zl(this),this.A=[]}function Al(a){C.call(this,"languageCodeChanged"),this.h=a}function Bl(a){C.call(this,"frameworkChanged"),this.f=a}function zl(a){Object.defineProperty(a,"lc",{get:function(){return this.$()},set:function(a){this.na(a)},enumerable:!1}),a.V=null}function Cl(a){return a.Jb||B(new N("auth-domain-config-required"))}function yl(a){var b=S(a).options.authDomain,c=S(a).options.apiKey;b&&Rf()&&(a.Jb=a.U.then(function(){if(!a.l){if(a.a=gk(b,c,S(a).name),a.a.subscribe(a),U(a)&&Nk(U(a)),a.w){Nk(a.w);var d=a.w;d.na(a.$()),Gk(d,a),d=a.w,Fk(d,a.A),Hk(d,a),a.w=null}return a.a}}))}function Dl(a,b){var c={};return c.apiKey=S(a).options.apiKey,c.authDomain=S(a).options.authDomain,c.appName=S(a).name,a.U.then(function(){return il(c,b,a.G,a.Ka())}).then(function(b){return U(a)&&b.uid==U(a).uid?(Uk(U(a),b),a.ka(b)):(vl(a,b),Nk(b),a.ka(b))}).then(function(){El(a)})}function vl(a,b){U(a)&&(Lk(U(a),a.Ga),E(U(a),"tokenChanged",a.pa),E(U(a),"userDeleted",a.qa),E(U(a),"userInvalidated",a.ra),Kk(U(a))),b&&(b.N.push(a.Ga),cd(b,"tokenChanged",a.pa),cd(b,"userDeleted",a.qa),cd(b,"userInvalidated",a.ra),0<a.o&&Jk(b)),M(a,"currentUser",b),b&&(b.na(a.$()),Gk(b,a),Fk(b,a.A),Hk(b,a))}function Fl(a){var b=kl(a.G,S(a).options.authDomain).then(function(b){return(a.w=b)&&(b.ca=a.G),fl(a.G)});return T(a,b)}function wl(a){var b=S(a).options.authDomain,c=Fl(a).then(function(){return tl(a.h,b)}).then(function(b){return b?(b.ca=a.G,a.w&&(a.w.Z||null)==(b.Z||null)?b:b.reload().then(function(){return rl(a.h,b).then(function(){return b})}).s(function(c){return"auth/network-request-failed"==c.code?b:sl(a.h)})):null}).then(function(b){vl(a,b||null)});return T(a,c)}function xl(a){return a.U.then(function(){return a.aa()}).s(function(){}).then(function(){if(!a.l)return a.ha()}).s(function(){}).then(function(){if(!a.l){a.W=!0;var b=a.h;vj(b.b,yj("local"),b.a,a.ha)}})}function Gl(a,b){var c=null,d=null;return T(a,b.then(function(b){return c=uh(b),d=Mg(b),Dl(a,b)}).then(function(){return hg({user:U(a),credential:c,additionalUserInfo:d,operationType:"signIn"})}))}function S(a){return a.app}function U(a){return a.currentUser}function Il(a){return U(a)&&U(a)._lat||null}function El(a){if(a.W){for(var b=0;b<a.m.length;b++)a.m[b]&&a.m[b](Il(a));if(a.R!==a.getUid()&&a.I.length)for(a.R=a.getUid(),b=0;b<a.I.length;b++)a.I[b]&&a.I[b](Il(a))}}function Hl(a,b){a.I.push(b),T(a,a.i.then(function(){!a.l&&Ha(a.I,b)&&a.R!==a.getUid()&&(a.R=a.getUid(),b(Il(a)))}))}function T(a,b){return a.N.push(b),Qb(b,function(){Ia(a.N,b)}),b}function Jl(a,b,c,d){a:{c=Array.prototype.slice.call(c);for(var e=0,f=!1,g=0;g<b.length;g++)if(b[g].optional)f=!0;else{if(f)throw new N("internal-error","Argument validator encountered a required argument after an optional argument.");e++}if(f=b.length,c.length<e||f<c.length)d="Expected "+(e==f?1==e?"1 argument":e+" arguments":e+"-"+f+" arguments")+" but got "+c.length+".";else{for(e=0;e<c.length;e++)if(f=b[e].optional&&void 0===c[e],!b[e].M(c[e])&&!f){if(b=b[e],0>e||e>=Kl.length)throw new N("internal-error","Argument validator received an unsupported number of arguments.");c=Kl[e],d=(d?"":c+" argument ")+(b.name?'"'+b.name+'" ':"")+"must be "+b.K+".";break a}d=null}}if(d)throw new N("argument-error",a+" failed: "+d)}function V(a,b){return{name:a||"",K:"a valid string",optional:!!b,M:m}}function Ll(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:ba}}function W(a,b){return{name:a||"",K:"a valid object",optional:!!b,M:q}}function Ml(a,b){return{name:a||"",K:"a function",optional:!!b,M:p}}function Nl(a,b){return{name:a||"",K:"null",optional:!!b,M:ea}}function Ol(){return{name:"",K:"an HTML element",optional:!1,M:function(a){return!!(a&&a instanceof Element)}}}function Pl(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(a){return!!(a&&a instanceof ul)}}}function Ql(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(a){return!!(a&&a instanceof firebase.app.App)}}}function Rl(a){return{name:a?a+"Credential":"credential",K:a?"a valid "+a+" credential":"a valid credential",optional:!1,M:function(b){if(!b)return!1;var c=!a||b.providerId===a;return!(!b.wa||!c)}}}function Sl(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty("isOAuthProvider"))}}}function Tl(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(a){return!!(a&&m(a.type)&&p(a.verify))}}}function X(a,b,c,d){return{name:c||"",K:a.K+" or "+b.K,optional:!!d,M:function(c){return a.M(c)||b.M(c)}}}function Ul(a,b,c,d,e,f){if(M(this,"type","recaptcha"),this.b=this.c=null,this.m=!1,this.l=b,this.a=c||{theme:"light",type:"image"},this.g=[],this.a[Vl])throw new N("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.h="invisible"===this.a[Wl],!wc(b)||!this.h&&wc(b).hasChildNodes())throw new N("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Ch(a,f||null,e||null),this.o=d||function(){return null};var g=this;this.i=[];var l=this.a[Xl];this.a[Xl]=function(a){if(Yl(g,a),"function"==typeof l)l(a);else if("string"==typeof l){var b=L(l,k);"function"==typeof b&&b(a)}};var n=this.a[Zl];this.a[Zl]=function(){if(Yl(g,null),"function"==typeof n)n();else if("string"==typeof n){var a=L(n,k);"function"==typeof a&&a()}}}function Yl(a,b){for(var c=0;c<a.i.length;c++)try{a.i[c](b)}catch(d){}}function $l(a,b){Ja(a.i,function(a){return a==b})}function am(a,b){return a.g.push(b),Qb(b,function(){Ia(a.g,b)}),b}function dm(a){if(a.m)throw new N("internal-error","RecaptchaVerifier instance has been destroyed.")}function fm(){this.b=k.grecaptcha?1/0:0,this.c=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function bm(a,b){return new z(function(c,d){if(Zf())if(!k.grecaptcha||b!==a.c&&!a.b){k[a.a]=function(){if(k.grecaptcha){a.c=b;var e=k.grecaptcha.render;k.grecaptcha.render=function(b,c){return b=e(b,c),a.b++,b},c()}else d(new N("internal-error"));delete k[a.a]};var e=hc(em,{onload:a.a,hl:b||""});A(kf(e)).s(function(){d(new N("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else c();else d(new N("network-request-failed"))})}function cm(){return gm||(gm=new fm),gm}function hm(a,b,c){try{this.f=c||firebase.app()}catch(f){throw new N("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.f.options||!this.f.options.apiKey)throw new N("invalid-api-key");c=this.f.options.apiKey;var d=this,e=null;try{e=this.f.auth().Ka()}catch(f){}e=firebase.SDK_VERSION?Of(firebase.SDK_VERSION,e):null,Ul.call(this,c,a,b,function(){try{var a=d.f.auth().$()}catch(g){a=null}return a},e,xi(yi))}function Y(a,b){for(var c in b){var d=b[c].name;a[d]=im(d,a[c],b[c].j)}}function Z(a,b,c,d){a[b]=im(b,c,d)}function im(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);return Jl(e,c,a),b.apply(this,a)}if(!c)return b;var f,e=jm(a);for(f in b)d[f]=b[f];for(f in b.prototype)d.prototype[f]=b.prototype[f];return d}function jm(a){return a=a.split("."),a[a.length-1]}var h,firebase=__webpack_require__(18).default,aa=aa||{},k=this,ia="closure_uid_"+(1e9*Math.random()>>>0),ja=0,na=Date.now||function(){return+new Date};t(u,Error),u.prototype.name="CustomError";var pa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sa=/&/g,ta=/</g,ua=/>/g,va=/"/g,wa=/'/g,xa=/\x00/g,ra=/[\x00&<>"']/;t(za,u),za.prototype.name="AssertionError";var Ma,Ba=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){if(c=null==c?0:0>c?Math.max(0,a.length+c):c,m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},w=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Da=Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=m(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ea=Array.prototype.some?function(a,b,c){return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};a:{var Na=k.navigator;if(Na){var Oa=Na.userAgent;if(Oa){Ma=Oa;break a}}Ma=""}var Va="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Xa[" "]=ca;var fb,$a=x("Opera"),y=x("Trident")||x("MSIE"),ab=x("Edge"),bb=ab||y,cb=x("Gecko")&&!(v(Ma.toLowerCase(),"webkit")&&!x("Edge"))&&!(x("Trident")||x("MSIE"))&&!x("Edge"),db=v(Ma.toLowerCase(),"webkit")&&!x("Edge");a:{var gb="",hb=function(){var a=Ma;return cb?/rv\:([^\);]+)(\)|;)/.exec(a):ab?/Edge\/([\d\.]+)/.exec(a):y?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):db?/WebKit\/(\S+)/.exec(a):$a?/(?:Version)[ \/]?(\S+)/.exec(a):void 0}();if(hb&&(gb=hb?hb[1]:""),y){var ib=eb();if(null!=ib&&ib>parseFloat(gb)){fb=String(ib);break a}}fb=gb}var kb,Za={},lb=k.document;kb=lb&&y?eb()||("CSS1Compat"==lb.compatMode?parseInt(fb,10):5):void 0,ob.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next,a.next=null}else a=this.c();return a};var rb=new ob(function(){return new qb},function(a){a.reset()},100);qb.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},qb.prototype.reset=function(){this.next=this.b=this.a=null};var wb,zb,Bb=!1,tb=new function(){this.b=this.a=null},Db=0,Fb=2,Hb=3;Ib.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Jb=new ob(function(){return new Ib},function(a){a.reset()},100);z.prototype.then=function(a,b,c){return Pb(this,p(a)?a:null,p(b)?b:null,c)},mb(z),h=z.prototype,h.s=function(a,b){return Pb(this,null,a,b)},h.cancel=function(a){this.a==Db&&yb(function(){Sb(this,new Gb(a))},this)},h.Ac=function(a){this.a=Db,Eb(this,Fb,a)},h.Bc=function(a){this.a=Db,Eb(this,Hb,a)},h.Qb=function(){for(var a;a=Tb(this);)Ub(this,a,this.a,this.i);this.h=!1};var Zb=ub;t(Gb,u),Gb.prototype.name="cancel";var $b=!y||9<=Number(kb);ac.prototype.la=!0,ac.prototype.ja=function(){return this.a},ac.prototype.toString=function(){return"Const{"+this.a+"}"};var bc={};dc(""),ec.prototype.la=!0,ec.prototype.ja=function(){return this.a},ec.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kc=/%{(\w+)}/g,jc=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,fc={};lc.prototype.la=!0,lc.prototype.ja=function(){return this.a},lc.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var oc=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,mc={};qc("about:blank"),rc.prototype.la=!0,rc.prototype.ja=function(){return this.a},rc.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var sc={};vc("<!DOCTYPE html>"),vc(""),vc("<br>");var yc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Gc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Hc=/\uffff/.test("")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,Jc=0,Kc={};Ic.prototype.oa=!1,Ic.prototype.ta=function(){if(this.Fa)for(;this.Fa.length;)this.Fa.shift()()};var Mc=Object.freeze||function(a){return a},Nc=!y||9<=Number(kb),Oc=y&&!jb("9"),Pc=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});return k.addEventListener("test",ca,b),k.removeEventListener("test",ca,b),a}();C.prototype.c=function(){this.Bb=!1},t(Qc,C);var Rc=Mc({2:"touch",3:"pen",4:"mouse"});Qc.prototype.c=function(){Qc.ib.c.call(this);var a=this.a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Oc)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}},Qc.prototype.g=function(){return this.a};var Sc="closure_listenable_"+(1e6*Math.random()|0),Tc=0,$c="closure_lm_"+(1e6*Math.random()|0),ad={},bd=0,pd="__closure_events_fn_"+(1e9*Math.random()>>>0);t(F,Ic),F.prototype[Sc]=!0,F.prototype.removeEventListener=function(a,b,c,d){E(this,a,b,c,d)},F.prototype.ta=function(){if(F.ib.ta.call(this),this.u){var c,a=this.u,b=0;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,Vc(d[e]);delete a.a[c],a.b--}}this.Ra=null},td.prototype.a=null;var ud=0;td.prototype.reset=function(a,b,c,d,e){"number"==typeof e||ud++,d||na(),this.b=b,delete this.a},wd.prototype.toString=function(){return this.name};var xd=new wd("SEVERE",1e3),yd=new wd("CONFIG",700),zd=new wd("FINE",500);vd.prototype.log=function(a,b,c){if(a.value>=Ad(this).value)for(p(b)&&(b=b()),a=new td(a,String(b),this.f),c&&(a.a=c),c="log:"+a.b,(a=k.console)&&a.timeStamp&&a.timeStamp(c),(a=k.msWriteProfilerMark)&&a(c),c=this;c;)c=c.a};var Bd={},Cd=null;h=Ed.prototype,h.P=function(){Fd(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},h.S=function(){return Fd(this),this.a.concat()},h.clear=function(){this.b={},this.c=this.a.length=0},h.get=function(a,b){return Gd(this.b,a)?this.b[a]:b},h.set=function(a,b){Gd(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},h.forEach=function(a,b){for(var c=this.S(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var Id=null,Jd=null;Nd.prototype.cancel=function(a){if(this.a)this.c instanceof Nd&&this.c.cancel();else{if(this.b){var b=this.b;delete this.b,a?b.cancel(a):0>=--b.l&&b.cancel()}this.v?this.v.call(this.o,this):this.u=!0,this.a||(a=new Od,Pd(this),Qd(this,!1,a))}},Nd.prototype.m=function(a,b){this.i=!1,Qd(this,a,b)},Nd.prototype.A=function(a){Pd(this),Qd(this,!0,a)},Nd.prototype.then=function(a,b,c){var d,e,f=new z(function(a,b){d=a,e=b});return Ud(this,d,function(a){a instanceof Od?f.cancel():e(a)}),f.then(a,b,c)},mb(Nd),t(Sd,u),Sd.prototype.message="Deferred has already fired",Sd.prototype.name="AlreadyCalledError",t(Od,u),Od.prototype.message="Deferred was canceled",Od.prototype.name="CanceledError",Xd.prototype.c=function(){throw delete Wd[this.a],this.b};var ae,Wd={};t(Zd,Yd);for(var $d=64,ce=$d-1,de=[],ee=0;ee<ce;ee++)de[ee]=0;var fe=Ka(128,de);Zd.prototype.reset=function(){this.g=this.c=0,this.a=k.Int32Array?new Int32Array(this.h):La(this.h)};var be=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];t(ie,Zd);var je=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],ne=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;pe.prototype.toString=function(){var a=[],b=this.c;b&&a.push(ve(b,we,!0),":");var c=this.b;return(c||"file"==b)&&(a.push("//"),(b=this.l)&&a.push(ve(b,we,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(c=this.i)&&a.push(":",String(c))),(c=this.g)&&(this.b&&"/"!=c.charAt(0)&&a.push("/"),a.push(ve(c,"/"==c.charAt(0)?xe:ye,!0))),(c=this.a.toString())&&a.push("?",c),(c=this.h)&&a.push("#",ve(c,ze)),a.join("")};var we=/[#\/\?@]/g,ye=/[\#\?:]/g,xe=/[\#\?]/g,Be=/[\#\?@]/g,ze=/#/g;h=se.prototype,h.clear=function(){this.a=this.c=null,this.b=0},h.forEach=function(a,b){Ge(this),this.a.forEach(function(c,d){w(c,function(c){a.call(b,c,d,this)},this)},this)},h.S=function(){Ge(this);for(var a=this.a.P(),b=this.a.S(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},h.P=function(a){Ge(this);var b=[];if(m(a))Me(this,a)&&(b=Ka(b,this.a.get(Ke(this,a))));else{a=this.a.P();for(var c=0;c<a.length;c++)b=Ka(b,a[c])}return b},h.set=function(a,b){return Ge(this),this.c=null,a=Ke(this,a),Me(this,a)&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},h.get=function(a,b){return a=a?this.P(a):[],0<a.length?String(a[0]):b},h.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.S(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.P(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}}return this.c=a.join("&")},Ne.prototype.c=null;var Pe;t(Qe,Ne),Qe.prototype.a=function(){var a=Re(this);return a?new ActiveXObject(a):new XMLHttpRequest},Qe.prototype.b=function(){var a={};return Re(this)&&(a[0]=!0,a[1]=!0),a},Pe=new Qe,t(Se,F);var Te="",Ue=Se.prototype,Ve=Dd("goog.net.XhrIo");Ue.J=Ve;var We=/^https?$/i,Xe=["POST","PUT"];h=Se.prototype,h.Ea=function(){void 0!==aa&&this.a&&(this.g="Timed out after "+this.f+"ms, aborting",H(this.J,Ze(this,this.g)),G(this,"timeout"),this.abort(8))},h.abort=function(){this.a&&this.b&&(H(this.J,Ze(this,"Aborting")),this.b=!1,this.c=!0,this.a.abort(),this.c=!1,G(this,"complete"),G(this,"abort"),df(this))},h.ta=function(){this.a&&(this.b&&(this.b=!1,this.c=!0,this.a.abort(),this.c=!1),df(this,!0)),Se.ib.ta.call(this)},h.Ab=function(){this.oa||(this.G||this.h||this.c?ef(this):this.jc())},h.jc=function(){ef(this)},h.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.l){case Te:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var a=this.J;return a&&a.log(xd,"Response type "+this.l+" is not supported on this browser",void 0),null}catch(b){return H(this.J,"Can not get response: "+b.message),null}};var jf=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,pf=0,of=1;t(nf,u),t(rf,Ne),rf.prototype.a=function(){var a=new XMLHttpRequest;if("withCredentials"in a)return a;if("undefined"!=typeof XDomainRequest)return new sf;throw Error("Unsupported browser")},rf.prototype.b=function(){return{}},h=sf.prototype,h.open=function(a,b,c){if(null!=c&&!c)throw Error("Only async requests are supported.");this.a.open(a,b)},h.send=function(a){if(a){if("string"!=typeof a)throw Error("Only string data is supported");this.a.send(a)}else this.a.send()},h.abort=function(){this.a.abort()},h.setRequestHeader=function(){},h.getResponseHeader=function(a){return"content-type"==a.toLowerCase()?this.a.contentType:""},h.Wb=function(){this.status=200,this.responseText=this.a.responseText,tf(this,4)},h.xb=function(){this.status=500,this.responseText="",tf(this,4)},h.Yb=function(){this.xb()},h.Xb=function(){this.status=200,tf(this,1)},h.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};var Gf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ef="Firefox",Af="Chrome",Nf={Gc:"FirebaseCore-web",Ic:"FirebaseUI-web"};$f.prototype.get=function(){return this.a?this.b:this.c};var eg,dg={};try{var fg={};Object.defineProperty(fg,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(fg,"abcd",{configurable:!0,enumerable:!0,value:2}),eg=2==fg.abcd}catch(a){eg=!1}var mg="email",ng="newEmail",og="requestType",qg="email",pg="fromEmail",sg="data",rg="operation";t(N,Error),N.prototype.B=function(){return{code:this.code,message:this.message}},N.prototype.toJSON=function(){return this.B()};var tg="auth/",ug={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},yg="android",Eg="handleCodeInApp",Cg="iOS",xg="url",Ag="installApp",Bg="minimumVersion",zg="packageName",Dg="bundleId",Ig="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Jg=["client_id","response_type","scope","redirect_uri","state"],Kg={Hc:{Ma:"locale",za:500,ya:600,Na:"facebook.com",$a:Jg},Jc:{Ma:null,za:500,ya:620,Na:"github.com",$a:Jg},Kc:{Ma:"hl",za:515,ya:680,Na:"google.com",$a:Jg},Qc:{Ma:"lang",za:485,ya:705,Na:"twitter.com",$a:Ig}},Tg="idToken",Rg="providerId";t(Sg,Ug),t(Ng,Sg),t(Pg,Sg),t(Og,Sg),t(Qg,Sg),Wg.prototype.wa=function(a){return Xg(a,Yg(this))},Wg.prototype.b=function(a,b){var c=Yg(this);return c.idToken=b,Zg(a,c)},Wg.prototype.c=function(a,b){return Vg($g(a,Yg(this)),b)},Wg.prototype.B=function(){var a={providerId:this.providerId};return this.idToken&&(a.oauthIdToken=this.idToken),this.accessToken&&(a.oauthAccessToken=this.accessToken),this.secret&&(a.oauthTokenSecret=this.secret),a},ah.prototype.Ba=function(a){return this.rb=Ua(a),this},t(P,ah),P.prototype.sa=function(a){return Ha(this.a,a)||this.a.push(a),this},P.prototype.wb=function(){return La(this.a)},P.prototype.credential=function(a,b){if(!a&&!b)throw new N("argument-error","credential failed: must provide the ID token and/or the access token.");return new Wg(this.providerId,{idToken:a||null,accessToken:b||null})},t(bh,P),M(bh,"PROVIDER_ID","facebook.com"),t(dh,P),M(dh,"PROVIDER_ID","github.com"),t(fh,P),M(fh,"PROVIDER_ID","google.com"),t(hh,ah),M(hh,"PROVIDER_ID","twitter.com"),jh.prototype.wa=function(a){return Q(a,kh,{email:this.a,password:this.f})},jh.prototype.b=function(a,b){return Q(a,lh,{idToken:b,email:this.a,password:this.f})},jh.prototype.c=function(a,b){return Vg(this.wa(a),b)},jh.prototype.B=function(){return{email:this.a,password:this.f}},gg(mh,{PROVIDER_ID:"password"}),nh.prototype.wa=function(a){return a.Qa(oh(this))},nh.prototype.b=function(a,b){var c=oh(this);return c.idToken=b,Q(a,ph,c)},nh.prototype.c=function(a,b){var c=oh(this);return c.operation="REAUTH",a=Q(a,qh,c),Vg(a,b)},nh.prototype.B=function(){var a={providerId:"phone"};return this.a.Pa&&(a.verificationId=this.a.Pa),this.a.Oa&&(a.verificationCode=this.a.Oa),this.a.Da&&(a.temporaryProof=this.a.Da),this.a.Y&&(a.phoneNumber=this.a.Y),a},rh.prototype.Qa=function(a,b){var c=this.a.c;return A(b.verify()).then(function(d){if(!m(d))throw new N("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(b.type){case"recaptcha":return sh(c,{phoneNumber:a,recaptchaToken:d}).then(function(a){return"function"==typeof b.reset&&b.reset(),a},function(a){throw"function"==typeof b.reset&&b.reset(),a});default:throw new N("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},gg(rh,{PROVIDER_ID:"phone"}),wh.prototype.B=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.B()}},t(yh,N),t(zh,N),zh.prototype.B=function(){var a={code:this.code,message:this.message};this.email&&(a.email=this.email),this.phoneNumber&&(a.phoneNumber=this.phoneNumber);var b=this.credential&&this.credential.B();return b&&Wa(a,b),a},zh.prototype.toJSON=function(){return this.B()},t(Bh,Ne),Bh.prototype.a=function(){return new this.f},Bh.prototype.b=function(){return{}};var Hh,O="idToken",Dh=new $f(3e4,6e4),Eh={"Content-Type":"application/x-www-form-urlencoded"},Fh=new $f(3e4,6e4),Gh={"Content-Type":"application/json"};Ch.prototype.m=function(a,b,c,d,e,f){var g="Node"==K(),l=Mf()?g?new Se(this.o):new Se:new Se(this.f);if(f){l.f=Math.max(0,f);var n=setTimeout(function(){G(l,"timeout")},f)}fd(l,"complete",function(){n&&clearTimeout(n);var a=null;try{a=JSON.parse(hf(this))||null}catch(vb){a=null}b&&b(a)}),ld(l,"ready",function(){n&&clearTimeout(n),Lc(this)}),ld(l,"timeout",function(){n&&clearTimeout(n),Lc(this),b&&b(null)}),Ye(l,a,c,d,e)};var Mh=dc("https://apis.google.com/js/client.js?onload=%{onload}"),Nh="__fcb"+Math.floor(1e6*Math.random()).toString();Ch.prototype.u=function(a,b,c,d,e){var f=this;Hh.then(function(){window.gapi.client.setApiKey(f.b);var g=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:a,method:c,body:d,headers:e,authType:"none",callback:function(a){window.gapi.auth.setToken(g),b&&b(a)}})}).s(function(a){b&&b({error:{message:a&&a.message||"CORS_UNSUPPORTED"}})})},Ch.prototype.gb=function(){return Q(this,Zh,{})},Ch.prototype.kb=function(a,b){return Q(this,$h,{idToken:a,email:b})},Ch.prototype.lb=function(a,b){return Q(this,lh,{idToken:a,password:b})};var ai={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};h=Ch.prototype,h.mb=function(a,b){var c={idToken:a},d=[];return Pa(ai,function(a,f){var e=b[f];null===e?d.push(a):f in b&&(c[f]=e)}),d.length&&(c.deleteAttribute=d),Q(this,$h,c)},h.cb=function(a,b){return a={requestType:"PASSWORD_RESET",email:a},Wa(a,b),Q(this,bi,a)},h.bb=function(a,b){return a={requestType:"VERIFY_EMAIL",idToken:a},Wa(a,b),Q(this,ci,a)},h.Qa=function(a){return Q(this,ei,a)},h.Ta=function(a,b){return Q(this,oi,{oobCode:a,newPassword:b})},h.Ia=function(a){return Q(this,pi,{oobCode:a})},h.Sa=function(a){return Q(this,qi,{oobCode:a})};var yi,qi={endpoint:"setAccountInfo",D:ni,ga:"email"},pi={endpoint:"resetPassword",D:ni,O:function(a){if(!a.email||!a.requestType)throw new N("internal-error")}},ri={endpoint:"signupNewUser",D:function(a){if(Rh(a),!a.password)throw new N("weak-password")},O:Xh,T:!0},Uh={endpoint:"createAuthUri"},si={endpoint:"deleteAccount",ea:["idToken"]},gi={endpoint:"setAccountInfo",ea:["idToken","deleteProvider"],D:function(a){if(!fa(a.deleteProvider))throw new N("internal-error")}},ti={endpoint:"getAccountInfo"},ci={endpoint:"getOobConfirmationCode",ea:["idToken","requestType"],D:function(a){if("VERIFY_EMAIL"!=a.requestType)throw new N("internal-error")},ga:"email"},bi={endpoint:"getOobConfirmationCode",ea:["requestType"],D:function(a){if("PASSWORD_RESET"!=a.requestType)throw new N("internal-error");Rh(a)},ga:"email"},Wh={nb:!0,endpoint:"getProjectConfig",zb:"GET"},ui={nb:!0,endpoint:"getRecaptchaParam",zb:"GET",O:function(a){if(!a.recaptchaSiteKey)throw new N("internal-error")}},oi={endpoint:"resetPassword",D:ni,ga:"email"},di={endpoint:"sendVerificationCode",ea:["phoneNumber","recaptchaToken"],ga:"sessionInfo"},$h={endpoint:"setAccountInfo",ea:["idToken"],D:Sh,T:!0},lh={endpoint:"setAccountInfo",ea:["idToken"],D:function(a){if(Sh(a),!a.password)throw new N("weak-password")},O:Xh,T:!0},Zh={endpoint:"signupNewUser",O:Xh,T:!0},ki={endpoint:"verifyAssertion",D:hi,O:ii,T:!0},mi={endpoint:"verifyAssertion",D:hi,O:function(a){if(a.errorMessage&&"USER_NOT_FOUND"==a.errorMessage)throw new N("user-not-found");if(a.errorMessage)throw ji(a.errorMessage);if(!a[O])throw new N("internal-error")},T:!0},li={endpoint:"verifyAssertion",D:function(a){if(hi(a),!a.idToken)throw new N("internal-error")},O:ii,T:!0},vi={endpoint:"verifyCustomToken",D:function(a){if(!a.token)throw new N("invalid-custom-token")},O:Xh,T:!0},kh={endpoint:"verifyPassword",D:function(a){if(Rh(a),!a.password)throw new N("wrong-password")},O:Xh,T:!0},ei={endpoint:"verifyPhoneNumber",D:Yh,O:Xh},ph={endpoint:"verifyPhoneNumber",D:function(a){if(!a.idToken)throw new N("internal-error");Yh(a)},O:function(a){if(a.temporaryProof)throw a.code="credential-already-in-use",Ah(a);Xh(a)}},qh={Pb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Yh,O:Xh},wi={Mc:{Va:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://securetoken.googleapis.com/v1/token",id:"p"},Oc:{Va:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Pc:{Va:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ab:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};yi=xi("__EID__")?"__EID__":void 0;var Fi=dc("https://apis.google.com/js/api.js?onload=%{onload}"),Gi=new $f(3e4,6e4),Ci=new $f(5e3,15e3),Hi=null;Ii.prototype.toString=function(){return this.f?I(this.a,"v",this.f):Le(this.a.a,"v"),this.b?I(this.a,"eid",this.b):Le(this.a.a,"eid"),this.c.length?I(this.a,"fw",this.c.join(",")):Le(this.a.a,"fw"),this.a.toString()},Ji.prototype.toString=function(){var a=Ee(this.m,"/__/auth/handler");if(I(a,"apiKey",this.u),I(a,"appName",this.c),I(a,"authType",this.l),this.a.isOAuthProvider){var b=this.a;try{var c=firebase.app(this.c).auth().$()}catch(l){c=null}b.Ua=c,I(a,"providerId",this.a.providerId),b=this.a,c=Vf(b.rb);for(var d in c)c[d]=c[d].toString();d=b.rc,c=Ua(c);for(var e=0;e<d.length;e++){var f=d[e];f in c&&delete c[f]}b.Wa&&b.Ua&&!c[b.Wa]&&(c[b.Wa]=b.Ua),Sa(c)||I(a,"customParameters",Uf(c))}if("function"==typeof this.a.wb&&(b=this.a.wb(),b.length&&I(a,"scopes",b.join(","))),this.h?I(a,"redirectUrl",this.h):Le(a.a,"redirectUrl"),this.g?I(a,"eventId",this.g):Le(a.a,"eventId"),this.i?I(a,"v",this.i):Le(a.a,"v"),this.b)for(var g in this.b)this.b.hasOwnProperty(g)&&!Ce(a,g)&&I(a,g,this.b[g]);return this.f?I(a,"eid",this.f):Le(a.a,"eid"),g=Ki(this.c),g.length&&I(a,"fw",g.join(",")),a.toString()},h=Li.prototype,h.Ca=function(a,b,c){var d=new N("popup-closed-by-user"),e=new N("web-storage-unsupported"),f=this,g=!1;return this.ba().then(function(){Pi(f).then(function(c){c||(a&&Cf(a),b(e),g=!0)})}).s(function(){}).then(function(){if(!g)return Ff(a)}).then(function(){if(!g)return sd(c).then(function(){b(d)})})},h.Db=function(){var a=J();return!Tf(a)&&!Xf(a)},h.yb=function(){return!1},h.vb=function(a,b,c,d,e,f,g){if(!a)return B(new N("popup-blocked"));if(g&&!Tf())return this.ba().s(function(b){Cf(a),e(b)}),d(),A();this.a||(this.a=Mi(Qi(this)));var l=this;return this.a.then(function(){var b=l.ba().s(function(b){throw Cf(a),e(b),b});return d(),b}).then(function(){if(vh(c),!g){wf(Ri(l.u,l.f,l.b,b,c,null,f,l.c,void 0,l.h),a)}}).s(function(a){throw"auth/network-request-failed"==a.code&&(l.a=null),a})},h.Aa=function(a,b,c){this.a||(this.a=Mi(Qi(this)));var d=this;return this.a.then(function(){vh(b),wf(Ri(d.u,d.f,d.b,a,b,vf(),c,d.c,void 0,d.h))}).s(function(a){throw"auth/network-request-failed"==a.code&&(d.a=null),a})},h.ba=function(){var a=this;return Ni(this).then(function(){return a.i.Ya}).s(function(){throw a.a=null,new N("network-request-failed")})},h.Hb=function(){return!0},h.ua=function(a){this.g.push(a)},h.Ja=function(a){Ja(this.g,function(b){return b==a})},h=Si.prototype,h.get=function(a){return A(this.a.getItem(a)).then(function(a){return a&&Wf(a)})},h.set=function(a,b){return A(this.a.setItem(a,Uf(b)))},h.X=function(a){return A(this.a.removeItem(a))},h.ia=function(){},h.da=function(){},h=Ti.prototype,h.get=function(a){return A(this.a[a])},h.set=function(a,b){return this.a[a]=b,A()},h.X=function(a){return delete this.a[a],A()},h.ia=function(){},h.da=function(){};var Vi;h=Ui.prototype,h.set=function(a,b){var d,c=!1,e=this;return Qb(Xi(this).then(function(b){return d=b,b=Yi(e,Zi(e,d,!0)),$i(b.get(a))}).then(function(f){var g=Yi(e,Zi(e,d,!0));return f?(f.value=b,$i(g.put(f))):(e.a++,c=!0,f={},f[e.g]=a,f[e.l]=b,$i(g.add(f)))}).then(function(){e.f[a]=b}),function(){c&&e.a--})},h.get=function(a){var b=this;return Xi(this).then(function(c){return $i(Yi(b,Zi(b,c,!1)).get(a))}).then(function(a){return a&&a.value})},h.X=function(a){var b=!1,c=this;return Qb(Xi(this).then(function(d){return b=!0,c.a++,$i(Yi(c,Zi(c,d,!0)).delete(a))}).then(function(){delete c.f[a]}),function(){b&&c.a--})},h.zc=function(){var a=this;return Xi(this).then(function(b){var c=Yi(a,Zi(a,b,!1));return c.getAll?$i(c.getAll()):new z(function(a,b){var d=[],e=c.openCursor();e.onsuccess=function(b){(b=b.target.result)?(d.push(b.value),b.continue()):a(d)},e.onerror=function(a){b(Error(a.target.errorCode))}})}).then(function(b){var c={},d=[];if(0==a.a){for(d=0;d<b.length;d++)c[b[d][a.g]]=b[d][a.l];d=xf(a.f,c),a.f=c}return d})},h.ia=function(a){0==this.c.length&&aj(this),this.c.push(a)},h.da=function(a){Ja(this.c,function(b){return b==a}),0==this.c.length&&this.b&&this.b.cancel("STOP_EVENT")},h=bj.prototype,h.get=function(a){var b=this;return A().then(function(){return Wf(b.a.getItem(a))})},h.set=function(a,b){var c=this;return A().then(function(){var d=Uf(b);null===d?c.X(a):c.a.setItem(a,d)})},h.X=function(a){var b=this;return A().then(function(){b.a.removeItem(a)})},h.ia=function(a){k.window&&cd(k.window,"storage",a)},h.da=function(a){k.window&&E(k.window,"storage",a)},h=ej.prototype,h.get=function(){return A(null)},h.set=function(){return A()},h.X=function(){return A()},h.ia=function(){},h.da=function(){},h=fj.prototype,h.get=function(a){var b=this;return A().then(function(){return Wf(b.a.getItem(a))})},h.set=function(a,b){var c=this;return A().then(function(){var d=Uf(b);null===d?c.X(a):c.a.setItem(a,d)})},h.X=function(a){var b=this;return A().then(function(){b.a.removeItem(a)})},h.ia=function(){},h.da=function(){};var mj,qj,jj={C:bj,jb:fj},kj={C:bj,jb:fj},lj={C:Si,jb:ej},nj={Lc:"local",NONE:"none",Nc:"session"};pj.prototype.get=function(a,b){return sj(this,a.C).get(tj(this,a,b))},pj.prototype.set=function(a,b,c){var d=tj(this,a,c),e=this,f=sj(this,a.C);return f.set(d,b).then(function(){return f.get(d)}).then(function(b){"local"==a.C&&(e.b[d]=b)})},pj.prototype.m=function(a){if(a&&a.g){var b=a.a.key;if(null==b)for(var c in this.a){var d=this.b[c];void 0===d&&(d=null);var e=k.localStorage.getItem(c);e!==d&&(this.b[c]=e,this.c(c))}else if(0==b.indexOf(this.i+this.g)&&this.a[b]){if(void 0!==a.a.a?sj(this,"local").da(this.h):Aj(this),this.A)if(c=k.localStorage.getItem(b),(d=a.a.newValue)!==c)null!==d?k.localStorage.setItem(b,d):k.localStorage.removeItem(b);else if(this.b[b]===d&&void 0===a.a.a)return;var f=this;c=function(){void 0===a.a.a&&f.b[b]===k.localStorage.getItem(b)||(f.b[b]=k.localStorage.getItem(b),f.c(b))},y&&kb&&10==kb&&k.localStorage.getItem(b)!==a.a.newValue&&a.a.newValue!==a.a.oldValue?setTimeout(c,10):c()}}else w(a,r(this.c,this))},pj.prototype.c=function(a){this.a[a]&&w(this.a[a],function(a){a()})};var Dj={name:"authEvent",C:"local"};h=Gj.prototype,h.ba=function(){return this.xa?this.xa:this.xa=If().then(function(){if("function"!=typeof L("universalLinks.subscribe",k))throw Hj("cordova-universal-links-plugin is not installed");if(void 0===L("BuildInfo.packageName",k))throw Hj("cordova-plugin-buildinfo is not installed");if("function"!=typeof L("cordova.plugins.browsertab.openUrl",k))throw Hj("cordova-plugin-browsertab is not installed");if("function"!=typeof L("cordova.InAppBrowser.open",k))throw Hj("cordova-plugin-inappbrowser is not installed")},function(){throw new N("cordova-not-ready")})},h.Ca=function(a,b){return b(new N("operation-not-supported-in-this-environment")),A()},h.vb=function(){return B(new N("operation-not-supported-in-this-environment"))},h.Hb=function(){return!1},h.Db=function(){return!0},h.yb=function(){return!0},h.Aa=function(a,b,c){if(this.c)return B(new N("redirect-operation-pending"));var d=this,e=k.document,f=null,g=null,l=null,n=null;return this.c=Qb(A().then(function(){return vh(b),Kj(d)}).then(function(){return Lj(d,a,b,c)}).then(function(){return new z(function(a,b){g=function(){var b=L("cordova.plugins.browsertab.close",k);return a(),"function"==typeof b&&b(),d.a&&"function"==typeof d.a.close&&(d.a.close(),d.a=null),!1},d.ua(g),l=function(){f||(f=sd(d.w).then(function(){b(new N("redirect-cancelled-by-user"))}))},n=function(){ag()&&l()},e.addEventListener("resume",l,!1),J().toLowerCase().match(/android/)||e.addEventListener("visibilitychange",n,!1)}).s(function(a){return Mj(d).then(function(){throw a})})}),function(){l&&e.removeEventListener("resume",l,!1),n&&e.removeEventListener("visibilitychange",n,!1),f&&f.cancel(),g&&d.Ja(g),d.c=null})},h.ua=function(a){this.b.push(a),Kj(this).s(function(b){"auth/invalid-cordova-configuration"===b.code&&(b=new wh("unknown",null,null,null,new N("no-auth-event")),a(b))})},h.Ja=function(a){Ja(this.b,function(b){return b==a})};var Qj={name:"pendingRedirect",C:"session"};Uj.prototype.reset=function(){this.f=!1,this.a.Ja(this.i),this.a=Xj(this.v,this.l,this.u)},Uj.prototype.subscribe=function(a){if(Ha(this.h,a)||this.h.push(a),!this.f){var b=this;Tj(this.g).then(function(a){a?Sj(b.g).then(function(){Yj(b).s(function(a){var c=new wh("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));ak(a)&&b.m(c)})}):Zj(b)}).s(function(){Zj(b)})}},Uj.prototype.unsubscribe=function(a){Ja(this.h,function(b){return b==a})},Uj.prototype.m=function(a){if(!a)throw new N("invalid-auth-event");for(var b=!1,c=0;c<this.h.length;c++){var d=this.h[c];if(d.ob(a.b,a.c)){(b=this.b[a.b])&&b.h(a,d),b=!0;break}}return bk(this.c),b};var ck=new $f(2e3,1e4),dk=new $f(3e4,6e4);Uj.prototype.aa=function(){return this.c.aa()},Uj.prototype.Aa=function(a,b,c){var e,d=this;return Rj(this.g).then(function(){return d.a.Aa(a,b,c).s(function(a){if(ak(a))throw new N("operation-not-supported-in-this-environment");return e=a,Sj(d.g).then(function(){throw e})}).then(function(){return d.a.Hb()?new z(function(){}):Sj(d.g).then(function(){return d.aa()}).then(function(){}).s(function(){})})})},Uj.prototype.Ca=function(a,b,c,d){return this.a.Ca(c,function(c){a.fa(b,null,c,d)},ck.get())};var fk={};Vj.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Vj.prototype.h=function(a,b){if(!a)return B(new N("invalid-auth-event"));this.reset(),this.g=!0;var c=a.b,d=a.c,e=a.a&&"auth/web-storage-unsupported"==a.a.code,f=a.a&&"auth/operation-not-supported-in-this-environment"==a.a.code;return"unknown"!=c||e||f?a.a?(hk(this,!0,null,a.a),a=A()):a=b.va(c,d)?ik(this,a,b):B(new N("invalid-auth-event")):(hk(this,!1,null,null),a=A()),a},Vj.prototype.aa=function(){var a=this;return new z(function(b,c){a.b?a.b().then(b,c):(a.f.push(b),a.c.push(c),lk(a))})},Wj.prototype.h=function(a,b){if(!a)return B(new N("invalid-auth-event"));var c=a.b,d=a.c;return a.a?(b.fa(a.b,null,a.a,a.c),a=A()):a=b.va(c,d)?mk(a,b):B(new N("invalid-auth-event")),a},nk.prototype.confirm=function(a){return a=th(this.verificationId,a),this.a(a)},pk.prototype.start=function(){this.a=this.c,qk(this,!0)},tk.prototype.B=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},tk.prototype.getToken=function(a){return a=!!a,this.b&&!this.a?B(new N("user-token-expired")):a||!this.b||na()>this.c-3e4?this.a?wk(this,{grant_type:"refresh_token",refresh_token:this.a}):A(null):A({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},xk.prototype.B=function(){return{lastLoginAt:this.b,createdAt:this.a}},t(Ak,C),t(Bk,F),Bk.prototype.na=function(a){this.ha=a,Ih(this.c,a)},Bk.prototype.$=function(){return this.ha},Bk.prototype.Ka=function(){return La(this.R)},Bk.prototype.Ga=function(){this.l.b&&(sk(this.l),this.l.start())},M(Bk.prototype,"providerId","firebase"),h=Bk.prototype,h.reload=function(){var a=this;return R(this,Pk(this).then(function(){return Vk(a).then(function(){return Mk(a)}).then(Ok)}))},h.F=function(a){var b=this;return R(this,Pk(this).then(function(){return b.h.getToken(a)}).then(function(a){if(!a)throw new N("internal-error");return a.accessToken!=b.pa&&(Ck(b,a.accessToken),G(b,new Ak("tokenChanged"))),Tk(b,"refreshToken",a.refreshToken),a.accessToken}))},h.getToken=function(a){return dg["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(dg["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.F(a)},h.kc=function(a){if(!(a=a.users)||!a.length)throw new N("internal-error");a=a[0],Dk(this,{uid:a.localId,displayName:a.displayName,photoURL:a.photoUrl,email:a.email,emailVerified:!!a.emailVerified,phoneNumber:a.phoneNumber,lastLoginAt:a.lastLoginAt,createdAt:a.createdAt});for(var b=Yk(a),c=0;c<b.length;c++)Rk(this,b[c]);Tk(this,"isAnonymous",!(this.email&&a.passwordHash||this.providerData&&this.providerData.length))},h.Za=function(a){var b=this,c=null;return R(this,a.c(this.c,this.uid).then(function(a){return Xk(b,a),c=Zk(b,a,"reauthenticate"),b.i=null,b.reload()}).then(function(){return c}),!0)},h.mc=function(a){return this.Za(a).then(function(){})},h.Xa=function(a){var b=this,c=null;return R(this,$k(this,a.providerId).then(function(){return b.F()}).then(function(c){return a.b(b.c,c)}).then(function(a){return c=Zk(b,a,"link"),al(b,a)}).then(function(){return c}))},h.cc=function(a){return this.Xa(a).then(function(a){return a.user})},h.dc=function(a,b){var c=this;return R(this,$k(this,"phone").then(function(){return ok(Ik(c),a,b,r(c.Xa,c))}))},h.nc=function(a,b){var c=this;return R(this,A().then(function(){return ok(Ik(c),a,b,r(c.Za,c))}),!0)},h.kb=function(a){var b=this;return R(this,this.F().then(function(c){return b.c.kb(c,a)}).then(function(a){return Xk(b,a),b.reload()}))},h.Dc=function(a){var b=this;return R(this,this.F().then(function(c){return a.b(b.c,c)}).then(function(a){return Xk(b,a),b.reload()}))},h.lb=function(a){var b=this;return R(this,this.F().then(function(c){return b.c.lb(c,a)}).then(function(a){return Xk(b,a),b.reload()}))},h.mb=function(a){if(void 0===a.displayName&&void 0===a.photoURL)return Pk(this);var b=this;return R(this,this.F().then(function(c){return b.c.mb(c,{displayName:a.displayName,photoUrl:a.photoURL})}).then(function(a){return Xk(b,a),Tk(b,"displayName",a.displayName||null),Tk(b,"photoURL",a.photoUrl||null),w(b.providerData,function(a){"password"===a.providerId&&(M(a,"displayName",b.displayName),M(a,"photoURL",b.photoURL))}),Mk(b)}).then(Ok))},h.Cc=function(a){var b=this;return R(this,Vk(this).then(function(c){return Ha(Qk(b),a)?fi(b.c,c,[a]).then(function(a){var c={};return w(a.providerUserInfo||[],function(a){c[a.providerId]=!0}),w(Qk(b),function(a){c[a]||Sk(b,a)}),c[rh.PROVIDER_ID]||M(b,"phoneNumber",null),Mk(b)}):Mk(b).then(function(){throw new N("no-such-provider")})}))},h.delete=function(){var a=this;return R(this,this.F().then(function(b){return Q(a.c,si,{idToken:b})}).then(function(){G(a,new Ak("userDeleted"))})).then(function(){for(var b=0;b<a.A.length;b++)a.A[b].cancel("app-deleted");Gk(a,null),Hk(a,null),a.A=[],a.m=!0,Kk(a),M(a,"refreshToken",null),a.a&&a.a.unsubscribe(a)})},h.ob=function(a,b){return!!("linkViaPopup"==a&&(this.g||null)==b&&this.f||"reauthViaPopup"==a&&(this.g||null)==b&&this.f||"linkViaRedirect"==a&&(this.Z||null)==b||"reauthViaRedirect"==a&&(this.Z||null)==b)},h.fa=function(a,b,c,d){"linkViaPopup"!=a&&"reauthViaPopup"!=a||d!=(this.g||null)||(c&&this.v?this.v(c):b&&!c&&this.f&&this.f(b),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},h.va=function(a,b){return"linkViaPopup"==a&&b==(this.g||null)?r(this.tb,this):"reauthViaPopup"==a&&b==(this.g||null)?r(this.ub,this):"linkViaRedirect"==a&&(this.Z||null)==b?r(this.tb,this):"reauthViaRedirect"==a&&(this.Z||null)==b?r(this.ub,this):null},h.ec=function(a){var b=this;return bl(this,"linkViaPopup",a,function(){return $k(b,a.providerId).then(function(){return Mk(b)})},!1)},h.oc=function(a){return bl(this,"reauthViaPopup",a,function(){return A()},!0)},h.fc=function(a){var b=this;return dl(this,"linkViaRedirect",a,function(){return $k(b,a.providerId)},!1)},h.pc=function(a){return dl(this,"reauthViaRedirect",a,function(){return A()},!0)},h.tb=function(a,b){var c=this;this.b&&(this.b.cancel(),this.b=null);var d=null;return R(this,this.F().then(function(d){return Zg(c.c,{requestUri:a,sessionId:b,idToken:d})}).then(function(a){return d=Zk(c,a,"link"),al(c,a)}).then(function(){return d}))},h.ub=function(a,b){var c=this;this.b&&(this.b.cancel(),this.b=null);var d=null;return R(this,A().then(function(){return Vg($g(c.c,{requestUri:a,sessionId:b}),c.uid)}).then(function(a){return d=Zk(c,a,"reauthenticate"),Xk(c,a),c.i=null,c.reload()}).then(function(){return d}),!0)},h.bb=function(a){var b=this,c=null;return R(this,this.F().then(function(b){return c=b,void 0===a||Sa(a)?{}:Fg(new wg(a))}).then(function(a){return b.c.bb(c,a)}).then(function(a){if(b.email!=a)return b.reload()}).then(function(){}))},h.toJSON=function(){return this.B()},h.B=function(){var a={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.o,authDomain:this.w,stsTokenManager:this.h.B(),redirectEventId:this.Z||null};return this.metadata&&Wa(a,this.metadata.B()),w(this.providerData,function(b){a.providerData.push(ig(b))}),a};var el={name:"redirectUser",C:"session"};ll.prototype.g=function(){var a=this,b=yj("local");nl(this,function(){return A().then(function(){return a.c&&"local"!=a.c.C?a.b.get(b,a.a):null}).then(function(c){if(c)return ol(a,"local").then(function(){a.c=b})})})};var pl={name:"persistence",C:"session"};ll.prototype.eb=function(a){var b=null,c=this;return oj(a),nl(this,function(){return a!=c.c.C?c.b.get(c.c,c.a).then(function(d){return b=d,ol(c,a)}).then(function(){if(c.c=yj(a),b)return c.b.set(c.c,b,c.a)}):A()})},t(ul,F),t(Al,C),t(Bl,C),h=ul.prototype,h.eb=function(a){return a=this.h.eb(a),T(this,a)},h.na=function(a){this.V===a||this.l||(this.V=a,Ih(this.c,this.V),G(this,new Al(this.$())))},h.$=function(){return this.V},h.Ec=function(){var a=k.navigator;this.na(a?a.languages&&a.languages[0]||a.language||a.userLanguage||null:null)},h.gc=function(a){this.A.push(a),Jh(this.c,firebase.SDK_VERSION?Of(firebase.SDK_VERSION,this.A):null),G(this,new Bl(this.A))},h.Ka=function(){return La(this.A)},h.toJSON=function(){return{apiKey:S(this).options.apiKey,authDomain:S(this).options.authDomain,appName:S(this).name,currentUser:U(this)&&U(this).B()}},h.ob=function(a,b){switch(a){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==b&&!!this.f;default:return!1}},h.fa=function(a,b,c,d){"signInViaPopup"==a&&this.g==d&&(c&&this.v?this.v(c):b&&!c&&this.f&&this.f(b),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},h.va=function(a,b){return"signInViaRedirect"==a||"signInViaPopup"==a&&this.g==b&&this.f?r(this.Sb,this):null},h.Sb=function(a,b){var c=this;a={requestUri:a,sessionId:b},this.b&&(this.b.cancel(),this.b=null);var d=null,e=null,f=Xg(c.c,a).then(function(a){return d=uh(a),e=Mg(a),a});return a=c.U.then(function(){return f}).then(function(a){return Dl(c,a)}).then(function(){return hg({user:U(c),credential:d,additionalUserInfo:e,operationType:"signIn"})}),T(this,a)},h.wc=function(a){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var b=this,c=Lg(a.providerId),d=Qf(),e=null;(!Tf()||Lf())&&S(this).options.authDomain&&a.isOAuthProvider&&(e=Ri(S(this).options.authDomain,S(this).options.apiKey,S(this).name,"signInViaPopup",a,null,d,firebase.SDK_VERSION||null));var f=Df(e,c&&c.za,c&&c.ya);return c=Cl(this).then(function(b){return ek(b,f,"signInViaPopup",a,d,!!e)}).then(function(){return new z(function(a,c){b.fa("signInViaPopup",null,new N("cancelled-popup-request"),b.g),b.f=a,b.v=c,b.g=d,b.b=b.a.Ca(b,"signInViaPopup",f,d)})}).then(function(a){return f&&Cf(f),a?hg(a):null}).s(function(a){throw f&&Cf(f),a}),T(this,c)},h.xc=function(a){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var b=this;return T(this,Cl(this).then(function(){return ql(b.h)}).then(function(){return b.a.Aa("signInViaRedirect",a)}))},h.aa=function(){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var a=this;return T(this,Cl(this).then(function(){return a.a.aa()}).then(function(a){return a?hg(a):null}))},h.hb=function(){var a=this;return T(this,this.i.then(function(){return U(a)?(vl(a,null),sl(a.h).then(function(){El(a)})):A()}))},h.yc=function(){var a=this;return tl(this.h,S(this).options.authDomain).then(function(b){if(!a.l){var c;if(c=U(a)&&b){c=U(a).uid;var d=b.uid;c=void 0!==c&&null!==c&&""!==c&&void 0!==d&&null!==d&&""!==d&&c==d}if(c)return Uk(U(a),b),U(a).F();(U(a)||b)&&(vl(a,b),b&&(Nk(b),b.ca=a.G),a.a&&a.a.subscribe(a),El(a))}})},h.ka=function(a){return rl(this.h,a)},h.Tb=function(){El(this),this.ka(U(this))},h.Zb=function(){this.hb()},h.$b=function(){this.hb()},h.ac=function(a){var b=this;this.addAuthTokenListener(function(){a.next(U(b))})},h.bc=function(a){var b=this;Hl(this,function(){a.next(U(b))})},h.ic=function(a,b,c){var d=this;return this.W&&firebase.Promise.resolve().then(function(){p(a)?a(U(d)):p(a.next)&&a.next(U(d))}),this.Kb(a,b,c)},h.hc=function(a,b,c){var d=this;return this.W&&firebase.Promise.resolve().then(function(){d.R=d.getUid(),p(a)?a(U(d)):p(a.next)&&a.next(U(d))}),this.Lb(a,b,c)},h.Vb=function(a){var b=this;return T(this,this.i.then(function(){return U(b)?U(b).F(a).then(function(a){return{accessToken:a}}):null}))},h.tc=function(a){return this.Eb(a).then(function(a){return a.user})},h.Eb=function(a){var b=this;return this.i.then(function(){return Gl(b,Q(b.c,vi,{token:a}))}).then(function(a){var c=a.user;return Tk(c,"isAnonymous",!1),b.ka(c),a})},h.Fb=function(a,b){var c=this;return this.i.then(function(){return Gl(c,Q(c.c,kh,{email:a,password:b}))})},h.uc=function(a,b){return this.Fb(a,b).then(function(a){return a.user})},h.Ob=function(a,b){return this.qb(a,b).then(function(a){return a.user})},h.qb=function(a,b){var c=this;return this.i.then(function(){return Gl(c,Q(c.c,ri,{email:a,password:b}))})},h.sc=function(a){return this.fb(a).then(function(a){return a.user})},h.fb=function(a){var b=this;return this.i.then(function(){return Gl(b,a.wa(b.c))})},h.gb=function(){return this.Gb().then(function(a){return a.user})},h.Gb=function(){var a=this;return this.i.then(function(){var b=U(a);if(b&&b.isAnonymous){return hg({user:b,credential:null,additionalUserInfo:hg({providerId:null,isNewUser:!1}),operationType:"signIn"})}return Gl(a,a.c.gb()).then(function(b){var c=b.user;return Tk(c,"isAnonymous",!0),a.ka(c),b})})},h.getUid=function(){return U(this)&&U(this).uid||null},h.Mb=function(a){this.addAuthTokenListener(a),0<++this.o&&U(this)&&Jk(U(this))},h.qc=function(a){var b=this;w(this.m,function(c){c==a&&b.o--}),0>this.o&&(this.o=0),0==this.o&&U(this)&&Kk(U(this)),this.removeAuthTokenListener(a)},h.addAuthTokenListener=function(a){var b=this;this.m.push(a),T(this,this.i.then(function(){b.l||Ha(b.m,a)&&a(Il(b))}))},h.removeAuthTokenListener=function(a){Ja(this.m,function(b){return b==a})},h.delete=function(){this.l=!0;for(var a=0;a<this.N.length;a++)this.N[a].cancel("app-deleted");return this.N=[],this.h&&(a=this.h,xj(a.b,a.a,this.ha)),this.a&&this.a.unsubscribe(this),firebase.Promise.resolve()},h.Rb=function(a){return T(this,Th(this.c,a))},h.Fc=function(a){return this.Ia(a).then(function(a){return a.data.email})},h.Ta=function(a,b){return T(this,this.c.Ta(a,b).then(function(){}))},h.Ia=function(a){return T(this,this.c.Ia(a).then(function(a){return new lg(a)}))},h.Sa=function(a){return T(this,this.c.Sa(a).then(function(){}))},h.cb=function(a,b){var c=this;return T(this,A().then(function(){return void 0===b||Sa(b)?{}:Fg(new wg(b))}).then(function(b){return c.c.cb(a,b)}).then(function(){}))},h.vc=function(a,b){return T(this,ok(this,a,b,r(this.fb,this)))};var Kl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),Xl="callback",Zl="expired-callback",Vl="sitekey",Wl="size";h=Ul.prototype,h.xa=function(){var a=this;return this.c?this.c:this.c=am(this,A().then(function(){if(Sf())return Hf();throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return bm(cm(),a.o())}).then(function(){return Q(a.u,ui,{})}).then(function(b){a.a[Vl]=b.recaptchaSiteKey}).s(function(b){throw a.c=null,b}))},h.render=function(){dm(this);var a=this;return am(this,this.xa().then(function(){if(null===a.b){var b=a.l;if(!a.h){var c=wc(b);b=zc("DIV"),c.appendChild(b)}a.b=grecaptcha.render(b,a.a)}return a.b}))},h.verify=function(){dm(this);var a=this;return am(this,this.render().then(function(b){return new z(function(c){var d=grecaptcha.getResponse(b);if(d)c(d);else{var e=function(b){b&&($l(a,e),c(b))};a.i.push(e),a.h&&grecaptcha.execute(a.b)}})}))},h.reset=function(){dm(this),null!==this.b&&grecaptcha.reset(this.b)},h.clear=function(){dm(this),this.m=!0,cm().b--;for(var a=0;a<this.g.length;a++)this.g[a].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){a=wc(this.l);for(var b;b=a.firstChild;)a.removeChild(b)}};var em=dc("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),gm=null;t(hm,Ul),Y(ul.prototype,{Sa:{name:"applyActionCode",j:[V("code")]},Ia:{name:"checkActionCode",j:[V("code")]},Ta:{name:"confirmPasswordReset",j:[V("code"),V("newPassword")]},Ob:{name:"createUserWithEmailAndPassword",j:[V("email"),V("password")]},qb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[V("email"),V("password")]},Rb:{name:"fetchProvidersForEmail",j:[V("email")]},aa:{name:"getRedirectResult",j:[]},hc:{name:"onAuthStateChanged",j:[X(W(),Ml(),"nextOrObserver"),Ml("opt_error",!0),Ml("opt_completed",!0)]},ic:{name:"onIdTokenChanged",j:[X(W(),Ml(),"nextOrObserver"),Ml("opt_error",!0),Ml("opt_completed",!0)]},cb:{name:"sendPasswordResetEmail",j:[V("email"),X(W("opt_actionCodeSettings",!0),Nl(null,!0),"opt_actionCodeSettings",!0)]},eb:{name:"setPersistence",j:[V("persistence")]},fb:{name:"signInAndRetrieveDataWithCredential",j:[Rl()]},gb:{name:"signInAnonymously",j:[]},Gb:{name:"signInAnonymouslyAndRetrieveData",j:[]},sc:{name:"signInWithCredential",j:[Rl()]},tc:{name:"signInWithCustomToken",j:[V("token")]},Eb:{name:"signInAndRetrieveDataWithCustomToken",j:[V("token")]},uc:{name:"signInWithEmailAndPassword",j:[V("email"),V("password")]},Fb:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[V("email"),V("password")]},vc:{name:"signInWithPhoneNumber",j:[V("phoneNumber"),Tl()]},wc:{name:"signInWithPopup",j:[Sl()]},xc:{name:"signInWithRedirect",j:[Sl()]},hb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[V(null,!0)]},Ec:{name:"useDeviceLanguage",j:[]},Fc:{name:"verifyPasswordResetCode",j:[V("code")]}}),function(a,b){for(var c in b){var d=b[c].name;if(d!==c){var e=b[c].Nb;Object.defineProperty(a,d,{get:function(){return this[c]},set:function(a){Jl(d,[e],[a],!0),this[c]=a},enumerable:!0})}}}(ul.prototype,{lc:{name:"languageCode",Nb:X(V(),Nl(),"languageCode")}}),ul.Persistence=nj,ul.Persistence.LOCAL="local",ul.Persistence.SESSION="session",ul.Persistence.NONE="none",Y(Bk.prototype,{delete:{name:"delete",j:[]},F:{name:"getIdToken",j:[Ll()]},getToken:{name:"getToken",j:[Ll()]},Xa:{name:"linkAndRetrieveDataWithCredential",j:[Rl()]},cc:{name:"linkWithCredential",j:[Rl()]},dc:{name:"linkWithPhoneNumber",j:[V("phoneNumber"),Tl()]},ec:{name:"linkWithPopup",j:[Sl()]},fc:{name:"linkWithRedirect",j:[Sl()]},Za:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Rl()]},mc:{name:"reauthenticateWithCredential",j:[Rl()]},nc:{name:"reauthenticateWithPhoneNumber",j:[V("phoneNumber"),Tl()]},oc:{name:"reauthenticateWithPopup",j:[Sl()]},pc:{name:"reauthenticateWithRedirect",j:[Sl()]},reload:{name:"reload",j:[]},bb:{name:"sendEmailVerification",j:[X(W("opt_actionCodeSettings",!0),Nl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[V(null,!0)]},Cc:{name:"unlink",j:[V("provider")]},kb:{name:"updateEmail",j:[V("email")]},lb:{name:"updatePassword",j:[V("password")]},Dc:{name:"updatePhoneNumber",j:[Rl("phone")]},mb:{name:"updateProfile",j:[W("profile")]}}),Y(z.prototype,{s:{name:"catch"},then:{name:"then"}}),Y(nk.prototype,{confirm:{name:"confirm",j:[V("verificationCode")]}}),Z(mh,"credential",function(a,b){return new jh(a,b)},[V("email"),V("password")]),Y(bh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}}),Z(bh,"credential",ch,[X(V(),W(),"token")]),Y(dh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}}),Z(dh,"credential",eh,[X(V(),W(),"token")]),Y(fh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}}),Z(fh,"credential",gh,[X(V(),X(W(),Nl()),"idToken"),X(V(),Nl(),"accessToken",!0)]),Y(hh.prototype,{Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}}),Z(hh,"credential",ih,[X(V(),W(),"token"),V("secret",!0)]),Y(P.prototype,{sa:{name:"addScope",j:[V("scope")]},credential:{name:"credential",j:[X(V(),Nl(),"idToken",!0),X(V(),Nl(),"accessToken",!0)]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}}),Z(rh,"credential",th,[V("verificationId"),V("verificationCode")]),Y(rh.prototype,{Qa:{name:"verifyPhoneNumber",j:[V("phoneNumber"),Tl()]}}),Y(N.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}}),Y(zh.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}}),Y(yh.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}}),Y(hm.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===firebase||!firebase.INTERNAL||!firebase.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var a={Auth:ul,Error:N};Z(a,"EmailAuthProvider",mh,[]),Z(a,"FacebookAuthProvider",bh,[]),Z(a,"GithubAuthProvider",dh,[]),Z(a,"GoogleAuthProvider",fh,[]),Z(a,"TwitterAuthProvider",hh,[]),Z(a,"OAuthProvider",P,[V("providerId")]),Z(a,"PhoneAuthProvider",rh,[Pl()]),Z(a,"RecaptchaVerifier",hm,[X(V(),Ol(),"recaptchaContainer"),W("recaptchaParameters",!0),Ql()]),firebase.INTERNAL.registerService("auth",function(a,c){return a=new ul(a),c({INTERNAL:{getUid:r(a.getUid,a),getToken:r(a.Vb,a),addAuthTokenListener:r(a.Mb,a),removeAuthTokenListener:r(a.qc,a)}}),a},a,function(a,c){if("create"===a)try{c.auth()}catch(d){}}),firebase.INTERNAL.extendNamespace({User:Bk})}()}).call(void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(exports,__webpack_require__(23))},function(module,exports,__webpack_require__){module.exports=__webpack_require__(141)},function(module,exports,__webpack_require__){"use strict";function registerDatabase(instance){var namespace=instance.INTERNAL.registerService("database",function(app,unused,url){return RepoManager_1.RepoManager.getInstance().databaseFromApp(app,url)},{Reference:Reference_1.Reference,Query:Query_1.Query,Database:Database_1.Database,enableLogging:util_1.enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS},null,!0);util_2.isNodeSdk()&&(module.exports=namespace)}Object.defineProperty(exports,"__esModule",{value:!0});var app_1=__webpack_require__(18),Database_1=__webpack_require__(66);exports.Database=Database_1.Database;var Query_1=__webpack_require__(70);exports.Query=Query_1.Query;var Reference_1=__webpack_require__(47);exports.Reference=Reference_1.Reference;var util_1=__webpack_require__(1);exports.enableLogging=util_1.enableLogging;var RepoManager_1=__webpack_require__(52),INTERNAL=__webpack_require__(173),TEST_ACCESS=__webpack_require__(174),util_2=__webpack_require__(0),ServerValue=Database_1.Database.ServerValue;exports.ServerValue=ServerValue,exports.registerDatabase=registerDatabase,registerDatabase(app_1.default);var DataSnapshot_1=__webpack_require__(48);exports.DataSnapshot=DataSnapshot_1.DataSnapshot;var onDisconnect_1=__webpack_require__(69);exports.OnDisconnect=onDisconnect_1.OnDisconnect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),DOMStorageWrapper=function(){function DOMStorageWrapper(domStorage_){this.domStorage_=domStorage_,this.prefix_="firebase:"}return DOMStorageWrapper.prototype.set=function(key,value){null==value?this.domStorage_.removeItem(this.prefixedName_(key)):this.domStorage_.setItem(this.prefixedName_(key),util_1.stringify(value))},DOMStorageWrapper.prototype.get=function(key){var storedVal=this.domStorage_.getItem(this.prefixedName_(key));return null==storedVal?null:util_1.jsonEval(storedVal)},DOMStorageWrapper.prototype.remove=function(key){this.domStorage_.removeItem(this.prefixedName_(key))},DOMStorageWrapper.prototype.prefixedName_=function(name){return this.prefix_+name},DOMStorageWrapper.prototype.toString=function(){return this.domStorage_.toString()},DOMStorageWrapper}();exports.DOMStorageWrapper=DOMStorageWrapper},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),MemoryStorage=function(){function MemoryStorage(){this.cache_={},this.isInMemoryStorage=!0}return MemoryStorage.prototype.set=function(key,value){null==value?delete this.cache_[key]:this.cache_[key]=value},MemoryStorage.prototype.get=function(key){return util_1.contains(this.cache_,key)?this.cache_[key]:null},MemoryStorage.prototype.remove=function(key){delete this.cache_[key]},MemoryStorage}();exports.MemoryStorage=MemoryStorage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),TransactionResult=function(){function TransactionResult(committed,snapshot){this.committed=committed,this.snapshot=snapshot}return TransactionResult.prototype.toJSON=function(){return util_1.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},TransactionResult}();exports.TransactionResult=TransactionResult},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0);exports.nextPushId=function(){var PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",lastPushTime=0,lastRandChars=[];return function(now){var duplicateTime=now===lastPushTime;lastPushTime=now;var i,timeStampChars=new Array(8);for(i=7;i>=0;i--)timeStampChars[i]=PUSH_CHARS.charAt(now%64),now=Math.floor(now/64);util_1.assert(0===now,"Cannot push at time == 0");var id=timeStampChars.join("");if(duplicateTime){for(i=11;i>=0&&63===lastRandChars[i];i--)lastRandChars[i]=0;lastRandChars[i]++}else for(i=0;i<12;i++)lastRandChars[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)id+=PUSH_CHARS.charAt(lastRandChars[i]);return util_1.assert(20===id.length,"nextPushId: Length should be 20."),id}}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var DataSnapshot_1=__webpack_require__(48),Event_1=__webpack_require__(147),util_1=__webpack_require__(0),util_2=__webpack_require__(0),ValueEventRegistration=function(){function ValueEventRegistration(callback_,cancelCallback_,context_){this.callback_=callback_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ValueEventRegistration.prototype.respondsTo=function(eventType){return"value"===eventType},ValueEventRegistration.prototype.createEvent=function(change,query){var index=query.getQueryParams().getIndex();return new Event_1.DataEvent("value",this,new DataSnapshot_1.DataSnapshot(change.snapshotNode,query.getRef(),index))},ValueEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if("cancel"===eventData.getEventType()){util_2.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_1=this.cancelCallback_;return function(){cancelCB_1.call(ctx,eventData.error)}}var cb_1=this.callback_;return function(){cb_1.call(ctx,eventData.snapshot)}},ValueEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new Event_1.CancelEvent(this,error,path):null},ValueEventRegistration.prototype.matches=function(other){return other instanceof ValueEventRegistration&&(!other.callback_||!this.callback_||other.callback_===this.callback_&&other.context_===this.context_)},ValueEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callback_},ValueEventRegistration}();exports.ValueEventRegistration=ValueEventRegistration;var ChildEventRegistration=function(){function ChildEventRegistration(callbacks_,cancelCallback_,context_){this.callbacks_=callbacks_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ChildEventRegistration.prototype.respondsTo=function(eventType){var eventToCheck="children_added"===eventType?"child_added":eventType;return eventToCheck="children_removed"===eventToCheck?"child_removed":eventToCheck,util_1.contains(this.callbacks_,eventToCheck)},ChildEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new Event_1.CancelEvent(this,error,path):null},ChildEventRegistration.prototype.createEvent=function(change,query){util_2.assert(null!=change.childName,"Child events should have a childName.");var ref=query.getRef().child(change.childName),index=query.getQueryParams().getIndex();return new Event_1.DataEvent(change.type,this,new DataSnapshot_1.DataSnapshot(change.snapshotNode,ref,index),change.prevName)},ChildEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if("cancel"===eventData.getEventType()){util_2.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_2=this.cancelCallback_;return function(){cancelCB_2.call(ctx,eventData.error)}}var cb_2=this.callbacks_[eventData.eventType];return function(){cb_2.call(ctx,eventData.snapshot,eventData.prevName)}},ChildEventRegistration.prototype.matches=function(other){if(other instanceof ChildEventRegistration){if(!this.callbacks_||!other.callbacks_)return!0;if(this.context_===other.context_){var otherCount=util_1.getCount(other.callbacks_);if(otherCount===util_1.getCount(this.callbacks_)){if(1===otherCount){var otherKey=util_1.getAnyKey(other.callbacks_),thisKey=util_1.getAnyKey(this.callbacks_);return!(thisKey!==otherKey||other.callbacks_[otherKey]&&this.callbacks_[thisKey]&&other.callbacks_[otherKey]!==this.callbacks_[thisKey])}return util_1.every(this.callbacks_,function(eventType,cb){return other.callbacks_[eventType]===cb})}}}return!1},ChildEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callbacks_},ChildEventRegistration}();exports.ChildEventRegistration=ChildEventRegistration},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),DataEvent=function(){function DataEvent(eventType,eventRegistration,snapshot,prevName){this.eventType=eventType,this.eventRegistration=eventRegistration,this.snapshot=snapshot,this.prevName=prevName}return DataEvent.prototype.getPath=function(){var ref=this.snapshot.getRef();return"value"===this.eventType?ref.path:ref.getParent().path},DataEvent.prototype.getEventType=function(){return this.eventType},DataEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},DataEvent.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+util_1.stringify(this.snapshot.exportVal())},DataEvent}();exports.DataEvent=DataEvent;var CancelEvent=function(){function CancelEvent(eventRegistration,error,path){this.eventRegistration=eventRegistration,this.error=error,this.path=path}return CancelEvent.prototype.getPath=function(){return this.path},CancelEvent.prototype.getEventType=function(){return"cancel"},CancelEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},CancelEvent.prototype.toString=function(){return this.path.toString()+":cancel"},CancelEvent}();exports.CancelEvent=CancelEvent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(1),AckUserWrite_1=__webpack_require__(149),ChildrenNode_1=__webpack_require__(10),util_3=__webpack_require__(0),ImmutableTree_1=__webpack_require__(49),ListenComplete_1=__webpack_require__(150),Merge_1=__webpack_require__(151),Operation_1=__webpack_require__(20),Overwrite_1=__webpack_require__(80),Path_1=__webpack_require__(4),SyncPoint_1=__webpack_require__(81),WriteTree_1=__webpack_require__(157),SyncTree=function(){function SyncTree(listenProvider_){this.listenProvider_=listenProvider_,this.syncPointTree_=ImmutableTree_1.ImmutableTree.Empty,this.pendingWriteTree_=new WriteTree_1.WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return SyncTree.prototype.applyUserOverwrite=function(path,newData,writeId,visible){return this.pendingWriteTree_.addOverwrite(path,newData,writeId,visible),visible?this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.User,path,newData)):[]},SyncTree.prototype.applyUserMerge=function(path,changedChildren,writeId){this.pendingWriteTree_.addMerge(path,changedChildren,writeId);var changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.User,path,changeTree))},SyncTree.prototype.ackUserWrite=function(writeId,revert){void 0===revert&&(revert=!1);var write=this.pendingWriteTree_.getWrite(writeId);if(this.pendingWriteTree_.removeWrite(writeId)){var affectedTree_1=ImmutableTree_1.ImmutableTree.Empty;return null!=write.snap?affectedTree_1=affectedTree_1.set(Path_1.Path.Empty,!0):util_3.forEach(write.children,function(pathString,node){affectedTree_1=affectedTree_1.set(new Path_1.Path(pathString),node)}),this.applyOperationToSyncPoints_(new AckUserWrite_1.AckUserWrite(write.path,affectedTree_1,revert))}return[]},SyncTree.prototype.applyServerOverwrite=function(path,newData){return this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.Server,path,newData))},SyncTree.prototype.applyServerMerge=function(path,changedChildren){var changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.Server,path,changeTree))},SyncTree.prototype.applyListenComplete=function(path){return this.applyOperationToSyncPoints_(new ListenComplete_1.ListenComplete(Operation_1.OperationSource.Server,path))},SyncTree.prototype.applyTaggedQueryOverwrite=function(path,snap,tag){var queryKey=this.queryKeyForTag_(tag);if(null!=queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path_1.Path.relativePath(queryPath,path),op=new Overwrite_1.Overwrite(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath,snap);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedQueryMerge=function(path,changedChildren,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path_1.Path.relativePath(queryPath,path),changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren),op=new Merge_1.Merge(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath,changeTree);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedListenComplete=function(path,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path_1.Path.relativePath(queryPath,path),op=new ListenComplete_1.ListenComplete(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.addEventRegistration=function(query,eventRegistration){var path=query.path,serverCache=null,foundAncestorDefaultView=!1;this.syncPointTree_.foreachOnPath(path,function(pathToSyncPoint,sp){var relativePath=Path_1.Path.relativePath(pathToSyncPoint,path);serverCache=serverCache||sp.getCompleteServerCache(relativePath),foundAncestorDefaultView=foundAncestorDefaultView||sp.hasCompleteView()});var syncPoint=this.syncPointTree_.get(path);syncPoint?(foundAncestorDefaultView=foundAncestorDefaultView||syncPoint.hasCompleteView(),serverCache=serverCache||syncPoint.getCompleteServerCache(Path_1.Path.Empty)):(syncPoint=new SyncPoint_1.SyncPoint,this.syncPointTree_=this.syncPointTree_.set(path,syncPoint));var serverCacheComplete;if(null!=serverCache)serverCacheComplete=!0;else{serverCacheComplete=!1,serverCache=ChildrenNode_1.ChildrenNode.EMPTY_NODE;this.syncPointTree_.subtree(path).foreachChild(function(childName,childSyncPoint){var completeCache=childSyncPoint.getCompleteServerCache(Path_1.Path.Empty);completeCache&&(serverCache=serverCache.updateImmediateChild(childName,completeCache))})}var viewAlreadyExists=syncPoint.viewExistsForQuery(query);if(!viewAlreadyExists&&!query.getQueryParams().loadsAllData()){var queryKey=SyncTree.makeQueryKey_(query);util_1.assert(!(queryKey in this.queryToTagMap_),"View does not exist, but we have a tag");var tag=SyncTree.getNextQueryTag_();this.queryToTagMap_[queryKey]=tag,this.tagToQueryMap_["_"+tag]=queryKey}var writesCache=this.pendingWriteTree_.childWrites(path),events=syncPoint.addEventRegistration(query,eventRegistration,writesCache,serverCache,serverCacheComplete);if(!viewAlreadyExists&&!foundAncestorDefaultView){var view=syncPoint.viewForQuery(query);events=events.concat(this.setupListener_(query,view))}return events},SyncTree.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var _this=this,path=query.path,maybeSyncPoint=this.syncPointTree_.get(path),cancelEvents=[];if(maybeSyncPoint&&("default"===query.queryIdentifier()||maybeSyncPoint.viewExistsForQuery(query))){var removedAndEvents=maybeSyncPoint.removeEventRegistration(query,eventRegistration,cancelError);maybeSyncPoint.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(path));var removed=removedAndEvents.removed;cancelEvents=removedAndEvents.events;var removingDefault=-1!==removed.findIndex(function(query){return query.getQueryParams().loadsAllData()}),covered=this.syncPointTree_.findOnPath(path,function(relativePath,parentSyncPoint){return parentSyncPoint.hasCompleteView()});if(removingDefault&&!covered){var subtree=this.syncPointTree_.subtree(path);if(!subtree.isEmpty())for(var newViews=this.collectDistinctViewsForSubTree_(subtree),i=0;i<newViews.length;++i){var view=newViews[i],newQuery=view.getQuery(),listener=this.createListenerForView_(view);this.listenProvider_.startListening(SyncTree.queryForListening_(newQuery),this.tagForQuery_(newQuery),listener.hashFn,listener.onComplete)}}if(!covered&&removed.length>0&&!cancelError)if(removingDefault){this.listenProvider_.stopListening(SyncTree.queryForListening_(query),null)}else removed.forEach(function(queryToRemove){var tagToRemove=_this.queryToTagMap_[SyncTree.makeQueryKey_(queryToRemove)];_this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToRemove),tagToRemove)});this.removeTags_(removed)}return cancelEvents},SyncTree.prototype.calcCompleteEventCache=function(path,writeIdsToExclude){var writeTree=this.pendingWriteTree_,serverCache=this.syncPointTree_.findOnPath(path,function(pathSoFar,syncPoint){var relativePath=Path_1.Path.relativePath(pathSoFar,path),serverCache=syncPoint.getCompleteServerCache(relativePath);if(serverCache)return serverCache});return writeTree.calcCompleteEventCache(path,serverCache,writeIdsToExclude,!0)},SyncTree.prototype.collectDistinctViewsForSubTree_=function(subtree){return subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView()){return[maybeChildSyncPoint.getCompleteView()]}var views_1=[];return maybeChildSyncPoint&&(views_1=maybeChildSyncPoint.getQueryViews()),util_3.forEach(childMap,function(key,childViews){views_1=views_1.concat(childViews)}),views_1})},SyncTree.prototype.removeTags_=function(queries){for(var j=0;j<queries.length;++j){var removedQuery=queries[j];if(!removedQuery.getQueryParams().loadsAllData()){var removedQueryKey=SyncTree.makeQueryKey_(removedQuery),removedQueryTag=this.queryToTagMap_[removedQueryKey];delete this.queryToTagMap_[removedQueryKey],delete this.tagToQueryMap_["_"+removedQueryTag]}}},SyncTree.queryForListening_=function(query){return query.getQueryParams().loadsAllData()&&!query.getQueryParams().isDefault()?query.getRef():query},SyncTree.prototype.setupListener_=function(query,view){var path=query.path,tag=this.tagForQuery_(query),listener=this.createListenerForView_(view),events=this.listenProvider_.startListening(SyncTree.queryForListening_(query),tag,listener.hashFn,listener.onComplete),subtree=this.syncPointTree_.subtree(path);if(tag)util_1.assert(!subtree.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var queriesToStop=subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(!relativePath.isEmpty()&&maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView())return[maybeChildSyncPoint.getCompleteView().getQuery()];var queries_1=[];return maybeChildSyncPoint&&(queries_1=queries_1.concat(maybeChildSyncPoint.getQueryViews().map(function(view){return view.getQuery()}))),util_3.forEach(childMap,function(key,childQueries){queries_1=queries_1.concat(childQueries)}),queries_1}),i=0;i<queriesToStop.length;++i){var queryToStop=queriesToStop[i];this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToStop),this.tagForQuery_(queryToStop))}return events},SyncTree.prototype.createListenerForView_=function(view){var _this=this,query=view.getQuery(),tag=this.tagForQuery_(query);return{hashFn:function(){return(view.getServerCache()||ChildrenNode_1.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(status){if("ok"===status)return tag?_this.applyTaggedListenComplete(query.path,tag):_this.applyListenComplete(query.path);var error=util_2.errorForServerCode(status,query);return _this.removeEventRegistration(query,null,error)}}},SyncTree.makeQueryKey_=function(query){return query.path.toString()+"$"+query.queryIdentifier()},SyncTree.parseQueryKey_=function(queryKey){var splitIndex=queryKey.indexOf("$");return util_1.assert(-1!==splitIndex&&splitIndex<queryKey.length-1,"Bad queryKey."),{queryId:queryKey.substr(splitIndex+1),path:new Path_1.Path(queryKey.substr(0,splitIndex))}},SyncTree.prototype.queryKeyForTag_=function(tag){return this.tagToQueryMap_["_"+tag]},SyncTree.prototype.tagForQuery_=function(query){var queryKey=SyncTree.makeQueryKey_(query);return util_3.safeGet(this.queryToTagMap_,queryKey)},SyncTree.getNextQueryTag_=function(){return SyncTree.nextQueryTag_++},SyncTree.prototype.applyTaggedOperation_=function(queryPath,operation){var syncPoint=this.syncPointTree_.get(queryPath);util_1.assert(syncPoint,"Missing sync point for query tag that we're tracking");var writesCache=this.pendingWriteTree_.childWrites(queryPath);return syncPoint.applyOperation(operation,writesCache,null)},SyncTree.prototype.applyOperationToSyncPoints_=function(operation){return this.applyOperationHelper_(operation,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path_1.Path.Empty))},SyncTree.prototype.applyOperationHelper_=function(operation,syncPointTree,serverCache,writesCache){if(operation.path.isEmpty())return this.applyOperationDescendantsHelper_(operation,syncPointTree,serverCache,writesCache);var syncPoint=syncPointTree.get(Path_1.Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path_1.Path.Empty));var events=[],childName=operation.path.getFront(),childOperation=operation.operationForChild(childName),childTree=syncPointTree.children.get(childName);if(childTree&&childOperation){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName);events=events.concat(this.applyOperationHelper_(childOperation,childTree,childServerCache,childWritesCache))}return syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.prototype.applyOperationDescendantsHelper_=function(operation,syncPointTree,serverCache,writesCache){var _this=this,syncPoint=syncPointTree.get(Path_1.Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path_1.Path.Empty));var events=[];return syncPointTree.children.inorderTraversal(function(childName,childTree){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName),childOperation=operation.operationForChild(childName);childOperation&&(events=events.concat(_this.applyOperationDescendantsHelper_(childOperation,childTree,childServerCache,childWritesCache)))}),syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.nextQueryTag_=1,SyncTree}();exports.SyncTree=SyncTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Path_1=__webpack_require__(4),Operation_1=__webpack_require__(20),AckUserWrite=function(){function AckUserWrite(path,affectedTree,revert){this.path=path,this.affectedTree=affectedTree,this.revert=revert,this.type=Operation_1.OperationType.ACK_USER_WRITE,this.source=Operation_1.OperationSource.User}return AckUserWrite.prototype.operationForChild=function(childName){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return util_1.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var childTree=this.affectedTree.subtree(new Path_1.Path(childName));return new AckUserWrite(Path_1.Path.Empty,childTree,this.revert)}return util_1.assert(this.path.getFront()===childName,"operationForChild called for unrelated child."),new AckUserWrite(this.path.popFront(),this.affectedTree,this.revert)},AckUserWrite}();exports.AckUserWrite=AckUserWrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Path_1=__webpack_require__(4),Operation_1=__webpack_require__(20),ListenComplete=function(){function ListenComplete(source,path){this.source=source,this.path=path,this.type=Operation_1.OperationType.LISTEN_COMPLETE}return ListenComplete.prototype.operationForChild=function(childName){return this.path.isEmpty()?new ListenComplete(this.source,Path_1.Path.Empty):new ListenComplete(this.source,this.path.popFront())},ListenComplete}();exports.ListenComplete=ListenComplete},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Operation_1=__webpack_require__(20),Overwrite_1=__webpack_require__(80),Path_1=__webpack_require__(4),util_1=__webpack_require__(0),Merge=function(){function Merge(source,path,children){this.source=source,this.path=path,this.children=children,this.type=Operation_1.OperationType.MERGE}return Merge.prototype.operationForChild=function(childName){if(this.path.isEmpty()){var childTree=this.children.subtree(new Path_1.Path(childName));return childTree.isEmpty()?null:childTree.value?new Overwrite_1.Overwrite(this.source,Path_1.Path.Empty,childTree.value):new Merge(this.source,Path_1.Path.Empty,childTree)}return util_1.assert(this.path.getFront()===childName,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,this.path.popFront(),this.children)},Merge.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Merge}();exports.Merge=Merge},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var IndexedFilter_1=__webpack_require__(50),ViewProcessor_1=__webpack_require__(153),ChildrenNode_1=__webpack_require__(10),CacheNode_1=__webpack_require__(40),ViewCache_1=__webpack_require__(82),EventGenerator_1=__webpack_require__(156),util_1=__webpack_require__(0),Operation_1=__webpack_require__(20),Change_1=__webpack_require__(24),PriorityIndex_1=__webpack_require__(8),View=function(){function View(query_,initialViewCache){this.query_=query_,this.eventRegistrations_=[];var params=this.query_.getQueryParams(),indexFilter=new IndexedFilter_1.IndexedFilter(params.getIndex()),filter=params.getNodeFilter();this.processor_=new ViewProcessor_1.ViewProcessor(filter);var initialServerCache=initialViewCache.getServerCache(),initialEventCache=initialViewCache.getEventCache(),serverSnap=indexFilter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,initialServerCache.getNode(),null),eventSnap=filter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,initialEventCache.getNode(),null),newServerCache=new CacheNode_1.CacheNode(serverSnap,initialServerCache.isFullyInitialized(),indexFilter.filtersNodes()),newEventCache=new CacheNode_1.CacheNode(eventSnap,initialEventCache.isFullyInitialized(),filter.filtersNodes());this.viewCache_=new ViewCache_1.ViewCache(newEventCache,newServerCache),this.eventGenerator_=new EventGenerator_1.EventGenerator(this.query_)}return View.prototype.getQuery=function(){return this.query_},View.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},View.prototype.getCompleteServerCache=function(path){var cache=this.viewCache_.getCompleteServerSnap();return cache&&(this.query_.getQueryParams().loadsAllData()||!path.isEmpty()&&!cache.getImmediateChild(path.getFront()).isEmpty())?cache.getChild(path):null},View.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},View.prototype.addEventRegistration=function(eventRegistration){this.eventRegistrations_.push(eventRegistration)},View.prototype.removeEventRegistration=function(eventRegistration,cancelError){var cancelEvents=[];if(cancelError){util_1.assert(null==eventRegistration,"A cancel should cancel all event registrations.");var path_1=this.query_.path;this.eventRegistrations_.forEach(function(registration){cancelError=cancelError;var maybeEvent=registration.createCancelEvent(cancelError,path_1);maybeEvent&&cancelEvents.push(maybeEvent)})}if(eventRegistration){for(var remaining=[],i=0;i<this.eventRegistrations_.length;++i){var existing=this.eventRegistrations_[i];if(existing.matches(eventRegistration)){if(eventRegistration.hasAnyCallback()){remaining=remaining.concat(this.eventRegistrations_.slice(i+1));break}}else remaining.push(existing)}this.eventRegistrations_=remaining}else this.eventRegistrations_=[];return cancelEvents},View.prototype.applyOperation=function(operation,writesCache,completeServerCache){operation.type===Operation_1.OperationType.MERGE&&null!==operation.source.queryId&&(util_1.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),util_1.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var oldViewCache=this.viewCache_,result=this.processor_.applyOperation(oldViewCache,operation,writesCache,completeServerCache);return this.processor_.assertIndexed(result.viewCache),util_1.assert(result.viewCache.getServerCache().isFullyInitialized()||!oldViewCache.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=result.viewCache,this.generateEventsForChanges_(result.changes,result.viewCache.getEventCache().getNode(),null)},View.prototype.getInitialEvents=function(registration){var eventSnap=this.viewCache_.getEventCache(),initialChanges=[];if(!eventSnap.getNode().isLeafNode()){eventSnap.getNode().forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){initialChanges.push(Change_1.Change.childAddedChange(key,childNode))})}return eventSnap.isFullyInitialized()&&initialChanges.push(Change_1.Change.valueChange(eventSnap.getNode())),this.generateEventsForChanges_(initialChanges,eventSnap.getNode(),registration)},View.prototype.generateEventsForChanges_=function(changes,eventCache,eventRegistration){var registrations=eventRegistration?[eventRegistration]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(changes,eventCache,registrations)},View}();exports.View=View},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Operation_1=__webpack_require__(20),util_1=__webpack_require__(0),ChildChangeAccumulator_1=__webpack_require__(154),Change_1=__webpack_require__(24),ChildrenNode_1=__webpack_require__(10),KeyIndex_1=__webpack_require__(28),ImmutableTree_1=__webpack_require__(49),Path_1=__webpack_require__(4),CompleteChildSource_1=__webpack_require__(155),ProcessorResult=function(){function ProcessorResult(viewCache,changes){this.viewCache=viewCache,this.changes=changes}return ProcessorResult}();exports.ProcessorResult=ProcessorResult;var ViewProcessor=function(){function ViewProcessor(filter_){this.filter_=filter_}return ViewProcessor.prototype.assertIndexed=function(viewCache){util_1.assert(viewCache.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),util_1.assert(viewCache.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},ViewProcessor.prototype.applyOperation=function(oldViewCache,operation,writesCache,completeCache){var newViewCache,filterServerNode,accumulator=new ChildChangeAccumulator_1.ChildChangeAccumulator;if(operation.type===Operation_1.OperationType.OVERWRITE){var overwrite=operation;overwrite.source.fromUser?newViewCache=this.applyUserOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,accumulator):(util_1.assert(overwrite.source.fromServer,"Unknown source."),filterServerNode=overwrite.source.tagged||oldViewCache.getServerCache().isFiltered()&&!overwrite.path.isEmpty(),newViewCache=this.applyServerOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===Operation_1.OperationType.MERGE){var merge=operation;merge.source.fromUser?newViewCache=this.applyUserMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,accumulator):(util_1.assert(merge.source.fromServer,"Unknown source."),filterServerNode=merge.source.tagged||oldViewCache.getServerCache().isFiltered(),newViewCache=this.applyServerMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===Operation_1.OperationType.ACK_USER_WRITE){var ackUserWrite=operation;newViewCache=ackUserWrite.revert?this.revertUserWrite_(oldViewCache,ackUserWrite.path,writesCache,completeCache,accumulator):this.ackUserWrite_(oldViewCache,ackUserWrite.path,ackUserWrite.affectedTree,writesCache,completeCache,accumulator)}else{if(operation.type!==Operation_1.OperationType.LISTEN_COMPLETE)throw util_1.assertionError("Unknown operation type: "+operation.type);newViewCache=this.listenComplete_(oldViewCache,operation.path,writesCache,accumulator)}var changes=accumulator.getChanges();return ViewProcessor.maybeAddValueEvent_(oldViewCache,newViewCache,changes),new ProcessorResult(newViewCache,changes)},ViewProcessor.maybeAddValueEvent_=function(oldViewCache,newViewCache,accumulator){var eventSnap=newViewCache.getEventCache();if(eventSnap.isFullyInitialized()){var isLeafOrEmpty=eventSnap.getNode().isLeafNode()||eventSnap.getNode().isEmpty(),oldCompleteSnap=oldViewCache.getCompleteEventSnap();(accumulator.length>0||!oldViewCache.getEventCache().isFullyInitialized()||isLeafOrEmpty&&!eventSnap.getNode().equals(oldCompleteSnap)||!eventSnap.getNode().getPriority().equals(oldCompleteSnap.getPriority()))&&accumulator.push(Change_1.Change.valueChange(newViewCache.getCompleteEventSnap()))}},ViewProcessor.prototype.generateEventCacheAfterServerEvent_=function(viewCache,changePath,writesCache,source,accumulator){var oldEventSnap=viewCache.getEventCache();if(null!=writesCache.shadowingWrite(changePath))return viewCache;var newEventCache=void 0,serverNode=void 0;if(changePath.isEmpty())if(util_1.assert(viewCache.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),viewCache.getServerCache().isFiltered()){var serverCache=viewCache.getCompleteServerSnap(),completeChildren=serverCache instanceof ChildrenNode_1.ChildrenNode?serverCache:ChildrenNode_1.ChildrenNode.EMPTY_NODE,completeEventChildren=writesCache.calcCompleteEventChildren(completeChildren);newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeEventChildren,accumulator)}else{var completeNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeNode,accumulator)}else{var childKey=changePath.getFront();if(".priority"==childKey){util_1.assert(1==changePath.getLength(),"Can't have a priority with additional path components");var oldEventNode=oldEventSnap.getNode();serverNode=viewCache.getServerCache().getNode();var updatedPriority=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventNode,serverNode);newEventCache=null!=updatedPriority?this.filter_.updatePriority(oldEventNode,updatedPriority):oldEventSnap.getNode()}else{var childChangePath=changePath.popFront(),newEventChild=void 0;if(oldEventSnap.isCompleteForChild(childKey)){serverNode=viewCache.getServerCache().getNode();var eventChildUpdate=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventSnap.getNode(),serverNode);newEventChild=null!=eventChildUpdate?oldEventSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,eventChildUpdate):oldEventSnap.getNode().getImmediateChild(childKey)}else newEventChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());newEventCache=null!=newEventChild?this.filter_.updateChild(oldEventSnap.getNode(),childKey,newEventChild,childChangePath,source,accumulator):oldEventSnap.getNode()}}return viewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized()||changePath.isEmpty(),this.filter_.filtersNodes())},ViewProcessor.prototype.applyServerOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,filterServerNode,accumulator){var newServerCache,oldServerSnap=oldViewCache.getServerCache(),serverFilter=filterServerNode?this.filter_:this.filter_.getIndexedFilter();if(changePath.isEmpty())newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),changedSnap,null);else if(serverFilter.filtersNodes()&&!oldServerSnap.isFiltered()){var newServerNode=oldServerSnap.getNode().updateChild(changePath,changedSnap);newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),newServerNode,null)}else{var childKey=changePath.getFront();if(!oldServerSnap.isCompleteForPath(changePath)&&changePath.getLength()>1)return oldViewCache;var childChangePath=changePath.popFront(),childNode=oldServerSnap.getNode().getImmediateChild(childKey),newChildNode=childNode.updateChild(childChangePath,changedSnap);newServerCache=".priority"==childKey?serverFilter.updatePriority(oldServerSnap.getNode(),newChildNode):serverFilter.updateChild(oldServerSnap.getNode(),childKey,newChildNode,childChangePath,CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE,null)}var newViewCache=oldViewCache.updateServerSnap(newServerCache,oldServerSnap.isFullyInitialized()||changePath.isEmpty(),serverFilter.filtersNodes()),source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,newViewCache,completeCache);return this.generateEventCacheAfterServerEvent_(newViewCache,changePath,writesCache,source,accumulator)},ViewProcessor.prototype.applyUserOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,accumulator){var newViewCache,newEventCache,oldEventSnap=oldViewCache.getEventCache(),source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,oldViewCache,completeCache);if(changePath.isEmpty())newEventCache=this.filter_.updateFullNode(oldViewCache.getEventCache().getNode(),changedSnap,accumulator),newViewCache=oldViewCache.updateEventSnap(newEventCache,!0,this.filter_.filtersNodes());else{var childKey=changePath.getFront();if(".priority"===childKey)newEventCache=this.filter_.updatePriority(oldViewCache.getEventCache().getNode(),changedSnap),newViewCache=oldViewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized(),oldEventSnap.isFiltered());else{var childChangePath=changePath.popFront(),oldChild=oldEventSnap.getNode().getImmediateChild(childKey),newChild=void 0;if(childChangePath.isEmpty())newChild=changedSnap;else{var childNode=source.getCompleteChild(childKey);newChild=null!=childNode?".priority"===childChangePath.getBack()&&childNode.getChild(childChangePath.parent()).isEmpty()?childNode:childNode.updateChild(childChangePath,changedSnap):ChildrenNode_1.ChildrenNode.EMPTY_NODE}if(oldChild.equals(newChild))newViewCache=oldViewCache;else{var newEventSnap=this.filter_.updateChild(oldEventSnap.getNode(),childKey,newChild,childChangePath,source,accumulator);newViewCache=oldViewCache.updateEventSnap(newEventSnap,oldEventSnap.isFullyInitialized(),this.filter_.filtersNodes())}}}return newViewCache},ViewProcessor.cacheHasChild_=function(viewCache,childKey){return viewCache.getEventCache().isCompleteForChild(childKey)},ViewProcessor.prototype.applyUserMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,accumulator){var _this=this,curViewCache=viewCache;return changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())&&(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))}),changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())||(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))}),curViewCache},ViewProcessor.prototype.applyMerge_=function(node,merge){return merge.foreach(function(relativePath,childNode){node=node.updateChild(relativePath,childNode)}),node},ViewProcessor.prototype.applyServerMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,filterServerNode,accumulator){var _this=this;if(viewCache.getServerCache().getNode().isEmpty()&&!viewCache.getServerCache().isFullyInitialized())return viewCache;var viewMergeTree,curViewCache=viewCache;viewMergeTree=path.isEmpty()?changedChildren:ImmutableTree_1.ImmutableTree.Empty.setTree(path,changedChildren);var serverNode=viewCache.getServerCache().getNode();return viewMergeTree.children.inorderTraversal(function(childKey,childTree){if(serverNode.hasChild(childKey)){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path_1.Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}}),viewMergeTree.children.inorderTraversal(function(childKey,childMergeTree){var isUnknownDeepMerge=!viewCache.getServerCache().isCompleteForChild(childKey)&&null==childMergeTree.value;if(!serverNode.hasChild(childKey)&&!isUnknownDeepMerge){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childMergeTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path_1.Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}}),curViewCache},ViewProcessor.prototype.ackUserWrite_=function(viewCache,ackPath,affectedTree,writesCache,completeCache,accumulator){if(null!=writesCache.shadowingWrite(ackPath))return viewCache;var filterServerNode=viewCache.getServerCache().isFiltered(),serverCache=viewCache.getServerCache();if(null!=affectedTree.value){if(ackPath.isEmpty()&&serverCache.isFullyInitialized()||serverCache.isCompleteForPath(ackPath))return this.applyServerOverwrite_(viewCache,ackPath,serverCache.getNode().getChild(ackPath),writesCache,completeCache,filterServerNode,accumulator);if(ackPath.isEmpty()){var changedChildren_1=ImmutableTree_1.ImmutableTree.Empty;return serverCache.getNode().forEachChild(KeyIndex_1.KEY_INDEX,function(name,node){changedChildren_1=changedChildren_1.set(new Path_1.Path(name),node)}),this.applyServerMerge_(viewCache,ackPath,changedChildren_1,writesCache,completeCache,filterServerNode,accumulator)}return viewCache}var changedChildren_2=ImmutableTree_1.ImmutableTree.Empty;return affectedTree.foreach(function(mergePath,value){var serverCachePath=ackPath.child(mergePath);serverCache.isCompleteForPath(serverCachePath)&&(changedChildren_2=changedChildren_2.set(mergePath,serverCache.getNode().getChild(serverCachePath)))}),this.applyServerMerge_(viewCache,ackPath,changedChildren_2,writesCache,completeCache,filterServerNode,accumulator)},ViewProcessor.prototype.listenComplete_=function(viewCache,path,writesCache,accumulator){var oldServerNode=viewCache.getServerCache(),newViewCache=viewCache.updateServerSnap(oldServerNode.getNode(),oldServerNode.isFullyInitialized()||path.isEmpty(),oldServerNode.isFiltered());return this.generateEventCacheAfterServerEvent_(newViewCache,path,writesCache,CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE,accumulator)},ViewProcessor.prototype.revertUserWrite_=function(viewCache,path,writesCache,completeServerCache,accumulator){var complete;if(null!=writesCache.shadowingWrite(path))return viewCache;var source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,viewCache,completeServerCache),oldEventCache=viewCache.getEventCache().getNode(),newEventCache=void 0;if(path.isEmpty()||".priority"===path.getFront()){var newNode=void 0;if(viewCache.getServerCache().isFullyInitialized())newNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());else{var serverChildren=viewCache.getServerCache().getNode();util_1.assert(serverChildren instanceof ChildrenNode_1.ChildrenNode,"serverChildren would be complete if leaf node"),newNode=writesCache.calcCompleteEventChildren(serverChildren)}newNode=newNode,newEventCache=this.filter_.updateFullNode(oldEventCache,newNode,accumulator)}else{var childKey=path.getFront(),newChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());null==newChild&&viewCache.getServerCache().isCompleteForChild(childKey)&&(newChild=oldEventCache.getImmediateChild(childKey)),newEventCache=null!=newChild?this.filter_.updateChild(oldEventCache,childKey,newChild,path.popFront(),source,accumulator):viewCache.getEventCache().getNode().hasChild(childKey)?this.filter_.updateChild(oldEventCache,childKey,ChildrenNode_1.ChildrenNode.EMPTY_NODE,path.popFront(),source,accumulator):oldEventCache,newEventCache.isEmpty()&&viewCache.getServerCache().isFullyInitialized()&&(complete=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap()),complete.isLeafNode()&&(newEventCache=this.filter_.updateFullNode(newEventCache,complete,accumulator)))}return complete=viewCache.getServerCache().isFullyInitialized()||null!=writesCache.shadowingWrite(Path_1.Path.Empty),viewCache.updateEventSnap(newEventCache,complete,this.filter_.filtersNodes())},ViewProcessor}();exports.ViewProcessor=ViewProcessor},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Change_1=__webpack_require__(24),util_2=__webpack_require__(0),ChildChangeAccumulator=function(){function ChildChangeAccumulator(){this.changeMap_={}}return ChildChangeAccumulator.prototype.trackChildChange=function(change){var type=change.type,childKey=change.childName;util_2.assert(type==Change_1.Change.CHILD_ADDED||type==Change_1.Change.CHILD_CHANGED||type==Change_1.Change.CHILD_REMOVED,"Only child changes supported for tracking"),util_2.assert(".priority"!==childKey,"Only non-priority child changes can be tracked.");var oldChange=util_1.safeGet(this.changeMap_,childKey);if(oldChange){var oldType=oldChange.type;if(type==Change_1.Change.CHILD_ADDED&&oldType==Change_1.Change.CHILD_REMOVED)this.changeMap_[childKey]=Change_1.Change.childChangedChange(childKey,change.snapshotNode,oldChange.snapshotNode);else if(type==Change_1.Change.CHILD_REMOVED&&oldType==Change_1.Change.CHILD_ADDED)delete this.changeMap_[childKey];else if(type==Change_1.Change.CHILD_REMOVED&&oldType==Change_1.Change.CHILD_CHANGED)this.changeMap_[childKey]=Change_1.Change.childRemovedChange(childKey,oldChange.oldSnap);else if(type==Change_1.Change.CHILD_CHANGED&&oldType==Change_1.Change.CHILD_ADDED)this.changeMap_[childKey]=Change_1.Change.childAddedChange(childKey,change.snapshotNode);else{if(type!=Change_1.Change.CHILD_CHANGED||oldType!=Change_1.Change.CHILD_CHANGED)throw util_2.assertionError("Illegal combination of changes: "+change+" occurred after "+oldChange);this.changeMap_[childKey]=Change_1.Change.childChangedChange(childKey,change.snapshotNode,oldChange.oldSnap)}}else this.changeMap_[childKey]=change},ChildChangeAccumulator.prototype.getChanges=function(){return util_1.getValues(this.changeMap_)},ChildChangeAccumulator}();exports.ChildChangeAccumulator=ChildChangeAccumulator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var CacheNode_1=__webpack_require__(40),NoCompleteChildSource_=function(){function NoCompleteChildSource_(){}return NoCompleteChildSource_.prototype.getCompleteChild=function(childKey){return null},NoCompleteChildSource_.prototype.getChildAfterChild=function(index,child,reverse){return null},NoCompleteChildSource_}();exports.NoCompleteChildSource_=NoCompleteChildSource_,exports.NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;var WriteTreeCompleteChildSource=function(){function WriteTreeCompleteChildSource(writes_,viewCache_,optCompleteServerCache_){void 0===optCompleteServerCache_&&(optCompleteServerCache_=null),this.writes_=writes_,this.viewCache_=viewCache_,this.optCompleteServerCache_=optCompleteServerCache_}return WriteTreeCompleteChildSource.prototype.getCompleteChild=function(childKey){var node=this.viewCache_.getEventCache();if(node.isCompleteForChild(childKey))return node.getNode().getImmediateChild(childKey);var serverNode=null!=this.optCompleteServerCache_?new CacheNode_1.CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(childKey,serverNode)},WriteTreeCompleteChildSource.prototype.getChildAfterChild=function(index,child,reverse){var completeServerData=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),nodes=this.writes_.calcIndexedSlice(completeServerData,child,1,reverse,index);return 0===nodes.length?null:nodes[0]},WriteTreeCompleteChildSource}();exports.WriteTreeCompleteChildSource=WriteTreeCompleteChildSource},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Node_1=__webpack_require__(11),Change_1=__webpack_require__(24),util_1=__webpack_require__(0),EventGenerator=function(){function EventGenerator(query_){this.query_=query_,this.index_=this.query_.getQueryParams().getIndex()}return EventGenerator.prototype.generateEventsForChanges=function(changes,eventCache,eventRegistrations){var _this=this,events=[],moves=[];return changes.forEach(function(change){change.type===Change_1.Change.CHILD_CHANGED&&_this.index_.indexedValueChanged(change.oldSnap,change.snapshotNode)&&moves.push(Change_1.Change.childMovedChange(change.childName,change.snapshotNode))}),this.generateEventsForType_(events,Change_1.Change.CHILD_REMOVED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change_1.Change.CHILD_ADDED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change_1.Change.CHILD_MOVED,moves,eventRegistrations,eventCache),this.generateEventsForType_(events,Change_1.Change.CHILD_CHANGED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change_1.Change.VALUE,changes,eventRegistrations,eventCache),events},EventGenerator.prototype.generateEventsForType_=function(events,eventType,changes,registrations,eventCache){var _this=this,filteredChanges=changes.filter(function(change){return change.type===eventType});filteredChanges.sort(this.compareChanges_.bind(this)),filteredChanges.forEach(function(change){var materializedChange=_this.materializeSingleChange_(change,eventCache);registrations.forEach(function(registration){registration.respondsTo(change.type)&&events.push(registration.createEvent(materializedChange,_this.query_))})})},EventGenerator.prototype.materializeSingleChange_=function(change,eventCache){return"value"===change.type||"child_removed"===change.type?change:(change.prevName=eventCache.getPredecessorChildName(change.childName,change.snapshotNode,this.index_),change)},EventGenerator.prototype.compareChanges_=function(a,b){if(null==a.childName||null==b.childName)throw util_1.assertionError("Should only compare child_ events.");var aWrapped=new Node_1.NamedNode(a.childName,a.snapshotNode),bWrapped=new Node_1.NamedNode(b.childName,b.snapshotNode);return this.index_.compare(aWrapped,bWrapped)},EventGenerator}();exports.EventGenerator=EventGenerator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(0),Path_1=__webpack_require__(4),CompoundWrite_1=__webpack_require__(158),PriorityIndex_1=__webpack_require__(8),ChildrenNode_1=__webpack_require__(10),WriteTree=function(){function WriteTree(){this.visibleWrites_=CompoundWrite_1.CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return WriteTree.prototype.childWrites=function(path){return new WriteTreeRef(path,this)},WriteTree.prototype.addOverwrite=function(path,snap,writeId,visible){util_2.assert(writeId>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===visible&&(visible=!0),this.allWrites_.push({path:path,snap:snap,writeId:writeId,visible:visible}),visible&&(this.visibleWrites_=this.visibleWrites_.addWrite(path,snap)),this.lastWriteId_=writeId},WriteTree.prototype.addMerge=function(path,changedChildren,writeId){util_2.assert(writeId>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:path,children:changedChildren,writeId:writeId,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(path,changedChildren),this.lastWriteId_=writeId},WriteTree.prototype.getWrite=function(writeId){for(var i=0;i<this.allWrites_.length;i++){var record=this.allWrites_[i];if(record.writeId===writeId)return record}return null},WriteTree.prototype.removeWrite=function(writeId){var _this=this,idx=this.allWrites_.findIndex(function(s){return s.writeId===writeId});util_2.assert(idx>=0,"removeWrite called with nonexistent writeId.");var writeToRemove=this.allWrites_[idx];this.allWrites_.splice(idx,1);for(var removedWriteWasVisible=writeToRemove.visible,removedWriteOverlapsWithOtherWrites=!1,i=this.allWrites_.length-1;removedWriteWasVisible&&i>=0;){var currentWrite=this.allWrites_[i];currentWrite.visible&&(i>=idx&&this.recordContainsPath_(currentWrite,writeToRemove.path)?removedWriteWasVisible=!1:writeToRemove.path.contains(currentWrite.path)&&(removedWriteOverlapsWithOtherWrites=!0)),i--}if(removedWriteWasVisible){if(removedWriteOverlapsWithOtherWrites)return this.resetTree_(),!0;if(writeToRemove.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(writeToRemove.path);else{var children=writeToRemove.children;util_1.forEach(children,function(childName){_this.visibleWrites_=_this.visibleWrites_.removeWrite(writeToRemove.path.child(childName))})}return!0}return!1},WriteTree.prototype.getCompleteWriteData=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcCompleteEventCache=function(treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites){if(writeIdsToExclude||includeHiddenWrites){var merge=this.visibleWrites_.childCompoundWrite(treePath);if(!includeHiddenWrites&&merge.isEmpty())return completeServerCache;if(includeHiddenWrites||null!=completeServerCache||merge.hasCompleteWrite(Path_1.Path.Empty)){var filter=function(write){return(write.visible||includeHiddenWrites)&&(!writeIdsToExclude||!~writeIdsToExclude.indexOf(write.writeId))&&(write.path.contains(treePath)||treePath.contains(write.path))},mergeAtPath=WriteTree.layerTree_(this.allWrites_,filter,treePath),layeredCache=completeServerCache||ChildrenNode_1.ChildrenNode.EMPTY_NODE;return mergeAtPath.apply(layeredCache)}return null}var shadowingNode=this.visibleWrites_.getCompleteNode(treePath);if(null!=shadowingNode)return shadowingNode;var subMerge=this.visibleWrites_.childCompoundWrite(treePath);if(subMerge.isEmpty())return completeServerCache;if(null!=completeServerCache||subMerge.hasCompleteWrite(Path_1.Path.Empty)){var layeredCache=completeServerCache||ChildrenNode_1.ChildrenNode.EMPTY_NODE;return subMerge.apply(layeredCache)}return null},WriteTree.prototype.calcCompleteEventChildren=function(treePath,completeServerChildren){var completeChildren=ChildrenNode_1.ChildrenNode.EMPTY_NODE,topLevelSet=this.visibleWrites_.getCompleteNode(treePath);if(topLevelSet)return topLevelSet.isLeafNode()||topLevelSet.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childSnap){completeChildren=completeChildren.updateImmediateChild(childName,childSnap)}),completeChildren;if(completeServerChildren){var merge_1=this.visibleWrites_.childCompoundWrite(treePath);return completeServerChildren.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){var node=merge_1.childCompoundWrite(new Path_1.Path(childName)).apply(childNode);completeChildren=completeChildren.updateImmediateChild(childName,node)}),merge_1.getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)}),completeChildren}return this.visibleWrites_.childCompoundWrite(treePath).getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)}),completeChildren},WriteTree.prototype.calcEventCacheAfterServerOverwrite=function(treePath,childPath,existingEventSnap,existingServerSnap){util_2.assert(existingEventSnap||existingServerSnap,"Either existingEventSnap or existingServerSnap must exist");var path=treePath.child(childPath);if(this.visibleWrites_.hasCompleteWrite(path))return null;var childMerge=this.visibleWrites_.childCompoundWrite(path);return childMerge.isEmpty()?existingServerSnap.getChild(childPath):childMerge.apply(existingServerSnap.getChild(childPath))},WriteTree.prototype.calcCompleteChild=function(treePath,childKey,existingServerSnap){var path=treePath.child(childKey),shadowingNode=this.visibleWrites_.getCompleteNode(path);if(null!=shadowingNode)return shadowingNode;if(existingServerSnap.isCompleteForChild(childKey)){return this.visibleWrites_.childCompoundWrite(path).apply(existingServerSnap.getNode().getImmediateChild(childKey))}return null},WriteTree.prototype.shadowingWrite=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcIndexedSlice=function(treePath,completeServerData,startPost,count,reverse,index){var toIterate,merge=this.visibleWrites_.childCompoundWrite(treePath),shadowingNode=merge.getCompleteNode(Path_1.Path.Empty);if(null!=shadowingNode)toIterate=shadowingNode;else{if(null==completeServerData)return[];toIterate=merge.apply(completeServerData)}if(toIterate=toIterate.withIndex(index),toIterate.isEmpty()||toIterate.isLeafNode())return[];for(var nodes=[],cmp=index.getCompare(),iter=reverse?toIterate.getReverseIteratorFrom(startPost,index):toIterate.getIteratorFrom(startPost,index),next=iter.getNext();next&&nodes.length<count;)0!==cmp(next,startPost)&&nodes.push(next),next=iter.getNext();return nodes},WriteTree.prototype.recordContainsPath_=function(writeRecord,path){return writeRecord.snap?writeRecord.path.contains(path):!!util_1.findKey(writeRecord.children,function(childSnap,childName){return writeRecord.path.child(childName).contains(path)})},WriteTree.prototype.resetTree_=function(){this.visibleWrites_=WriteTree.layerTree_(this.allWrites_,WriteTree.DefaultFilter_,Path_1.Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},WriteTree.DefaultFilter_=function(write){return write.visible},WriteTree.layerTree_=function(writes,filter,treeRoot){for(var compoundWrite=CompoundWrite_1.CompoundWrite.Empty,i=0;i<writes.length;++i){var write=writes[i];if(filter(write)){var writePath=write.path,relativePath=void 0;if(write.snap)treeRoot.contains(writePath)?(relativePath=Path_1.Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrite(relativePath,write.snap)):writePath.contains(treeRoot)&&(relativePath=Path_1.Path.relativePath(writePath,treeRoot),compoundWrite=compoundWrite.addWrite(Path_1.Path.Empty,write.snap.getChild(relativePath)));else{if(!write.children)throw util_2.assertionError("WriteRecord should have .snap or .children");if(treeRoot.contains(writePath))relativePath=Path_1.Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrites(relativePath,write.children);else if(writePath.contains(treeRoot))if(relativePath=Path_1.Path.relativePath(writePath,treeRoot),relativePath.isEmpty())compoundWrite=compoundWrite.addWrites(Path_1.Path.Empty,write.children);else{var child=util_1.safeGet(write.children,relativePath.getFront());if(child){var deepNode=child.getChild(relativePath.popFront());compoundWrite=compoundWrite.addWrite(Path_1.Path.Empty,deepNode)}}}}}return compoundWrite},WriteTree}();exports.WriteTree=WriteTree;var WriteTreeRef=function(){function WriteTreeRef(path,writeTree){this.treePath_=path,this.writeTree_=writeTree}return WriteTreeRef.prototype.calcCompleteEventCache=function(completeServerCache,writeIdsToExclude,includeHiddenWrites){return this.writeTree_.calcCompleteEventCache(this.treePath_,completeServerCache,writeIdsToExclude,includeHiddenWrites)},WriteTreeRef.prototype.calcCompleteEventChildren=function(completeServerChildren){return this.writeTree_.calcCompleteEventChildren(this.treePath_,completeServerChildren)},WriteTreeRef.prototype.calcEventCacheAfterServerOverwrite=function(path,existingEventSnap,existingServerSnap){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,path,existingEventSnap,existingServerSnap)},WriteTreeRef.prototype.shadowingWrite=function(path){return this.writeTree_.shadowingWrite(this.treePath_.child(path))},WriteTreeRef.prototype.calcIndexedSlice=function(completeServerData,startPost,count,reverse,index){return this.writeTree_.calcIndexedSlice(this.treePath_,completeServerData,startPost,count,reverse,index)},WriteTreeRef.prototype.calcCompleteChild=function(childKey,existingServerCache){return this.writeTree_.calcCompleteChild(this.treePath_,childKey,existingServerCache)},WriteTreeRef.prototype.child=function(childName){return new WriteTreeRef(this.treePath_.child(childName),this.writeTree_)},WriteTreeRef}();exports.WriteTreeRef=WriteTreeRef},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ImmutableTree_1=__webpack_require__(49),Path_1=__webpack_require__(4),util_1=__webpack_require__(0),Node_1=__webpack_require__(11),PriorityIndex_1=__webpack_require__(8),util_2=__webpack_require__(0),CompoundWrite=function(){function CompoundWrite(writeTree_){this.writeTree_=writeTree_}return CompoundWrite.prototype.addWrite=function(path,node){if(path.isEmpty())return new CompoundWrite(new ImmutableTree_1.ImmutableTree(node));var rootmost=this.writeTree_.findRootMostValueAndPath(path);if(null!=rootmost){var rootMostPath=rootmost.path,value=rootmost.value,relativePath=Path_1.Path.relativePath(rootMostPath,path);return value=value.updateChild(relativePath,node),new CompoundWrite(this.writeTree_.set(rootMostPath,value))}var subtree=new ImmutableTree_1.ImmutableTree(node);return new CompoundWrite(this.writeTree_.setTree(path,subtree))},CompoundWrite.prototype.addWrites=function(path,updates){var newWrite=this;return util_1.forEach(updates,function(childKey,node){newWrite=newWrite.addWrite(path.child(childKey),node)}),newWrite},CompoundWrite.prototype.removeWrite=function(path){return path.isEmpty()?CompoundWrite.Empty:new CompoundWrite(this.writeTree_.setTree(path,ImmutableTree_1.ImmutableTree.Empty))},CompoundWrite.prototype.hasCompleteWrite=function(path){return null!=this.getCompleteNode(path)},CompoundWrite.prototype.getCompleteNode=function(path){var rootmost=this.writeTree_.findRootMostValueAndPath(path);return null!=rootmost?this.writeTree_.get(rootmost.path).getChild(Path_1.Path.relativePath(rootmost.path,path)):null},CompoundWrite.prototype.getCompleteChildren=function(){var children=[],node=this.writeTree_.value;return null!=node?node.isLeafNode()||node.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){children.push(new Node_1.NamedNode(childName,childNode))}):this.writeTree_.children.inorderTraversal(function(childName,childTree){null!=childTree.value&&children.push(new Node_1.NamedNode(childName,childTree.value))}),children},CompoundWrite.prototype.childCompoundWrite=function(path){if(path.isEmpty())return this;var shadowingNode=this.getCompleteNode(path);return new CompoundWrite(null!=shadowingNode?new ImmutableTree_1.ImmutableTree(shadowingNode):this.writeTree_.subtree(path))},CompoundWrite.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},CompoundWrite.prototype.apply=function(node){return CompoundWrite.applySubtreeWrite_(Path_1.Path.Empty,this.writeTree_,node)},CompoundWrite.Empty=new CompoundWrite(new ImmutableTree_1.ImmutableTree(null)),CompoundWrite.applySubtreeWrite_=function(relativePath,writeTree,node){if(null!=writeTree.value)return node.updateChild(relativePath,writeTree.value);var priorityWrite_1=null;return writeTree.children.inorderTraversal(function(childKey,childTree){".priority"===childKey?(util_2.assert(null!==childTree.value,"Priority writes must always be leaf nodes"),priorityWrite_1=childTree.value):node=CompoundWrite.applySubtreeWrite_(relativePath.child(childKey),childTree,node)}),node.getChild(relativePath).isEmpty()||null===priorityWrite_1||(node=node.updateChild(relativePath.child(".priority"),priorityWrite_1)),node},CompoundWrite}();exports.CompoundWrite=CompoundWrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ChildrenNode_1=__webpack_require__(10),SnapshotHolder=function(){function SnapshotHolder(){this.rootNode_=ChildrenNode_1.ChildrenNode.EMPTY_NODE}return SnapshotHolder.prototype.getNode=function(path){return this.rootNode_.getChild(path)},SnapshotHolder.prototype.updateSnapshot=function(path,newSnapshotNode){this.rootNode_=this.rootNode_.updateChild(path,newSnapshotNode)},SnapshotHolder}();exports.SnapshotHolder=SnapshotHolder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),AuthTokenProvider=function(){function AuthTokenProvider(app_){this.app_=app_}return AuthTokenProvider.prototype.getToken=function(forceRefresh){return this.app_.INTERNAL.getToken(forceRefresh).then(null,function(error){return error&&"auth/token-not-initialized"===error.code?(util_1.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(error)})},AuthTokenProvider.prototype.addTokenChangeListener=function(listener){this.app_.INTERNAL.addAuthTokenListener(listener)},AuthTokenProvider.prototype.removeTokenChangeListener=function(listener){this.app_.INTERNAL.removeAuthTokenListener(listener)},AuthTokenProvider.prototype.notifyForInvalidToken=function(){var errorMessage='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?errorMessage+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?errorMessage+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':errorMessage+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',util_1.warn(errorMessage)},AuthTokenProvider}();exports.AuthTokenProvider=AuthTokenProvider},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(0),StatsCollection=function(){function StatsCollection(){this.counters_={}}return StatsCollection.prototype.incrementCounter=function(name,amount){void 0===amount&&(amount=1),util_2.contains(this.counters_,name)||(this.counters_[name]=0),this.counters_[name]+=amount},StatsCollection.prototype.get=function(){return util_1.deepCopy(this.counters_)},StatsCollection}();exports.StatsCollection=StatsCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(1),StatsListener_1=__webpack_require__(83),FIRST_STATS_MIN_TIME=1e4,FIRST_STATS_MAX_TIME=3e4,StatsReporter=function(){function StatsReporter(collection,server_){this.server_=server_,this.statsToReport_={},this.statsListener_=new StatsListener_1.StatsListener(collection);var timeout=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();util_2.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(timeout))}return StatsReporter.prototype.includeStat=function(stat){this.statsToReport_[stat]=!0},StatsReporter.prototype.reportStats_=function(){var _this=this,stats=this.statsListener_.get(),reportedStats={},haveStatsToReport=!1;util_1.forEach(stats,function(stat,value){value>0&&util_1.contains(_this.statsToReport_,stat)&&(reportedStats[stat]=value,haveStatsToReport=!0)}),haveStatsToReport&&this.server_.reportStats(reportedStats),util_2.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},StatsReporter}();exports.StatsReporter=StatsReporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),EventQueue=function(){function EventQueue(){this.eventLists_=[],this.recursionDepth_=0}return EventQueue.prototype.queueEvents=function(eventDataList){for(var currList=null,i=0;i<eventDataList.length;i++){var eventData=eventDataList[i],eventPath=eventData.getPath();null===currList||eventPath.equals(currList.getPath())||(this.eventLists_.push(currList),currList=null),null===currList&&(currList=new EventList(eventPath)),currList.add(eventData)}currList&&this.eventLists_.push(currList)},EventQueue.prototype.raiseEventsAtPath=function(path,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.equals(path)})},EventQueue.prototype.raiseEventsForChangedPath=function(changedPath,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.contains(changedPath)||changedPath.contains(eventPath)})},EventQueue.prototype.raiseQueuedEventsMatchingPredicate_=function(predicate){this.recursionDepth_++;for(var sentAll=!0,i=0;i<this.eventLists_.length;i++){var eventList=this.eventLists_[i];if(eventList){predicate(eventList.getPath())?(this.eventLists_[i].raise(),this.eventLists_[i]=null):sentAll=!1}}sentAll&&(this.eventLists_=[]),this.recursionDepth_--},EventQueue}();exports.EventQueue=EventQueue;var EventList=function(){function EventList(path_){this.path_=path_,this.events_=[]}return EventList.prototype.add=function(eventData){this.events_.push(eventData)},EventList.prototype.raise=function(){for(var i=0;i<this.events_.length;i++){var eventData=this.events_[i];if(null!==eventData){this.events_[i]=null;var eventFn=eventData.getEventRunner();util_1.logger&&util_1.log("event: "+eventData.toString()),util_1.exceptionGuard(eventFn)}}},EventList.prototype.getPath=function(){return this.path_},EventList}();exports.EventList=EventList},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var EventEmitter_1=__webpack_require__(85),util_1=__webpack_require__(0),VisibilityMonitor=function(_super){function VisibilityMonitor(){var hidden,visibilityChange,_this=_super.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(visibilityChange="visibilitychange",hidden="hidden"):void 0!==document.mozHidden?(visibilityChange="mozvisibilitychange",hidden="mozHidden"):void 0!==document.msHidden?(visibilityChange="msvisibilitychange",hidden="msHidden"):void 0!==document.webkitHidden&&(visibilityChange="webkitvisibilitychange",hidden="webkitHidden")),_this.visible_=!0,visibilityChange&&document.addEventListener(visibilityChange,function(){var visible=!document[hidden];visible!==_this.visible_&&(_this.visible_=visible,_this.trigger("visible",visible))},!1),_this}return __extends(VisibilityMonitor,_super),VisibilityMonitor.getInstance=function(){return new VisibilityMonitor},VisibilityMonitor.prototype.getInitialEvent=function(eventType){return util_1.assert("visible"===eventType,"Unknown event type: "+eventType),[this.visible_]},VisibilityMonitor}(EventEmitter_1.EventEmitter);exports.VisibilityMonitor=VisibilityMonitor},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),EventEmitter_1=__webpack_require__(85),util_2=__webpack_require__(0),OnlineMonitor=function(_super){function OnlineMonitor(){var _this=_super.call(this,["online"])||this;return _this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||util_2.isMobileCordova()||(window.addEventListener("online",function(){_this.online_||(_this.online_=!0,_this.trigger("online",!0))},!1),window.addEventListener("offline",function(){_this.online_&&(_this.online_=!1,_this.trigger("online",!1))},!1)),_this}return __extends(OnlineMonitor,_super),OnlineMonitor.getInstance=function(){return new OnlineMonitor},OnlineMonitor.prototype.getInitialEvent=function(eventType){return util_1.assert("online"===eventType,"Unknown event type: "+eventType),[this.online_]},OnlineMonitor.prototype.currentlyOnline=function(){return this.online_},OnlineMonitor}(EventEmitter_1.EventEmitter);exports.OnlineMonitor=OnlineMonitor},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BrowserPollConnection_1=__webpack_require__(87),WebSocketConnection_1=__webpack_require__(88),util_1=__webpack_require__(1),TransportManager=function(){function TransportManager(repoInfo){this.initTransports_(repoInfo)}return Object.defineProperty(TransportManager,"ALL_TRANSPORTS",{get:function(){return[BrowserPollConnection_1.BrowserPollConnection,WebSocketConnection_1.WebSocketConnection]},enumerable:!0,configurable:!0}),TransportManager.prototype.initTransports_=function(repoInfo){var isWebSocketsAvailable=WebSocketConnection_1.WebSocketConnection&&WebSocketConnection_1.WebSocketConnection.isAvailable(),isSkipPollConnection=isWebSocketsAvailable&&!WebSocketConnection_1.WebSocketConnection.previouslyFailed();if(repoInfo.webSocketOnly&&(isWebSocketsAvailable||util_1.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),isSkipPollConnection=!0),isSkipPollConnection)this.transports_=[WebSocketConnection_1.WebSocketConnection];else{var transports_1=this.transports_=[];util_1.each(TransportManager.ALL_TRANSPORTS,function(i,transport){transport&&transport.isAvailable()&&transports_1.push(transport)})}},TransportManager.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},TransportManager.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},TransportManager}();exports.TransportManager=TransportManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(1),PacketReceiver=function(){function PacketReceiver(onMessage_){this.onMessage_=onMessage_,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return PacketReceiver.prototype.closeAfter=function(responseNum,callback){this.closeAfterResponse=responseNum,this.onClose=callback,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},PacketReceiver.prototype.handleResponse=function(requestNum,data){var _this=this;this.pendingResponses[requestNum]=data;for(var this_1=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var toProcess=this_1.pendingResponses[this_1.currentResponseNum];delete this_1.pendingResponses[this_1.currentResponseNum];for(var i=0;i<toProcess.length;++i)!function(i){toProcess[i]&&util_1.exceptionGuard(function(){_this.onMessage_(toProcess[i])})}(i);if(this_1.currentResponseNum===this_1.closeAfterResponse)return this_1.onClose&&(this_1.onClose(),this_1.onClose=null),"break";this_1.currentResponseNum++}())break}},PacketReceiver}();exports.PacketReceiver=PacketReceiver},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(1),util_3=__webpack_require__(0),util_4=__webpack_require__(0),util_5=__webpack_require__(0),ServerActions_1=__webpack_require__(89),ReadonlyRestClient=function(_super){function ReadonlyRestClient(repoInfo_,onDataUpdate_,authTokenProvider_){var _this=_super.call(this)||this;return _this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.log_=util_2.logWrapper("p:rest:"),_this.listens_={},_this}return __extends(ReadonlyRestClient,_super),ReadonlyRestClient.prototype.reportStats=function(stats){throw new Error("Method not implemented.")},ReadonlyRestClient.getListenId_=function(query,tag){return void 0!==tag?"tag$"+tag:(util_1.assert(query.getQueryParams().isDefault(),"should have a tag if it's not a default query."),query.path.toString())},ReadonlyRestClient.prototype.listen=function(query,currentHashFn,tag,onComplete){var _this=this,pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+query.queryIdentifier());var listenId=ReadonlyRestClient.getListenId_(query,tag),thisListen={};this.listens_[listenId]=thisListen;var queryStringParamaters=query.getQueryParams().toRestQueryStringParameters();this.restRequest_(pathString+".json",queryStringParamaters,function(error,result){var data=result;if(404===error&&(data=null,error=null),null===error&&_this.onDataUpdate_(pathString,data,!1,tag),util_4.safeGet(_this.listens_,listenId)===thisListen){var status_1;status_1=error?401==error?"permission_denied":"rest_error:"+error:"ok",onComplete(status_1,null)}})},ReadonlyRestClient.prototype.unlisten=function(query,tag){var listenId=ReadonlyRestClient.getListenId_(query,tag);delete this.listens_[listenId]},ReadonlyRestClient.prototype.refreshAuthToken=function(token){},ReadonlyRestClient.prototype.restRequest_=function(pathString,queryStringParameters,callback){var _this=this;void 0===queryStringParameters&&(queryStringParameters={}),queryStringParameters.format="export",this.authTokenProvider_.getToken(!1).then(function(authTokenData){var authToken=authTokenData&&authTokenData.accessToken;authToken&&(queryStringParameters.auth=authToken);var url=(_this.repoInfo_.secure?"https://":"http://")+_this.repoInfo_.host+pathString+"?"+util_5.querystring(queryStringParameters);_this.log_("Sending REST request for "+url);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(callback&&4===xhr.readyState){_this.log_("REST Response for "+url+" received. status:",xhr.status,"response:",xhr.responseText);var res=null;if(xhr.status>=200&&xhr.status<300){try{res=util_3.jsonEval(xhr.responseText)}catch(e){util_2.warn("Failed to parse JSON response for "+url+": "+xhr.responseText)}callback(null,res)}else 401!==xhr.status&&404!==xhr.status&&util_2.warn("Got unsuccessful REST response for "+url+" Status: "+xhr.status),callback(xhr.status);callback=null}},xhr.open("GET",url,!0),xhr.send()})},ReadonlyRestClient}(ServerActions_1.ServerActions);exports.ReadonlyRestClient=ReadonlyRestClient},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),util_2=__webpack_require__(1),KeyIndex_1=__webpack_require__(28),PriorityIndex_1=__webpack_require__(8),ValueIndex_1=__webpack_require__(72),PathIndex_1=__webpack_require__(76),IndexedFilter_1=__webpack_require__(50),LimitedFilter_1=__webpack_require__(170),RangedFilter_1=__webpack_require__(90),util_3=__webpack_require__(0),QueryParams=function(){function QueryParams(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PriorityIndex_1.PRIORITY_INDEX}return QueryParams.prototype.hasStart=function(){return this.startSet_},QueryParams.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},QueryParams.prototype.getIndexStartValue=function(){return util_1.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},QueryParams.prototype.getIndexStartName=function(){return util_1.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:util_2.MIN_NAME},QueryParams.prototype.hasEnd=function(){return this.endSet_},QueryParams.prototype.getIndexEndValue=function(){return util_1.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},QueryParams.prototype.getIndexEndName=function(){return util_1.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:util_2.MAX_NAME},QueryParams.prototype.hasLimit=function(){return this.limitSet_},QueryParams.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},QueryParams.prototype.getLimit=function(){return util_1.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},QueryParams.prototype.getIndex=function(){return this.index_},QueryParams.prototype.copy_=function(){var copy=new QueryParams;return copy.limitSet_=this.limitSet_,copy.limit_=this.limit_,copy.startSet_=this.startSet_,copy.indexStartValue_=this.indexStartValue_,copy.startNameSet_=this.startNameSet_,copy.indexStartName_=this.indexStartName_,copy.endSet_=this.endSet_,copy.indexEndValue_=this.indexEndValue_,copy.endNameSet_=this.endNameSet_,copy.indexEndName_=this.indexEndName_,copy.index_=this.index_,copy.viewFrom_=this.viewFrom_,copy},QueryParams.prototype.limit=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_="",newParams},QueryParams.prototype.limitToFirst=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,newParams},QueryParams.prototype.limitToLast=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,newParams},QueryParams.prototype.startAt=function(indexValue,key){var newParams=this.copy_();return newParams.startSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexStartValue_=indexValue,null!=key?(newParams.startNameSet_=!0,newParams.indexStartName_=key):(newParams.startNameSet_=!1,newParams.indexStartName_=""),newParams},QueryParams.prototype.endAt=function(indexValue,key){var newParams=this.copy_();return newParams.endSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexEndValue_=indexValue,void 0!==key?(newParams.endNameSet_=!0,newParams.indexEndName_=key):(newParams.endNameSet_=!1,newParams.indexEndName_=""),newParams},QueryParams.prototype.orderBy=function(index){var newParams=this.copy_();return newParams.index_=index,newParams},QueryParams.prototype.getQueryObject=function(){var WIRE_PROTOCOL_CONSTANTS=QueryParams.WIRE_PROTOCOL_CONSTANTS_,obj={};if(this.startSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){obj[WIRE_PROTOCOL_CONSTANTS.LIMIT]=this.limit_;var viewFrom=this.viewFrom_;""===viewFrom&&(viewFrom=this.isViewFromLeft()?WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT:WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT),obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM]=viewFrom}return this.index_!==PriorityIndex_1.PRIORITY_INDEX&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX]=this.index_.toString()),obj},QueryParams.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},QueryParams.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==PriorityIndex_1.PRIORITY_INDEX},QueryParams.prototype.getNodeFilter=function(){return this.loadsAllData()?new IndexedFilter_1.IndexedFilter(this.getIndex()):this.hasLimit()?new LimitedFilter_1.LimitedFilter(this):new RangedFilter_1.RangedFilter(this)},QueryParams.prototype.toRestQueryStringParameters=function(){var REST_CONSTANTS=QueryParams.REST_QUERY_CONSTANTS_,qs={};if(this.isDefault())return qs;var orderBy;return this.index_===PriorityIndex_1.PRIORITY_INDEX?orderBy=REST_CONSTANTS.PRIORITY_INDEX:this.index_===ValueIndex_1.VALUE_INDEX?orderBy=REST_CONSTANTS.VALUE_INDEX:this.index_===KeyIndex_1.KEY_INDEX?orderBy=REST_CONSTANTS.KEY_INDEX:(util_1.assert(this.index_ instanceof PathIndex_1.PathIndex,"Unrecognized index type!"),orderBy=this.index_.toString()),qs[REST_CONSTANTS.ORDER_BY]=util_3.stringify(orderBy),this.startSet_&&(qs[REST_CONSTANTS.START_AT]=util_3.stringify(this.indexStartValue_),this.startNameSet_&&(qs[REST_CONSTANTS.START_AT]+=","+util_3.stringify(this.indexStartName_))),this.endSet_&&(qs[REST_CONSTANTS.END_AT]=util_3.stringify(this.indexEndValue_),this.endNameSet_&&(qs[REST_CONSTANTS.END_AT]+=","+util_3.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?qs[REST_CONSTANTS.LIMIT_TO_FIRST]=this.limit_:qs[REST_CONSTANTS.LIMIT_TO_LAST]=this.limit_),qs},QueryParams.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},QueryParams.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},QueryParams.DEFAULT=new QueryParams,QueryParams}();exports.QueryParams=QueryParams},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var RangedFilter_1=__webpack_require__(90),ChildrenNode_1=__webpack_require__(10),Node_1=__webpack_require__(11),util_1=__webpack_require__(0),Change_1=__webpack_require__(24),LimitedFilter=function(){function LimitedFilter(params){this.rangedFilter_=new RangedFilter_1.RangedFilter(params),this.index_=params.getIndex(),this.limit_=params.getLimit(),this.reverse_=!params.isViewFromLeft()}return LimitedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.rangedFilter_.matches(new Node_1.NamedNode(key,newChild))||(newChild=ChildrenNode_1.ChildrenNode.EMPTY_NODE),snap.getImmediateChild(key).equals(newChild)?snap:snap.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator):this.fullLimitUpdateChild_(snap,key,newChild,source,optChangeAccumulator)},LimitedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){var filtered;if(newSnap.isLeafNode()||newSnap.isEmpty())filtered=ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<newSnap.numChildren()&&newSnap.isIndexed(this.index_)){filtered=ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var iterator=void 0;iterator=this.reverse_?newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var count=0;iterator.hasNext()&&count<this.limit_;){var next=iterator.getNext(),inRange=void 0;if(!(inRange=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),next)<=0:this.index_.compare(next,this.rangedFilter_.getEndPost())<=0))break;filtered=filtered.updateImmediateChild(next.name,next.node),count++}}else{filtered=newSnap.withIndex(this.index_),filtered=filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);var startPost=void 0,endPost=void 0,cmp=void 0,iterator=void 0;if(this.reverse_){iterator=filtered.getReverseIterator(this.index_),startPost=this.rangedFilter_.getEndPost(),endPost=this.rangedFilter_.getStartPost();var indexCompare_1=this.index_.getCompare();cmp=function(a,b){return indexCompare_1(b,a)}}else iterator=filtered.getIterator(this.index_),startPost=this.rangedFilter_.getStartPost(),endPost=this.rangedFilter_.getEndPost(),cmp=this.index_.getCompare();for(var count=0,foundStartPost=!1;iterator.hasNext();){var next=iterator.getNext();!foundStartPost&&cmp(startPost,next)<=0&&(foundStartPost=!0);var inRange=foundStartPost&&count<this.limit_&&cmp(next,endPost)<=0;inRange?count++:filtered=filtered.updateImmediateChild(next.name,ChildrenNode_1.ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(oldSnap,filtered,optChangeAccumulator)},LimitedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},LimitedFilter.prototype.filtersNodes=function(){return!0},LimitedFilter.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},LimitedFilter.prototype.getIndex=function(){return this.index_},LimitedFilter.prototype.fullLimitUpdateChild_=function(snap,childKey,childSnap,source,changeAccumulator){var cmp;if(this.reverse_){var indexCmp_1=this.index_.getCompare();cmp=function(a,b){return indexCmp_1(b,a)}}else cmp=this.index_.getCompare();var oldEventCache=snap;util_1.assert(oldEventCache.numChildren()==this.limit_,"");var newChildNamedNode=new Node_1.NamedNode(childKey,childSnap),windowBoundary=this.reverse_?oldEventCache.getFirstChild(this.index_):oldEventCache.getLastChild(this.index_),inRange=this.rangedFilter_.matches(newChildNamedNode);if(oldEventCache.hasChild(childKey)){for(var oldChildSnap=oldEventCache.getImmediateChild(childKey),nextChild=source.getChildAfterChild(this.index_,windowBoundary,this.reverse_);null!=nextChild&&(nextChild.name==childKey||oldEventCache.hasChild(nextChild.name));)nextChild=source.getChildAfterChild(this.index_,nextChild,this.reverse_);var compareNext=null==nextChild?1:cmp(nextChild,newChildNamedNode);if(inRange&&!childSnap.isEmpty()&&compareNext>=0)return null!=changeAccumulator&&changeAccumulator.trackChildChange(Change_1.Change.childChangedChange(childKey,childSnap,oldChildSnap)),oldEventCache.updateImmediateChild(childKey,childSnap);null!=changeAccumulator&&changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(childKey,oldChildSnap));var newEventCache=oldEventCache.updateImmediateChild(childKey,ChildrenNode_1.ChildrenNode.EMPTY_NODE);return null!=nextChild&&this.rangedFilter_.matches(nextChild)?(null!=changeAccumulator&&changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(nextChild.name,nextChild.node)),newEventCache.updateImmediateChild(nextChild.name,nextChild.node)):newEventCache}return childSnap.isEmpty()?snap:inRange&&cmp(windowBoundary,newChildNamedNode)>=0?(null!=changeAccumulator&&(changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(windowBoundary.name,windowBoundary.node)),changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(childKey,childSnap))),oldEventCache.updateImmediateChild(childKey,childSnap).updateImmediateChild(windowBoundary.name,ChildrenNode_1.ChildrenNode.EMPTY_NODE)):snap},LimitedFilter}();exports.LimitedFilter=LimitedFilter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var TransactionStatus,util_1=__webpack_require__(0),Reference_1=__webpack_require__(47),DataSnapshot_1=__webpack_require__(48),Path_1=__webpack_require__(4),Tree_1=__webpack_require__(172),PriorityIndex_1=__webpack_require__(8),util_2=__webpack_require__(1),ServerValues_1=__webpack_require__(77),validation_1=__webpack_require__(19),util_3=__webpack_require__(0),nodeFromJSON_1=__webpack_require__(29),ChildrenNode_1=__webpack_require__(10),Repo_1=__webpack_require__(39);!function(TransactionStatus){TransactionStatus[TransactionStatus.RUN=0]="RUN",TransactionStatus[TransactionStatus.SENT=1]="SENT",TransactionStatus[TransactionStatus.COMPLETED=2]="COMPLETED",TransactionStatus[TransactionStatus.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",TransactionStatus[TransactionStatus.NEEDS_ABORT=4]="NEEDS_ABORT"}(TransactionStatus=exports.TransactionStatus||(exports.TransactionStatus={})),Repo_1.Repo.MAX_TRANSACTION_RETRIES_=25,Repo_1.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new Tree_1.Tree},Repo_1.Repo.prototype.startTransaction=function(path,transactionUpdate,onComplete,applyLocally){this.log_("transaction on "+path);var valueCallback=function(){},watchRef=new Reference_1.Reference(this,path);watchRef.on("value",valueCallback);var unwatcher=function(){watchRef.off("value",valueCallback)},transaction={path:path,update:transactionUpdate,onComplete:onComplete,status:null,order:util_2.LUIDGenerator(),applyLocally:applyLocally,retryCount:0,unwatcher:unwatcher,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},currentState=this.getLatestState_(path);transaction.currentInputSnapshot=currentState;var newVal=transaction.update(currentState.val());if(void 0===newVal){if(transaction.unwatcher(),transaction.currentOutputSnapshotRaw=null,transaction.currentOutputSnapshotResolved=null,transaction.onComplete){var snapshot=new DataSnapshot_1.DataSnapshot(transaction.currentInputSnapshot,new Reference_1.Reference(this,transaction.path),PriorityIndex_1.PRIORITY_INDEX);transaction.onComplete(null,!1,snapshot)}}else{validation_1.validateFirebaseData("transaction failed: Data returned ",newVal,transaction.path),transaction.status=TransactionStatus.RUN;var queueNode=this.transactionQueueTree_.subTree(path),nodeQueue=queueNode.getValue()||[];nodeQueue.push(transaction),queueNode.setValue(nodeQueue);var priorityForNode=void 0;if("object"==typeof newVal&&null!==newVal&&util_3.contains(newVal,".priority"))priorityForNode=util_3.safeGet(newVal,".priority"),util_1.assert(validation_1.isValidPriority(priorityForNode),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{priorityForNode=(this.serverSyncTree_.calcCompleteEventCache(path)||ChildrenNode_1.ChildrenNode.EMPTY_NODE).getPriority().val()}priorityForNode=priorityForNode;var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(newVal,priorityForNode),newNode=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues);transaction.currentOutputSnapshotRaw=newNodeUnresolved,transaction.currentOutputSnapshotResolved=newNode,transaction.currentWriteId=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserOverwrite(path,newNode,transaction.currentWriteId,transaction.applyLocally);this.eventQueue_.raiseEventsForChangedPath(path,events),this.sendReadyTransactions_()}},Repo_1.Repo.prototype.getLatestState_=function(path,excludeSets){return this.serverSyncTree_.calcCompleteEventCache(path,excludeSets)||ChildrenNode_1.ChildrenNode.EMPTY_NODE},Repo_1.Repo.prototype.sendReadyTransactions_=function(node){var _this=this;if(void 0===node&&(node=this.transactionQueueTree_),node||this.pruneCompletedTransactionsBelowNode_(node),null!==node.getValue()){var queue=this.buildTransactionQueue_(node);util_1.assert(queue.length>0,"Sending zero length transaction queue");queue.every(function(transaction){return transaction.status===TransactionStatus.RUN})&&this.sendTransactionQueue_(node.path(),queue)}else node.hasChildren()&&node.forEachChild(function(childNode){_this.sendReadyTransactions_(childNode)})},Repo_1.Repo.prototype.sendTransactionQueue_=function(path,queue){for(var _this=this,setsToIgnore=queue.map(function(txn){return txn.currentWriteId}),latestState=this.getLatestState_(path,setsToIgnore),snapToSend=latestState,latestHash=latestState.hash(),i=0;i<queue.length;i++){var txn=queue[i];util_1.assert(txn.status===TransactionStatus.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),txn.status=TransactionStatus.SENT,txn.retryCount++;var relativePath=Path_1.Path.relativePath(path,txn.path);snapToSend=snapToSend.updateChild(relativePath,txn.currentOutputSnapshotRaw)}var dataToSend=snapToSend.val(!0),pathToSend=path;this.server_.put(pathToSend.toString(),dataToSend,function(status){_this.log_("transaction put response",{path:pathToSend.toString(),status:status});var events=[];if("ok"===status){for(var callbacks=[],i=0;i<queue.length;i++){if(queue[i].status=TransactionStatus.COMPLETED,events=events.concat(_this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId)),queue[i].onComplete){var node=queue[i].currentOutputSnapshotResolved,ref=new Reference_1.Reference(_this,queue[i].path),snapshot=new DataSnapshot_1.DataSnapshot(node,ref,PriorityIndex_1.PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!0,snapshot))}queue[i].unwatcher()}_this.pruneCompletedTransactionsBelowNode_(_this.transactionQueueTree_.subTree(path)),_this.sendReadyTransactions_(),_this.eventQueue_.raiseEventsForChangedPath(path,events);for(var i=0;i<callbacks.length;i++)util_2.exceptionGuard(callbacks[i])}else{if("datastale"===status)for(var i=0;i<queue.length;i++)queue[i].status===TransactionStatus.SENT_NEEDS_ABORT?queue[i].status=TransactionStatus.NEEDS_ABORT:queue[i].status=TransactionStatus.RUN;else{util_2.warn("transaction at "+pathToSend.toString()+" failed: "+status);for(var i=0;i<queue.length;i++)queue[i].status=TransactionStatus.NEEDS_ABORT,queue[i].abortReason=status}_this.rerunTransactions_(path)}},latestHash)},Repo_1.Repo.prototype.rerunTransactions_=function(changedPath){var rootMostTransactionNode=this.getAncestorTransactionNode_(changedPath),path=rootMostTransactionNode.path(),queue=this.buildTransactionQueue_(rootMostTransactionNode);return this.rerunTransactionQueue_(queue,path),path},Repo_1.Repo.prototype.rerunTransactionQueue_=function(queue,path){if(0!==queue.length){for(var callbacks=[],events=[],txnsToRerun=queue.filter(function(q){return q.status===TransactionStatus.RUN}),setsToIgnore=txnsToRerun.map(function(q){return q.currentWriteId}),i=0;i<queue.length;i++){var transaction=queue[i],relativePath=Path_1.Path.relativePath(path,transaction.path),abortTransaction=!1,abortReason=void 0;if(util_1.assert(null!==relativePath,"rerunTransactionsUnderNode_: relativePath should not be null."),transaction.status===TransactionStatus.NEEDS_ABORT)abortTransaction=!0,abortReason=transaction.abortReason,events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else if(transaction.status===TransactionStatus.RUN)if(transaction.retryCount>=Repo_1.Repo.MAX_TRANSACTION_RETRIES_)abortTransaction=!0,abortReason="maxretry",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else{var currentNode=this.getLatestState_(transaction.path,setsToIgnore);transaction.currentInputSnapshot=currentNode;var newData=queue[i].update(currentNode.val());if(void 0!==newData){validation_1.validateFirebaseData("transaction failed: Data returned ",newData,transaction.path);var newDataNode=nodeFromJSON_1.nodeFromJSON(newData),hasExplicitPriority="object"==typeof newData&&null!=newData&&util_3.contains(newData,".priority");hasExplicitPriority||(newDataNode=newDataNode.updatePriority(currentNode.getPriority()));var oldWriteId=transaction.currentWriteId,serverValues=this.generateServerValues(),newNodeResolved=ServerValues_1.resolveDeferredValueSnapshot(newDataNode,serverValues);transaction.currentOutputSnapshotRaw=newDataNode,transaction.currentOutputSnapshotResolved=newNodeResolved,transaction.currentWriteId=this.getNextWriteId_(),setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId),1),events=events.concat(this.serverSyncTree_.applyUserOverwrite(transaction.path,newNodeResolved,transaction.currentWriteId,transaction.applyLocally)),events=events.concat(this.serverSyncTree_.ackUserWrite(oldWriteId,!0))}else abortTransaction=!0,abortReason="nodata",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(path,events),events=[],abortTransaction&&(queue[i].status=TransactionStatus.COMPLETED,function(unwatcher){setTimeout(unwatcher,Math.floor(0))}(queue[i].unwatcher),queue[i].onComplete))if("nodata"===abortReason){var ref=new Reference_1.Reference(this,queue[i].path),lastInput=queue[i].currentInputSnapshot,snapshot=new DataSnapshot_1.DataSnapshot(lastInput,ref,PriorityIndex_1.PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!1,snapshot))}else callbacks.push(queue[i].onComplete.bind(null,new Error(abortReason),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var i=0;i<callbacks.length;i++)util_2.exceptionGuard(callbacks[i]);this.sendReadyTransactions_()}},Repo_1.Repo.prototype.getAncestorTransactionNode_=function(path){for(var front,transactionNode=this.transactionQueueTree_;null!==(front=path.getFront())&&null===transactionNode.getValue();)transactionNode=transactionNode.subTree(front),path=path.popFront();return transactionNode},Repo_1.Repo.prototype.buildTransactionQueue_=function(transactionNode){var transactionQueue=[];return this.aggregateTransactionQueuesForNode_(transactionNode,transactionQueue),transactionQueue.sort(function(a,b){return a.order-b.order}),transactionQueue},Repo_1.Repo.prototype.aggregateTransactionQueuesForNode_=function(node,queue){var _this=this,nodeQueue=node.getValue();if(null!==nodeQueue)for(var i=0;i<nodeQueue.length;i++)queue.push(nodeQueue[i]);node.forEachChild(function(child){_this.aggregateTransactionQueuesForNode_(child,queue)})},Repo_1.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(node){var _this=this,queue=node.getValue();if(queue){for(var to=0,from=0;from<queue.length;from++)queue[from].status!==TransactionStatus.COMPLETED&&(queue[to]=queue[from],to++);queue.length=to,node.setValue(queue.length>0?queue:null)}node.forEachChild(function(childNode){_this.pruneCompletedTransactionsBelowNode_(childNode)})},Repo_1.Repo.prototype.abortTransactions_=function(path){var _this=this,affectedPath=this.getAncestorTransactionNode_(path).path(),transactionNode=this.transactionQueueTree_.subTree(path);return transactionNode.forEachAncestor(function(node){_this.abortTransactionsOnNode_(node)}),this.abortTransactionsOnNode_(transactionNode),transactionNode.forEachDescendant(function(node){_this.abortTransactionsOnNode_(node)}),affectedPath},Repo_1.Repo.prototype.abortTransactionsOnNode_=function(node){var queue=node.getValue();if(null!==queue){for(var callbacks=[],events=[],lastSent=-1,i=0;i<queue.length;i++)if(queue[i].status===TransactionStatus.SENT_NEEDS_ABORT);else if(queue[i].status===TransactionStatus.SENT)util_1.assert(lastSent===i-1,"All SENT items should be at beginning of queue."),lastSent=i,queue[i].status=TransactionStatus.SENT_NEEDS_ABORT,queue[i].abortReason="set";else if(util_1.assert(queue[i].status===TransactionStatus.RUN,"Unexpected transaction status in abort"),queue[i].unwatcher(),events=events.concat(this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId,!0)),queue[i].onComplete){callbacks.push(queue[i].onComplete.bind(null,new Error("set"),!1,null))}-1===lastSent?node.setValue(null):queue.length=lastSent+1,this.eventQueue_.raiseEventsForChangedPath(node.path(),events);for(var i=0;i<callbacks.length;i++)util_2.exceptionGuard(callbacks[i])}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util_1=__webpack_require__(0),Path_1=__webpack_require__(4),util_2=__webpack_require__(0),TreeNode=function(){function TreeNode(){this.children={},this.childCount=0,this.value=null}return TreeNode}();exports.TreeNode=TreeNode;var Tree=function(){function Tree(name_,parent_,node_){void 0===name_&&(name_=""),void 0===parent_&&(parent_=null),void 0===node_&&(node_=new TreeNode),this.name_=name_,this.parent_=parent_,this.node_=node_}return Tree.prototype.subTree=function(pathObj){for(var next,path=pathObj instanceof Path_1.Path?pathObj:new Path_1.Path(pathObj),child=this;null!==(next=path.getFront());){child=new Tree(next,child,util_2.safeGet(child.node_.children,next)||new TreeNode),path=path.popFront()}return child},Tree.prototype.getValue=function(){return this.node_.value},Tree.prototype.setValue=function(value){util_1.assert(void 0!==value,"Cannot set value to undefined"),this.node_.value=value,this.updateParents_()},Tree.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},Tree.prototype.hasChildren=function(){return this.node_.childCount>0},Tree.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},Tree.prototype.forEachChild=function(action){var _this=this;util_2.forEach(this.node_.children,function(child,childTree){action(new Tree(child,_this,childTree))})},Tree.prototype.forEachDescendant=function(action,includeSelf,childrenFirst){includeSelf&&!childrenFirst&&action(this),this.forEachChild(function(child){child.forEachDescendant(action,!0,childrenFirst)}),includeSelf&&childrenFirst&&action(this)},Tree.prototype.forEachAncestor=function(action,includeSelf){for(var node=includeSelf?this:this.parent();null!==node;){if(action(node))return!0;node=node.parent()}return!1},Tree.prototype.forEachImmediateDescendantWithValue=function(action){this.forEachChild(function(child){null!==child.getValue()?action(child):child.forEachImmediateDescendantWithValue(action)})},Tree.prototype.path=function(){return new Path_1.Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},Tree.prototype.name=function(){return this.name_},Tree.prototype.parent=function(){return this.parent_},Tree.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},Tree.prototype.updateChild_=function(childName,child){var childEmpty=child.isEmpty(),childExists=util_2.contains(this.node_.children,childName);childEmpty&&childExists?(delete this.node_.children[childName],this.node_.childCount--,this.updateParents_()):childEmpty||childExists||(this.node_.children[childName]=child.node_,this.node_.childCount++,this.updateParents_())},Tree}();exports.Tree=Tree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var WebSocketConnection_1=__webpack_require__(88),BrowserPollConnection_1=__webpack_require__(87);exports.forceLongPolling=function(){WebSocketConnection_1.WebSocketConnection.forceDisallow(),BrowserPollConnection_1.BrowserPollConnection.forceAllow()},exports.forceWebSockets=function(){BrowserPollConnection_1.BrowserPollConnection.forceDisallow()},exports.isWebSocketsAvailable=function(){return WebSocketConnection_1.WebSocketConnection.isAvailable()},exports.setSecurityDebugCallback=function(ref,callback){ref.repo.persistentConnection_.securityDebugCallback_=callback},exports.stats=function(ref,showDelta){ref.repo.stats(showDelta)},exports.statsIncrementCounter=function(ref,metric){ref.repo.statsIncrementCounter(metric)},exports.dataUpdateCount=function(ref){return ref.repo.dataUpdateCount},exports.interceptServerData=function(ref,callback){return ref.repo.interceptServerData_(callback)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var RepoInfo_1=__webpack_require__(68),PersistentConnection_1=__webpack_require__(84),RepoManager_1=__webpack_require__(52),Connection_1=__webpack_require__(86);exports.DataConnection=PersistentConnection_1.PersistentConnection,PersistentConnection_1.PersistentConnection.prototype.simpleListen=function(pathString,onComplete){this.sendRequest("q",{p:pathString},onComplete)},PersistentConnection_1.PersistentConnection.prototype.echo=function(data,onEcho){this.sendRequest("echo",{d:data},onEcho)},exports.RealTimeConnection=Connection_1.Connection,exports.hijackHash=function(newHash){var oldPut=PersistentConnection_1.PersistentConnection.prototype.put;return PersistentConnection_1.PersistentConnection.prototype.put=function(pathString,data,opt_onComplete,opt_hash){void 0!==opt_hash&&(opt_hash=newHash()),oldPut.call(this,pathString,data,opt_onComplete,opt_hash)},function(){PersistentConnection_1.PersistentConnection.prototype.put=oldPut}},exports.ConnectionTarget=RepoInfo_1.RepoInfo,exports.queryIdentifier=function(query){return query.queryIdentifier()},exports.listens=function(firebaseRef){return firebaseRef.repo.persistentConnection_.listens_},exports.forceRestClient=function(forceRestClient){RepoManager_1.RepoManager.getInstance().forceRestClient(forceRestClient)}},function(module,exports,__webpack_require__){__webpack_require__(176)},function(module,__webpack_exports__,__webpack_require__){"use strict";function registerMessaging(instance){var factoryMethod=function(app){return self&&"ServiceWorkerGlobalScope"in self?new __WEBPACK_IMPORTED_MODULE_1__src_controllers_sw_controller__.a(app):new __WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__.a(app)},namespaceExports={Messaging:__WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__.a};instance.INTERNAL.registerService("messaging",factoryMethod,namespaceExports)}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_exports__.registerMessaging=registerMessaging;var __WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__=__webpack_require__(177),__WEBPACK_IMPORTED_MODULE_1__src_controllers_sw_controller__=__webpack_require__(181);registerMessaging(__webpack_require__(18).firebase)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__controller_interface__=__webpack_require__(91),__WEBPACK_IMPORTED_MODULE_1__models_errors__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__=__webpack_require__(94),__WEBPACK_IMPORTED_MODULE_3__models_default_sw__=__webpack_require__(180),__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__=__webpack_require__(93),__WEBPACK_IMPORTED_MODULE_5__firebase_util__=__webpack_require__(0),__extends=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__firebase_util__),this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}()),WindowController=function(_super){function WindowController(app){var _this=_super.call(this,app)||this;return _this.messageObserver_=null,_this.onMessage_=Object(__WEBPACK_IMPORTED_MODULE_5__firebase_util__.createSubscribe)(function(observer){_this.messageObserver_=observer}),_this.tokenRefreshObserver_=null,_this.onTokenRefresh_=Object(__WEBPACK_IMPORTED_MODULE_5__firebase_util__.createSubscribe)(function(observer){_this.tokenRefreshObserver_=observer}),_this.setupSWMessageListener_(),_this}return __extends(WindowController,_super),WindowController.prototype.getToken=function(){var _this=this;return this.isSupported_()?this.manifestCheck_().then(function(){return _super.prototype.getToken.call(_this)}):Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.UNSUPPORTED_BROWSER))},WindowController.prototype.manifestCheck_=function(){var _this=this;if(this.manifestCheckPromise_)return this.manifestCheckPromise_;var manifestTag=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise_=manifestTag?fetch(manifestTag.href).then(function(response){return response.json()}).catch(function(){return Promise.resolve()}).then(function(manifestContent){if(manifestContent&&manifestContent.gcm_sender_id&&"103953800507"!==manifestContent.gcm_sender_id)throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise_},WindowController.prototype.requestPermission=function(){var _this=this;return Notification.permission===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__.a.granted?Promise.resolve():new Promise(function(resolve,reject){var managePermissionResult=function(result){return result===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__.a.granted?resolve():reject(result===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__.a.denied?_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.PERMISSION_BLOCKED):_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.PERMISSION_DEFAULT))},permissionPromise=Notification.requestPermission(function(result){permissionPromise||managePermissionResult(result)});permissionPromise&&permissionPromise.then(managePermissionResult)})},WindowController.prototype.useServiceWorker=function(registration){if(!(registration instanceof ServiceWorkerRegistration))throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.registrationToUse_)throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse_=registration},WindowController.prototype.onMessage=function(nextOrObserver,optError,optCompleted){return this.onMessage_(nextOrObserver,optError,optCompleted)},WindowController.prototype.onTokenRefresh=function(nextOrObserver,optError,optCompleted){return this.onTokenRefresh_(nextOrObserver,optError,optCompleted)},WindowController.prototype.waitForRegistrationToActivate_=function(registration){var _this=this,serviceWorker=registration.installing||registration.waiting||registration.active;return new Promise(function(resolve,reject){if(!serviceWorker)return void reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.NO_SW_IN_REG));if("activated"===serviceWorker.state)return void resolve(registration);if("redundant"===serviceWorker.state)return void reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.SW_REG_REDUNDANT));var stateChangeListener=function(){if("activated"===serviceWorker.state)resolve(registration);else{if("redundant"!==serviceWorker.state)return;reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.SW_REG_REDUNDANT))}serviceWorker.removeEventListener("statechange",stateChangeListener)};serviceWorker.addEventListener("statechange",stateChangeListener)})},WindowController.prototype.getSWRegistration_=function(){var _this=this;return this.registrationToUse_?this.waitForRegistrationToActivate_(this.registrationToUse_):(this.registrationToUse_=null,navigator.serviceWorker.register(__WEBPACK_IMPORTED_MODULE_3__models_default_sw__.a.path,{scope:__WEBPACK_IMPORTED_MODULE_3__models_default_sw__.a.scope}).catch(function(err){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:err.message})}).then(function(registration){return _this.waitForRegistrationToActivate_(registration).then(function(){return _this.registrationToUse_=registration,registration.update(),registration})}))},WindowController.prototype.setupSWMessageListener_=function(){var _this=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(event){if(event.data&&event.data[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.PARAMS.TYPE_OF_MSG]){var workerPageMessage=event.data;switch(workerPageMessage[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.PARAMS.TYPE_OF_MSG]){case __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.TYPES_OF_MSG.NOTIFICATION_CLICKED:var pushMessage=workerPageMessage[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.PARAMS.DATA];_this.messageObserver_.next(pushMessage)}}},!1)},WindowController.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},WindowController}(__WEBPACK_IMPORTED_MODULE_0__controller_interface__.a);__webpack_exports__.a=WindowController},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_1__errors__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__),__webpack_require__(41)),__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__=__webpack_require__(179),__WEBPACK_IMPORTED_MODULE_3__fcm_details__=__webpack_require__(92),FCM_TOKEN_OBJ_STORE="fcm_token_object_Store",TokenManager=function(){function TokenManager(){this.errorFactory_=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__.ErrorFactory("messaging","Messaging",__WEBPACK_IMPORTED_MODULE_1__errors__.a.map),this.openDbPromise_=null}return TokenManager.prototype.openDatabase_=function(){return this.openDbPromise_?this.openDbPromise_:(this.openDbPromise_=new Promise(function(resolve,reject){var request=indexedDB.open(TokenManager.DB_NAME,1);request.onerror=function(event){reject(event.target.error)},request.onsuccess=function(event){resolve(event.target.result)},request.onupgradeneeded=function(event){var db=event.target.result,objectStore=db.createObjectStore(FCM_TOKEN_OBJ_STORE,{keyPath:"swScope"});objectStore.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),objectStore.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.openDbPromise_)},TokenManager.prototype.closeDatabase=function(){var _this=this;return this.openDbPromise_?this.openDbPromise_.then(function(db){db.close(),_this.openDbPromise_=null}):Promise.resolve()},TokenManager.prototype.getTokenDetailsFromToken=function(fcmToken){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]),objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE),index=objectStore.index("fcmToken"),request=index.get(fcmToken);request.onerror=function(event){reject(event.target.error)},request.onsuccess=function(event){resolve(event.target.result)}})})},TokenManager.prototype.getTokenDetailsFromSWScope_=function(swScope){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]),objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE),scopeRequest=objectStore.get(swScope);scopeRequest.onerror=function(event){reject(event.target.error)},scopeRequest.onsuccess=function(event){resolve(event.target.result)}})})},TokenManager.prototype.getAllTokenDetailsForSenderId_=function(senderId){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]),objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE),senderIdTokens=[],cursorRequest=objectStore.openCursor();cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;cursor?(cursor.value.fcmSenderId===senderId&&senderIdTokens.push(cursor.value),cursor.continue()):resolve(senderIdTokens)}})})},TokenManager.prototype.subscribeToFCM=function(senderId,subscription,pushSet){var _this=this,p256dh=Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("p256dh")),auth=Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("auth")),fcmSubscribeBody="authorized_entity="+senderId+"&endpoint="+subscription.endpoint+"&encryption_key="+p256dh+"&encryption_auth="+auth;pushSet&&(fcmSubscribeBody+="&pushSet="+pushSet);var headers=new Headers;headers.append("Content-Type","application/x-www-form-urlencoded");var subscribeOptions={method:"POST",headers:headers,body:fcmSubscribeBody};return fetch(__WEBPACK_IMPORTED_MODULE_3__fcm_details__.a.ENDPOINT+"/fcm/connect/subscribe",subscribeOptions).then(function(response){return response.json()}).then(function(response){var fcmTokenResponse=response;if(fcmTokenResponse.error){var message=fcmTokenResponse.error.message;throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.TOKEN_SUBSCRIBE_FAILED,{message:message})}if(!fcmTokenResponse.token)throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!fcmTokenResponse.pushSet)throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:fcmTokenResponse.token,pushSet:fcmTokenResponse.pushSet}})},TokenManager.prototype.isSameSubscription_=function(subscription,masterTokenDetails){return subscription.endpoint===masterTokenDetails.endpoint&&Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("auth"))===masterTokenDetails.auth&&Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("p256dh"))===masterTokenDetails.p256dh},TokenManager.prototype.saveTokenDetails_=function(senderId,swRegistration,subscription,fcmToken,fcmPushSet){var details={swScope:swRegistration.scope,endpoint:subscription.endpoint,auth:Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("auth")),p256dh:Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__.a)(subscription.getKey("p256dh")),fcmToken:fcmToken,fcmPushSet:fcmPushSet,fcmSenderId:senderId};return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE],"readwrite"),objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE),request=objectStore.put(details);request.onerror=function(event){reject(event.target.error)},request.onsuccess=function(event){resolve()}})})},TokenManager.prototype.getSavedToken=function(senderId,swRegistration){var _this=this;return swRegistration instanceof ServiceWorkerRegistration?"string"!=typeof senderId||0===senderId.length?Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.BAD_SENDER_ID)):this.getAllTokenDetailsForSenderId_(senderId).then(function(allTokenDetails){if(0!==allTokenDetails.length){var index=allTokenDetails.findIndex(function(tokenDetails){return swRegistration.scope===tokenDetails.swScope&&senderId===tokenDetails.fcmSenderId});if(-1!==index)return allTokenDetails[index]}}).then(function(tokenDetails){if(tokenDetails)return swRegistration.pushManager.getSubscription().catch(function(err){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.GET_SUBSCRIPTION_FAILED)}).then(function(subscription){if(subscription&&_this.isSameSubscription_(subscription,tokenDetails))return tokenDetails.fcmToken})}):Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.SW_REGISTRATION_EXPECTED))},TokenManager.prototype.createToken=function(senderId,swRegistration){var _this=this;if("string"!=typeof senderId||0===senderId.length)return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.BAD_SENDER_ID));if(!(swRegistration instanceof ServiceWorkerRegistration))return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.SW_REGISTRATION_EXPECTED));var subscription,fcmTokenDetails;return swRegistration.pushManager.getSubscription().then(function(subscription){return subscription||swRegistration.pushManager.subscribe(__WEBPACK_IMPORTED_MODULE_3__fcm_details__.a.SUBSCRIPTION_OPTIONS)}).then(function(sub){return subscription=sub,_this.subscribeToFCM(senderId,subscription)}).then(function(tokenDetails){return fcmTokenDetails=tokenDetails,_this.saveTokenDetails_(senderId,swRegistration,subscription,fcmTokenDetails.token,fcmTokenDetails.pushSet)}).then(function(){return fcmTokenDetails.token})},TokenManager.prototype.deleteToken=function(token){var _this=this;return"string"!=typeof token||0===token.length?Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(token).then(function(details){if(!details)throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.DELETE_TOKEN_NOT_FOUND);return _this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE],"readwrite"),objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE),request=objectStore.delete(details.swScope);request.onerror=function(event){reject(event.target.error)},request.onsuccess=function(event){if(0===event.target.result)return void reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__.a.codes.FAILED_TO_DELETE_TOKEN));resolve(details)}})})})},TokenManager}();__webpack_exports__.a=TokenManager},function(module,__webpack_exports__,__webpack_require__){"use strict";function toBase64(arrayBuffer){var uint8Version=new Uint8Array(arrayBuffer);return window.btoa(String.fromCharCode.apply(null,uint8Version))}__webpack_exports__.a=function(arrayBuffer){return toBase64(arrayBuffer).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__controller_interface__=__webpack_require__(91),__WEBPACK_IMPORTED_MODULE_1__models_errors__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__=__webpack_require__(94),__WEBPACK_IMPORTED_MODULE_3__models_fcm_details__=__webpack_require__(92),__extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),SWController=function(_super){function SWController(app){var _this=_super.call(this,app)||this;return self.addEventListener("push",function(e){return _this.onPush_(e)},!1),self.addEventListener("pushsubscriptionchange",function(e){return _this.onSubChange_(e)},!1),self.addEventListener("notificationclick",function(e){return _this.onNotificationClick_(e)},!1),_this.bgMessageHandler_=null,_this}return __extends(SWController,_super),SWController.prototype.onPush_=function(event){var msgPayload,_this=this;try{msgPayload=event.data.json()}catch(err){return}var handleMsgPromise=this.hasVisibleClients_().then(function(hasVisibleClients){if(hasVisibleClients){if(msgPayload.notification||_this.bgMessageHandler_)return _this.sendMessageToWindowClients_(msgPayload)}else{var notificationDetails=_this.getNotificationData_(msgPayload);if(notificationDetails){var notificationTitle=notificationDetails.title||"";return self.registration.showNotification(notificationTitle,notificationDetails)}if(_this.bgMessageHandler_)return _this.bgMessageHandler_(msgPayload)}});event.waitUntil(handleMsgPromise)},SWController.prototype.onSubChange_=function(event){var _this=this,promiseChain=this.getToken().then(function(token){if(!token)throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var tokenDetails=null,tokenManager=_this.getTokenManager();return tokenManager.getTokenDetailsFromToken(token).then(function(details){if(!(tokenDetails=details))throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(__WEBPACK_IMPORTED_MODULE_3__models_fcm_details__.a.SUBSCRIPTION_OPTIONS)}).then(function(newSubscription){return tokenManager.subscribeToFCM(tokenDetails.fcmSenderId,newSubscription,tokenDetails.fcmPushSet)}).catch(function(err){return tokenManager.deleteToken(tokenDetails.fcmToken).then(function(){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.UNABLE_TO_RESUBSCRIBE,{message:err})})})});event.waitUntil(promiseChain)},SWController.prototype.onNotificationClick_=function(event){var _this=this;if(event.notification&&event.notification.data&&event.notification.data.FCM_MSG){event.stopImmediatePropagation(),event.notification.close();var msgPayload=event.notification.data.FCM_MSG,clickAction=msgPayload.notification.click_action;if(clickAction){var promiseChain=this.getWindowClient_(clickAction).then(function(windowClient){return windowClient||self.clients.openWindow(clickAction)}).then(function(windowClient){if(windowClient){msgPayload.notification;delete msgPayload.notification;var internalMsg=__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.createNewMsg(__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.TYPES_OF_MSG.NOTIFICATION_CLICKED,msgPayload);return _this.attemptToMessageClient_(windowClient,internalMsg)}});event.waitUntil(promiseChain)}}},SWController.prototype.getNotificationData_=function(msgPayload){if(msgPayload&&"object"==typeof msgPayload.notification){var notificationInformation=Object.assign({},msgPayload.notification);return notificationInformation.data=(_a={},_a.FCM_MSG=msgPayload,_a),notificationInformation;var _a}},SWController.prototype.setBackgroundMessageHandler=function(callback){if(callback&&"function"!=typeof callback)throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler_=callback},SWController.prototype.getWindowClient_=function(url){var parsedURL=new URL(url).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(clientList){for(var suitableClient=null,i=0;i<clientList.length;i++){if(new URL(clientList[i].url).href===parsedURL){suitableClient=clientList[i];break}}if(suitableClient)return suitableClient.focus(),suitableClient})},SWController.prototype.attemptToMessageClient_=function(client,message){var _this=this;return new Promise(function(resolve,reject){if(!client)return reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__.a.codes.NO_WINDOW_CLIENT_TO_MSG));client.postMessage(message),resolve()})},SWController.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(clientList){return clientList.some(function(client){return"visible"===client.visibilityState})})},SWController.prototype.sendMessageToWindowClients_=function(msgPayload){var _this=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(clientList){var internalMsg=__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.createNewMsg(__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__.a.TYPES_OF_MSG.PUSH_MSG_RECEIVED,msgPayload);return Promise.all(clientList.map(function(client){return _this.attemptToMessageClient_(client,internalMsg)}))})},SWController.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)},SWController}(__WEBPACK_IMPORTED_MODULE_0__controller_interface__.a);__webpack_exports__.a=SWController},function(module,exports,__webpack_require__){__webpack_require__(183)},function(module,__webpack_exports__,__webpack_require__){"use strict";function factory(app,unused,opt_url){return new __WEBPACK_IMPORTED_MODULE_5__src_service__.a(app,new __WEBPACK_IMPORTED_MODULE_3__src_implementation_xhriopool__.a,opt_url)}function registerStorage(instance){var namespaceExports={TaskState:__WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__.c,TaskEvent:__WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__.b,StringFormat:__WEBPACK_IMPORTED_MODULE_1__src_implementation_string__.a,Storage:__WEBPACK_IMPORTED_MODULE_5__src_service__.a,Reference:__WEBPACK_IMPORTED_MODULE_4__src_reference__.a};instance.INTERNAL.registerService(STORAGE_TYPE,factory,namespaceExports,void 0,!0)}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_exports__.registerStorage=registerStorage;var __WEBPACK_IMPORTED_MODULE_0__firebase_app__=__webpack_require__(18),__WEBPACK_IMPORTED_MODULE_1__src_implementation_string__=__webpack_require__(30),__WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__=__webpack_require__(31),__WEBPACK_IMPORTED_MODULE_3__src_implementation_xhriopool__=__webpack_require__(184),__WEBPACK_IMPORTED_MODULE_4__src_reference__=__webpack_require__(96),__WEBPACK_IMPORTED_MODULE_5__src_service__=__webpack_require__(193),STORAGE_TYPE="storage";registerStorage(__WEBPACK_IMPORTED_MODULE_0__firebase_app__.default)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return XhrIoPool});var __WEBPACK_IMPORTED_MODULE_0__xhrio_network__=__webpack_require__(185),XhrIoPool=function(){function XhrIoPool(){}return XhrIoPool.prototype.createXhrIo=function(){return new __WEBPACK_IMPORTED_MODULE_0__xhrio_network__.a},XhrIoPool}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return NetworkXhrIo});var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_1__object__=__webpack_require__(25),__WEBPACK_IMPORTED_MODULE_2__promise_external__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_3__type__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_4__xhrio__=__webpack_require__(95),NetworkXhrIo=function(){function NetworkXhrIo(){var _this=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__.a.NO_ERROR,this.sendPromise_=__WEBPACK_IMPORTED_MODULE_2__promise_external__.a(function(resolve,reject){_this.xhr_.addEventListener("abort",function(event){_this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__.a.ABORT,resolve(_this)}),_this.xhr_.addEventListener("error",function(event){_this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__.a.NETWORK_ERROR,resolve(_this)}),_this.xhr_.addEventListener("load",function(event){resolve(_this)})})}return NetworkXhrIo.prototype.send=function(url,method,opt_body,opt_headers){var _this=this;if(this.sent_)throw __WEBPACK_IMPORTED_MODULE_0__error__.e("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(method,url,!0),__WEBPACK_IMPORTED_MODULE_3__type__.a(opt_headers)){var headers=opt_headers;__WEBPACK_IMPORTED_MODULE_1__object__.b(headers,function(key,val){_this.xhr_.setRequestHeader(key,val.toString())})}return __WEBPACK_IMPORTED_MODULE_3__type__.a(opt_body)?this.xhr_.send(opt_body):this.xhr_.send(),this.sendPromise_},NetworkXhrIo.prototype.getErrorCode=function(){if(!this.sent_)throw __WEBPACK_IMPORTED_MODULE_0__error__.e("cannot .getErrorCode() before sending");return this.errorCode_},NetworkXhrIo.prototype.getStatus=function(){if(!this.sent_)throw __WEBPACK_IMPORTED_MODULE_0__error__.e("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},NetworkXhrIo.prototype.getResponseText=function(){if(!this.sent_)throw __WEBPACK_IMPORTED_MODULE_0__error__.e("cannot .getResponseText() before sending");return this.xhr_.responseText},NetworkXhrIo.prototype.abort=function(){this.xhr_.abort()},NetworkXhrIo.prototype.getResponseHeader=function(header){return this.xhr_.getResponseHeader(header)},NetworkXhrIo.prototype.addUploadProgressListener=function(listener){__WEBPACK_IMPORTED_MODULE_3__type__.a(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",listener)},NetworkXhrIo.prototype.removeUploadProgressListener=function(listener){__WEBPACK_IMPORTED_MODULE_3__type__.a(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",listener)},NetworkXhrIo}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function jsonObjectOrNull(s){var obj;try{obj=JSON.parse(s)}catch(e){return null}return __WEBPACK_IMPORTED_MODULE_0__type__.f(obj)?obj:null}__webpack_exports__.a=jsonObjectOrNull;var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(12)},function(module,__webpack_exports__,__webpack_require__){"use strict";function getBlobBuilder(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function getBlob(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var BlobBuilder=getBlobBuilder();if(void 0!==BlobBuilder){for(var bb=new BlobBuilder,i=0;i<var_args.length;i++)bb.append(var_args[i]);return bb.getBlob()}if(__WEBPACK_IMPORTED_MODULE_0__type__.e())return new Blob(var_args);throw Error("This browser doesn't seem to support creating Blobs")}function sliceBlob(blob,start,end){return blob.webkitSlice?blob.webkitSlice(start,end):blob.mozSlice?blob.mozSlice(start,end):blob.slice?blob.slice(start,end):null}__webpack_exports__.a=getBlob,__webpack_exports__.b=sliceBlob;var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(12)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return RequestInfo});var RequestInfo=function(){function RequestInfo(url,method,handler,timeout){this.url=url,this.method=method,this.handler=handler,this.timeout=timeout,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return RequestInfo}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return UploadTask});var __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__=__webpack_require__(31),__WEBPACK_IMPORTED_MODULE_1__implementation_observer__=__webpack_require__(190),__WEBPACK_IMPORTED_MODULE_2__tasksnapshot__=__webpack_require__(191),__WEBPACK_IMPORTED_MODULE_3__implementation_args__=__webpack_require__(53),__WEBPACK_IMPORTED_MODULE_4__implementation_array__=__webpack_require__(56),__WEBPACK_IMPORTED_MODULE_5__implementation_async__=__webpack_require__(192),__WEBPACK_IMPORTED_MODULE_6__implementation_error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_7__implementation_promise_external__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_8__implementation_requests__=__webpack_require__(99),__WEBPACK_IMPORTED_MODULE_9__implementation_type__=__webpack_require__(12),UploadTask=function(){function UploadTask(ref,authWrapper,location,mappings,blob,metadata){void 0===metadata&&(metadata=null);var _this=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=ref,this.authWrapper_=authWrapper,this.location_=location,this.blob_=blob,this.metadata_=metadata,this.mappings_=mappings,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING,this.errorHandler_=function(error){_this.request_=null,_this.chunkMultiplier_=1,error.codeEquals(__WEBPACK_IMPORTED_MODULE_6__implementation_error__.a.CANCELED)?(_this.needToFetchStatus_=!0,_this.completeTransitions_()):(_this.error_=error,_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.ERROR))},this.metadataErrorHandler_=function(error){_this.request_=null,error.codeEquals(__WEBPACK_IMPORTED_MODULE_6__implementation_error__.a.CANCELED)?_this.completeTransitions_():(_this.error_=error,_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.ERROR))},this.promise_=__WEBPACK_IMPORTED_MODULE_7__implementation_promise_external__.a(function(resolve,reject){_this.resolve_=resolve,_this.reject_=reject,_this.start_()}),this.promise_.then(null,function(){})}return UploadTask.prototype.makeProgressCallback_=function(){var _this=this,sizeBefore=this.transferred_;return function(loaded,total){_this.updateProgress_(sizeBefore+loaded)}},UploadTask.prototype.shouldDoResumable_=function(blob){return blob.size()>262144},UploadTask.prototype.start_=function(){this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},UploadTask.prototype.resolveToken_=function(callback){var _this=this;this.authWrapper_.getAuthToken().then(function(authToken){switch(_this.state_){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING:callback(authToken);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELING:_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING:_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSED)}})},UploadTask.prototype.createResumable_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.c(_this.authWrapper_,_this.location_,_this.mappings_,_this.blob_,_this.metadata_),createRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=createRequest,createRequest.getPromise().then(function(url){_this.request_=null,_this.uploadUrl_=url,_this.needToFetchStatus_=!1,_this.completeTransitions_()},_this.errorHandler_)})},UploadTask.prototype.fetchStatus_=function(){var _this=this,url=this.uploadUrl_;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.f(_this.authWrapper_,_this.location_,url,_this.blob_),statusRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=statusRequest,statusRequest.getPromise().then(function(status){status=status,_this.request_=null,_this.updateProgress_(status.current),_this.needToFetchStatus_=!1,status.finalized&&(_this.needToFetchMetadata_=!0),_this.completeTransitions_()},_this.errorHandler_)})},UploadTask.prototype.continueUpload_=function(){var _this=this,chunkSize=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.h*this.chunkMultiplier_,status=new __WEBPACK_IMPORTED_MODULE_8__implementation_requests__.a(this.transferred_,this.blob_.size()),url=this.uploadUrl_;this.resolveToken_(function(authToken){var requestInfo;try{requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.b(_this.location_,_this.authWrapper_,url,_this.blob_,chunkSize,_this.mappings_,status,_this.makeProgressCallback_())}catch(e){return _this.error_=e,void _this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.ERROR)}var uploadRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=uploadRequest,uploadRequest.getPromise().then(function(newStatus){_this.increaseMultiplier_(),_this.request_=null,_this.updateProgress_(newStatus.current),newStatus.finalized?(_this.metadata_=newStatus.metadata,_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.SUCCESS)):_this.completeTransitions_()},_this.errorHandler_)})},UploadTask.prototype.increaseMultiplier_=function(){__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.h*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},UploadTask.prototype.fetchMetadata_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.e(_this.authWrapper_,_this.location_,_this.mappings_),metadataRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=metadataRequest,metadataRequest.getPromise().then(function(metadata){_this.request_=null,_this.metadata_=metadata,_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.SUCCESS)},_this.metadataErrorHandler_)})},UploadTask.prototype.oneShotUpload_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__.g(_this.authWrapper_,_this.location_,_this.mappings_,_this.blob_,_this.metadata_),multipartRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=multipartRequest,multipartRequest.getPromise().then(function(metadata){_this.request_=null,_this.metadata_=metadata,_this.updateProgress_(_this.blob_.size()),_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.SUCCESS)},_this.errorHandler_)})},UploadTask.prototype.updateProgress_=function(transferred){var old=this.transferred_;this.transferred_=transferred,this.transferred_!==old&&this.notifyObservers_()},UploadTask.prototype.transition_=function(state){if(this.state_!==state)switch(state){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELING:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING:this.state_=state,null!==this.request_&&this.request_.cancel();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING:var wasPaused=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSED;this.state_=state,wasPaused&&(this.notifyObservers_(),this.start_());break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSED:this.state_=state,this.notifyObservers_();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELED:this.error_=__WEBPACK_IMPORTED_MODULE_6__implementation_error__.c(),this.state_=state,this.notifyObservers_();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.ERROR:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.SUCCESS:this.state_=state,this.notifyObservers_()}},UploadTask.prototype.completeTransitions_=function(){switch(this.state_){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING:this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELING:this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING:this.start_()}},Object.defineProperty(UploadTask.prototype,"snapshot",{get:function(){var externalState=__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.d(this.state_);return new __WEBPACK_IMPORTED_MODULE_2__tasksnapshot__.a(this.transferred_,this.blob_.size(),externalState,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),UploadTask.prototype.on=function(type,nextOrObserver,error,completed){function typeValidator(_p){if(type!==__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.b.STATE_CHANGED)throw"Expected one of the event types: ["+__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.b.STATE_CHANGED+"]."}function nextOrObserverValidator(p){try{return void nextValidator(p)}catch(e){}try{observerValidator(p);if(!(__WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(p.next)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(p.error)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(p.complete)))throw"";return}catch(e){throw nextOrObserverMessage}}function makeBinder(specs){function binder(nextOrObserver,error,opt_complete){null!==specs&&__WEBPACK_IMPORTED_MODULE_3__implementation_args__.g("on",specs,arguments);var observer=new __WEBPACK_IMPORTED_MODULE_1__implementation_observer__.a(nextOrObserver,error,completed);return self.addObserver_(observer),function(){self.removeObserver_(observer)}}return binder}function binderNextOrObserverValidator(p){if(null===p)throw nextOrObserverMessage;nextOrObserverValidator(p)}void 0===nextOrObserver&&(nextOrObserver=void 0),void 0===error&&(error=void 0),void 0===completed&&(completed=void 0);var nextOrObserverMessage="Expected a function or an Object with one of `next`, `error`, `complete` properties.",nextValidator=__WEBPACK_IMPORTED_MODULE_3__implementation_args__.d(!0).validator,observerValidator=__WEBPACK_IMPORTED_MODULE_3__implementation_args__.a(null,!0).validator,specs=[__WEBPACK_IMPORTED_MODULE_3__implementation_args__.e(typeValidator),__WEBPACK_IMPORTED_MODULE_3__implementation_args__.a(nextOrObserverValidator,!0),__WEBPACK_IMPORTED_MODULE_3__implementation_args__.d(!0),__WEBPACK_IMPORTED_MODULE_3__implementation_args__.d(!0)];__WEBPACK_IMPORTED_MODULE_3__implementation_args__.g("on",specs,arguments);var self=this,binderSpecs=[__WEBPACK_IMPORTED_MODULE_3__implementation_args__.a(binderNextOrObserverValidator),__WEBPACK_IMPORTED_MODULE_3__implementation_args__.d(!0),__WEBPACK_IMPORTED_MODULE_3__implementation_args__.d(!0)];return __WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(nextOrObserver)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(error)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__.c(completed)?makeBinder(null)(nextOrObserver,error,completed):makeBinder(binderSpecs)},UploadTask.prototype.then=function(onFulfilled,onRejected){return this.promise_.then(onFulfilled,onRejected)},UploadTask.prototype.catch=function(onRejected){return this.then(null,onRejected)},UploadTask.prototype.addObserver_=function(observer){this.observers_.push(observer),this.notifyObserver_(observer)},UploadTask.prototype.removeObserver_=function(observer){__WEBPACK_IMPORTED_MODULE_4__implementation_array__.c(this.observers_,observer)},UploadTask.prototype.notifyObservers_=function(){var _this=this;this.finishPromise_(),__WEBPACK_IMPORTED_MODULE_4__implementation_array__.a(this.observers_).forEach(function(observer){_this.notifyObserver_(observer)})},UploadTask.prototype.finishPromise_=function(){if(null!==this.resolve_){var triggered=!0;switch(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.d(this.state_)){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.SUCCESS:Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(this.resolve_.bind(null,this.snapshot))();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.CANCELED:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.ERROR:var toCall=this.reject_;Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(toCall.bind(null,this.error_))();break;default:triggered=!1}triggered&&(this.resolve_=null,this.reject_=null)}},UploadTask.prototype.notifyObserver_=function(observer){switch(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.d(this.state_)){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.RUNNING:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.PAUSED:null!==observer.next&&Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(observer.next.bind(observer,this.snapshot))();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.SUCCESS:null!==observer.complete&&Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(observer.complete.bind(observer))();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.CANCELED:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.c.ERROR:null!==observer.error&&Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(observer.error.bind(observer,this.error_))();break;default:null!==observer.error&&Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__.a)(observer.error.bind(observer,this.error_))()}},UploadTask.prototype.resume=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__.g("resume",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSED||this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING;return valid&&this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING),valid},UploadTask.prototype.pause=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__.g("pause",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING;return valid&&this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING),valid},UploadTask.prototype.cancel=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__.g("cancel",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.RUNNING||this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.PAUSING;return valid&&this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__.a.CANCELING),valid},UploadTask}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Observer});var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(12),Observer=function(){function Observer(nextOrObserver,opt_error,opt_complete){if(__WEBPACK_IMPORTED_MODULE_0__type__.b(nextOrObserver)||__WEBPACK_IMPORTED_MODULE_0__type__.a(opt_error)||__WEBPACK_IMPORTED_MODULE_0__type__.a(opt_complete))this.next=nextOrObserver,this.error=opt_error||null,this.complete=opt_complete||null;else{var observer=nextOrObserver;this.next=observer.next||null,this.error=observer.error||null,this.complete=observer.complete||null}}return Observer}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return UploadTaskSnapshot});var UploadTaskSnapshot=function(){function UploadTaskSnapshot(bytesTransferred,totalBytes,state,metadata,task,ref){this.bytesTransferred=bytesTransferred,this.totalBytes=totalBytes,this.state=state,this.metadata=metadata,this.task=task,this.ref=ref}return Object.defineProperty(UploadTaskSnapshot.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var urls=this.metadata.downloadURLs;return null!=urls&&null!=urls[0]?urls[0]:null}return null},enumerable:!0,configurable:!0}),UploadTaskSnapshot}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function async(f){return function(){for(var argsToForward=[],_i=0;_i<arguments.length;_i++)argsToForward[_i]=arguments[_i];__WEBPACK_IMPORTED_MODULE_0__promise_external__.c(!0).then(function(){f.apply(null,argsToForward)})}}__webpack_exports__.a=async;var __WEBPACK_IMPORTED_MODULE_0__promise_external__=__webpack_require__(21)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Service});var __WEBPACK_IMPORTED_MODULE_0__implementation_args__=__webpack_require__(53),__WEBPACK_IMPORTED_MODULE_1__implementation_authwrapper__=__webpack_require__(194),__WEBPACK_IMPORTED_MODULE_2__implementation_location__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_3__implementation_promise_external__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_4__implementation_request__=__webpack_require__(197),__WEBPACK_IMPORTED_MODULE_5__reference__=__webpack_require__(96),Service=function(){function Service(app,pool,url){function maker(authWrapper,loc){return new __WEBPACK_IMPORTED_MODULE_5__reference__.a(authWrapper,loc)}if(this.bucket_=null,this.authWrapper_=new __WEBPACK_IMPORTED_MODULE_1__implementation_authwrapper__.a(app,maker,__WEBPACK_IMPORTED_MODULE_4__implementation_request__.a,this,pool),this.app_=app,null!=url)this.bucket_=__WEBPACK_IMPORTED_MODULE_2__implementation_location__.a.makeFromBucketSpec(url);else{var authWrapperBucket=this.authWrapper_.bucket();null!=authWrapperBucket&&(this.bucket_=new __WEBPACK_IMPORTED_MODULE_2__implementation_location__.a(authWrapperBucket,""))}this.internals_=new ServiceInternals(this)}return Service.prototype.ref=function(path){function validator(path){if(/^[A-Za-z]+:\/\//.test(path))throw"Expected child path but got a URL, use refFromURL instead."}if(__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("ref",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.e(validator,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var ref=new __WEBPACK_IMPORTED_MODULE_5__reference__.a(this.authWrapper_,this.bucket_);return null!=path?ref.child(path):ref},Service.prototype.refFromURL=function(url){function validator(p){if(!/^[A-Za-z]+:\/\//.test(p))throw"Expected full URL but got a child path, use ref instead.";try{__WEBPACK_IMPORTED_MODULE_2__implementation_location__.a.makeFromUrl(p)}catch(e){throw"Expected valid full URL but got an invalid one."}}return __WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("refFromURL",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.e(validator,!1)],arguments),new __WEBPACK_IMPORTED_MODULE_5__reference__.a(this.authWrapper_,url)},Object.defineProperty(Service.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),Service.prototype.setMaxUploadRetryTime=function(time){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("setMaxUploadRetryTime",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.c()],arguments),this.authWrapper_.setMaxUploadRetryTime(time)},Object.defineProperty(Service.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),Service.prototype.setMaxOperationRetryTime=function(time){__WEBPACK_IMPORTED_MODULE_0__implementation_args__.g("setMaxOperationRetryTime",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__.c()],arguments),this.authWrapper_.setMaxOperationRetryTime(time)},Object.defineProperty(Service.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(Service.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),Service}(),ServiceInternals=function(){function ServiceInternals(service){this.service_=service}return ServiceInternals.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),__WEBPACK_IMPORTED_MODULE_3__implementation_promise_external__.c(void 0)},ServiceInternals}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AuthWrapper});var __WEBPACK_IMPORTED_MODULE_0__constants__=__webpack_require__(42),__WEBPACK_IMPORTED_MODULE_1__error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_2__failrequest__=__webpack_require__(195),__WEBPACK_IMPORTED_MODULE_3__location__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_4__promise_external__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_5__requestmap__=__webpack_require__(196),__WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(12),AuthWrapper=function(){function AuthWrapper(app,maker,requestMaker,service,pool){if(this.bucket_=null,this.deleted_=!1,this.app_=app,null!==this.app_){var options=this.app_.options;__WEBPACK_IMPORTED_MODULE_6__type__.a(options)&&(this.bucket_=AuthWrapper.extractBucket_(options))}this.storageRefMaker_=maker,this.requestMaker_=requestMaker,this.pool_=pool,this.service_=service,this.maxOperationRetryTime_=__WEBPACK_IMPORTED_MODULE_0__constants__.d,this.maxUploadRetryTime_=__WEBPACK_IMPORTED_MODULE_0__constants__.e,this.requestMap_=new __WEBPACK_IMPORTED_MODULE_5__requestmap__.a}return AuthWrapper.extractBucket_=function(config){var bucketString=config[__WEBPACK_IMPORTED_MODULE_0__constants__.c]||null;return null==bucketString?null:__WEBPACK_IMPORTED_MODULE_3__location__.a.makeFromBucketSpec(bucketString).bucket},AuthWrapper.prototype.getAuthToken=function(){return null!==this.app_&&__WEBPACK_IMPORTED_MODULE_6__type__.a(this.app_.INTERNAL)&&__WEBPACK_IMPORTED_MODULE_6__type__.a(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(response){return null!==response?response.accessToken:null},function(_error){return null}):__WEBPACK_IMPORTED_MODULE_4__promise_external__.c(null)},AuthWrapper.prototype.bucket=function(){if(this.deleted_)throw __WEBPACK_IMPORTED_MODULE_1__error__.b();return this.bucket_},AuthWrapper.prototype.service=function(){return this.service_},AuthWrapper.prototype.makeStorageReference=function(loc){return this.storageRefMaker_(this,loc)},AuthWrapper.prototype.makeRequest=function(requestInfo,authToken){if(this.deleted_)return new __WEBPACK_IMPORTED_MODULE_2__failrequest__.a(__WEBPACK_IMPORTED_MODULE_1__error__.b());var request=this.requestMaker_(requestInfo,authToken,this.pool_);return this.requestMap_.addRequest(request),request},AuthWrapper.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},AuthWrapper.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},AuthWrapper.prototype.setMaxUploadRetryTime=function(time){this.maxUploadRetryTime_=time},AuthWrapper.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},AuthWrapper.prototype.setMaxOperationRetryTime=function(time){this.maxOperationRetryTime_=time},AuthWrapper}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return FailRequest});var __WEBPACK_IMPORTED_MODULE_0__promise_external__=__webpack_require__(21),FailRequest=function(){function FailRequest(error){this.promise_=__WEBPACK_IMPORTED_MODULE_0__promise_external__.b(error)}return FailRequest.prototype.getPromise=function(){return this.promise_},FailRequest.prototype.cancel=function(appDelete){void 0===appDelete&&(appDelete=!1)},FailRequest}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return RequestMap});var __WEBPACK_IMPORTED_MODULE_0__object__=__webpack_require__(25),__WEBPACK_IMPORTED_MODULE_1__constants__=__webpack_require__(42),RequestMap=function(){function RequestMap(){this.map_={},this.id_=__WEBPACK_IMPORTED_MODULE_1__constants__.h}return RequestMap.prototype.addRequest=function(r){function unmap(){delete self.map_[id]}var id=this.id_;this.id_++,this.map_[id]=r;var self=this;r.getPromise().then(unmap,unmap)},RequestMap.prototype.clear=function(){__WEBPACK_IMPORTED_MODULE_0__object__.b(this.map_,function(key,val){val&&val.cancel(!0)}),this.map_={}},RequestMap}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function addAuthHeader_(headers,authToken){null!==authToken&&authToken.length>0&&(headers.Authorization="Firebase "+authToken)}function addVersionHeader_(headers){var number=void 0!==__WEBPACK_IMPORTED_MODULE_0__firebase_app__.default?__WEBPACK_IMPORTED_MODULE_0__firebase_app__.default.SDK_VERSION:"AppManager";headers["X-Firebase-Storage-Version"]="webjs/"+number}function makeRequest(requestInfo,authToken,pool){var queryPart=__WEBPACK_IMPORTED_MODULE_7__url__.c(requestInfo.urlParams),url=requestInfo.url+queryPart,headers=__WEBPACK_IMPORTED_MODULE_4__object__.a(requestInfo.headers);return addAuthHeader_(headers,authToken),addVersionHeader_(headers),new NetworkRequest(url,requestInfo.method,headers,requestInfo.body,requestInfo.successCodes,requestInfo.additionalRetryCodes,requestInfo.handler,requestInfo.errorHandler,requestInfo.timeout,requestInfo.progressCallback,pool)}__webpack_exports__.a=makeRequest;var __WEBPACK_IMPORTED_MODULE_0__firebase_app__=__webpack_require__(18),__WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(56),__WEBPACK_IMPORTED_MODULE_2__backoff__=__webpack_require__(198),__WEBPACK_IMPORTED_MODULE_3__error__=__webpack_require__(15),__WEBPACK_IMPORTED_MODULE_4__object__=__webpack_require__(25),__WEBPACK_IMPORTED_MODULE_5__promise_external__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_7__url__=__webpack_require__(55),__WEBPACK_IMPORTED_MODULE_8__xhrio__=__webpack_require__(95),NetworkRequest=function(){function NetworkRequest(url,method,headers,body,successCodes,additionalRetryCodes,callback,errorCallback,timeout,progressCallback,pool){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=url,this.method_=method,this.headers_=headers,this.body_=body,this.successCodes_=successCodes.slice(),this.additionalRetryCodes_=additionalRetryCodes.slice(),this.callback_=callback,this.errorCallback_=errorCallback,this.progressCallback_=progressCallback,this.timeout_=timeout,this.pool_=pool;var self=this;this.promise_=__WEBPACK_IMPORTED_MODULE_5__promise_external__.a(function(resolve,reject){self.resolve_=resolve,self.reject_=reject,self.start_()})}return NetworkRequest.prototype.start_=function(){function doTheRequest(backoffCallback,canceled){function progressListener(progressEvent){var loaded=progressEvent.loaded,total=progressEvent.lengthComputable?progressEvent.total:-1;null!==self.progressCallback_&&self.progressCallback_(loaded,total)}if(canceled)return void backoffCallback(!1,new RequestEndStatus(!1,null,!0));var xhr=self.pool_.createXhrIo();self.pendingXhr_=xhr,null!==self.progressCallback_&&xhr.addUploadProgressListener(progressListener),xhr.send(self.url_,self.method_,self.body_,self.headers_).then(function(xhr){null!==self.progressCallback_&&xhr.removeUploadProgressListener(progressListener),self.pendingXhr_=null,xhr=xhr;var hitServer=xhr.getErrorCode()===__WEBPACK_IMPORTED_MODULE_8__xhrio__.a.NO_ERROR,status=xhr.getStatus();if(!hitServer||self.isRetryStatusCode_(status)){var wasCanceled=xhr.getErrorCode()===__WEBPACK_IMPORTED_MODULE_8__xhrio__.a.ABORT;return void backoffCallback(!1,new RequestEndStatus(!1,null,wasCanceled))}var successCode=__WEBPACK_IMPORTED_MODULE_1__array__.b(self.successCodes_,status);backoffCallback(!0,new RequestEndStatus(successCode,xhr))})}function backoffDone(requestWentThrough,status){var resolve=self.resolve_,reject=self.reject_,xhr=status.xhr;if(status.wasSuccessCode)try{var result=self.callback_(xhr,xhr.getResponseText());__WEBPACK_IMPORTED_MODULE_6__type__.c(result)?resolve(result):resolve()}catch(e){reject(e)}else if(null!==xhr){var err=__WEBPACK_IMPORTED_MODULE_3__error__.s();err.setServerResponseProp(xhr.getResponseText()),reject(self.errorCallback_?self.errorCallback_(xhr,err):err)}else if(status.canceled){var err=self.appDelete_?__WEBPACK_IMPORTED_MODULE_3__error__.b():__WEBPACK_IMPORTED_MODULE_3__error__.c();reject(err)}else{var err=__WEBPACK_IMPORTED_MODULE_3__error__.o();reject(err)}}var self=this;this.canceled_?backoffDone(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=__WEBPACK_IMPORTED_MODULE_2__backoff__.a(doTheRequest,backoffDone,this.timeout_)},NetworkRequest.prototype.getPromise=function(){return this.promise_},NetworkRequest.prototype.cancel=function(appDelete){this.canceled_=!0,this.appDelete_=appDelete||!1,null!==this.backoffId_&&__WEBPACK_IMPORTED_MODULE_2__backoff__.b(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},NetworkRequest.prototype.isRetryStatusCode_=function(status){var isFiveHundredCode=status>=500&&status<600,extraRetryCodes=[408,429],isExtraRetryCode=__WEBPACK_IMPORTED_MODULE_1__array__.b(extraRetryCodes,status),isRequestSpecificRetryCode=__WEBPACK_IMPORTED_MODULE_1__array__.b(this.additionalRetryCodes_,status);return isFiveHundredCode||isExtraRetryCode||isRequestSpecificRetryCode},NetworkRequest}(),RequestEndStatus=function(){function RequestEndStatus(wasSuccessCode,xhr,opt_canceled){this.wasSuccessCode=wasSuccessCode,this.xhr=xhr,this.canceled=!!opt_canceled}return RequestEndStatus}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function start(f,callback,timeout){function canceled(){return 2===cancelState}function triggerCallback(){triggeredCallback||(triggeredCallback=!0,callback.apply(null,arguments))}function callWithDelay(millis){timeoutId=setTimeout(function(){timeoutId=null,f(handler,canceled())},millis)}function handler(success){for(var var_args=[],_i=1;_i<arguments.length;_i++)var_args[_i-1]=arguments[_i];if(!triggeredCallback){if(success)return void triggerCallback.apply(null,arguments);if(canceled()||hitTimeout)return void triggerCallback.apply(null,arguments);waitSeconds<64&&(waitSeconds*=2);var waitMillis;1===cancelState?(cancelState=2,waitMillis=0):waitMillis=1e3*(waitSeconds+Math.random()),callWithDelay(waitMillis)}}function stop(wasTimeout){stopped||(stopped=!0,triggeredCallback||(null!==timeoutId?(wasTimeout||(cancelState=2),clearTimeout(timeoutId),callWithDelay(0)):wasTimeout||(cancelState=1)))}var waitSeconds=1,timeoutId=null,hitTimeout=!1,cancelState=0,triggeredCallback=!1,stopped=!1;return callWithDelay(0),setTimeout(function(){hitTimeout=!0,stop(!0)},timeout),stop}function stop(id){id(!1)}__webpack_exports__.a=start,__webpack_exports__.b=stop},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},_this=this;Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),Transition_1=__webpack_require__(22),firebase=__webpack_require__(45),helpers_1=__webpack_require__(13),iconfont_1=__webpack_require__(100),LocalStorage=__webpack_require__(57),logger_1=__webpack_require__(16);__webpack_require__(210);var productComponents_1=__webpack_require__(213),index_1=__webpack_require__(217),Grid_1=__webpack_require__(243),index_2=__webpack_require__(246),index_3=__webpack_require__(257),index_4=__webpack_require__(263),index_5=__webpack_require__(270),index_6=__webpack_require__(273);__webpack_require__(277),__webpack_require__(279),iconfont_1.setIcons("Material-Design-Iconic-Font",["f101","f409"]);var productManager;easydeps_1.default.getInstance().invokeRawFrom(["productManager"],function(pm){productManager=pm.get(),pm.onchange(function(pmval){return productManager=pmval})});var shareUrl,load=function(pps){void 0===pps&&(pps=LocalStorage.get("definition")),pps&&productManager.importDefinition(pps)},store=function(pps){void 0===pps&&(pps=productManager.exportDefinition()),LocalStorage.set("definition",pps)},share=function(){return __awaiter(_this,void 0,void 0,function(){var pps,snapshot;return __generator(this,function(_a){switch(_a.label){case 0:return[4,productManager.exportDefinition()];case 1:return pps=_a.sent(),[4,firebase.push("/share/",pps)];case 2:return snapshot=_a.sent(),shareUrl="http://ojc.mariuslinders.nl/?share="+snapshot.key,m.redraw(),[2]}})})},shareKey=helpers_1.parseQuery().share;shareKey&&eventaggregator_1.default.getInstance("dom").once("ready",function(event){return __awaiter(_this,void 0,void 0,function(){var snapshot,pps;return __generator(this,function(_a){switch(_a.label){case 0:return[4,firebase.get("/share/"+shareKey)];case 1:return snapshot=_a.sent(),snapshot&&(pps=snapshot.val())&&load(pps),[2]}})})});var results=[],submit=function(scale,individual,download){return void 0===scale&&(scale=1),void 0===individual&&(individual=!1),void 0===download&&(download=!0),__awaiter(_this,void 0,void 0,function(){var result;return __generator(this,function(_a){switch(_a.label){case 0:return[4,productComponents_1.default(scale,{individual:individual})];case 1:result=_a.sent(),results.push(result.result),m.redraw();try{productManager.submit(result)}catch(err){logger_1.default(err)}return[2]}})})},holderIsSelected=function(){try{return!!productManager.getHolder()}catch(err){return!1}},Main=function(){function Main(){}return Main.prototype.view=function(v){return m("div",{className:"component--Main"},m("button",{onclick:function(){return submit(window.submitscale||3,!0)}},"SUBMIT"),m("button",{onclick:function(){return store()}},"STORE"),m("button",{onclick:function(){return share()}},"SHARE"),shareUrl&&m("input",{readonly:!0,value:shareUrl}),m("button",{onclick:function(){return load()}},"LOAD"),m("div",{className:"result-cover"}),m(Grid_1.Row,null,m(Grid_1.Col,{className:"col-component--LayoutDrawer"},m(index_4.default,null))),m(Grid_1.Row,null,m(Grid_1.Col,{fixed:!0,className:"col-component--ImageDrawer"},m(index_3.default,null)),m(Grid_1.Col,null,m(Grid_1.Row,null,m(Grid_1.Col,{fixed:!0,className:"col-component--OtherDrawer"},m(index_5.default,null)),m(Grid_1.Col,{className:"col-component--HolderDrawer"},m(index_2.default,null))),m(Grid_1.Row,null,m(Grid_1.Col,{className:"col-component--ProductPreview"},m("div",{className:"preview-wrapper"},m(index_6.default,null)))),m(Grid_1.Row,null,m(Grid_1.Col,{className:"col-component--EditorDrawer"},holderIsSelected()&&m(Transition_1.default,{className:"t--slide-down"},m(index_1.default,null)))))),m(Grid_1.Row,null,m(Grid_1.Col,{className:"col-results"},results.map(function(src){return m("img",{style:{width:"100%"},src:src})}))))},Main}();exports.default=Main},function(module,exports,__webpack_require__){function _warn(){var _console="undefined"==typeof console?null:console;if(_console){(_console.warn?_console.warn:_console.log).apply(_console,arguments)}}function createStore(storages,plugins,namespace){namespace||(namespace=""),storages&&!isList(storages)&&(storages=[storages]),plugins&&!isList(plugins)&&(plugins=[plugins]);var namespacePrefix=namespace?"__storejs_"+namespace+"_":"",namespaceRegexp=namespace?new RegExp("^"+namespacePrefix):null;if(!/^[a-zA-Z0-9_\-]*$/.test(namespace))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var _privateStoreProps={_namespacePrefix:namespacePrefix,_namespaceRegexp:namespaceRegexp,_testStorage:function(storage){try{var testStr="__storejs__test__";storage.write(testStr,testStr);var ok=storage.read(testStr)===testStr;return storage.remove(testStr),ok}catch(e){return!1}},_assignPluginFnProp:function(pluginFnProp,propName){var oldFn=this[propName];this[propName]=function(){function super_fn(){if(oldFn)return each(arguments,function(arg,i){args[i]=arg}),oldFn.apply(self,args)}var args=slice(arguments,0),self=this,newFnArgs=[super_fn].concat(args);return pluginFnProp.apply(self,newFnArgs)}},_serialize:function(obj){return JSON.stringify(obj)},_deserialize:function(strVal,defaultVal){if(!strVal)return defaultVal;var val="";try{val=JSON.parse(strVal)}catch(e){val=strVal}return void 0!==val?val:defaultVal},_addStorage:function(storage){this.enabled||this._testStorage(storage)&&(this.storage=storage,this.enabled=!0)},_addPlugin:function(plugin){var self=this;if(isList(plugin))return void each(plugin,function(plugin){self._addPlugin(plugin)});if(!pluck(this.plugins,function(seenPlugin){return plugin===seenPlugin})){if(this.plugins.push(plugin),!isFunction(plugin))throw new Error("Plugins must be function values that return objects");var pluginProperties=plugin.call(this);if(!isObject(pluginProperties))throw new Error("Plugins must return an object of function properties");each(pluginProperties,function(pluginFnProp,propName){if(!isFunction(pluginFnProp))throw new Error("Bad plugin property: "+propName+" from plugin "+plugin.name+". Plugins should only return functions.");self._assignPluginFnProp(pluginFnProp,propName)})}},addStorage:function(storage){_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(storage)}},store=create(_privateStoreProps,storeAPI,{plugins:[]});return store.raw={},each(store,function(prop,propName){isFunction(prop)&&(store.raw[propName]=bind(store,prop))}),each(storages,function(storage){store._addStorage(storage)}),each(plugins,function(plugin){store._addPlugin(plugin)}),store}var util=__webpack_require__(26),slice=util.slice,pluck=util.pluck,each=util.each,bind=util.bind,create=util.create,isList=util.isList,isFunction=util.isFunction,isObject=util.isObject;module.exports={createStore:createStore};var storeAPI={version:"2.0.12",enabled:!1,get:function(key,optionalDefaultValue){var data=this.storage.read(this._namespacePrefix+key);return this._deserialize(data,optionalDefaultValue)},set:function(key,value){return void 0===value?this.remove(key):(this.storage.write(this._namespacePrefix+key,this._serialize(value)),value)},remove:function(key){this.storage.remove(this._namespacePrefix+key)},each:function(callback){var self=this;this.storage.each(function(val,namespacedKey){callback.call(self,self._deserialize(val),(namespacedKey||"").replace(self._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(namespace){return this._namespacePrefix=="__storejs_"+namespace+"_"},createStore:function(){return createStore.apply(this,arguments)},addPlugin:function(plugin){this._addPlugin(plugin)},namespace:function(namespace){return createStore(this.storage,this.plugins,namespace)}}},function(module,exports,__webpack_require__){module.exports=[__webpack_require__(202),__webpack_require__(203),__webpack_require__(204),__webpack_require__(205),__webpack_require__(206),__webpack_require__(207)]},function(module,exports,__webpack_require__){function localStorage(){return Global.localStorage}function read(key){return localStorage().getItem(key)}function write(key,data){return localStorage().setItem(key,data)}function each(fn){for(var i=localStorage().length-1;i>=0;i--){var key=localStorage().key(i);fn(read(key),key)}}function remove(key){return localStorage().removeItem(key)}function clearAll(){return localStorage().clear()}var util=__webpack_require__(26),Global=util.Global;module.exports={name:"localStorage",read:read,write:write,each:each,remove:remove,clearAll:clearAll}},function(module,exports,__webpack_require__){function read(key){return globalStorage[key]}function write(key,data){globalStorage[key]=data}function each(fn){for(var i=globalStorage.length-1;i>=0;i--){var key=globalStorage.key(i);fn(globalStorage[key],key)}}function remove(key){return globalStorage.removeItem(key)}function clearAll(){each(function(key,_){delete globalStorage[key]})}var util=__webpack_require__(26),Global=util.Global;module.exports={name:"oldFF-globalStorage",read:read,write:write,each:each,remove:remove,clearAll:clearAll};var globalStorage=Global.globalStorage},function(module,exports,__webpack_require__){function write(unfixedKey,data){if(!disable){var fixedKey=fixKey(unfixedKey);_withStorageEl(function(storageEl){storageEl.setAttribute(fixedKey,data),storageEl.save(storageName)})}}function read(unfixedKey){if(!disable){var fixedKey=fixKey(unfixedKey),res=null;return _withStorageEl(function(storageEl){res=storageEl.getAttribute(fixedKey)}),res}}function each(callback){_withStorageEl(function(storageEl){for(var attributes=storageEl.XMLDocument.documentElement.attributes,i=attributes.length-1;i>=0;i--){var attr=attributes[i];callback(storageEl.getAttribute(attr.name),attr.name)}})}function remove(unfixedKey){var fixedKey=fixKey(unfixedKey);_withStorageEl(function(storageEl){storageEl.removeAttribute(fixedKey),storageEl.save(storageName)})}function clearAll(){_withStorageEl(function(storageEl){var attributes=storageEl.XMLDocument.documentElement.attributes;storageEl.load(storageName);for(var i=attributes.length-1;i>=0;i--)storageEl.removeAttribute(attributes[i].name);storageEl.save(storageName)})}function fixKey(key){return key.replace(/^\d/,"___$&").replace(forbiddenCharsRegex,"___")}var util=__webpack_require__(26),Global=util.Global;module.exports={name:"oldIE-userDataStorage",write:write,read:read,each:each,remove:remove,clearAll:clearAll};var storageName="storejs",doc=Global.document,_withStorageEl=function(){if(!doc||!doc.documentElement||!doc.documentElement.addBehavior)return null;var storageOwner,storageContainer,storageEl;try{storageContainer=new ActiveXObject("htmlfile"),storageContainer.open(),storageContainer.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),storageContainer.close(),storageOwner=storageContainer.w.frames[0].document,storageEl=storageOwner.createElement("div")}catch(e){storageEl=doc.createElement("div"),storageOwner=doc.body}return function(storeFunction){var args=[].slice.call(arguments,0);args.unshift(storageEl),storageOwner.appendChild(storageEl),storageEl.addBehavior("#default#userData"),storageEl.load(storageName),storeFunction.apply(this,args),storageOwner.removeChild(storageEl)}}(),disable=(Global.navigator?Global.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./),forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g")},function(module,exports,__webpack_require__){function read(key){if(!key||!_has(key))return null;var regexpStr="(?:^|.*;\\s*)"+escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(doc.cookie.replace(new RegExp(regexpStr),"$1"))}function each(callback){for(var cookies=doc.cookie.split(/; ?/g),i=cookies.length-1;i>=0;i--)if(trim(cookies[i])){var kvp=cookies[i].split("="),key=unescape(kvp[0]),val=unescape(kvp[1]);callback(val,key)}}function write(key,data){key&&(doc.cookie=escape(key)+"="+escape(data)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function remove(key){key&&_has(key)&&(doc.cookie=escape(key)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function clearAll(){each(function(_,key){remove(key)})}function _has(key){return new RegExp("(?:^|;\\s*)"+escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(doc.cookie)}var util=__webpack_require__(26),Global=util.Global,trim=util.trim;module.exports={name:"cookieStorage",read:read,write:write,each:each,remove:remove,clearAll:clearAll};var doc=Global.document},function(module,exports,__webpack_require__){function sessionStorage(){return Global.sessionStorage}function read(key){return sessionStorage().getItem(key)}function write(key,data){return sessionStorage().setItem(key,data)}function each(fn){for(var i=sessionStorage().length-1;i>=0;i--){var key=sessionStorage().key(i);fn(read(key),key)}}function remove(key){return sessionStorage().removeItem(key)}function clearAll(){return sessionStorage().clear()}var util=__webpack_require__(26),Global=util.Global;module.exports={name:"sessionStorage",read:read,write:write,each:each,remove:remove,clearAll:clearAll}},function(module,exports){function read(key){return memoryStorage[key]}function write(key,data){memoryStorage[key]=data}function each(callback){for(var key in memoryStorage)memoryStorage.hasOwnProperty(key)&&callback(memoryStorage[key],key)}function remove(key){delete memoryStorage[key]}function clearAll(key){memoryStorage={}}module.exports={name:"memoryStorage",read:read,write:write,each:each,remove:remove,clearAll:clearAll};var memoryStorage={}},function(module,exports,__webpack_require__){function json2Plugin(){return __webpack_require__(209),{}}module.exports=json2Plugin},function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}function quote(string){return rx_escapable.lastIndex=0,rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;i<length;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;i<length;i+=1)"string"==typeof rep[i]&&(k=rep[i],(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v);return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;i<space;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(module,exports,__webpack_require__){var content=__webpack_require__(211);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'@font-face {\n  font-family: \'Amatic SC\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Amatic SC Regular"), local("AmaticSC-Regular"), url(https://fonts.gstatic.com/s/amaticsc/v11/DPPfSFKxRTXvae2bKDzp5FtXRa8TVwTICgirnJhmVJw.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Bungee\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Bungee"), local("Bungee-Regular"), url(https://fonts.gstatic.com/s/bungee/v3/86NbnFpNqZ2MU9Gl0ca2YQ.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Indie Flower\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Indie Flower"), local("IndieFlower"), url(https://fonts.gstatic.com/s/indieflower/v9/10JVD_humAd5zP2yrFqw6ugdm0LZdjqr5-oayXSOefg.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Lobster\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Lobster Regular"), local("Lobster-Regular"), url(https://fonts.gstatic.com/s/lobster/v20/cycBf3mfbGkh66G5NhszPQ.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Open Sans Condensed\';\n  font-style: normal;\n  font-weight: 300;\n  src: local("Open Sans Condensed Light"), local("OpenSansCondensed-Light"), url(https://fonts.gstatic.com/s/opensanscondensed/v12/gk5FxslNkTTHtojXrkp-xBEur64QvLD-0IbiAdTUNXE.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Schoolbell\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Schoolbell Regular"), local("Schoolbell-Regular"), url(https://fonts.gstatic.com/s/schoolbell/v8/BSqn7FernLolrt-MFco9Wvk_vArhqVIZ0nv9q090hN8.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Shadows Into Light\';\n  font-style: normal;\n  font-weight: 400;\n  src: local("Shadows Into Light"), local("ShadowsIntoLight"), url(https://fonts.gstatic.com/s/shadowsintolight/v7/clhLqOv7MXn459PTh0gXYFK2TSYBz0eNcHnp4YqE4Ts.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215; }\n\n@font-face {\n  font-family: \'Material-Design-Iconic-Font\';\n  font-style: normal;\n  font-weight: 400;\n  src: url(https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/fonts/Material-Design-Iconic-Font.woff2) format("woff2"); }\n',""])},function(module,exports){module.exports=function(css){var location="undefined"!=typeof window&&window.location;if(!location)throw new Error("fixUrls requires window.location");if(!css||"string"!=typeof css)return css;var baseUrl=location.protocol+"//"+location.host,currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,"/");return css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(unquotedOrigUrl))return fullMatch;var newUrl;return newUrl=0===unquotedOrigUrl.indexOf("//")?unquotedOrigUrl:0===unquotedOrigUrl.indexOf("/")?baseUrl+unquotedOrigUrl:currentDir+unquotedOrigUrl.replace(/^\.\//,""),"url("+JSON.stringify(newUrl)+")"})}},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},_this=this;Object.defineProperty(exports,"__esModule",{value:!0});var preview,easydeps_1=__webpack_require__(14),m=__webpack_require__(2),image_1=__webpack_require__(32),Holder_1=__webpack_require__(58),Layout_1=__webpack_require__(216),initializePreview=function(){return void 0!==preview?preview:(preview=document.createElement("div"),preview.style.position="fixed",preview.style.top="0",preview.style.left="0",preview.style.zIndex="-100",preview.style.pointerEvents="none",document.body.appendChild(preview),preview)},getProductManager=function(){return easydeps_1.default.getInstance().request(["productManager"])[0]};exports.default=function(scale,options){return void 0===scale&&(scale=1),void 0===options&&(options={}),__awaiter(_this,void 0,void 0,function(){var manager,layout,holders,_i,_a,h,position,_b,_c,_d,rect,result;return __generator(this,function(_e){switch(_e.label){case 0:if(manager=getProductManager(),initializePreview(),!(layout=manager.getProductPart().layout))throw new Error("ProductPart is undefined or has no layout");if(layout=manager.getScaledLayout(manager.getProductPart().layout,scale),holders=void 0,!options.individual)return[3,4];holders=[],_i=0,_a=layout.holders,_e.label=1;case 1:return _i<_a.length?(h=_a[_i],position={left:0,top:0,width:h.position.width,height:h.position.height},m.render(preview,m(Holder_1.default,{holder:h,position:position})),_c=(_b=holders).push,_d={id:h.id},[4,image_1.domToImage(preview)]):[3,4];case 2:_c.apply(_b,[(_d.image=_e.sent(),_d)]),_e.label=3;case 3:return _i++,[3,1];case 4:return m.render(preview,m(Layout_1.default,{layout:layout},layout.holders.map(function(holder){return m(Holder_1.default,{holder:holder})}))),rect=preview.getBoundingClientRect(),[4,image_1.domToImage(preview)];case 5:return result=_e.sent(),m.render(preview,null),[2,{result:result,holders:holders}]}})})}},function(module,exports,__webpack_require__){!function(global){"use strict";function toSvg(node,options){function applyOptions(clone){return options.bgcolor&&(clone.style.backgroundColor=options.bgcolor),options.width&&(clone.style.width=options.width+"px"),options.height&&(clone.style.height=options.height+"px"),options.style&&Object.keys(options.style).forEach(function(property){clone.style[property]=options.style[property]}),clone}return options=options||{},copyOptions(options),Promise.resolve(node).then(function(node){return cloneNode(node,options.filter,!0)}).then(embedFonts).then(inlineImages).then(applyOptions).then(function(clone){return makeSvgDataUri(clone,options.width||util.width(node),options.height||util.height(node))})}function toPixelData(node,options){return draw(node,options||{}).then(function(canvas){return canvas.getContext("2d").getImageData(0,0,util.width(node),util.height(node)).data})}function toPng(node,options){return draw(node,options||{}).then(function(canvas){return canvas.toDataURL()})}function toJpeg(node,options){return options=options||{},draw(node,options).then(function(canvas){return canvas.toDataURL("image/jpeg",options.quality||1)})}function toBlob(node,options){return draw(node,options||{}).then(util.canvasToBlob)}function copyOptions(options){void 0===options.imagePlaceholder?domtoimage.impl.options.imagePlaceholder=defaultOptions.imagePlaceholder:domtoimage.impl.options.imagePlaceholder=options.imagePlaceholder,void 0===options.cacheBust?domtoimage.impl.options.cacheBust=defaultOptions.cacheBust:domtoimage.impl.options.cacheBust=options.cacheBust}function draw(domNode,options){function newCanvas(domNode){var canvas=document.createElement("canvas");if(canvas.width=options.width||util.width(domNode),canvas.height=options.height||util.height(domNode),options.bgcolor){var ctx=canvas.getContext("2d");ctx.fillStyle=options.bgcolor,ctx.fillRect(0,0,canvas.width,canvas.height)}return canvas}return toSvg(domNode,options).then(util.makeImage).then(util.delay(100)).then(function(image){var canvas=newCanvas(domNode);return canvas.getContext("2d").drawImage(image,0,0),canvas})}function cloneNode(node,filter,root){function makeNodeCopy(node){return node instanceof HTMLCanvasElement?util.makeImage(node.toDataURL()):node.cloneNode(!1)}function cloneChildren(original,clone,filter){var children=original.childNodes;return 0===children.length?Promise.resolve(clone):function(parent,children,filter){var done=Promise.resolve();return children.forEach(function(child){done=done.then(function(){return cloneNode(child,filter)}).then(function(childClone){childClone&&parent.appendChild(childClone)})}),done}(clone,util.asArray(children),filter).then(function(){return clone})}function processClone(original,clone){function cloneStyle(){!function(source,target){source.cssText?target.cssText=source.cssText:function(source,target){util.asArray(source).forEach(function(name){target.setProperty(name,source.getPropertyValue(name),source.getPropertyPriority(name))})}(source,target)}(window.getComputedStyle(original),clone.style)}function clonePseudoElements(){function clonePseudoElement(element){var style=window.getComputedStyle(original,element),content=style.getPropertyValue("content");if(""!==content&&"none"!==content){var className=util.uid();clone.className=clone.className+" "+className;var styleElement=document.createElement("style");styleElement.appendChild(function(className,element,style){var selector="."+className+":"+element,cssText=style.cssText?function(style){var content=style.getPropertyValue("content");return style.cssText+" content: "+content+";"}(style):function(style){function formatProperty(name){return name+": "+style.getPropertyValue(name)+(style.getPropertyPriority(name)?" !important":"")}return util.asArray(style).map(formatProperty).join("; ")+";"}(style);return document.createTextNode(selector+"{"+cssText+"}")}(className,element,style)),clone.appendChild(styleElement)}}[":before",":after"].forEach(function(element){clonePseudoElement(element)})}function copyUserInput(){original instanceof HTMLTextAreaElement&&(clone.innerHTML=original.value),original instanceof HTMLInputElement&&clone.setAttribute("value",original.value)}function fixSvg(){clone instanceof SVGElement&&(clone.setAttribute("xmlns","http://www.w3.org/2000/svg"),clone instanceof SVGRectElement&&["width","height"].forEach(function(attribute){var value=clone.getAttribute(attribute);value&&clone.style.setProperty(attribute,value)}))}return clone instanceof Element?Promise.resolve().then(cloneStyle).then(clonePseudoElements).then(copyUserInput).then(fixSvg).then(function(){return clone}):clone}return root||!filter||filter(node)?Promise.resolve(node).then(makeNodeCopy).then(function(clone){return cloneChildren(node,clone,filter)}).then(function(clone){return processClone(node,clone)}):Promise.resolve()}function embedFonts(node){return fontFaces.resolveAll().then(function(cssText){var styleNode=document.createElement("style");return node.appendChild(styleNode),styleNode.appendChild(document.createTextNode(cssText)),node})}function inlineImages(node){return images.inlineAll(node).then(function(){return node})}function makeSvgDataUri(node,width,height){return Promise.resolve(node).then(function(node){return node.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(node)}).then(util.escapeXhtml).then(function(xhtml){return'<foreignObject x="0" y="0" width="100%" height="100%">'+xhtml+"</foreignObject>"}).then(function(foreignObject){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+width+'" height="'+height+'">'+foreignObject+"</svg>"}).then(function(svg){return"data:image/svg+xml;charset=utf-8,"+svg})}var util=function(){function mimes(){var WOFF="application/font-woff";return{woff:WOFF,woff2:WOFF,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function parseExtension(url){var match=/\.([^\.\/]*?)$/g.exec(url);return match?match[1]:""}function mimeType(url){var extension=parseExtension(url).toLowerCase();return mimes()[extension]||""}function isDataUrl(url){return-1!==url.search(/^(data:)/)}function toBlob(canvas){return new Promise(function(resolve){for(var binaryString=window.atob(canvas.toDataURL().split(",")[1]),length=binaryString.length,binaryArray=new Uint8Array(length),i=0;i<length;i++)binaryArray[i]=binaryString.charCodeAt(i);resolve(new Blob([binaryArray],{type:"image/png"}))})}function canvasToBlob(canvas){return canvas.toBlob?new Promise(function(resolve){canvas.toBlob(resolve)}):toBlob(canvas)}function resolveUrl(url,baseUrl){var doc=document.implementation.createHTMLDocument(),base=doc.createElement("base");doc.head.appendChild(base);var a=doc.createElement("a");return doc.body.appendChild(a),base.href=baseUrl,a.href=url,a.href}function makeImage(uri){return new Promise(function(resolve,reject){var image=new Image;image.onload=function(){resolve(image)},image.onerror=reject,image.src=uri})}function getAndEncode(url){var TIMEOUT=3e4;return domtoimage.impl.options.cacheBust&&(url+=(/\?/.test(url)?"&":"?")+(new Date).getTime()),new Promise(function(resolve){function done(){if(4===request.readyState){if(200!==request.status)return void(placeholder?resolve(placeholder):fail("cannot fetch resource: "+url+", status: "+request.status));var encoder=new FileReader;encoder.onloadend=function(){var content=encoder.result.split(/,/)[1];resolve(content)},encoder.readAsDataURL(request.response)}}function timeout(){placeholder?resolve(placeholder):fail("timeout of "+TIMEOUT+"ms occured while fetching resource: "+url)}function fail(message){console.error(message),resolve("")}var request=new XMLHttpRequest;request.onreadystatechange=done,request.ontimeout=timeout,request.responseType="blob",request.timeout=TIMEOUT,request.open("GET",url,!0),request.send();var placeholder;if(domtoimage.impl.options.imagePlaceholder){var split=domtoimage.impl.options.imagePlaceholder.split(/,/);split&&split[1]&&(placeholder=split[1])}})}function dataAsUrl(content,type){return"data:"+type+";base64,"+content}function escape(string){return string.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function delay(ms){return function(arg){return new Promise(function(resolve){setTimeout(function(){resolve(arg)},ms)})}}function asArray(arrayLike){for(var array=[],length=arrayLike.length,i=0;i<length;i++)array.push(arrayLike[i]);return array}function escapeXhtml(string){return string.replace(/#/g,"%23").replace(/\n/g,"%0A")}function width(node){var leftBorder=px(node,"border-left-width"),rightBorder=px(node,"border-right-width");return node.scrollWidth+leftBorder+rightBorder}function height(node){var topBorder=px(node,"border-top-width"),bottomBorder=px(node,"border-bottom-width");return node.scrollHeight+topBorder+bottomBorder}function px(node,styleProperty){var value=window.getComputedStyle(node).getPropertyValue(styleProperty);return parseFloat(value.replace("px",""))}return{escape:escape,parseExtension:parseExtension,mimeType:mimeType,dataAsUrl:dataAsUrl,isDataUrl:isDataUrl,canvasToBlob:canvasToBlob,resolveUrl:resolveUrl,getAndEncode:getAndEncode,uid:function(){var index=0;return function(){return"u"+function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}()+index++}}(),delay:delay,asArray:asArray,escapeXhtml:escapeXhtml,makeImage:makeImage,width:width,height:height}}(),inliner=function(){function shouldProcess(string){return-1!==string.search(URL_REGEX)}function readUrls(string){for(var match,result=[];null!==(match=URL_REGEX.exec(string));)result.push(match[1]);return result.filter(function(url){return!util.isDataUrl(url)})}function inline(string,url,baseUrl,get){function urlAsRegex(url){return new RegExp("(url\\(['\"]?)("+util.escape(url)+")(['\"]?\\))","g")}return Promise.resolve(url).then(function(url){return baseUrl?util.resolveUrl(url,baseUrl):url}).then(get||util.getAndEncode).then(function(data){return util.dataAsUrl(data,util.mimeType(url))}).then(function(dataUrl){return string.replace(urlAsRegex(url),"$1"+dataUrl+"$3")})}function inlineAll(string,baseUrl,get){return function(){return!shouldProcess(string)}()?Promise.resolve(string):Promise.resolve(string).then(readUrls).then(function(urls){var done=Promise.resolve(string);return urls.forEach(function(url){done=done.then(function(string){return inline(string,url,baseUrl,get)})}),done})}var URL_REGEX=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:inlineAll,shouldProcess:shouldProcess,impl:{readUrls:readUrls,inline:inline}}}(),fontFaces=function(){function resolveAll(){return readAll(document).then(function(webFonts){return Promise.all(webFonts.map(function(webFont){return webFont.resolve()}))}).then(function(cssStrings){return cssStrings.join("\n")})}function readAll(){function selectWebFontRules(cssRules){return cssRules.filter(function(rule){return rule.type===CSSRule.FONT_FACE_RULE}).filter(function(rule){return inliner.shouldProcess(rule.style.getPropertyValue("src"))})}function getCssRules(styleSheets){var cssRules=[];return styleSheets.forEach(function(sheet){try{util.asArray(sheet.cssRules||[]).forEach(cssRules.push.bind(cssRules))}catch(e){console.log("Error while reading CSS rules from "+sheet.href,e.toString())}}),cssRules}function newWebFont(webFontRule){return{resolve:function(){var baseUrl=(webFontRule.parentStyleSheet||{}).href;return inliner.inlineAll(webFontRule.cssText,baseUrl)},src:function(){return webFontRule.style.getPropertyValue("src")}}}return Promise.resolve(util.asArray(document.styleSheets)).then(getCssRules).then(selectWebFontRules).then(function(rules){return rules.map(newWebFont)})}return{resolveAll:resolveAll,impl:{readAll:readAll}}}(),images=function(){function newImage(element){function inline(get){return util.isDataUrl(element.src)?Promise.resolve():Promise.resolve(element.src).then(get||util.getAndEncode).then(function(data){return util.dataAsUrl(data,util.mimeType(element.src))}).then(function(dataUrl){return new Promise(function(resolve,reject){element.onload=resolve,element.onerror=reject,element.src=dataUrl})})}return{inline:inline}}function inlineAll(node){return node instanceof Element?function(node){var background=node.style.getPropertyValue("background");return background?inliner.inlineAll(background).then(function(inlined){node.style.setProperty("background",inlined,node.style.getPropertyPriority("background"))}).then(function(){return node}):Promise.resolve(node)}(node).then(function(){return node instanceof HTMLImageElement?newImage(node).inline():Promise.all(util.asArray(node.childNodes).map(function(child){return inlineAll(child)}))}):Promise.resolve(node)}return{inlineAll:inlineAll,impl:{newImage:newImage}}}(),defaultOptions={imagePlaceholder:void 0,cacheBust:!1},domtoimage={toSvg:toSvg,toPng:toPng,toJpeg:toJpeg,toBlob:toBlob,toPixelData:toPixelData,impl:{fontFaces:fontFaces,images:images,util:util,inliner:inliner,options:{}}};module.exports=domtoimage}()},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),enums_1=__webpack_require__(17),helpers_1=__webpack_require__(13),dom_1=__webpack_require__(7),HolderContent=function(){function HolderContent(){}return HolderContent.prototype.view=function(v){var h=v.attrs.holder;return h&&h.content&&h.content.value?h.content.type===enums_1.IMAGE?m("img",{oncreate:function(_a){var dom=_a.dom;return dom_1.preventDrag(dom)},style:exports.getHolderImgStyle(v.attrs.holder),src:v.attrs.thumb?h.content.thumb:h.content.value}):h.content.type===enums_1.TEXT?m("div",{style:exports.getHolderTextStyle(v.attrs.holder)},h.content.value):h.content.type===enums_1.SHAPE?m("div",{style:__assign({},exports.getHolderShapeStyle(v.attrs.holder),{fontFamily:h.content.fontFamily}),className:"icon-"+h.content.value}):void 0:null},HolderContent}();exports.default=HolderContent;var getStrokeWidth=function(width,fontSize){return void 0===width&&(width=1),void 0===fontSize&&(fontSize=22),("string"==typeof width?parseFloat(width):width)*("string"==typeof fontSize?parseFloat(fontSize):fontSize)/100},holderContentStyle=function(h){return h.content?{width:"100%"}:{}};exports.getHolderImgStyle=function(h){var style=__assign({},holderContentStyle(h));return h.content?(style=__assign({},style,{position:"absolute",objectFit:"cover",width:"100%",height:"100%",top:"0",left:"0"}),h.content.filter&&h.content.filter&&(style=__assign({},style,h.content.filter.value)),style):style},exports.getHolderShapeStyle=function(h){var style=__assign({},holderContentStyle(h));if(!h.content)return style;var _a=h.content,color=_a.color,fontSize=_a.fontSize;_a.lineHeight,_a.fontWeight,_a.textDecoration;return style=__assign({},style,{color:color,fontSize:fontSize,textAlign:h.content&&h.content.align||""}),h.content.filter&&h.content.filter&&(-1===h.content.filter.key.indexOf("stroke")?style=__assign({},style,h.content.filter.value):style.textShadow=helpers_1.generateStroke(getStrokeWidth(h.content.filter.value.width,h.content.fontSize),h.content.filter.value.color)),style},exports.getHolderTextStyle=function(h){var style=__assign({},holderContentStyle(h));if(!h.content)return style;var _a=h.content,color=_a.color,fontSize=_a.fontSize,lineHeight=_a.lineHeight,fontFamily=_a.fontFamily,fontStyle=_a.fontStyle,fontWeight=_a.fontWeight,textDecoration=_a.textDecoration;return style=__assign({},style,{color:color,fontSize:fontSize,fontFamily:fontFamily,fontStyle:fontStyle,lineHeight:lineHeight,fontWeight:fontWeight,textDecoration:textDecoration,textAlign:h.content&&h.content.align||""}),h.content.filter&&h.content.filter&&(-1===h.content.filter.key.indexOf("stroke")?style=__assign({},style,h.content.filter.value):style.textShadow=helpers_1.generateStroke(getStrokeWidth(h.content.filter.value.width,h.content.fontSize),h.content.filter.value.color)),style}},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),dom_1=__webpack_require__(7),object_1=__webpack_require__(3),Layout=function(){function Layout(){}return Layout.prototype.view=function(v){return m("div",{className:object_1.cleanString("layout",v.attrs.className),style:exports.getLayoutStyle(v.attrs.layout)},v.children)},Layout}();exports.default=Layout,exports.getLayoutStyle=function(l){var position=dom_1.getRectStyle(l.position);return __assign({},position,{position:"relative",overflow:"hidden"})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),Transition_1=__webpack_require__(22),image_1=__webpack_require__(32),object_1=__webpack_require__(3),Editor_1=__webpack_require__(218),controller_1=__webpack_require__(240);__webpack_require__(241);var EditorDrawer=function(){function EditorDrawer(){this.controller=new controller_1.default}return EditorDrawer.prototype.view=function(v){var _this=this,_a=this.controller.refresh(),holder=_a.holder,scale=_a.scale;return void 0===holder?null:m(Transition_1.default,{className:"t--slide-right"},m("div",{className:object_1.cleanString("component--EditorDrawer",v.attrs.className)},m(Editor_1.default,{holder:holder,scale:scale,options:this.controller.getEditorOptions(),contentoptions:this.controller.options,ondepthchange:function(change){return _this.controller.update({depth:change||0})},oncontentchange:function(change){return _this.controller.update({content:change})},oncontentrotatechange:function(change){return _this.controller.update({content:{rotate:change||0}})},oncontentalignchange:function(change){return _this.controller.update({content:{align:change||""}})},oncontentvaluechange:function(change){return _this.controller.update({content:{value:change||""}})},oncontentfontsizechange:function(change){return _this.controller.update({content:{fontSize:change||""}})},oncontentlineheightchange:function(change){return _this.controller.update({content:{lineHeight:change||""}})},oncontentfontfamilychange:function(change){return _this.controller.update({content:{fontFamily:change||""}})},oncontentfontstylechange:function(change){return _this.controller.update({content:{fontStyle:change||""}})},oncontentfontweightchange:function(change){return _this.controller.update({content:{fontWeight:change||""}})},oncontenttextdecorationchange:function(change){return _this.controller.update({content:{textDecoration:change||""}})},oncontentcolorchange:function(change){return _this.controller.update({content:{color:change||""}})},oncontentbackgroundcolorchange:function(change){return _this.controller.update({content:{backgroundColor:change||""}})},oncontentopacitychange:function(change){return _this.controller.update({content:{opacity:change||""}})},oncontentpixelatedchange:function(change){return _this.controller.update({content:{pixelated:change||""}})},oncontentfilterchange:function(filter){_this.controller.update({filter:filter})},oncontentimagechange:function(value){image_1.getThumb(value).then(function(thumb){return _this.controller.update({content:{value:value,thumb:thumb}})})}})))},EditorDrawer}();exports.default=EditorDrawer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),Checkbox_1=__webpack_require__(102),ColorPicker_1=__webpack_require__(220),IconPicker_1=__webpack_require__(221),Input_1=__webpack_require__(222),Select_1=__webpack_require__(223),ImageBackgroundRemover_1=__webpack_require__(224),ImageEditor_1=__webpack_require__(230),Transition_1=__webpack_require__(22),enums_1=__webpack_require__(17),dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13),LocalStorage=__webpack_require__(57),object_1=__webpack_require__(3);__webpack_require__(238);var getStrokeWidth=function(width,fontSize){return void 0===width&&(width=1),void 0===fontSize&&(fontSize=22),("string"==typeof width?parseFloat(width):width)*("string"==typeof fontSize?parseFloat(fontSize):fontSize)/100},Editor=function(){function Editor(){this.imageBackgroundRemover=!1,this.imageEditor=!1}return Editor.prototype.view=function(v){var _this=this;if(!v.attrs.holder||!v.attrs.holder.content)return null;var options=function(attrs){var opts=[];return attrs.options.type===enums_1.TEXT?opts=opts.concat(_this.getTextEditorOptions(attrs)):attrs.options.type===enums_1.IMAGE?opts=opts.concat(_this.getImageEditorOptions(attrs)):attrs.options.type===enums_1.SHAPE&&(opts=opts.concat(_this.getShapeEditorOptions(attrs))),opts.concat(_this.getSharedEditorOptions(attrs))}(v.attrs);return m("div",{className:object_1.cleanString("editor",v.attrs.className)},options.map(function(o,i){return m(Transition_1.default,{key:o.key,className:"t--switch-fast"},o.view)}),v.attrs.holder.content.value&&this.imageBackgroundRemover&&m(Transition_1.default,{key:13,className:"t--slide-down"},m(ImageBackgroundRemover_1.default,{position:helpers_1.setScale(v.attrs.holder.position,v.attrs.scale),src:v.attrs.holder.content.value,onclose:function(event){return _this.imageBackgroundRemover=!1},onsubmit:function(changed,original){return object_1.exec(v.attrs.oncontentimagechange,changed,original)}})),v.attrs.holder.content.value&&this.imageEditor&&m(Transition_1.default,{key:15,className:"t--slide-down"},m(ImageEditor_1.default,{position:helpers_1.setScale(v.attrs.holder.position,v.attrs.scale),src:v.attrs.holder.content.value,onclose:function(event){return _this.imageEditor=!1},onsubmit:function(changed,original){return object_1.exec(v.attrs.oncontentimagechange,changed,original)}})))},Editor.prototype.getSharedEditorOptions=function(attrs){var options=[];return options.push({key:0,view:m("div",{className:"option"},m("span",{className:"option-description"},"Background color"),m("div",{className:"colorSelectPicker"},m(Select_1.default,{option:attrs.holder.content.backgroundColor||attrs.contentoptions.backgroundColor[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentbackgroundcolorchange,value)}},attrs.contentoptions.backgroundColor.map(function(backgroundColor){return m("span",{option:backgroundColor,style:{backgroundColor:backgroundColor}},backgroundColor)})),m(ColorPicker_1.default,{onchange:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentbackgroundcolorchange,value)}})))}),options.push({key:1,view:m("div",{className:"option"},m("span",{className:"option-description"},"Transparency"),m(Select_1.default,{option:attrs.holder.content.opacity,oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentopacitychange,value)}},m("span",{option:0,style:{opacity:1}},"0%"),m("span",{option:.9,style:{opacity:.9}},"10%"),m("span",{option:.8,style:{opacity:.8}},"20%"),m("span",{option:.7,style:{opacity:.7}},"30%"),m("span",{option:.6,style:{opacity:.6}},"40%"),m("span",{option:.5,style:{opacity:.5}},"50%"),m("span",{option:.4,style:{opacity:.4}},"60%"),m("span",{option:.3,style:{opacity:.3}},"70%"),m("span",{option:.2,style:{opacity:.2}},"80%"),m("span",{option:.1,style:{opacity:.1}},"90%")))}),attrs.options.depth&&options.push({key:2,view:m("div",{className:"option"},m("span",{className:"option-description"},"Depth"),m("button",{onclick:function(event){return dom_1.devent(event)&&object_1.exec(attrs.ondepthchange,1)}},"+"),m("button",{onclick:function(event){return dom_1.devent(event)&&object_1.exec(attrs.ondepthchange,-1)}},"-"))}),options},Editor.prototype.getTextEditorOptions=function(attrs){var options=[];return options.push({key:3,view:m("div",{className:"option"},m("span",{className:"option-description"},"Content"),m(Input_1.default,{value:attrs.holder.content.value,multiline:!0,autofocus:!0,oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentvaluechange,value)}}))}),options.push({key:4,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font size"),m(Select_1.default,{option:attrs.holder.content.fontSize||attrs.contentoptions.fontSize[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfontsizechange,value)}},attrs.contentoptions.fontSize.map(function(fontSize){return m("span",{option:fontSize},fontSize)})))}),options.push({key:24,view:m("div",{className:"option"},m("span",{className:"option-description"},"Line height"),m(Select_1.default,{option:attrs.holder.content.lineHeight||attrs.contentoptions.lineHeight[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentlineheightchange,value)}},attrs.contentoptions.lineHeight.map(function(lineHeight){return m("span",{option:lineHeight},lineHeight)})))}),options.push({key:5,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font family"),m(Select_1.default,{style:{width:"200px"},option:attrs.holder.content.fontFamily||attrs.contentoptions.fontFamily[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfontfamilychange,value)}},attrs.contentoptions.fontFamily.map(function(fontFamily){return m("span",{option:fontFamily,style:{fontFamily:fontFamily}},fontFamily)})))}),options.push({key:6,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font style"),m(Select_1.default,{option:attrs.holder.content.fontStyle||attrs.contentoptions.fontStyle[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfontstylechange,value)}},attrs.contentoptions.fontStyle.map(function(fontStyle){return m("span",{option:fontStyle,style:{fontStyle:fontStyle}},fontStyle)})))}),options.push({key:7,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font weight"),m(Select_1.default,{option:attrs.holder.content.fontWeight||attrs.contentoptions.fontWeight[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfontweightchange,value)}},attrs.contentoptions.fontWeight.map(function(fontWeight){return m("span",{option:fontWeight,style:{fontWeight:fontWeight}},fontWeight)})))}),options.push({key:8,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font decoration"),m(Select_1.default,{option:attrs.holder.content.textDecoration||attrs.contentoptions.textDecoration[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontenttextdecorationchange,value)}},attrs.contentoptions.textDecoration.map(function(textDecoration){return m("span",{option:textDecoration,style:{textDecoration:textDecoration}},textDecoration)})))}),options.push({key:9,view:m("div",{className:"option"},m("span",{className:"option-description"},"Font color"),m("div",{className:"colorSelectPicker"},m(Select_1.default,{option:attrs.holder.content.color||attrs.contentoptions.color[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentcolorchange,value)}},attrs.contentoptions.color.map(function(color){return m("span",{option:color,style:{color:color}},color)})),m(ColorPicker_1.default,{onchange:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentcolorchange,value)}})))}),options.push({key:10,view:m("div",{className:"option"},m("span",{className:"option-description"},"Text align"),m(Select_1.default,{option:attrs.holder.content.align||attrs.contentoptions.align[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentalignchange,value)}},attrs.contentoptions.align.map(function(align){return m("span",{option:align,style:{align:align}},align)})))}),options.push({key:11,view:m("div",{className:"option"},m("span",{className:"option-description"},"Text filter"),m(Select_1.default,{className:"filterOptions",option:attrs.holder.content.filter||attrs.contentoptions.textFilter[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfilterchange,value)}},attrs.contentoptions.textFilter.map(function(filter){return-1===filter.key.indexOf("stroke")?m("span",{option:filter},m("span",{style:filter.value},filter.key)):m("span",{option:filter},m("span",{style:{textShadow:helpers_1.generateStroke(getStrokeWidth(filter.value.width,attrs.holder.content.fontSize),filter.value.color)}},filter.key))})))}),options},Editor.prototype.getImageEditorOptions=function(attrs){var _this=this,options=[];return options.push({key:12,view:m("div",{className:"option"},m("span",{className:"option-description"},"Pick image"),m(Select_1.default,{custom:!0,className:"filterOptions",option:!!attrs.holder.content.thumb&&m("div",{style:{height:"22px",width:"100%"}},m("img",{src:attrs.holder.content.thumb,style:{height:"100%",width:"100%",objectFit:"cover"}}))},(LocalStorage.get("images",!0)||[]).map(function(img){return m("div",{style:{height:"60px",width:"100%"},onclick:function(event){return object_1.exec(attrs.oncontentchange,{value:img.src,type:enums_1.IMAGE,thumb:img.thumb})}},m("img",{src:img.thumb,style:{height:"100%",width:"100%",objectFit:"cover"}}))})))}),attrs.holder.content.originalValue&&options.push({key:13,view:m("div",{className:"option"},m("span",{className:"option-description"},"Reset image"),m("button",{onclick:function(event){return object_1.exec(attrs.oncontentimagechange,attrs.holder.content.originalValue)}},"reset"))}),options.push({key:14,view:m("div",{className:"option"},m("span",{className:"option-description"},"Crop image"),m("button",{onclick:function(event){return _this.imageEditor=!0}},"Open cropping tool"))}),options.push({key:16,view:m("div",{className:"option"},m("span",{className:"option-description"},"Remove background color"),m("button",{onclick:function(event){return _this.imageBackgroundRemover=!0}},"Open background remover tool"))}),options.push({key:17,view:m("div",{className:"option"},m("span",{className:"option-description"},"Image filter"),m(Select_1.default,{className:"filterOptions",option:attrs.holder.content.filter||attrs.contentoptions.imageFilter[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfilterchange,value)}},attrs.contentoptions.imageFilter.map(function(filter){return m("span",{option:filter},filter.key,m("div",{className:"image-wrapper"},m("img",{src:attrs.holder.content.thumb,style:filter.value})))})))}),options.push({key:18,view:m("div",{className:"option"},m("span",{className:"option-description"},"Disable image smoothing"),m(Checkbox_1.default,{checked:attrs.holder.content.pixelated,onclick:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentpixelatedchange,value)}}))}),options},Editor.prototype.getShapeEditorOptions=function(attrs){var options=[];return options.push({key:19,view:m("div",{className:"option"},m("span",{className:"option-description"},"Icon"),m(IconPicker_1.default,{value:attrs.holder.content.value,font:attrs.holder.content.fontFamily,onchange:function(_a,event){var unicode=_a.unicode,font=_a.font;dom_1.devent(event),object_1.exec(attrs.oncontentvaluechange,unicode),object_1.exec(attrs.oncontentfontfamilychange,font)}}))}),options.push({key:20,view:m("div",{className:"option"},m("span",{className:"option-description"},"Size"),m(Select_1.default,{option:attrs.holder.content.fontSize||attrs.contentoptions.fontSize[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfontsizechange,value)}},attrs.contentoptions.fontSize.map(function(fontSize){return m("span",{option:fontSize},fontSize)})))}),options.push({key:21,view:m("div",{className:"option"},m("span",{className:"option-description"},"Color"),m("div",{className:"colorSelectPicker"},m(Select_1.default,{option:attrs.holder.content.color||attrs.contentoptions.color[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentcolorchange,value)}},attrs.contentoptions.color.map(function(color){return m("span",{option:color,style:{color:color}},color)})),m(ColorPicker_1.default,{onchange:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentcolorchange,value)}})))}),options.push({key:22,view:m("div",{className:"option"},m("span",{className:"option-description"},"Align"),m(Select_1.default,{option:attrs.holder.content.align||attrs.contentoptions.align[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentalignchange,value)}},attrs.contentoptions.align.map(function(align){return m("span",{option:align,style:{align:align}},align)})))}),options.push({key:21,view:m("div",{className:"option"},m("span",{className:"option-description"},"Shape filter"),m(Select_1.default,{className:"filterOptions",option:attrs.holder.content.filter||attrs.contentoptions.shapeFilter[0],oninput:function(value,event){return dom_1.devent(event)&&object_1.exec(attrs.oncontentfilterchange,value)}},attrs.contentoptions.shapeFilter.map(function(filter){return-1===filter.key.indexOf("stroke")?m("span",{option:filter},m("span",{style:filter.value},filter.key)):m("span",{option:filter},m("span",{style:{textShadow:helpers_1.generateStroke(getStrokeWidth(filter.value.width,attrs.holder.content.fontSize),filter.value.color)}},filter.key))})))}),options},Editor}();exports.default=Editor},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--Input {\n  position: relative;\n  min-height: 30px;\n  min-width: 100px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-family: sans-serif; }\n  .component--Input input,\n  .component--Input textarea {\n    border: none;\n    width: 100%;\n    line-height: 20px;\n    padding: 5px;\n    background-color: rgba(255, 255, 255, 0.6); }\n  .component--Input label {\n    padding: 0 10px; }\n\n.component--Slider {\n  position: relative;\n  min-height: 30px;\n  min-width: 100px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-family: sans-serif; }\n  .component--Slider input {\n    border: none;\n    width: 100%;\n    line-height: 20px;\n    padding: 5px;\n    background-color: rgba(255, 255, 255, 0.6); }\n  .component--Slider label {\n    padding: 0 10px; }\n\n.component--ColorPicker {\n  position: relative;\n  display: inline-block;\n  min-height: 30px;\n  min-width: 20px; }\n  .component--ColorPicker input {\n    border: none;\n    background-color: transparent;\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 100%;\n    padding: 0;\n    width: 100%;\n    margin: 0;\n    cursor: pointer; }\n\n.component--Checkbox {\n  position: relative;\n  display: inline-block;\n  min-height: 30px;\n  min-width: 100px; }\n  .component--Checkbox input,\n  .component--Checkbox textarea {\n    border: none;\n    line-height: 20px;\n    padding: 5px;\n    background-color: rgba(255, 255, 255, 0.6); }\n\n.component--Select {\n  border: none;\n  width: 100%;\n  line-height: 20px;\n  background-color: rgba(255, 255, 255, 0.6);\n  display: inline-block;\n  position: relative;\n  cursor: pointer; }\n  .component--Select .value {\n    width: 100%;\n    height: 100%; }\n    .component--Select .value span {\n      padding: 5px;\n      width: auto;\n      height: calc(100% - 10px); }\n  .component--Select .options {\n    position: absolute;\n    top: calc(100% + 4px);\n    left: 0;\n    width: 100%;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n    background-color: white;\n    display: none;\n    -webkit-box-shadow: 0 7px 20px -5px grey;\n            box-shadow: 0 7px 20px -5px grey;\n    max-height: 200px;\n    overflow: auto;\n    z-index: 1; }\n  .component--Select .option,\n  .component--Select .value {\n    margin: 0 !important; }\n    .component--Select .option > *,\n    .component--Select .value > * {\n      width: 100%;\n      height: 100%;\n      display: block; }\n    .component--Select .option img,\n    .component--Select .value img {\n      -o-object-fit: cover;\n         object-fit: cover;\n      width: 100%;\n      height: 100%; }\n  .component--Select .option {\n    display: block;\n    width: calc(100% - 10px);\n    margin: 0;\n    line-height: 20px;\n    padding: 5px;\n    background-color: rgba(255, 255, 255, 0.6);\n    position: relative;\n    cursor: pointer;\n    -webkit-box-flex: 0;\n        -ms-flex: 0 0 auto;\n            flex: 0 0 auto; }\n    .component--Select .option:hover {\n      background-color: #cccccc; }\n    .component--Select .option.selected {\n      background-color: #dedede; }\n  .component--Select.columns .options .option {\n    width: auto; }\n  .component--Select.open .options {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -ms-flex-wrap: wrap;\n        flex-wrap: wrap; }\n\n.component--IconPicker {\n  border: none;\n  width: 100%;\n  line-height: 20px;\n  padding: 5px;\n  background-color: rgba(255, 255, 255, 0.6);\n  display: inline-block;\n  position: relative;\n  cursor: pointer; }\n  .component--IconPicker .value {\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    margin: 0;\n    font-size: 20px; }\n  .component--IconPicker .options {\n    position: absolute;\n    top: calc(100% + 4px);\n    left: 0;\n    width: 300px;\n    background-color: white;\n    display: none;\n    -webkit-box-shadow: 0 7px 20px -5px grey;\n            box-shadow: 0 7px 20px -5px grey;\n    max-height: 200px;\n    overflow: auto;\n    z-index: 1;\n    -ms-flex-wrap: wrap;\n        flex-wrap: wrap; }\n  .component--IconPicker .options > .option.selected {\n    background-color: #dedede; }\n  .component--IconPicker .options > .option {\n    display: block;\n    position: relative;\n    cursor: pointer;\n    width: 16.667%;\n    height: 30px;\n    font-size: 30px;\n    line-height: 30px;\n    text-align: center;\n    margin: 0; }\n    .component--IconPicker .options > .option:hover {\n      background-color: #cccccc; }\n  .component--IconPicker.open .options {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(27);var ColorPicker=function(){function ColorPicker(){}return ColorPicker.prototype.view=function(v){var _this=this,id=Math.random().toString();return m("div",{className:object_1.cleanString("component--ColorPicker",v.attrs.className),style:v.attrs.style},m("input",{id:id,type:"color",value:v.attrs.value,defaultValue:v.attrs.default,onchange:function(evt){return _this.emitEvent(v.attrs.onchange,evt)},oninput:function(evt){return _this.emitEvent(v.attrs.oninput,evt)}}),v.attrs.label&&m("label",{htmlFor:id},v.attrs.label))},ColorPicker.prototype.emitEvent=function(eventCb,event){event.redraw=!1,object_1.exec(eventCb,event.target.value,event,function(value){return event.target.value=value})},ColorPicker}();exports.default=ColorPicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),iconfont_1=__webpack_require__(100),object_1=__webpack_require__(3);__webpack_require__(27);var cache={},IconPicker=function(){function IconPicker(){this.selectedOption="",this.clicked=!1}return IconPicker.prototype.oninit=function(v){void 0===cache[v.attrs.font]&&(cache[v.attrs.font]=iconfont_1.getIcons(v.attrs.font)),this.selectedOption=v.attrs.value||cache[v.attrs.font][0]},IconPicker.prototype.oncreate=function(v){this.dom=v.dom},IconPicker.prototype.onbeforeupdate=function(v,o){return!1},IconPicker.prototype.view=function(v){var _this=this;return m("div",{className:object_1.cleanString("component--IconPicker",v.attrs.className),style:v.attrs.style,onclick:function(event){_this.dom.classList.contains("open")?_this.dom.classList.remove("open"):_this.dom.classList.add("open")}},m("div",{className:"value",key:this.selectedOption},m("div",{style:{fontFamily:v.attrs.font},className:"icon-"+this.selectedOption,oncreate:function(vnode){return _this.valueDom=vnode.dom}})),m("div",{className:"options"},cache[v.attrs.font].map(function(unicode){return m("div",{style:{fontFamily:v.attrs.font},className:"option icon-"+unicode+" "+(unicode===_this.selectedOption?"selected":""),onclick:function(event){event.stopPropagation(),_this.dom.classList.remove("open"),_this.selectedOption=unicode,_this.valueDom.className="icon-"+unicode,object_1.exec(v.attrs.onchange,{font:v.attrs.font,unicode:_this.selectedOption},event)}})})))},IconPicker.prototype.getOption=function(item){return"object"==typeof item&&!Array.isArray(item)&&item&&item.attrs&&item.attrs["data-option"]},IconPicker.prototype.isSelected=function(item,option){return void 0===option&&(option=this.getOption(item)),option&&option===this.selectedOption},IconPicker}();exports.default=IconPicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(27);var Input=function(){function Input(){}return Input.prototype.oncreate=function(v){v.attrs.autofocus&&setTimeout(function(){return v.dom.focus()})},Input.prototype.view=function(v){var _this=this,Tag=v.attrs.multiline?"textarea":"input",id=Math.random().toString();return m("div",{className:object_1.cleanString("component--Input",v.attrs.className),style:v.attrs.style},m(Tag,{id:id,type:v.attrs.type,placeholder:v.attrs.placeholder,value:v.attrs.value,defaultValue:v.attrs.default,onchange:function(evt){return _this.emitEvent(v.attrs.onchange,evt)},oninput:function(evt){return _this.emitEvent(v.attrs.oninput,evt)},onkeypress:function(evt){_this.emitEvent(v.attrs.onkeypress,evt),"Enter"===evt.key&&_this.emitEvent(v.attrs.onenter,evt)},onblur:function(evt){return _this.emitEvent(v.attrs.onblur,evt)},onclick:function(evt){return _this.emitEvent(v.attrs.onclick,evt)}}),v.attrs.label&&m("label",{htmlFor:id},v.attrs.label))},Input.prototype.emitEvent=function(eventCb,event){event.redraw=!1,object_1.exec(eventCb,event.target.value,event,function(value){return event.target.value=value})},Input}();exports.default=Input},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(27);var eventaggregator_1=__webpack_require__(9),instances=[],Select=function(){function Select(){}return Select.prototype.onremove=function(v){var _this=this;instances=instances.filter(function(i){return i!==_this}),this.event.off()},Select.prototype.oncreate=function(v){var _this=this;this.dom=v.dom,instances.push(this),this.event=eventaggregator_1.default.getInstance("dom").on("click",function(event){-1===event.path.indexOf(_this.dom)&&_this.close()})},Select.prototype.view=function(v){var _this=this,children=Array.isArray(v.children)?v.children:[v.children];return v.attrs.custom?m("div",{className:object_1.cleanString("component--Select",v.attrs.className,v.attrs.columns&&"columns"),style:v.attrs.style,onclick:function(event){return _this.open()}},m("div",{className:"value",key:this.clickedKey},m("span",null,v.attrs.option||"no image selected")),m("div",{className:"options"},children.map(function(item,index){return m("div",{className:"option",onclick:function(event){event.stopPropagation(),_this.dom.classList.remove("open"),_this.clickedKey=index,object_1.exec(v.attrs.onchange,index,event),object_1.exec(v.attrs.oninput,index,event)},onmouseenter:function(event){if(_this.clickedKey===index)return void(event.redraw=!1);_this.selectedKey=index,object_1.exec(v.attrs.oninput,index,event)},onmouseleave:function(event){if(_this.clickedKey===index)return void(event.redraw=!1);_this.selectedKey=void 0,object_1.exec(v.attrs.oninput,_this.clickedKey,event)}},item)}))):(void 0===this.clickedKey&&(void 0!==v.attrs.option?this.clickedOption=v.attrs.option:this.clickedOption=this.getOption(children[0]),this.clickedKey=this.getOptionKey(this.clickedOption)),m("div",{className:object_1.cleanString("component--Select",v.attrs.className,v.attrs.columns&&"columns"),style:v.attrs.style,onclick:function(event){return _this.open()}},m("div",{className:"value",key:this.clickedKey},children.find(function(item){return _this.getOptionKey(_this.getOption(item))===_this.clickedKey})||children[0]),m("div",{className:"options"},children.map(function(item,index){if(!item)return null;var option=_this.getOption(item),key=_this.getOptionKey(option);return m("div",{className:"option "+(_this.getOptionKey(option)===_this.clickedKey?"selected":""),onclick:function(event){event.stopPropagation(),_this.dom.classList.remove("open"),_this.clickedOption=option,_this.clickedKey=key,object_1.exec(v.attrs.onchange,option,event),object_1.exec(v.attrs.oninput,option,event)},onmouseenter:function(event){if(_this.clickedKey===key)return void(event.redraw=!1);_this.selectedKey=key,object_1.exec(v.attrs.oninput,option,event)},onmouseleave:function(event){if(_this.clickedKey===key)return void(event.redraw=!1);_this.selectedKey=void 0,object_1.exec(v.attrs.oninput,_this.clickedOption,event)}},item)}))))},Select.prototype.getOption=function(item){if(object_1.isPlainObj(item)&&object_1.isPlainObj(item.attrs))return item.attrs.option},Select.prototype.getOptionKey=function(option){return"object"==typeof option&&null!==option&&void 0!==option.key?option.key:option},Select.prototype.open=function(){this.dom.classList.add("open")},Select.prototype.close=function(){this.dom.classList.remove("open")},Select}();exports.default=Select},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),object_1=__webpack_require__(3),Dialog_1=__webpack_require__(103),Slider_1=__webpack_require__(104),controller_1=__webpack_require__(227);__webpack_require__(228);var ImageBackgroundRemover=function(){function ImageBackgroundRemover(){this.c=new controller_1.default}return ImageBackgroundRemover.prototype.oninit=function(v){var _this=this;this.c.construct(v.attrs.src,m.redraw),this.c.onColorHover=function(r,g,b,a){return _this.colorElement.style.backgroundColor=a<50?"white":"rgb("+r+","+g+","+b+")"}},ImageBackgroundRemover.prototype.onremove=function(v){this.c.destruct()},ImageBackgroundRemover.prototype.view=function(v){var _this=this;return m(Dialog_1.default,{className:object_1.cleanString("component--ImageBackgroundRemover","open",v.attrs.className)},m("div",{className:"color",oncreate:function(vnode){return _this.colorElement=vnode.dom}}),m("div",{className:"previews",oninit:function(vnode){return _this.previewVnode=vnode}},m("canvas",{className:"original",oncreate:function(vnode){return _this.c.buildCanvas(vnode.dom,_this.previewVnode.dom)}}),m("img",{className:"modified pixelated",src:this.c.modifiedSrc})),m("div",{className:"options"},m(Slider_1.default,{label:"threshold",min:0,max:255,step:1,value:this.c.margin,oninput:eventaggregator_1.debounce(function(value,event){return _this.c.onMarginChange(value)},250)})),m("div",{className:"navigation"},m("button",{disabled:this.c.isBusy,onclick:function(event){return _this.c.onSave(v.attrs.onsubmit,v.attrs.onclose)}},"save"),m("button",{disabled:this.c.isBusy,onclick:function(event){return _this.c.onUpdate()}},"update"),m("button",{onclick:function(event){return object_1.exec(v.attrs.onclose,event)}},"close")))},ImageBackgroundRemover}();exports.default=ImageBackgroundRemover},function(module,exports,__webpack_require__){var content=__webpack_require__(226);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'.component--Dialog {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  z-index: 999; }\n  .component--Dialog .dialog {\n    position: fixed;\n    top: 10vh;\n    left: 10vw;\n    width: 80vw;\n    height: 80vh;\n    z-index: 1;\n    display: none;\n    background-color: white;\n    -webkit-box-shadow: 0 7px 20px -5px black;\n            box-shadow: 0 7px 20px -5px black; }\n  .component--Dialog .container {\n    background-color: rgba(0, 0, 0, 0.5);\n    content: "";\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    z-index: -1;\n    display: none; }\n  .component--Dialog.open .dialog,\n  .component--Dialog.open .container {\n    display: block; }\n',""])},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),image_1=__webpack_require__(32),object_1=__webpack_require__(3),Controller=function(){function Controller(){this.isBusy=!1,this.margin=100,this.modified=!1,this.changes=[]}return Controller.prototype.construct=function(src,updater){this.originalSrc=src,this.updater=updater},Controller.prototype.destruct=function(){this.resizeEvent.off()},Controller.prototype.buildCanvas=function(canvasElement,previewElement){return void 0===canvasElement&&(canvasElement=this.canvasElement),void 0===previewElement&&(previewElement=this.previewElement),__awaiter(this,void 0,void 0,function(){var previewRect,ctx,modified,image,resize,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:if(this.canvasElement=canvasElement,this.previewElement=previewElement,previewRect=previewElement.getBoundingClientRect(),!(ctx=canvasElement.getContext("2d")))throw new Error("canvas not initialized");return void 0!==this.src?[3,3]:[4,image_1.compress(this.originalSrc,{quality:1,maxWidth:previewRect.width/2,maxHeight:previewRect.height,pixelated:!0})];case 1:return modified=_a.sent(),this.src=modified,[4,this.buildCanvas()];case 2:return _a.sent(),[2];case 3:return image=new Image,resize=function(){var _a=_this.getImageDimension(previewElement.getBoundingClientRect(),image.naturalWidth,image.naturalHeight),width=_a.width,height=_a.height;_this.canvasElement.width=width,_this.canvasElement.height=height,ctx.imageSmoothingEnabled=!1,ctx.drawImage(image,0,0,width,height)},image.onload=function(){_this.resizeEvent&&_this.resizeEvent.off(),_this.resizeEvent=eventaggregator_1.default.getInstance("dom").on("resize",function(){return resize()}),resize(),_this.loadColorPicker(canvasElement)},image.src=this.src,[2]}})})},Controller.prototype.onMarginChange=function(value){return __awaiter(this,void 0,void 0,function(){var modified;return __generator(this,function(_a){switch(_a.label){case 0:return this.isBusy?[2]:(this.isBusy=!0,this.margin=parseInt(value,10),this.modified=!0,[4,this.modifyImage()]);case 1:return modified=_a.sent(),this.modifiedSrc=modified,this.isBusy=!1,this.updater(),[2]}})})},Controller.prototype.onSave=function(saveCb,closeCb){return __awaiter(this,void 0,void 0,function(){var modified;return __generator(this,function(_a){switch(_a.label){case 0:return this.isBusy?[2]:(this.isBusy=!0,this.updater(),this.modifiedSrc?(this.modified&&(this.modified=!1,this.changes.push({color:this.pickedColor,margin:this.margin})),[4,this.applyModifications(this.originalSrc)]):(object_1.exec(closeCb,event),[2]));case 1:return modified=_a.sent(),object_1.exec(saveCb,modified,event),object_1.exec(closeCb,event),this.isBusy=!1,this.updater(),[2]}})})},Controller.prototype.onUpdate=function(updateCb){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return this.isBusy?[2]:(this.isBusy=!0,this.updater(),this.modified=!1,this.modifiedSrc?(this.src=this.modifiedSrc,this.changes.push({color:this.pickedColor,margin:this.margin}),[4,this.buildCanvas()]):[2]);case 1:return _a.sent(),this.isBusy=!1,this.updater(),[2]}})})},Controller.prototype.loadColorPicker=function(canvas){var _this=this;image_1.colorPicker(canvas,this.onColorHover,function(r,g,b,a){return __awaiter(_this,void 0,void 0,function(){var modified;return __generator(this,function(_a){switch(_a.label){case 0:return this.isBusy?[2]:(this.isBusy=!0,this.updater(),this.pickedColor={r:r,g:g,b:b,a:a},this.modified=!0,[4,this.modifyImage()]);case 1:return modified=_a.sent(),this.modifiedSrc=modified,this.isBusy=!1,this.updater(),[2]}})})})},Controller.prototype.modifyImage=function(src,color,margin){return void 0===src&&(src=this.src),void 0===color&&(color=this.pickedColor),void 0===margin&&(margin=this.margin),__awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.applyModifications(src,[{color:color,margin:margin}])];case 1:return[2,_a.sent()]}})})},Controller.prototype.applyModifications=function(src,modifications){return void 0===src&&(src=this.src),void 0===modifications&&(modifications=this.changes),__awaiter(this,void 0,void 0,function(){var image,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return[4,image_1.modifyPixels(src,function(pixels,row){for(var i=0;i<pixels.length;i+=4)for(var _i=0,modifications_1=modifications;_i<modifications_1.length;_i++){var mod=modifications_1[_i];pixels[i+3]=_this.calculateAlpha(pixels[i],pixels[i+1],pixels[i+2],pixels[i+3],mod.color,mod.margin)}return pixels})];case 1:return image=_a.sent(),[2,image]}})})},Controller.prototype.calculateAlpha=function(r,g,b,a,color,margin){var overlap=Math.abs(r-color.r)+Math.abs(g-color.g)+Math.abs(b-color.b);if(overlap<margin)return 0;var mapped=object_1.mapRange(overlap,{from:[margin,1.5*margin],to:[0,255]});return mapped<a?mapped:a},Controller.prototype.getImageDimension=function(previewRect,imageWidth,imageHeight){var ratio=imageHeight/imageWidth,width=previewRect.width/2;return{width:width,height:width*ratio}},Controller}();exports.default=Controller},function(module,exports,__webpack_require__){var content=__webpack_require__(229);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--ImageBackgroundRemover .dialog {\n  background-position: 0px 0px, 10px 10px;\n  background-size: 20px 20px;\n  background-image: linear-gradient(45deg, #eee 25%, transparent 25%, transparent 75%, #eee 75%, #eee 100%), linear-gradient(45deg, #eee 25%, white 25%, white 75%, #eee 75%, #eee 100%);\n  overflow-y: auto !important; }\n\n.component--ImageBackgroundRemover .color {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 40px;\n  -webkit-box-shadow: inset 0 -5px 5px -3px black;\n          box-shadow: inset 0 -5px 5px -3px black;\n  background-color: white; }\n\n.component--ImageBackgroundRemover .previews {\n  position: absolute;\n  left: 0;\n  top: 40px;\n  width: 100%;\n  height: calc(100% - 40px); }\n  .component--ImageBackgroundRemover .previews .modified {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 50%; }\n\n.component--ImageBackgroundRemover .navigation {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n  background-color: white; }\n\n.component--ImageBackgroundRemover .options {\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 999;\n  background-color: white; }\n\n.component--ImageBackgroundRemover button {\n  min-width: 30px;\n  min-height: 30px;\n  border: none;\n  line-height: 20px;\n  padding: 5px;\n  background-color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  border: 1px solid black;\n  color: black; }\n\n.component--ImageBackgroundRemover button + button {\n  margin-left: 5px; }\n",""])},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13),image_1=__webpack_require__(32),logger_1=__webpack_require__(16),object_1=__webpack_require__(3),Dialog_1=__webpack_require__(103),Area_1=__webpack_require__(59),Item_1=__webpack_require__(33),Slider_1=__webpack_require__(104),controller_1=__webpack_require__(235);__webpack_require__(236);var ImageEditor=function(){function ImageEditor(){this.initialized=!1,this.scale=1,this.rotateValue=0,this.zoomLevel=0}return ImageEditor.prototype.oninit=function(v){this.domEA=eventaggregator_1.default.getInstance("dom"),this.targetDimension={width:v.attrs.position.width,height:v.attrs.position.height}},ImageEditor.prototype.oncreate=function(v){var _this=this;this.resizeEvent=this.domEA.on("resize",function(event){_this.updateScale(),_this.updateImagePosition()}),this.scrollEvent=this.domEA.on("scroll",function(event){event.deltaY>0?_this.zoom(-1):event.deltaY<0&&_this.zoom(1)}),this.initialize()},ImageEditor.prototype.onremove=function(v){this.resizeEvent.off(),this.scrollEvent.off()},ImageEditor.prototype.view=function(v){var _this=this,scaledAreaDimension=helpers_1.setScale(this.targetDimension,this.scale);return m(Dialog_1.default,{className:object_1.cleanString("component--ImageEditor","open",v.attrs.className)},m("div",{className:"area",oninit:function(vnode){return _this.containerVnode=vnode}},m(Area_1.default,{type:"rotater"},m(Item_1.default,{type:"rotater",oninit:function(vnode){return _this.itemVnode=vnode},preventResize:!0,onitemmove:function(){return _this.updateImagePosition()}},m("img",{className:"back",src:v.attrs.src,oninit:function(vnode){return _this.backImageVnode=vnode}}))),m("div",{className:"image-area",style:dom_1.getRectStyle(scaledAreaDimension),oninit:function(vnode){return _this.imageAreaVnode=vnode}},m("img",{className:"front",src:v.attrs.src,oninit:function(vnode){return _this.frontImageVnode=vnode}}))),m("div",{className:"options"},m("button",{onclick:function(event){return _this.zoom(1)}},"zoom in"),m("button",{onclick:function(event){return _this.zoom(-1)}},"zoom out"),m(Slider_1.default,{label:"rotate",min:0,max:360,step:1,value:0,oninput:function(value,event){_this.rotateValue=value,_this.updateImagePosition()}})),m("div",{className:"navigation"},m("button",{onclick:function(event){return _this.crop(scaledAreaDimension,_this.imagePosition,v.attrs.src,v.attrs.onsubmit,event).then(function(){return v.attrs.onclose(event)})}},"save"),m("button",{onclick:function(event){return object_1.exec(v.attrs.onclose,event)}},"close")))},ImageEditor.prototype.initialize=function(){var _this=this;!0!==this.initialized&&setTimeout(function(){try{_this.updateScale();var containerRect=_this.containerVnode.dom.getBoundingClientRect(),areaRect=_this.imageAreaVnode.dom.getBoundingClientRect(),itemRect=_this.itemVnode.state.getBoundingClientRect();_this.updateDragItemPosition(controller_1.getScaledItemRect(containerRect,areaRect,itemRect)),_this.updateImagePosition(),_this.initialized=!0}catch(err){logger_1.default(err),_this.initialize()}},25)},ImageEditor.prototype.updateScale=function(){var containerRect=this.containerVnode.dom.getBoundingClientRect();this.scale=controller_1.getAreaScale(this.targetDimension,containerRect),m.redraw()},ImageEditor.prototype.updateDragItemPosition=function(position){this.itemVnode.state.updatePosition(position)},ImageEditor.prototype.updateImagePosition=function(){var areaRect=this.imageAreaVnode.dom.getBoundingClientRect(),itemRect=this.itemVnode.state.getBoundingClientRect();this.imagePosition=controller_1.getRelativePosition(itemRect,areaRect),dom_1.setStyle(this.backImageVnode.dom,{transform:controller_1.getRotateStyleProp(this.rotateValue)}),dom_1.setStyle(this.frontImageVnode.dom,__assign({transform:controller_1.getRotateStyleProp(this.rotateValue)},dom_1.getRectStyle(this.imagePosition)))},ImageEditor.prototype.crop=function(areaDimension,imagePosition,src,onsubmit,event){return __awaiter(this,void 0,void 0,function(){var previewNode,modifiedSrc;return __generator(this,function(_a){switch(_a.label){case 0:return previewNode=controller_1.initializePreview(),m.render(previewNode,m("div",{style:controller_1.getContainerStyle(areaDimension)},m("img",{src:src,style:controller_1.getImgStyle(imagePosition,this.rotateValue)}))),[4,image_1.domToImage(previewNode)];case 1:return modifiedSrc=_a.sent(),m.render(previewNode,null),object_1.exec(onsubmit,modifiedSrc,event),[2]}})})},ImageEditor.prototype.zoom=function(direction){if(direction>0?this.zoomLevel++:this.zoomLevel--,this.zoomLevel>=15)return void(this.zoomLevel=15);if(this.zoomLevel<=-15)return void(this.zoomLevel=-15);var containerRect=this.containerVnode.dom.getBoundingClientRect(),itemRect=this.itemVnode.state.getBoundingClientRect();this.updateDragItemPosition(controller_1.zoom(containerRect,itemRect,direction)),this.updateImagePosition()},ImageEditor.prototype.rotate=function(amount){this.rotateValue=controller_1.rotate(this.rotateValue,amount),this.updateImagePosition()},ImageEditor}();exports.default=ImageEditor},function(module,exports,__webpack_require__){var content=__webpack_require__(232);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--DragItem {\n  position: relative;\n  min-width: 10px;\n  min-height: 10px; }\n  .component--DragItem.handle {\n    cursor: move; }\n  .component--DragItem > .handle {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 6px;\n    height: 6px;\n    cursor: move;\n    z-index: 1;\n    background-color: rgba(0, 0, 0, 0.4); }\n  .component--DragItem.focus {\n    -webkit-box-shadow: inset 0 0 0 2px black;\n            box-shadow: inset 0 0 0 2px black; }\n  .component--DragItem > .border {\n    position: absolute;\n    z-index: 1; }\n    .component--DragItem > .border.left {\n      left: -6.66667px;\n      top: 0;\n      height: 100%;\n      width: 20px;\n      cursor: w-resize; }\n    .component--DragItem > .border.right {\n      right: -6.66667px;\n      top: 0;\n      height: 100%;\n      width: 20px;\n      cursor: w-resize; }\n    .component--DragItem > .border.top {\n      left: 0;\n      top: -6.66667px;\n      width: 100%;\n      height: 20px;\n      cursor: n-resize; }\n    .component--DragItem > .border.bottom {\n      left: 0;\n      bottom: -6.66667px;\n      width: 100%;\n      height: 20px;\n      cursor: n-resize; }\n\n.component--DragItem,\n.component--DragItem * {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none; }\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(234);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--DragArea {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden; }\n\n.component--DragArea,\n.component--DragArea * {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none; }\n",""])},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var preview,dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13);exports.initializePreview=function(){return void 0!==preview?preview:(preview=document.createElement("div"),preview.style.position="fixed",preview.style.top="0",preview.style.left="0",preview.style.zIndex="-100",preview.style.pointerEvents="none",document.body.appendChild(preview),preview)},exports.zoomIn=function(position){var diffW=.2*position.width,diffH=.2*position.height;return position.left-=diffW/2,position.top-=diffH/2,position.width+=diffW,position.height+=diffH,position},exports.zoomOut=function(position){var diffW=.2*position.width,diffH=.2*position.height;return position.top+=diffH/2,position.left+=diffW/2,position.width-=diffW,position.height-=diffH,position},exports.rotate=function(rotation,amount){return rotation+=amount,rotation>360?rotation-=360:rotation<0&&(rotation+=360),rotation},exports.zoom=function(containerRect,itemRect,direction){var nextPos=direction>0?exports.zoomIn(itemRect):exports.zoomOut(itemRect);return exports.getRelativePosition(nextPos,containerRect)},exports.getRelativePosition=function(fixedPosition,parentPosition){var position=__assign({},fixedPosition);return position.left-=parentPosition.left,position.top-=parentPosition.top,position},exports.getContainerStyle=function(areaDimension){return{position:"relative",width:areaDimension.width+"px",height:areaDimension.height+"px",overflow:"hidden"}},exports.getImgStyle=function(imagePosition,rotation){return __assign({position:"absolute",objectFit:"cover",width:"100%",height:"100%"},dom_1.getRectStyle(imagePosition),{transform:exports.getRotateStyleProp(rotation)})},exports.getRotateStyleProp=function(rotation){return"rotate("+rotation+"deg)"},exports.getAreaScale=function(target,containerRect){return helpers_1.getScale(target,{width:.8*containerRect.width,height:.8*containerRect.height})},exports.getScaledItemRect=function(containerRect,areaRect,itemRect){var leftOffset=areaRect.left-containerRect.left,topOffset=areaRect.top-containerRect.top,scale=helpers_1.getScale(itemRect,areaRect,!0),width=itemRect.width*scale,height=itemRect.height*scale,left=(width>areaRect.width?(areaRect.width-width)/2:0)+leftOffset;return{top:(height>areaRect.height?(areaRect.height-height)/2:0)+topOffset,left:left,width:width,height:height}}},function(module,exports,__webpack_require__){var content=__webpack_require__(237);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'.component--ImageEditor .dialog {\n  overflow: hidden; }\n\n.component--ImageEditor .area {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  overflow: hidden; }\n\n.component--ImageEditor .component--DragItem {\n  overflow: visible !important; }\n\n.component--ImageEditor .back {\n  width: 100% !important;\n  height: 100% !important;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -webkit-filter: grayscale(1) opacity(0.5);\n          filter: grayscale(1) opacity(0.5); }\n\n.component--ImageEditor .front {\n  position: absolute;\n  -o-object-fit: cover;\n     object-fit: cover;\n  z-index: 999; }\n\n.component--ImageEditor .image-area {\n  position: absolute;\n  pointer-events: none;\n  background-color: rgba(0, 0, 0, 0.5);\n  overflow: hidden; }\n  .component--ImageEditor .image-area:after {\n    content: "";\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    left: 0;\n    top: 0;\n    display: block; }\n\n.component--ImageEditor .border {\n  background-color: black; }\n\n.component--ImageEditor .navigation {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n  background-color: white; }\n\n.component--ImageEditor .options {\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 999;\n  background-color: white;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.component--ImageEditor button {\n  min-width: 30px;\n  min-height: 30px;\n  border: none;\n  line-height: 20px;\n  padding: 5px;\n  background-color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  border: 1px solid black;\n  color: black; }\n\n.component--ImageEditor button + button {\n  margin-left: 5px; }\n',""])},function(module,exports,__webpack_require__){var content=__webpack_require__(239);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".editor {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap; }\n  .editor .option {\n    display: inline-block;\n    margin: 0 10px; }\n    .editor .option .option-description {\n      display: block;\n      line-height: 24px;\n      margin: 0 5px 0 0; }\n  .editor button {\n    min-width: 30px;\n    min-height: 30px;\n    border: none;\n    line-height: 20px;\n    padding: 5px;\n    cursor: pointer; }\n  .editor button + button {\n    margin-left: 5px; }\n  .editor .filterOptions {\n    width: 180px; }\n    .editor .filterOptions .option, .editor .filterOptions .value {\n      position: relative;\n      overflow: hidden; }\n      .editor .filterOptions .option .image-wrapper, .editor .filterOptions .value .image-wrapper {\n        position: absolute;\n        top: 0;\n        right: 0;\n        height: 30px;\n        width: 60px;\n        overflow: hidden; }\n  .editor .colorSelectPicker {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),logger_1=__webpack_require__(16),EditorDrawerController=function(){function EditorDrawerController(){var _this=this;this.scale=1,easydeps_1.default.getInstance().invoke(function(productManager){_this.manager=productManager})}return EditorDrawerController.prototype.refresh=function(){try{this.holder=this.manager.getHolder(),this.layout=this.manager.getLayout(),this.options=this.manager.getContentOptions(),this.scale=this.manager.getPreviewScale()}catch(err){logger_1.default(err),this.holder=void 0,this.layout=void 0}return{layout:this.layout,holder:this.holder,options:this.options,scale:this.scale}},EditorDrawerController.prototype.getEditorOptions=function(){return{depth:this.layout&&!0!==this.layout.fixed,type:this.holder&&this.holder.content&&this.holder.content.type}},EditorDrawerController.prototype.update=function(update){if(!this.holder)return void logger_1.default(new Error("Cannot update the holder. this.holder is undefined"));update.id=this.holder.id,this.manager.updateHolder(update)},EditorDrawerController}();exports.default=EditorDrawerController},function(module,exports,__webpack_require__){var content=__webpack_require__(242);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,"",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),object_1=__webpack_require__(3);__webpack_require__(244);var Row=function(){function Row(){}return Row.prototype.view=function(v){return m("div",{className:object_1.cleanString("row",v.attrs.fixed&&"row--fixed",v.attrs.halign&&"row-h-align--"+v.attrs.halign,v.attrs.valign&&"row-v-align--"+v.attrs.valign,v.attrs.className),style:v.attrs.style},v.children)},Row}();exports.Row=Row;var Col=function(){function Col(){}return Col.prototype.view=function(v){return m("div",{className:object_1.cleanString(v.attrs.fixed&&"col--fixed","col",v.attrs.halign&&"col-h-align--"+v.attrs.halign,v.attrs.valign&&"col-v-align--"+v.attrs.valign,v.attrs.className),style:v.attrs.style},v.children)},Col}();exports.Col=Col},function(module,exports,__webpack_require__){var content=__webpack_require__(245);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".row {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -ms-flex-preferred-size: auto;\n      flex-basis: auto;\n  -ms-flex-negative: 1;\n      flex-shrink: 1;\n  -webkit-box-flex: 0;\n      -ms-flex-positive: 0;\n          flex-grow: 0;\n  width: auto;\n  height: auto; }\n\n.col {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -ms-flex-preferred-size: 100%;\n      flex-basis: 100%;\n  -ms-flex-negative: 1;\n      flex-shrink: 1;\n  -webkit-box-flex: 1;\n      -ms-flex-positive: 1;\n          flex-grow: 1;\n  width: 0;\n  height: auto; }\n\n.col--fixed {\n  -webkit-box-flex: 0;\n      -ms-flex: none;\n          flex: none;\n  width: auto;\n  height: auto; }\n\n.row-h-align--start {\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start; }\n\n.row-h-align--end {\n  -webkit-box-pack: end;\n      -ms-flex-pack: end;\n          justify-content: flex-end; }\n\n.row-h-align--center {\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center; }\n\n.row-h-align--between {\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between; }\n\n.row-h-align--around {\n  -ms-flex-pack: distribute;\n      justify-content: space-around; }\n\n.row-h-align--even {\n  -webkit-box-pack: space-evenly;\n      -ms-flex-pack: space-evenly;\n          justify-content: space-evenly; }\n\n.row-v-align--start {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start; }\n\n.row-v-align--end {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end; }\n\n.row-v-align--center {\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center; }\n\n.row-v-align--stretch {\n  -webkit-box-align: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch; }\n\n.row-v-align--baseline {\n  -webkit-box-align: baseline;\n      -ms-flex-align: baseline;\n          align-items: baseline; }\n\n.col-h-align--start {\n  justify-self: flex-start; }\n\n.col-h-align--end {\n  justify-self: flex-end; }\n\n.col-h-align--center {\n  justify-self: center; }\n\n.col-h-align--between {\n  justify-self: space-between; }\n\n.col-h-align--around {\n  justify-self: space-around; }\n\n.col-h-align--even {\n  justify-self: space-evenly; }\n\n.col-v-align--start {\n  -ms-flex-item-align: start;\n      align-self: flex-start; }\n\n.col-v-align--end {\n  -ms-flex-item-align: end;\n      align-self: flex-end; }\n\n.col-v-align--center {\n  -ms-flex-item-align: center;\n      align-self: center; }\n\n.col-v-align--stretch {\n  -ms-flex-item-align: stretch;\n      align-self: stretch; }\n\n.col-v-align--baseline {\n  -ms-flex-item-align: baseline;\n      align-self: baseline; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),ContextMenu_1=__webpack_require__(247),index_1=__webpack_require__(60),dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13),object_1=__webpack_require__(3),Holder_1=__webpack_require__(58),controller_1=__webpack_require__(254);__webpack_require__(255);var HolderDrawer=function(){function HolderDrawer(){this.controller=new controller_1.default}return HolderDrawer.prototype.view=function(v){var _this=this,_a=this.controller.refresh(),holders=_a.holders,manager=(_a.layout,_a.manager);return m("div",{className:object_1.cleanString("component--HolderDrawer",v.attrs.className)},m("span",{className:"element-description"},"Used Holders"),m(index_1.default,{className:"defaultLib",oncontainercreate:function(container){return _this.itemsContainer=container}},holders.map(function(holder,index){var scale=_this.itemsContainer?helpers_1.getScale(holder.position,dom_1.getInnerRect(_this.itemsContainer)):1;return holder=manager.getScaledHolder(holder,scale),m("div",{style:dom_1.getRectStyle({width:holder.position.width,height:holder.position.height})},m(Holder_1.default,{key:holder.id,holder:holder,onclick:function(){return manager.setCurrentHolder(holder.id)},thumb:!0}),m(ContextMenu_1.default,null,m("span",{onclick:function(){return manager.removeHolder(holder.id)}},"Remove"),m("span",{onclick:function(){var position={left:0,top:0};holder.position.width<10&&(position.width=10),holder.position.height<10&&(position.height=10),manager.updateHolder({id:holder.id,position:position})}}," Reset position"),m("span",{onclick:function(){return manager.updateHolder({id:holder.id,depth:-holders.length})}},"Move to back"),m("span",{onclick:function(){return manager.updateHolder({id:holder.id,depth:holders.length})}},"Move to front")))})))},HolderDrawer}();exports.default=HolderDrawer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),controller_1=__webpack_require__(248);__webpack_require__(249);var ContextMenu=function(){function ContextMenu(){this.controller=new controller_1.default}return ContextMenu.createCTX=function(){ContextMenu.ctx||(ContextMenu.ctx=document.createElement("div"),ContextMenu.ctx.classList.add("component--context-menu"),ContextMenu.ctx.style.position="fixed",ContextMenu.ctx.style.zIndex="999",document.body.appendChild(ContextMenu.ctx))},ContextMenu.showCTX=function(event,className,ctxData){className&&ContextMenu.ctx.classList.add(className),ContextMenu.ctx.style.display="block",ContextMenu.ctx.style.top=event.clientY+"px",ContextMenu.ctx.style.left=event.clientX+"px",m.render(ContextMenu.ctx,ctxData)},ContextMenu.hideCTX=function(className){className&&ContextMenu.ctx.classList.remove(className),ContextMenu.ctx.style.display="none"},ContextMenu.prototype.oncreate=function(vnode){this.reload(vnode)},ContextMenu.prototype.view=function(vnode){return m("span",{style:{display:"none"}})},ContextMenu.prototype.onupdate=function(vnode){this.controller.updateData(vnode.children),this.reload(vnode)},ContextMenu.prototype.onremove=function(vnode){this.controller.destroy()},ContextMenu.prototype.reload=function(vnode){var container=vnode.dom.parentElement;container&&(void 0===ContextMenu.ctx&&ContextMenu.createCTX(),this.controller.onShow(container,function(event){ContextMenu.showCTX(event,vnode.attrs.className,vnode.children)}),this.controller.onHide(ContextMenu.ctx,function(event){ContextMenu.hideCTX(vnode.attrs.className)}))},ContextMenu}();exports.default=ContextMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),dom_1=__webpack_require__(7),domEA=eventaggregator_1.default.getInstance("dom"),ContextMenuController=function(){function ContextMenuController(){this.ctxData=null,this.events=[]}return ContextMenuController.prototype.destroy=function(){this.events.forEach(function(event){return event.off()})},ContextMenuController.prototype.on=function(event,callback){this.events.push(domEA.on(event,callback))},ContextMenuController.prototype.onShow=function(container,callback){var _this=this;this.on("contextmenu",function(event){event.shiftKey||!1===_this.pathContains(event.path,container)||(dom_1.devent(event,{preventDefault:!0,stopPropagation:!0}),callback(event))})},ContextMenuController.prototype.onHide=function(container,callback){this.on(["keydown","click"],function(event){callback(event)})},ContextMenuController.prototype.updateData=function(data){this.ctxData=data},ContextMenuController.prototype.pathContains=function(path,container){return-1!==path.indexOf(container)},ContextMenuController}();exports.default=ContextMenuController},function(module,exports,__webpack_require__){var content=__webpack_require__(250);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--context-menu {\n  background-color: white;\n  padding: 0;\n  margin: 0;\n  -webkit-box-shadow: 4px 4px 4px -2px rgba(0, 0, 0, 0.5);\n          box-shadow: 4px 4px 4px -2px rgba(0, 0, 0, 0.5);\n  width: 100px;\n  overflow: hidden;\n  border: 1px solid #ccc; }\n  .component--context-menu > * {\n    padding: 4px;\n    font-family: sans-serif;\n    margin: 0;\n    text-align: left;\n    color: black;\n    font-size: small;\n    display: block;\n    width: calc(100% - 8px);\n    background-color: white;\n    border: none;\n    text-decoration: none;\n    cursor: pointer; }\n    .component--context-menu > *:hover {\n      background-color: #eee; }\n  .component--context-menu > .seperator {\n    border-bottom: 1px solid #ccc;\n    padding: 0;\n    width: 100%; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),dom_1=__webpack_require__(7),Controller=function(){function Controller(){this.dragSlideStarted=!1,this.events=[],this.page=0,this.interval=null,this.speed=20,this.domEA=eventaggregator_1.default.getInstance("dom")}return Controller.prototype.construct=function(){var _this=this;this.events.push(this.domEA.on("resize",function(event){return _this.refreshAll()})),this.events.push(this.domEA.on(["mousemove","touchmove"],function(event){return _this.dragSlide(event)})),this.events.push(this.domEA.on(["mouseup","touchend"],function(event){return _this.stopDragSlide(event)}))},Controller.prototype.destruct=function(){this.events.forEach(function(event){return event.off()})},Controller.prototype.refresh=function(){var _this=this;this.horizontal=this.isContainerHorizontal(),setTimeout(function(){return _this.refreshAll()})},Controller.prototype.navigate=function(direction){null===this.interval&&(this.refreshAll(),direction>0?this.nextPage():this.prevPage())},Controller.prototype.startDragSlide=function(event){if(null===this.interval){dom_1.devent(event,{stopPropagation:!0}),this.dragSlideStarted=!0;var _a=dom_1.getClientXY(event),x=_a.x,y=_a.y;this.dragStartPos={left:x,top:y}}},Controller.prototype.dragSlide=function(event){if(this.dragSlideStarted&&null===this.interval){dom_1.devent(event,{stopPropagation:!0});var _a=dom_1.getClientXY(event),x=_a.x,y=_a.y,threshold=this.getContainerSize()/4;this.horizontal?(x-this.dragStartPos.left>threshold&&(this.prevPage(),this.dragStartPos={left:x,top:y}),x-this.dragStartPos.left<-threshold&&(this.nextPage(),this.dragStartPos={left:x,top:y})):(y-this.dragStartPos.top>threshold&&(this.prevPage(),this.dragStartPos={left:x,top:y}),y-this.dragStartPos.top<-threshold&&(this.nextPage(),this.dragStartPos={left:x,top:y}))}},Controller.prototype.stopDragSlide=function(event){this.dragSlideStarted&&(dom_1.devent(event,{stopPropagation:!0}),this.dragSlideStarted=!1)},Controller.prototype.isHorizontal=function(rect){return rect.width>=rect.height},Controller.prototype.isContainerHorizontal=function(){return!!this.container&&this.isHorizontal(this.container.getBoundingClientRect())},Controller.prototype.getContainerScrollSize=function(){return this.container["scroll"+(this.horizontal?"Width":"Height")]},Controller.prototype.getContainerSize=function(){return this.container?this.container.getBoundingClientRect()[this.horizontal?"width":"height"]:0},Controller.prototype.getContainerScrollStart=function(){return this.container["scroll"+(this.horizontal?"Left":"Top")]},Controller.prototype.setContainerScrollStart=function(start){this.container["scroll"+(this.horizontal?"Left":"Top")]=start},Controller.prototype.nextPage=function(){var _this=this;this.page++;var maxPage=this.getMaxPage();if(this.page>maxPage)return void(this.page=maxPage);this.getContainerScrollSize();this.interval=setInterval(function(){_this.slideToNext()&&_this.clear()},this.speed)},Controller.prototype.prevPage=function(){var _this=this;if(--this.page<0)return void(this.page=0);this.interval=setInterval(function(){_this.slideToPrev()&&_this.clear()},this.speed)},Controller.prototype.slideToNext=function(){var containerScrollStart=this.getContainerScrollStart(),containerSize=this.getContainerSize(),containerScrollSize=this.getContainerScrollSize(),dest=containerSize*this.page;dest>=containerScrollSize-containerSize&&(dest=containerScrollSize-containerSize,dest=Math.floor(dest));var step=this.getStepSize(dest,containerScrollStart);return 0===step||containerScrollStart>=dest?(this.finishSlide(dest),!0):(this.setContainerScrollStart(containerScrollStart+step),!1)},Controller.prototype.slideToPrev=function(){var containerSize=this.getContainerSize(),containerScrollStart=this.getContainerScrollStart(),dest=containerSize*this.page;(dest=Math.ceil(dest))<0&&(dest=0);var step=this.getStepSize(dest,containerScrollStart);return 0===step||containerScrollStart<=dest?(this.finishSlide(dest),!0):(this.setContainerScrollStart(containerScrollStart-step),!1)},Controller.prototype.finishSlide=function(dest){this.setContainerScrollStart(dest),this.setNextState(),this.setPrevState()},Controller.prototype.setPrevState=function(){this.hasPrev()?this.prev.classList.remove("disabled"):this.prev.classList.add("disabled")},Controller.prototype.setNextState=function(){this.hasNext()?this.next.classList.remove("disabled"):this.next.classList.add("disabled")},Controller.prototype.hasPrev=function(){return this.page>0},Controller.prototype.hasNext=function(){return this.page+1<Math.ceil(parseFloat((this.getContainerScrollSize()/this.getContainerSize()).toFixed(1)))},Controller.prototype.getMaxPage=function(){return Math.ceil(this.getContainerScrollSize()/this.getContainerSize())},Controller.prototype.fixPosition=function(){var containerSize=this.getContainerSize(),containerScrollSize=this.getContainerScrollSize(),dest=containerSize*this.page;dest<0&&(dest=0),dest>=containerScrollSize-containerSize&&(dest=containerScrollSize-containerSize),this.setContainerScrollStart(dest)},Controller.prototype.getStepSize=function(dest,scrollStart){var step=1;return step=dest>scrollStart?(dest-scrollStart)/5:(scrollStart-dest)/5,step<1?0:step},Controller.prototype.refreshAll=function(){this.fixPosition(),this.setPrevState(),this.setNextState()},Controller.prototype.clear=function(){clearInterval(this.interval),this.interval=null},Controller}();exports.default=Controller},function(module,exports,__webpack_require__){var content=__webpack_require__(253);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--library {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n  .component--library > .nav {\n    text-align: center;\n    -webkit-box-flex: 0;\n        -ms-flex: 0 0 auto;\n            flex: 0 0 auto; }\n    .component--library > .nav.prev, .component--library > .nav.next {\n      cursor: pointer; }\n      .component--library > .nav.prev.disabled, .component--library > .nav.next.disabled {\n        display: none; }\n  .component--library > .items {\n    overflow: hidden;\n    -webkit-box-flex: 0;\n        -ms-flex: 0 1 auto;\n            flex: 0 1 auto;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    margin: 5px; }\n    .component--library > .items > .item {\n      position: relative;\n      display: block; }\n      .component--library > .items > .item:last-child {\n        margin: 0; }\n  .component--library.horizontal {\n    width: 100%; }\n    .component--library.horizontal > .nav {\n      line-height: 40px;\n      height: 40px;\n      width: 20px; }\n    .component--library.horizontal > .items {\n      height: 30px;\n      width: 100%; }\n      .component--library.horizontal > .items > .item {\n        height: 30px;\n        margin: 0 5px 0 0; }\n        .component--library.horizontal > .items > .item img {\n          height: 30px; }\n  .component--library.vertical {\n    height: 100%;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column; }\n    .component--library.vertical > .nav {\n      line-height: 20px;\n      width: 100px;\n      height: 20px; }\n    .component--library.vertical > .items {\n      width: 90px;\n      height: 100%;\n      -webkit-box-orient: vertical;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: column;\n              flex-direction: column; }\n      .component--library.vertical > .items > .item {\n        width: 90px;\n        margin: 5px 0 0 0; }\n        .component--library.vertical > .items > .item img {\n          width: 90px; }\n\n.component--library,\n.component--library * {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),logger_1=__webpack_require__(16),HolderDrawerUsedController=function(){function HolderDrawerUsedController(){var _this=this;easydeps_1.default.getInstance().invoke(function(productManager){_this.manager=productManager})}return HolderDrawerUsedController.prototype.refresh=function(){try{this.layout=this.manager.getLayout(),this.holders=this.manager.getHolders()}catch(err){this.holders=[],logger_1.default(err)}return{holders:this.holders,manager:this.manager,layout:this.layout}},HolderDrawerUsedController}();exports.default=HolderDrawerUsedController},function(module,exports,__webpack_require__){var content=__webpack_require__(256);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'.component--HolderDrawer .holder {\n  -webkit-box-shadow: inset 0 0 0 1px black;\n          box-shadow: inset 0 0 0 1px black;\n  background-color: rgba(0, 0, 0, 0.2);\n  top: 0 !important;\n  left: 0 !important; }\n  .component--HolderDrawer .holder.selected:after {\n    -webkit-box-shadow: inset 0 0 0 2px black;\n            box-shadow: inset 0 0 0 2px black;\n    display: block;\n    content: "";\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    position: absolute; }\n',""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),index_1=__webpack_require__(33),Checkbox_1=__webpack_require__(102),index_2=__webpack_require__(258),index_3=__webpack_require__(60),Transition_1=__webpack_require__(22),enums_1=__webpack_require__(17),LocalStorage=__webpack_require__(57),object_1=__webpack_require__(3);__webpack_require__(261);var ImageDrawer=function(){function ImageDrawer(){this.persistent=!0,this.storedImages=[]}return ImageDrawer.prototype.oncreate=function(v){var _this=this;eventaggregator_1.default.getInstance("images").on("add",function(images){images.forEach(function(image){-1===_this.storedImages.findIndex(function(storedImage){return storedImage.name===image.name})&&_this.storedImages.push(image)}),m.redraw()}),this.persistent&&this.setStoredImages(LocalStorage.get("images",this.persistent))},ImageDrawer.prototype.view=function(v){var _this=this;return m("div",{className:object_1.cleanString("component--ImageDrawer",v.attrs.className)},m("span",{className:"element-description"},"Images"),m(index_3.default,{direction:"vertical",className:"defaultLib pixelated",oncontainercreate:function(container){return _this.itemsContainer=container}},this.storedImages.map(function(image,index){var content={value:image.src,type:enums_1.IMAGE,thumb:image.thumb};return m(Transition_1.default,{key:image.name,delay:100,order:index,className:"t--slide-right-bounce"},m(index_1.default,{key:image.name,data:{content:content,imageName:image.name},keepPlaceholder:!0,preventPosition:!0,preventResize:!0},m("img",{src:image.thumb,alt:image.name})))})),m(index_2.default,{preview:!1,quality:.75,multiple:!0,thumb:256,max:1400,label:"NEW",onupload:function(event,images){_this.setStoredImages(LocalStorage.add("images",images,_this.persistent))}}),m(Checkbox_1.default,{checked:this.persistent,label:"Save images",onclick:function(checked){_this.persistent=checked,_this.persistent?LocalStorage.set("images",_this.storedImages):LocalStorage.clear("images")}}))},ImageDrawer.prototype.setStoredImages=function(storedImages){Array.isArray(storedImages)&&(this.storedImages=storedImages,m.redraw())},ImageDrawer}();exports.default=ImageDrawer},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),dom_1=__webpack_require__(7),image_1=__webpack_require__(32),logger_1=__webpack_require__(16),object_1=__webpack_require__(3);__webpack_require__(259);var ImageUploadController=function(){function ImageUploadController(placeholderImage){this.placeholderImage=placeholderImage}return ImageUploadController.prototype.onUpload=function(event,callback,quality,max,thumbmax,preview,multiple,progress){return __awaiter(this,void 0,void 0,function(){var maxWidth,maxHeight,thumbwidth,thumbheight,progressPercentage,upload,files,_a,_b,err_1,images,_i,files_1,file,_c,_d,err_2,_this=this;return __generator(this,function(_e){switch(_e.label){case 0:if(dom_1.devent(event),maxWidth=max?"number"==typeof max?max:max[0]:void 0,maxHeight=max?"number"==typeof max?max:max[1]:void 0,thumbwidth=thumbmax?"number"==typeof thumbmax?thumbmax:thumbmax[0]:void 0,thumbheight=thumbmax?"number"==typeof thumbmax?thumbmax:thumbmax[1]:void 0,progressPercentage=0,upload=function(file,totalFiles){return void 0===totalFiles&&(totalFiles=1),__awaiter(_this,void 0,void 0,function(){var progressPercentageFraction,name,src,thumb;return __generator(this,function(_a){switch(_a.label){case 0:return progressPercentageFraction=100/totalFiles/6,name=file.name,progressPercentage+=progressPercentageFraction,object_1.exec(progress,progressPercentage),[4,image_1.uploadImage(file,{quality:quality,maxWidth:maxWidth,maxHeight:maxHeight})];case 1:return src=_a.sent(),(progressPercentage+=thumbmax?3*progressPercentageFraction:5*progressPercentageFraction,object_1.exec(progress,progressPercentage),thumbmax)?(progressPercentage+=2*progressPercentageFraction,object_1.exec(progress,progressPercentage),[4,image_1.getThumb(src,{quality:.5,maxWidth:thumbwidth,maxHeight:thumbheight})]):[3,3];case 2:thumb=_a.sent(),_a.label=3;case 3:return[2,{name:name,src:src,thumb:thumb}]}})})},files=event.target.files,!1!==multiple)return[3,5];_e.label=1;case 1:return _e.trys.push([1,3,,4]),_a=object_1.exec,_b=[callback],[4,upload(files[0])];case 2:return _a.apply(void 0,_b.concat([_e.sent()])),[3,4];case 3:return err_1=_e.sent(),logger_1.default(err_1),[3,4];case 4:return[2];case 5:images=[],_i=0,files_1=files,_e.label=6;case 6:if(!(_i<files_1.length))return[3,11];file=files_1[_i],_e.label=7;case 7:return _e.trys.push([7,9,,10]),_d=(_c=images).push,[4,upload(file,files.length)];case 8:return _d.apply(_c,[_e.sent()]),[3,10];case 9:return err_2=_e.sent(),logger_1.default(err_2),[3,10];case 10:return _i++,[3,6];case 11:return object_1.exec(callback,images),[2]}})})},ImageUploadController}(),ImageUpload=function(){function ImageUpload(){this.controller=new ImageUploadController,this.progress=0,this.events=[],this.windowDrag=!1,this.fullscreenDropStyle={width:"100vw",height:"100vh",top:"0",left:"0",position:"fixed",zIndex:"999"}}return ImageUpload.prototype.oncreate=function(v){var _this=this,ea=eventaggregator_1.default.getInstance("dom");this.events.push(ea.on("dragenter",function(event,e){_this.windowDrag||(_this.windowDrag=!0,m.redraw())})),this.events.push(ea.on("dragleave",function(event,e){_this.windowDrag&&-1!==event.path.indexOf(v.dom)&&(_this.windowDrag=!1,m.redraw())}))},ImageUpload.prototype.onremove=function(v){this.events.forEach(function(e){return e.off()}),this.events=[]},ImageUpload.prototype.view=function(v){var _this=this;return m("div",{className:object_1.cleanString("component--ImageUpload",v.attrs.className),style:this.windowDrag?this.fullscreenDropStyle:{}},m("label",null,m("input",{type:"file",multiple:v.attrs.multiple,accept:".jpg, .jpeg, .png",onchange:function(event){return _this.controller.onUpload(event,function(images){object_1.exec(v.attrs.onupload,event,images),_this.progress=0,_this.windowDrag=!1,m.redraw()},v.attrs.quality,v.attrs.max,v.attrs.thumb,v.attrs.preview,v.attrs.multiple,function(progress){object_1.exec(v.attrs.onprogress,progress),_this.progress=progress,m.redraw()})}}),m("div",{className:"drop-zone"},m("div",{className:"area"},m("div",{className:"progress percentage-"+Math.round(this.progress)}),this.progress>0?(v.attrs.progresslabel?v.attrs.label+" ":"")+this.progress.toFixed(2)+"%":this.windowDrag?v.attrs.droplabel||"Drop your images here":v.attrs.label||"Click here or drop your images"))),v.attrs.preview&&this.controller.src&&m("img",{src:this.controller.src,alt:"preview"}))},ImageUpload}();exports.default=ImageUpload},function(module,exports,__webpack_require__){var content=__webpack_require__(260);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--ImageUpload label {\n  position: relative;\n  display: inline-block;\n  cursor: pointer;\n  width: 100%;\n  height: 100%; }\n\n.component--ImageUpload input[type=file] {\n  display: block;\n  cursor: pointer;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%; }\n\n.component--ImageUpload .drop-zone {\n  width: calc(100% - 6px);\n  height: calc(100% - 6px);\n  background-color: white;\n  position: absolute;\n  top: 0;\n  left: 0;\n  cursor: pointer;\n  pointer-events: none;\n  font-family: sans-serif;\n  padding: 3px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -ms-flex-line-pack: center;\n      align-content: center; }\n  .component--ImageUpload .drop-zone:hover > .area {\n    background-color: lightgreen; }\n  .component--ImageUpload .drop-zone > .area {\n    border: 2px dashed black;\n    width: calc(100% - 4px);\n    height: calc(100% - 4px);\n    display: block;\n    -webkit-transition: all .2s;\n    transition: all .2s;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex; }\n    .component--ImageUpload .drop-zone > .area > .progress {\n      height: 100%;\n      width: 0%;\n      position: absolute;\n      top: 0;\n      left: 0;\n      background-color: rgba(0, 202, 17, 0.5);\n      will-change: width;\n      -webkit-transition: all .25s linear;\n      transition: all .25s linear; }\n\n.component--ImageUpload .percentage-1 {\n  width: 1% !important; }\n\n.component--ImageUpload .percentage-2 {\n  width: 2% !important; }\n\n.component--ImageUpload .percentage-3 {\n  width: 3% !important; }\n\n.component--ImageUpload .percentage-4 {\n  width: 4% !important; }\n\n.component--ImageUpload .percentage-5 {\n  width: 5% !important; }\n\n.component--ImageUpload .percentage-6 {\n  width: 6% !important; }\n\n.component--ImageUpload .percentage-7 {\n  width: 7% !important; }\n\n.component--ImageUpload .percentage-8 {\n  width: 8% !important; }\n\n.component--ImageUpload .percentage-9 {\n  width: 9% !important; }\n\n.component--ImageUpload .percentage-10 {\n  width: 10% !important; }\n\n.component--ImageUpload .percentage-11 {\n  width: 11% !important; }\n\n.component--ImageUpload .percentage-12 {\n  width: 12% !important; }\n\n.component--ImageUpload .percentage-13 {\n  width: 13% !important; }\n\n.component--ImageUpload .percentage-14 {\n  width: 14% !important; }\n\n.component--ImageUpload .percentage-15 {\n  width: 15% !important; }\n\n.component--ImageUpload .percentage-16 {\n  width: 16% !important; }\n\n.component--ImageUpload .percentage-17 {\n  width: 17% !important; }\n\n.component--ImageUpload .percentage-18 {\n  width: 18% !important; }\n\n.component--ImageUpload .percentage-19 {\n  width: 19% !important; }\n\n.component--ImageUpload .percentage-20 {\n  width: 20% !important; }\n\n.component--ImageUpload .percentage-21 {\n  width: 21% !important; }\n\n.component--ImageUpload .percentage-22 {\n  width: 22% !important; }\n\n.component--ImageUpload .percentage-23 {\n  width: 23% !important; }\n\n.component--ImageUpload .percentage-24 {\n  width: 24% !important; }\n\n.component--ImageUpload .percentage-25 {\n  width: 25% !important; }\n\n.component--ImageUpload .percentage-26 {\n  width: 26% !important; }\n\n.component--ImageUpload .percentage-27 {\n  width: 27% !important; }\n\n.component--ImageUpload .percentage-28 {\n  width: 28% !important; }\n\n.component--ImageUpload .percentage-29 {\n  width: 29% !important; }\n\n.component--ImageUpload .percentage-30 {\n  width: 30% !important; }\n\n.component--ImageUpload .percentage-31 {\n  width: 31% !important; }\n\n.component--ImageUpload .percentage-32 {\n  width: 32% !important; }\n\n.component--ImageUpload .percentage-33 {\n  width: 33% !important; }\n\n.component--ImageUpload .percentage-34 {\n  width: 34% !important; }\n\n.component--ImageUpload .percentage-35 {\n  width: 35% !important; }\n\n.component--ImageUpload .percentage-36 {\n  width: 36% !important; }\n\n.component--ImageUpload .percentage-37 {\n  width: 37% !important; }\n\n.component--ImageUpload .percentage-38 {\n  width: 38% !important; }\n\n.component--ImageUpload .percentage-39 {\n  width: 39% !important; }\n\n.component--ImageUpload .percentage-40 {\n  width: 40% !important; }\n\n.component--ImageUpload .percentage-41 {\n  width: 41% !important; }\n\n.component--ImageUpload .percentage-42 {\n  width: 42% !important; }\n\n.component--ImageUpload .percentage-43 {\n  width: 43% !important; }\n\n.component--ImageUpload .percentage-44 {\n  width: 44% !important; }\n\n.component--ImageUpload .percentage-45 {\n  width: 45% !important; }\n\n.component--ImageUpload .percentage-46 {\n  width: 46% !important; }\n\n.component--ImageUpload .percentage-47 {\n  width: 47% !important; }\n\n.component--ImageUpload .percentage-48 {\n  width: 48% !important; }\n\n.component--ImageUpload .percentage-49 {\n  width: 49% !important; }\n\n.component--ImageUpload .percentage-50 {\n  width: 50% !important; }\n\n.component--ImageUpload .percentage-51 {\n  width: 51% !important; }\n\n.component--ImageUpload .percentage-52 {\n  width: 52% !important; }\n\n.component--ImageUpload .percentage-53 {\n  width: 53% !important; }\n\n.component--ImageUpload .percentage-54 {\n  width: 54% !important; }\n\n.component--ImageUpload .percentage-55 {\n  width: 55% !important; }\n\n.component--ImageUpload .percentage-56 {\n  width: 56% !important; }\n\n.component--ImageUpload .percentage-57 {\n  width: 57% !important; }\n\n.component--ImageUpload .percentage-58 {\n  width: 58% !important; }\n\n.component--ImageUpload .percentage-59 {\n  width: 59% !important; }\n\n.component--ImageUpload .percentage-60 {\n  width: 60% !important; }\n\n.component--ImageUpload .percentage-61 {\n  width: 61% !important; }\n\n.component--ImageUpload .percentage-62 {\n  width: 62% !important; }\n\n.component--ImageUpload .percentage-63 {\n  width: 63% !important; }\n\n.component--ImageUpload .percentage-64 {\n  width: 64% !important; }\n\n.component--ImageUpload .percentage-65 {\n  width: 65% !important; }\n\n.component--ImageUpload .percentage-66 {\n  width: 66% !important; }\n\n.component--ImageUpload .percentage-67 {\n  width: 67% !important; }\n\n.component--ImageUpload .percentage-68 {\n  width: 68% !important; }\n\n.component--ImageUpload .percentage-69 {\n  width: 69% !important; }\n\n.component--ImageUpload .percentage-70 {\n  width: 70% !important; }\n\n.component--ImageUpload .percentage-71 {\n  width: 71% !important; }\n\n.component--ImageUpload .percentage-72 {\n  width: 72% !important; }\n\n.component--ImageUpload .percentage-73 {\n  width: 73% !important; }\n\n.component--ImageUpload .percentage-74 {\n  width: 74% !important; }\n\n.component--ImageUpload .percentage-75 {\n  width: 75% !important; }\n\n.component--ImageUpload .percentage-76 {\n  width: 76% !important; }\n\n.component--ImageUpload .percentage-77 {\n  width: 77% !important; }\n\n.component--ImageUpload .percentage-78 {\n  width: 78% !important; }\n\n.component--ImageUpload .percentage-79 {\n  width: 79% !important; }\n\n.component--ImageUpload .percentage-80 {\n  width: 80% !important; }\n\n.component--ImageUpload .percentage-81 {\n  width: 81% !important; }\n\n.component--ImageUpload .percentage-82 {\n  width: 82% !important; }\n\n.component--ImageUpload .percentage-83 {\n  width: 83% !important; }\n\n.component--ImageUpload .percentage-84 {\n  width: 84% !important; }\n\n.component--ImageUpload .percentage-85 {\n  width: 85% !important; }\n\n.component--ImageUpload .percentage-86 {\n  width: 86% !important; }\n\n.component--ImageUpload .percentage-87 {\n  width: 87% !important; }\n\n.component--ImageUpload .percentage-88 {\n  width: 88% !important; }\n\n.component--ImageUpload .percentage-89 {\n  width: 89% !important; }\n\n.component--ImageUpload .percentage-90 {\n  width: 90% !important; }\n\n.component--ImageUpload .percentage-91 {\n  width: 91% !important; }\n\n.component--ImageUpload .percentage-92 {\n  width: 92% !important; }\n\n.component--ImageUpload .percentage-93 {\n  width: 93% !important; }\n\n.component--ImageUpload .percentage-94 {\n  width: 94% !important; }\n\n.component--ImageUpload .percentage-95 {\n  width: 95% !important; }\n\n.component--ImageUpload .percentage-96 {\n  width: 96% !important; }\n\n.component--ImageUpload .percentage-97 {\n  width: 97% !important; }\n\n.component--ImageUpload .percentage-98 {\n  width: 98% !important; }\n\n.component--ImageUpload .percentage-99 {\n  width: 99% !important; }\n\n.component--ImageUpload .percentage-100 {\n  width: 100% !important; }\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(262);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--ImageDrawer {\n  width: 100px; }\n  .component--ImageDrawer .component--library {\n    height: calc(100% - 105px); }\n  .component--ImageDrawer .component--ImageUpload {\n    height: 40px; }\n    .component--ImageDrawer .component--ImageUpload label {\n      overflow: hidden;\n      width: 100%;\n      width: 100%; }\n    .component--ImageDrawer .component--ImageUpload .drop-zone {\n      overflow: hidden; }\n  .component--ImageDrawer .component--Checkbox {\n    margin-top: 10px;\n    width: 100%;\n    font-size: 14px; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),index_1=__webpack_require__(60),Transition_1=__webpack_require__(22),object_1=__webpack_require__(3),Layout_1=__webpack_require__(264),controller_1=__webpack_require__(267);__webpack_require__(268);var LayoutDrawer=function(){function LayoutDrawer(){this.controller=new controller_1.default}return LayoutDrawer.prototype.view=function(v){var _this=this,layouts=this.controller.refresh().layouts;return m("div",{className:object_1.cleanString("component--LayoutDrawer",v.attrs.className)},m("span",{className:"element-description"},"Layouts"),m(index_1.default,{className:"defaultLib"},layouts.map(function(layout,index){return m(Transition_1.default,{key:layout.id,className:"t--slide-down-bounce",delay:100,order:index},m(Layout_1.default,{position:layout.position,holders:layout.holders,selected:layout.selected,onclick:function(){return _this.controller.setCurrentLayout(layout.id)}}))})))},LayoutDrawer}();exports.default=LayoutDrawer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13),object_1=__webpack_require__(3),iconText=__webpack_require__(105),iconImage=__webpack_require__(106),iconShape=__webpack_require__(107),index_1=__webpack_require__(17);__webpack_require__(265);var getPlaceholderContentIcon=function(holder){var icons=[];return-1!==holder.type.indexOf(index_1.IMAGE)&&icons.push(m("div",null,m("img",{oncreate:function(_a){var dom=_a.dom;return dom_1.preventDrag(dom)},src:iconImage,alt:"icon-image"}))),-1!==holder.type.indexOf(index_1.TEXT)&&icons.push(m("div",null,m("img",{oncreate:function(_a){var dom=_a.dom;return dom_1.preventDrag(dom)},src:iconText,alt:"icon-text"}))),-1!==holder.type.indexOf(index_1.SHAPE)&&icons.push(m("div",null,m("img",{oncreate:function(_a){var dom=_a.dom;return dom_1.preventDrag(dom)},src:iconShape,alt:"icon-shape"}))),m("div",null,icons)},Layout=function(){function Layout(){}return Layout.prototype.view=function(vnode){return m("div",{className:object_1.cleanString("component--Layout",vnode.attrs.className,vnode.attrs.selected&&"selected"),onclick:function(event){return object_1.exec(vnode.attrs.onclick,dom_1.devent(event))}},vnode.attrs.holders&&vnode.attrs.holders.map(function(h){return m("div",{className:"holder"},getPlaceholderContentIcon(h))}))},Layout.prototype.oncreate=function(vnode){this.updateScale(vnode.dom,vnode.attrs.position,vnode.attrs.holders)},Layout.prototype.onupdate=function(vnode){this.updateScale(vnode.dom,vnode.attrs.position,vnode.attrs.holders)},Layout.prototype.updateScale=function(dom,position,holders){var scale=dom_1.getScaleFromFirstContainer(dom,"items",position),scaled=helpers_1.setScale(position,scale),_a=dom_1.getRectStyle(scaled),width=_a.width,height=_a.height;dom_1.setStyle(dom,{width:width,height:height}),Array.from(dom.children).forEach(function(child,i){return dom_1.setStyle(child,dom_1.getRectStyle(helpers_1.setScale(holders[i].position,scale)))})},Layout}();exports.default=Layout},function(module,exports,__webpack_require__){var content=__webpack_require__(266);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--Layout {\n  background-color: white;\n  position: relative; }\n  .component--Layout .holder {\n    position: absolute;\n    background-color: rgba(0, 0, 0, 0.2);\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center; }\n    .component--Layout .holder > .type-image {\n      max-height: 80%;\n      max-width: 80%; }\n      .component--Layout .holder > .type-image + .type-image {\n        margin-left: 10%; }\n    .component--Layout .holder > div {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-orient: horizontal;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: row;\n              flex-direction: row;\n      height: 100%; }\n      .component--Layout .holder > div > div {\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        -webkit-box-pack: center;\n            -ms-flex-pack: center;\n                justify-content: center; }\n        .component--Layout .holder > div > div > img {\n          max-height: 100%;\n          max-width: 100%;\n          height: auto !important; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),logger_1=__webpack_require__(16),LayoutDrawerController=function(){function LayoutDrawerController(){this.manager=easydeps_1.default.getInstance().request(["productManager"])[0]}return LayoutDrawerController.prototype.refresh=function(){try{this.layouts=this.manager.getLayouts()}catch(err){logger_1.default(err),this.layouts=[]}return{layouts:this.layouts}},LayoutDrawerController.prototype.setCurrentLayout=function(layoutId){this.manager.setCurrentLayout(layoutId)},LayoutDrawerController}();exports.default=LayoutDrawerController},function(module,exports,__webpack_require__){var content=__webpack_require__(269);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'.component--LayoutDrawer .selected::after {\n  -webkit-box-shadow: inset 0 0 0 2px black;\n          box-shadow: inset 0 0 0 2px black;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  content: "";\n  left: 0;\n  top: 0; }\n',""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var m=__webpack_require__(2),index_1=__webpack_require__(17),iconText=__webpack_require__(105),iconShape=(__webpack_require__(106),__webpack_require__(107)),Item_1=__webpack_require__(33),Transition_1=__webpack_require__(22),object_1=__webpack_require__(3);__webpack_require__(271);var OtherDrawer=function(){function OtherDrawer(){}return OtherDrawer.prototype.view=function(v){return m("div",{className:object_1.cleanString("component--OtherDrawer",v.attrs.className)},m("span",{className:"element-description"},"Text and shapes"),m("div",{className:"items"},m("div",{className:"item"},m(Transition_1.default,{className:"t--slide-down-bounce"},m(Item_1.default,{data:{content:{type:index_1.TEXT,value:"TEXT"}},keepPlaceholder:!0,preventPosition:!0,preventResize:!0},m("img",{src:iconText,alt:"text"})))),m("div",{className:"item"},m(Transition_1.default,{className:"t--slide-down-bounce"},m(Item_1.default,{data:{content:{type:index_1.SHAPE,value:"f101",fontFamily:"Material-Design-Iconic-Font"}},keepPlaceholder:!0,preventPosition:!0,preventResize:!0},m("img",{src:iconShape,alt:"shape"}))))))},OtherDrawer}();exports.default=OtherDrawer},function(module,exports,__webpack_require__){var content=__webpack_require__(272);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".component--OtherDrawer .items .item {\n  width: 40px;\n  height: 40px;\n  display: inline-block; }\n  .component--OtherDrawer .items .item img {\n    width: 30px;\n    height: 30px;\n    padding: 5px; }\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var eventaggregator_1=__webpack_require__(9),m=__webpack_require__(2),Area_1=__webpack_require__(59),Item_1=__webpack_require__(33),Transition_1=__webpack_require__(22),dom_1=__webpack_require__(7),helpers_1=__webpack_require__(13),object_1=__webpack_require__(3),Holder_1=__webpack_require__(58),controller_1=__webpack_require__(274);__webpack_require__(275);var ProductPreview=function(){function ProductPreview(){this.controller=new controller_1.default,this.layoutDrawn=!1}return ProductPreview.prototype.onremove=function(v){this.controller.destruct()},ProductPreview.prototype.oninit=function(v){var layout=this.controller.refresh().layout;this.layout=layout},ProductPreview.prototype.onbeforeupdate=function(v,o){var layout=this.controller.refresh().layout;(!layout||!this.layout||layout.holders.length>this.layout.holders.length+1)&&(this.layoutDrawn=!1),this.layout=layout},ProductPreview.prototype.oncreate=function(v){var _this=this;this.controller.addEvent("resize",eventaggregator_1.debounce(function(){return _this.updateScale(v.dom)},25)),this.updateScale(v.dom)},ProductPreview.prototype.onupdate=function(v){this.layoutDrawn=!0,this.updateScale(v.dom)},ProductPreview.prototype.view=function(v){return this.layout?m("div",{className:object_1.cleanString("component--ProductPreview",v.attrs.className),style:dom_1.getRectStyle(this.layout.position)},this.getHolderViews(this.layout)):null},ProductPreview.prototype.getHolderViews=function(layout){var _this=this,holders=layout.holders;if(layout.fixed)return holders.map(function(h,i){return m(Transition_1.default,{key:h.id,className:"t--slide-down-bounce",order:i,delay:200},m(Area_1.default,{key:h.id,position:h.position,style:{zIndex:i},constrain:_this.controller.getDragAreaConstrainMargin(),onareahover:function(event,item,sourceArea,targetArea,initial){return _this.controller.onHolderHover(item,sourceArea,targetArea,h,initial)},onareadrop:function(event,item){return _this.controller.onHolderContentDrop(item,h)},onarearemove:function(event,item){return _this.controller.onHolderContentRemove(item,h)}},m(Item_1.default,{data:{content:h.content,holderId:h.id},preventResize:!0,position:{left:0,top:0,width:h.position.width,height:h.position.height},onclick:function(){return _this.controller.onHolderSelect(h)}},m(Holder_1.default,{holder:h,className:h.selected?"selected":""}))))});var transitionDuration=holders.length>5?100:200;return m(Transition_1.default,{key:-1,className:"t--slide-down-bounce"},m(Area_1.default,{grid:helpers_1.setScale({width:5,height:5},this.controller.scale),constrain:this.controller.getDragAreaConstrainMargin(),onareahover:function(event,item,sourceArea,targetArea,initial){return _this.controller.onHolderHover(item,sourceArea,targetArea,void 0,initial)},onareadrop:function(event,item){return _this.controller.onHolderContentDrop(item)},onarearemove:function(event,item){return _this.controller.onHolderContentRemove(item)}},holders.map(function(h,i){return m(Item_1.default,{key:h.id,data:{content:h.content,holderId:h.id},position:h.position,onitemmoveend:function(event,item){return _this.controller.onHolderPosition(item,h)},onitemresizeend:function(event,item){return _this.controller.onHolderPosition(item,h)},onclick:function(){return _this.controller.onHolderSelect(h)}},m(Transition_1.default,{key:h.id,className:"t--slide-down-bounce",order:_this.layoutDrawn?0:i,delay:transitionDuration},m(Holder_1.default,{holder:h,className:h.selected?"selected":""})))})))},ProductPreview.prototype.updateScale=function(dom){var newScale=this.calculateScale(dom);newScale!==this.controller.scale&&this.controller.updateProductPreviewScale(newScale)},ProductPreview.prototype.calculateScale=function(dom){if(!dom||!this.controller.actualLayoutRect)return 1;var container=dom.parentElement;return null===container?1:dom_1.getInnerRect(container).width/this.controller.actualLayoutRect.width},ProductPreview}();exports.default=ProductPreview},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),enums_1=__webpack_require__(17),logger_1=__webpack_require__(16),ProductPreviewController=function(){function ProductPreviewController(){this.scale=1,this.events=[];var _a=easydeps_1.default.getInstance().request(["productManager","domEA"]),manager=_a[0],domEA=_a[1];this.manager=manager,this.domEA=domEA}return ProductPreviewController.prototype.refresh=function(){try{var productPart=this.manager.getProductPart();productPart?(this.actualLayoutRect=productPart.layout.position,this.layout=this.manager.getScaledLayout(productPart.layout)):this.layout=void 0}catch(err){logger_1.default(err),this.layout=void 0}return{layout:this.layout}},ProductPreviewController.prototype.destruct=function(){this.events.forEach(function(sub){return sub.off()}),this.events=[]},ProductPreviewController.prototype.addEvent=function(event,callback){this.events.push(this.domEA.on(event,callback))},ProductPreviewController.prototype.onHolderHover=function(item,sourceArea,targetArea,holder,initial){var content=(item.getBoundingClientRect(),targetArea.getBoundingClientRect(),item.getData("content"));if(initial)if(void 0===holder){if(!this.layout)return!1;if(content.type===enums_1.IMAGE){var position=item.getPosition(),targetHeight=this.layout.position.height,targetWidth=position.width*(targetHeight/position.height);item.setStaticPosition({height:targetHeight,width:targetWidth>this.layout.position.width?this.layout.position.width:targetWidth})}content.type===enums_1.TEXT&&item.setStaticPosition({height:80,width:160}),content.type===enums_1.SHAPE&&item.setStaticPosition({height:80,width:80})}else content.type===enums_1.IMAGE&&holder.type.indexOf(content.type);return!holder||!content||-1!==holder.type.indexOf(content.type)},ProductPreviewController.prototype.onHolderContentDrop=function(item,holder){var position,content={type:enums_1.TEXT};void 0!==item&&(content=item.getData("content")),void 0===holder&&(holder=this.manager.addHolder(),void 0!==item&&(position=item.getPosition({snapToGrid:!0}))),content.fontSize&&(content.fontSize=(parseFloat(content.fontSize)*(1/this.scale)).toString()),content.lineHeight&&(content.lineHeight=(parseFloat(content.lineHeight)*(1/this.scale)).toString()),this.manager.updateHolder({id:holder.id,content:content,position:position}),!0!==holder.selected&&this.manager.setCurrentHolder(holder.id)},ProductPreviewController.prototype.onHolderContentRemove=function(item,holder){if(void 0===holder){var holderId=item.getData("holderId");void 0!==holderId&&this.manager.removeHolder(holderId)}else this.manager.removeHolderContent(holder.id);this.manager.setCurrentHolder()},ProductPreviewController.prototype.onHolderSelect=function(holder){void 0===holder?this.manager.setCurrentHolder():this.manager.setCurrentHolder(holder.id)},ProductPreviewController.prototype.onHolderPosition=function(item,holder){var position=item.getPosition();this.manager.updateHolder({id:holder.id,position:position}),!0!==holder.selected&&this.manager.setCurrentHolder(holder.id)},ProductPreviewController.prototype.getDragAreaConstrainMargin=function(){return{margin:50*this.scale}},ProductPreviewController.prototype.updateProductPreviewScale=function(scale){this.scale=scale,this.manager.setPreviewScale(scale)},ProductPreviewController.prototype.getScaledHolder=function(holder){return this.manager.getScaledHolder(holder)},ProductPreviewController}();exports.default=ProductPreviewController},function(module,exports,__webpack_require__){var content=__webpack_require__(276);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'.component--ProductPreview {\n  position: relative;\n  background: white url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAC7UlEQVRIS42WS08qQRCFqxVUoiI+kShuFFzoxp3+/4U7V24Q3PCQp6ARHIJg33x9U5NmHNBKCDPd1fU6p6rHWGttr9eT3d1dWV1dlSAI5PPzU/b39wV5e3uTTCbjntE7ODhwz7VaTfL5vHtW4WwqlZJWq+XsTSYTMTh4fn6W8/PzUPH19dU5QGFtbW3OSLPZlFwuJ8PhUEajkWSz2bl9fdHAnAOUt7a2pNPpyMrKiotSox0MBjIejyWZTIbRqxP2iBTd6XQqx8fH8vT0JMViMXRqhsOh3dzclH6/L3t7e/L+/i47OzuhAu9kcnh4GK5RnvX1dTk6OnJrHx8fsr29PZcJTtPptJjpdGqpvS9gwBpGfCFDNerjEVcjrYorEbUkC5VGoyEnJyextfV1CEDLOZvNHB7YAmhKBn7OASkDXCKRWGg0GgSKcSRgHZLAPKrgHLBYr9fl9PQ0dACwGxsbPxw+Pj7K9fV1bCDqUMFHKXSwrB5ab/1XGnPm4eFBrq6uQryi2Jhms2mhVzTd7+9vR1kVPyrWaCrKpo0Hbghs83sndLAUUW9Tu9Xv8K+vL9cnKlpusP1RIm2ivzpUPXUcPWfq9borEbz1G0xrCd2Wscs3CDGI/uLiQuCOMUZMuVy2LKhour810l9IsZRFAEhEDL2XlxfXOGdnZ3N20dFu1yyjGZtut2uVCf6mpqgW2WMu0fGkHh0jqgf43W5XCoWCG+kOZCJkxmCAltd5o4d0rug7BnT4EQjzn0kQJ6bf71tGbpz4w0334TtGAfP29tYt+5T17bTb7Xma+pGpYrVadSMDhi0qi+rS4eCmg5LmDPtA74NKpeJohuEoqBiKm/3LGGVqtZrVIcdhomQKkjYMUoO/jXAajQogGhg2TKlUslzezHBEM+F5kdG40b0oCxMEgYXD/KIDjUMwCFCjVyIgw7boR4E6ur+/l7u7u/8YgPairwMOQGMM0S+lUkkuLy/dRc8Ff3NzE2bvZ8E+Jf4H0Db2NpBHhswAAAAASUVORK5CYII=") repeat; }\n  .component--ProductPreview .component--DragArea {\n    background-color: rgba(0, 0, 0, 0.2);\n    overflow: hidden; }\n    .component--ProductPreview .component--DragArea.disabled {\n      position: absolute;\n      top: 0;\n      left: 0;\n      display: block;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(255, 0, 0, 0.5);\n      background-image: linear-gradient(to top left, transparent 0%, transparent calc(50% - 2px), black 50%, transparent calc(50% + 2px), transparent 100%), linear-gradient(to top right, transparent 0%, transparent calc(50% - 2px), black 50%, transparent calc(50% + 2px), transparent 100%); }\n    .component--ProductPreview .component--DragArea.focus:after {\n      -webkit-box-shadow: inset 0 0 0 2px black;\n              box-shadow: inset 0 0 0 2px black;\n      display: block;\n      content: "";\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      position: absolute; }\n  .component--ProductPreview .holder {\n    top: 0 !important;\n    left: 0 !important;\n    width: 100% !important;\n    height: 100% !important; }\n    .component--ProductPreview .holder.selected:after {\n      -webkit-box-shadow: inset 0 0 0 4px black;\n              box-shadow: inset 0 0 0 4px black;\n      display: block;\n      content: "";\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      position: absolute; }\n',""])},function(module,exports,__webpack_require__){var content=__webpack_require__(278);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,".t--slide-right {\n  -webkit-transition: opacity 0.125s, -webkit-transform 0.25s;\n  transition: opacity 0.125s, -webkit-transform 0.25s;\n  transition: transform 0.25s, opacity 0.125s;\n  transition: transform 0.25s, opacity 0.125s, -webkit-transform 0.25s; }\n  .t--slide-right.before {\n    -webkit-transform: translate3d(-100vw, 0, 0);\n            transform: translate3d(-100vw, 0, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: transform 0.25s, opacity 0.125s 0.125s;\n    transition: transform 0.25s, opacity 0.125s 0.125s, -webkit-transform 0.25s; }\n  .t--slide-right.after {\n    -webkit-transform: translate3d(100vw, 0, 0);\n            transform: translate3d(100vw, 0, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: transform 0.25s, opacity 0.125s 0.125s;\n    transition: transform 0.25s, opacity 0.125s 0.125s, -webkit-transform 0.25s; }\n\n.t--slide-down {\n  -webkit-transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s;\n  transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s;\n  transition: transform 0.25s 0.05s, opacity 0.125s 0.05s;\n  transition: transform 0.25s 0.05s, opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s; }\n  .t--slide-down.before {\n    -webkit-transform: translate3d(0, -100px, 0);\n            transform: translate3d(0, -100px, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: transform 0.25s, opacity 0.125s 0.125s;\n    transition: transform 0.25s, opacity 0.125s 0.125s, -webkit-transform 0.25s; }\n  .t--slide-down.after {\n    -webkit-transform: translate3d(0, 100px, 0);\n            transform: translate3d(0, 100px, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s;\n    transition: transform 0.25s, opacity 0.125s 0.125s;\n    transition: transform 0.25s, opacity 0.125s 0.125s, -webkit-transform 0.25s; }\n\n.t--slide-down-bounce {\n  -webkit-transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n  transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n  transition: transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.05s;\n  transition: transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n  .t--slide-down-bounce.before {\n    -webkit-transform: translate3d(0, -100px, 0);\n            transform: translate3d(0, -100px, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s;\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n  .t--slide-down-bounce.after {\n    -webkit-transform: translate3d(0, 100px, 0);\n            transform: translate3d(0, 100px, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s;\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n\n.t--slide-right-bounce {\n  -webkit-transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n  transition: opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n  transition: transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.05s;\n  transition: transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.05s, -webkit-transform 0.25s 0.05s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n  .t--slide-right-bounce.before {\n    -webkit-transform: translate3d(-100px, 0, 0);\n            transform: translate3d(-100px, 0, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s;\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n  .t--slide-right-bounce.after {\n    -webkit-transform: translate3d(100px, 0, 0);\n            transform: translate3d(100px, 0, 0);\n    opacity: 0;\n    -webkit-transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72);\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s;\n    transition: transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72), opacity 0.125s 0.125s, -webkit-transform 0.25s cubic-bezier(0.63, 0.44, 0.37, 1.72); }\n\n.t--switch-fast {\n  -webkit-transition: all 0.25s;\n  transition: all 0.25s; }\n  .t--switch-fast.before, .t--switch-fast.after {\n    max-height: 0;\n    max-width: 0;\n    margin: 0;\n    padding: 0;\n    overflow: hidden;\n    -webkit-transform: scale(0);\n            transform: scale(0);\n    -webkit-transition: all 0.25s;\n    transition: all 0.25s; }\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(280);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0};options.transform=void 0;__webpack_require__(6)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(!1),exports.push([module.i,'body {\n  margin: 0;\n  background-color: #1a1a1a; }\n\n.result-cover {\n  width: 100vw;\n  height: 100vh;\n  position: fixed;\n  top: 0;\n  left: 0;\n  background-color: #1a1a1a;\n  z-index: -1; }\n\n.component--Main {\n  width: 100%;\n  max-width: 1024px;\n  margin: 0 auto;\n  background-color: #41af68;\n  overflow-x: hidden; }\n  .component--Main * {\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    font-family: "Segoe UI", monospace; }\n  .component--Main .sideBySide {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex; }\n    .component--Main .sideBySide > * {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      width: 0; }\n  .component--Main .element-description {\n    line-height: 24px;\n    color: white; }\n  .component--Main .defaultLib {\n    background-color: rgba(255, 255, 255, 0.6); }\n    .component--Main .defaultLib > .nav {\n      background-color: #f1861d; }\n  .component--Main .component--DragItem.dragging.within-area img {\n    display: block;\n    height: 100%;\n    width: 100%;\n    -o-object-fit: cover;\n       object-fit: cover; }\n  .component--Main .component--HolderDrawer,\n  .component--Main .component--LayoutDrawer,\n  .component--Main .component--ImageDrawer,\n  .component--Main .component--OtherDrawer {\n    padding: 5px 10px;\n    width: calc(100% - 20px); }\n  .component--Main .col-component--EditorDrawer {\n    min-height: 270px; }\n  .component--Main .component--ImageDrawer {\n    height: calc(100vh - 115px); }\n  .component--Main img.pixelated,\n  .component--Main .pixelated img {\n    -ms-interpolation-mode: nearest-neighbor;\n        image-rendering: -webkit-optimize-contrast;\n        image-rendering: -moz-crisp-edges;\n        image-rendering: -o-pixelated;\n        image-rendering: pixelated; }\n  .component--Main button {\n    padding: 5px;\n    cursor: pointer;\n    background-color: rgba(255, 255, 255, 0.6);\n    border: none;\n    margin: 2px; }\n  .component--Main .preview-wrapper {\n    width: calc(100% - 10px);\n    padding: 0 10px 10px 0; }\n',""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var index_1=__webpack_require__(17),object_1=__webpack_require__(3),holderId=0,getNextHolderId=function(){return holderId++},layouts0={id:"0",position:{top:0,left:0,width:300,height:40},holders:[{id:getNextHolderId(),position:{top:5,left:5,width:90,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:105,width:90,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:205,width:90,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0}],fixed:!0},layouts1={id:"1",position:{top:0,left:0,width:300,height:40},holders:[{id:getNextHolderId(),position:{top:5,left:5,width:140,height:30},content:{value:"text",type:index_1.TEXT,fontFamily:"sans-serif",fontSize:"22",align:"center"},type:[index_1.TEXT],fixed:!0},{id:getNextHolderId(),position:{top:5,left:150,width:145,height:30},content:{type:index_1.IMAGE},type:[index_1.IMAGE],fixed:!0}],fixed:!0},layouts2={id:"2",position:{top:0,left:0,width:300,height:40},holders:[{id:getNextHolderId(),position:{top:5,left:5,width:30,height:30},content:{type:index_1.IMAGE},type:[index_1.IMAGE,index_1.SHAPE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:40,width:220,height:30},content:{type:index_1.IMAGE},type:[index_1.IMAGE,index_1.SHAPE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:265,width:30,height:30},content:{type:index_1.IMAGE},type:[index_1.IMAGE,index_1.SHAPE],fixed:!0}],fixed:!0},layouts3={id:"3",position:{top:0,left:0,width:300,height:40},holders:[],fixed:!1},layouts4={id:"4",position:{top:0,left:0,width:300,height:40},holders:[{id:getNextHolderId(),position:{top:0,left:0,width:300,height:40},content:{type:index_1.IMAGE},type:[index_1.IMAGE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:5,width:30,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:40,width:125,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0},{id:getNextHolderId(),position:{top:5,left:170,width:125,height:30},content:{value:"text",fontFamily:"sans-serif",fontSize:"22",align:"center",type:index_1.TEXT},type:[index_1.TEXT,index_1.SHAPE,index_1.IMAGE],fixed:!0}],fixed:!0},layouts5={id:"5",position:{top:0,left:0,width:300,height:200},holders:[],fixed:!1},layouts=[layouts3,layouts5,layouts0,layouts1,layouts2,layouts4],imageFilter=[{key:"none",value:{}},{key:"grayscale",value:{filter:"grayscale(1)"}},{key:"darken",value:{filter:"brightness(.5)"}},{key:"lighten",value:{filter:"brightness(2)"}},{key:"low contrast",value:{filter:"contrast(.5)"}},{key:"high contrast",value:{filter:"contrast(2)"}},{key:"invert",value:{filter:"invert(1)"}},{key:"sepia",value:{filter:"sepia(1)"}},{key:"low saturate",value:{filter:"saturate(.5)"}},{key:"high saturate",value:{filter:"saturate(2)"}},{key:"light blur",value:{filter:"blur(2.5px)",transform:"scale(1.1)"}},{key:"medium blur",value:{filter:"blur(10px)",transform:"scale(1.5)"}},{key:"high blur",value:{filter:"blur(20px)",transform:"scale(3)"}},{key:"extreme blur",value:{filter:"blur(80px)",transform:"scale(12)"}}],textFilter=[{key:"none",value:{}},{key:"black stroke thin",value:{width:".5",color:"black"}},{key:"white stroke thin",value:{width:".5",color:"white"}},{key:"black stroke medium",value:{width:"1",color:"black"}},{key:"white stroke medium",value:{width:"1",color:"white"}},{key:"black stroke thick",value:{width:"3",color:"black"}},{key:"white stroke thick",value:{width:"3",color:"white"}},{key:"emboss",value:{textShadow:"-.02em -.02em .02em #fff, .02em .02em .02em #000"}},{key:"inset",value:{textShadow:".01em .01em 0 rgba(140,140,140,0.6), -.01em -.01em .01em rgba(0,0,0,0.67)"}},{key:"small white drop shadow",value:{textShadow:".04em .04em #fff"}},{key:"small black drop shadow",value:{textShadow:".04em .04em #000"}},{key:"small white drop shadow blur",value:{textShadow:".04em .04em .08em #fff"}},{key:"small black drop shadow blur",value:{textShadow:".04em .04em .08em #000"}},{key:"small white shadow behind",value:{textShadow:"0 0 .08em #fff"}},{key:"small black shadow behind",value:{textShadow:"0 0 .08em #000"}},{key:"medium white shadow behind",value:{textShadow:"0 0 .16em #fff"}},{key:"medium black shadow behind",value:{textShadow:"0 0 .16em #000"}},{key:"large white shadow behind",value:{textShadow:"0 0 .32em #fff"}},{key:"large black shadow behind",value:{textShadow:"0 0 .32em #000"}},{key:"funny",value:{textShadow:"-1px -1px 0 #6e1f58, 1px -1px 0 #6e1f58, -1px 1px 0 #6e1f58, 1px 1px 0 #6e1f58,\n1px 0px 0px #65f283, 0px 1px 0px #65f283, 2px 1px 0px #65f283, 1px 2px 0px #65f283,\n3px 2px 0px #65f283, 2px 3px 0px #65f283, 4px 3px 0px #65f283, 3px 4px 0px #65f283,\n5px 4px 0px #65f283, 3px 5px 0px #6e1f58, 6px 5px 0px #6e1f58, -1px 2px 0 black,\n0 3px 0 #6e1f58, 1px 4px 0 #6e1f58, 2px 5px 0px #6e1f58, 2px -1px 0 #6e1f58,\n3px 0 0 #6e1f58, 4px 1px 0 #6e1f58, 5px 2px 0px #6e1f58, 6px 3px 0 #6e1f58,\n7px 4px 0 #6e1f58, 10px 10px 4px #dac249"}},{key:"neon",value:{textShadow:"0 0 10px rgba(255,255,255,1),\n0 0 20px rgba(255,255,255,1),\n0 0 30px rgba(255,255,255,1),\n0 0 40px #ff00de,\n0 0 70px #ff00de,\n0 0 80px #ff00de,\n0 0 100px #ff00de"}},{key:"retro",value:{textShadow:".04em .04em 0 rgb(238,238,238), .06em .06em 0 rgb(112,112,112)"}}],productParts=[{id:"default",layout:object_1.clone(layouts[0]),layouts:layouts,options:{fontFamily:["sans-serif","serif","cursive","fantasy","monospace","Schoolbell","Bungee","Open Sans Condensed","Indie Flower","Lobster","Shadows Into Light","Amatic SC"],fontSize:Array(50).fill(4).map(function(x,i){return(x+2*i).toString()}),lineHeight:Array(50).fill(2).map(function(x,i){return(x+2*i).toString()}),align:["left","center","right"],backgroundColor:["transparent","white","black","red","blue","green","orange"],color:["black","white","red","blue","green","orange"],fontStyle:["normal","italic"],textDecoration:["none","overline","line-through","underline"],fontWeight:["normal","light","bold"],textFilter:textFilter,shapeFilter:textFilter,imageFilter:imageFilter}}],product={id:"0",productParts:productParts,defaults:{fontFamily:"sans-serif",fontSize:"22",align:"center"}};exports.default=product},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var easydeps_1=__webpack_require__(14),Store=__webpack_require__(101),firebase_1=__webpack_require__(45),logger_1=__webpack_require__(16),deps=easydeps_1.default.getInstance();exports.registerBrowser=function(){var browserKey=Store.get("stat-browser-key"),browser=deps.request(["browser"])[0];if(!browserKey){var version_1=browser.version.replace(/\./g,"_");firebase_1.transaction("/stat/browser/"+browser.name,function(){return{count:1,versions:(_a={},_a[version_1]={count:1},_a)};var _a},function(data){return data.count++,data.versions[version_1]?data.versions[version_1].count++:data.versions[version_1].count=1,data},function(err,committed,snapshot){Store.set("stat-browser-key",snapshot.key),err&&logger_1.default(err)})}},exports.registerCheckin=function(){var browserKey=Store.get("stat-checkin-key"),browser=deps.request(["browser"])[0];firebase_1.transaction("/stat/checkin/"+browserKey+"/",function(){return __assign({},browser,{visits:1})},function(data){return data.visits++,deps.register("browserVisits",data.visits),data},function(err,committed,snapshot){Store.set("stat-checkin-key",snapshot.key),err&&logger_1.default(err)})}}]);